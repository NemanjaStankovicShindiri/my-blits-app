!function(){function e(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function t(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach(function(e){o(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function o(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e){return function(){return new i(e.apply(this,arguments))}}function i(e){var t,o;function r(t,o){try{var n=e[t](o),s=n.value,l=s instanceof a;Promise.resolve(l?s.v:s).then(function(o){if(l){var a="return"===t?"return":"next";if(!s.k||o.done)return r(a,o);o=e[a](o).value}i(n.done?"return":"normal",o)},function(e){r("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):o=null}this._invoke=function(e,i){return new Promise(function(n,s){var a={key:e,arg:i,resolve:n,reject:s,next:null};o?o=o.next=a:(t=o=a,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function n(e){return new a(e,0)}function s(e){var t={},o=!1;function r(t,r){return o=!0,r=new Promise(function(o){o(e[t](r))}),{done:!1,value:new a(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return o?(o=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(o)throw o=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return o?(o=!1,e):r("return",e)}),t}function a(e,t){this.v=e,this.k=t}function l(e){var t,o,r,i=2;for("undefined"!=typeof Symbol&&(o=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(o&&null!=(t=e[o]))return t.call(e);if(r&&null!=(t=e[r]))return new h(t.call(e));o="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function h(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return h=function(e){this.s=e,this.n=e.next},h.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var o=this.s.return;return void 0===o?Promise.resolve({value:e,done:!0}):t(o.apply(this.s,arguments))},throw:function(e){var o=this.s.return;return void 0===o?Promise.reject(e):t(o.apply(this.s,arguments))}},new h(e)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},System.register([],function(e,i){"use strict";return{execute:function(){var e;const a={cleanup:Symbol("cleanup"),currentView:Symbol("currentView"),cursorTagStart:Symbol("cursorTagStart"),computedKeys:Symbol("computedKeys"),destroy:Symbol("destroy"),rendererEventListeners:Symbol("rendererEventListeners"),getChildren:Symbol("getChildren"),holder:Symbol("holder"),id:Symbol("id"),identifier:Symbol("identifier"),index:Symbol("index"),init:Symbol("init"),inputEvents:Symbol("inputEvents"),internalEvent:Symbol("internalEvent"),intervals:Symbol("intervals"),isProxy:Symbol("isProxy"),launched:Symbol("launched"),level:Symbol("level"),methodKeys:Symbol("methodKeys"),originalState:Symbol("originalState"),propKeys:Symbol("propKeys"),raw:Symbol("raw"),ready:Symbol("ready"),renderer:Symbol("renderer"),routes:Symbol("routes"),routerHooks:Symbol("routerHooks"),settings:Symbol("settings"),state:Symbol("state"),stateKeys:Symbol("stateKeys"),textnode:Symbol("textnode"),timeouts:Symbol("timeouts"),type:Symbol("type"),watchers:Symbol("watchers"),watchKeys:Symbol("watchKeys"),wrapper:Symbol("wrapper"),children:Symbol.for("children"),components:Symbol.for("components"),config:Symbol.for("config"),isSlot:Symbol.for("isSlot"),props:Symbol.for("props"),slots:Symbol.for("slots"),componentType:Symbol.for("componentType"),isComponent:Symbol.for("isComponent"),effects:Symbol.for("effects"),removeGlobalEffects:Symbol.for("removeGlobalEffects")},h={[a.settings]:{},get(e,t=null){return e in this[a.settings]?this[a.settings][e]:t},set(e,t){"object"==typeof e?Object.keys(e).forEach(t=>{this.set(t,e[t])}):this[a.settings][e]=t}},d=()=>{},c=e=>String(e).padStart(2,"0"),u=()=>{const e=new Date;return c(e.getHours())+":"+c(e.getMinutes())+":"+c(e.getSeconds())},p=e=>{const t=h.get("debugLevel"),o={};return Object.defineProperty(o,"info",{get:()=>(t>=1||Array.isArray(t)&&t.indexOf("info")>-1)&&console.info.bind(window.console,`%c ⚡️ ${e} %c ${u()}`,"background-color: #0284c7; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||d}),Object.defineProperty(o,"warn",{get:()=>(t>=1||Array.isArray(t)&&t.indexOf("warn")>-1)&&console.warn.bind(window.console,`%c ⚡️ ${e} %c ${u()}`,"background-color: #fbbf24; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||d}),Object.defineProperty(o,"error",{get:()=>(t>=1||Array.isArray(t)&&t.indexOf("error")>-1)&&console.error.bind(window.console,`%c ⚡️ ${e} %c ${u()}`,"background-color: #dc2626; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||d}),Object.defineProperty(o,"debug",{get:()=>(t>=2||Array.isArray(t)&&t.indexOf("debug")>-1)&&console.debug.bind(window.console,`%c ⚡️ ${e} %c (${(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})`,"background-color: #e2e8f0; color: #334155; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||d}),o};let f;const m={aliceblue:"0xf0f8ffff",antiquewhite:"0xfaebd7ff",aqua:"0xffffff00",aquamarine:"0x7fffd4ff",azure:"0xf0ffffff",beige:"0xf5f5dcff",bisque:"0xffe4c4ff",black:"0x000000ff",blanchedalmond:"0xffebcdff",blue:"0x0000ffff",blueviolet:"0x8a2be2ff",brown:"0xa52a2aff",burlywood:"0xdeb887ff",cadetblue:"0x5f9ea0ff",chartreuse:"0x7fff00ff",chocolate:"0xd2691eff",coral:"0xff7f50ff",cornflowerblue:"0x6495edff",cornsilk:"0xfff8dcff",crimson:"0xdc143cff",cyan:"0x00ffffff",darkblue:"0x00008bff",darkcyan:"0x008b8bff",darkgoldenrod:"0xb8860bff",darkgray:"0xa9a9a9ff",darkgreen:"0x006400ff",darkgrey:"0xa9a9a9ff",darkkhaki:"0xbdb76bff",darkmagenta:"0x8b008bff",darkolivegreen:"0x556b2fff",darkorange:"0xff8c00ff",darkorchid:"0x9932ccff",darkred:"0x8b0000ff",darksalmon:"0xe9967aff",darkseagreen:"0x8fbc8fff",darkslateblue:"0x483d8bff",darkslategray:"0x2f4f4fff",darkslategrey:"0x2f4f4fff",darkturquoise:"0x00ced1ff",darkviolet:"0x9400d3ff",deeppink:"0xff1493ff",deepskyblue:"0x00bfffff",dimgray:"0x696969ff",dimgrey:"0x696969ff",dodgerblue:"0x1e90ffff",firebrick:"0xb22222ff",floralwhite:"0xfffaf0ff",forestgreen:"0x228b22ff",fuchsia:"0xff00ffff",gainsboro:"0xdcdcdcff",ghostwhite:"0xf8f8ffff",gold:"0xffd700ff",goldenrod:"0xdaa520ff",gray:"0x808080ff",green:"0x008000ff",greenyellow:"0xadff2fff",grey:"0x808080ff",honeydew:"0xf0fff0ff",hotpink:"0xff69b4ff",indianred:"0xcd5c5cff",indigo:"0x4b0082ff",ivory:"0xfffff0ff",khaki:"0xf0e68cff",lavender:"0xe6e6faff",lavenderblush:"0xfff0f5ff",lawngreen:"0x7cfc00ff",lemonchiffon:"0xfffacdff",lightblue:"0xadd8e6ff",lightcoral:"0xf08080ff",lightcyan:"0xe0ffffff",lightgoldenrodyellow:"0xfafad2ff",lightgray:"0xd3d3d3ff",lightgreen:"0x90ee90ff",lightgrey:"0xd3d3d3ff",lightpink:"0xffb6c1ff",lightsalmon:"0xffa07aff",lightseagreen:"0x20b2aaff",lightskyblue:"0x87cefaff",lightslategray:"0x778899ff",lightslategrey:"0x778899ff",lightsteelblue:"0xb0c4deff",lightyellow:"0xffffe0ff",lime:"0x00ff00ff",limegreen:"0x32cd32ff",linen:"0xfaf0e6ff",magenta:"0xff00ffff",maroon:"0x800000ff",mediumaquamarine:"0x66cdaaff",mediumblue:"0x0000cdff",mediumorchid:"0xba55d3ff",mediumpurple:"0x9370dbff",mediumseagreen:"0x3cb371ff",mediumslateblue:"0x7b68eeff",mediumspringgreen:"0x00fa9aff",mediumturquoise:"0x48d1ccff",mediumvioletred:"0xc71585ff",midnightblue:"0x191970ff",mintcream:"0xf5fffaff",mistyrose:"0xffe4e1ff",moccasin:"0xffe4b5ff",navajowhite:"0xffdeadff",navy:"0x000080ff",oldlace:"0xfdf5e6ff",olive:"0x808000ff",olivedrab:"0x6b8e23ff",orange:"0xffa500ff",orangered:"0xff4500ff",orchid:"0xda70d6ff",palegoldenrod:"0xeee8aaff",palegreen:"0x98fb98ff",paleturquoise:"0xafeeeeff",palevioletred:"0xdb7093ff",papayawhip:"0xffefd5ff",peachpuff:"0xffdab9ff",peru:"0xcd853fff",pink:"0xffc0cbff",plum:"0xdda0ddff",powderblue:"0xb0e0e6ff",purple:"0x800080ff",rebeccapurple:"0x663399ff",red:"0xff0000ff",rosybrown:"0xbc8f8fff",royalblue:"0x4169e1ff",saddlebrown:"0x8b4513ff",salmon:"0xfa8072ff",sandybrown:"0xf4a460ff",seagreen:"0x2e8b57ff",seashell:"0xfff5eeff",sienna:"0xa0522dff",silver:"0xc0c0c0ff",skyblue:"0x87ceebff",slateblue:"0x6a5acdff",slategray:"0x708090ff",slategrey:"0x708090ff",snow:"0xfffafaff",springgreen:"0x00ff7fff",steelblue:"0x4682b4ff",tan:"0xd2b48cff",teal:"0x008080ff",thistle:"0xd8bfd8ff",tomato:"0xff6347ff",transparent:"0x00000000",turquoise:"0x40e0d0ff",violet:"0xee82eeff",wheat:"0xf5deb3ff",white:"0xffffffff",whitesmoke:"0xf5f5f5ff",yellow:"0xffff00ff",yellowgreen:"0x9acd32ff"},g=/^#?([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,y=/^(rgba?)\((\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*)(,(\s*(-?\d+(?:\.\d+)?)\s*))?\)$/,x=/^(hsla?)\((\s*(360|3[0-5][0-9]|[12]?[0-9]{1,2})\s*),(\s*(100|[1-9]?[0-9])\s*)%,(\s*(100|[1-9]?[0-9])\s*)%(,(\s*(1|0(?:\.\d+)?)\s*))?\)$/,v={},b=e=>{if(void 0!==v[e])return v[e];const t=parseInt(e).toString(16).padStart(2,"0");return v[e]=t,t},w=(e="",t="0xffffffff")=>{if((e=e.toString()).startsWith("0x")&&10===e.length)return e;if(void 0!==m[e])return m[e];if(g.test(e)){3===(e=e.replace("#","").toLowerCase()).length&&(e=e.split("").map(e=>e+e).join(""));const t="0x"+e.padEnd(8,"f");return m[e]=t,t}const o=y.exec(e);if(o){const t=b(o[3]),r=b(o[5]),i=b(o[7]);let n="ff";if(o[10]&&"rgba"===o[1]){const e=Math.min(Math.max(Math.round(255*parseFloat(o[10])),0),255);n=b(e)}const s="0x"+t+r+i+n;return m[e]=s,s}return x.test(e)?(console.warn("HSL(A) color format is not supported yet"),"0xffffffff"):t};let T,S;function R(e={children:[]},t=!1){const o={renderCode:["const elms = []","const elementConfigs = []","const forloops = []","const props = []","const created = []","const effects = {}","const skips = []","let componentType","let rootComponent = component","let propData","let slotComponent","let inSlot = false","let slotChildCounter = 0","let cmps = []"],effectsCode:[],cleanupCode:["rootComponent = null","propData = null","slotComponent = null","parent = null"],context:{props:[],components:this.components}};return T=-1,S=t,!0===S&&o.renderCode.push("\n      function propInComponent(prop, kind=\"dynamic\") {\n        const property = prop.includes('.') ? prop.split('.')[0] : prop\n        if (kind === 'reactive' || prop.includes('.') === false) {\n          if (property in component === false) {\n            Log.warn('Property ' +  property + ' was accessed during render but is not defined on instance')\n          }\n        } else {\n          const nestedKeys = prop.split('.')\n          let base = component\n          for(let i =0; i<nestedKeys.length;i++){\n            if (base[nestedKeys[i]] === undefined) {\n              Log.warn('Property ' +  nestedKeys.slice(0,i+1).join('.') + ' was accessed during render but is not defined on instance')\n            }\n            base = base[nestedKeys[i]]\n          }\n        }\n      }\n    "),k.call(o,e),o.renderCode.push(`\n    return { elms, cleanup: () => {\n      ${o.cleanupCode.join("\n")}\n      component = null\n      cmps.length = 0\n      elms.length = 0\n      components.length = 0\n      elementConfigs.length = 0\n      forloops.length = 0\n      props.length = 0\n      skips.length = 0\n    }}\n  `),{render:new Function("parent","component","context","components","effect","getRaw","Log",o.renderCode.join("\n")),effects:o.effectsCode.map(e=>new Function("component","elms","context","components","rootComponent","effect",e)),context:o.context}}const E=function(e,t,o="dynamic"){const r=function(e){const t=e.match(/\$\$?\w+(\.\w+)?/g);if(null!==t){const e=/\$shader/;return t.filter(t=>!e.test(t))}return!1}(e);if(!1!==r)for(let i=0;i<r.length;i++){let e=r[i];"reactive"===o&&e.includes(".")&&(e=e.split(".")[0]),t.push(`propInComponent('${e.replace("$","")}', '${o}')`)}},_=function(e,t=!1,o={key:!1,component:"component.",forceEffect:!1,forloop:!1}){const r=o.forceEffect?this.effectsCode:this.renderCode;t&&r.push(`parent = ${t}`),"key"in e&&(o.key=M(e.key,o.component));const i=o.key?`elms[${T}][${o.key}]`:`elms[${T}]`;o.key&&r.push(`\n      if(elms[${T}] === undefined) {\n        elms[${T}] = {}\n      }\n    `),r.push(`elementConfigs[${T}] = {}`),o.forloop&&r.push(`if(${i} === undefined) {`),r.push(`\n    ${i} = this.element({parent: parent || 'root'}, inSlot === true ? slotComponent : component)\n  `),o.forloop&&r.push("}");const n=e.children;delete e.children,"Slot"===e[Symbol.for("componentType")]&&r.push(`elementConfigs[${T}][Symbol.for('isSlot')] = true`),Object.keys(e).forEach(t=>{if("slot"===t&&r.push(`\n        elementConfigs[${T}]['parent'] = slotComponent[Symbol.for('slots')] !== undefined && Array.isArray(slotComponent[Symbol.for('slots')]) === true && slotComponent[Symbol.for('slots')].filter(slot => slot.ref === '${e.slot}').shift() || parent\n      `),"key"===t)return;if("inspector-data"===t&&!S)return;const n=e[t];if(I(t)){if(o.holder&&":color"===t)return;o.holder?this.effectsCode.push(`\n        if(typeof skips === 'undefined' || (typeof skips[${T}] === 'undefined' ||\n          skips[${T}].indexOf('${t.substring(1)}') === -1))\n          ${i}.set('${t.substring(1)}', ${M(e[t],o.component)})\n        `):this.effectsCode.push(`\n            ${i}.set('${t.substring(1)}', ${M(e[t],o.component)})\n          `),!0===S&&"scope."!==o.component&&n.includes("$")&&E(n,r,"reactive"),r.push(`elementConfigs[${T}]['${t.substring(1)}'] = ${M(n,o.component)}`)}else!0===S&&"scope."!==o.component&&n.includes("$")&&E(n,r),r.push(`elementConfigs[${T}]['${t}'] = ${O(n,t,o.component)}`)}),!0===o.holder&&r.push(`\n    skips[${T}] = []\n    if(typeof cmps[${T}] !== 'undefined') {\n      for(let key in cmps[${T}][Symbol.for('config')].props) {\n        delete elementConfigs[${T}][cmps[${T}][Symbol.for('config')].props[key]]\n        skips[${T}].push(cmps[${T}][Symbol.for('config')].props[key])\n      }\n    }\n    `),o.forloop&&r.push(`if(${i}.nodeId === undefined) {`),r.push(`${i}.populate(elementConfigs[${T}])`),r.push("\n    if(inSlot === true) {\n      slotChildCounter -= 1\n    }\n  "),o.forloop&&r.push("}"),n&&k.call(this,{children:n},`${i}`,o)},C=function(e,o=!1,r={key:!1,component:"component.",forceEffect:!1,holder:!1,forloop:!1}){const i=r.forceEffect?this.effectsCode:this.renderCode;i.push(`\n    cmps[${T}] =\n      (context.components && context.components['${e[Symbol.for("componentType")]}']) || components['${e[Symbol.for("componentType")]}']\n  `),this.cleanupCode.push(`\n    cmps[${T}] = null\n  `),"key"in e&&(r.key=M(e.key,r.component));const n=e.children;delete e.children,_.call(this,e,o,t(t({},r),{holder:!0})),o=r.key?`elms[${T}][${r.key}]`:`elms[${T}]`,T++;const s=r.key?`elms[${T}][${r.key}]`:`elms[${T}]`;r.key&&i.push(`\n      if(elms[${T}] === undefined) {\n        elms[${T}] = {}\n      }\n    `),o&&i.push(`parent = ${o};`),i.push(`props[${T}] = {}`),this.cleanupCode.push(`props[${T}] = null`),r.forloop&&i.push(`if(${s} === undefined) {`),Object.keys(e).forEach(t=>{I(t)?(this.effectsCode.push(`\n        ${s}[Symbol.for('props')]['${t.substring(1)}'] = ${M(e[t],r.component)}`),i.push(`\n        propData = ${M(e[t],r.component)}\n        if (Array.isArray(propData) === true) {\n          propData = getRaw(propData).slice(0)\n        }\n        props[${T}]['${t.substring(1)}'] = propData`)):i.push(`props[${T}]['${t}'] = ${O(e[t],t,r.component)}`)}),i.push(`\n    componentType = props[${T}]['is'] || '${e[Symbol.for("componentType")]}'\n\n    components[${T}]\n    if(typeof componentType === 'string') {\n      components[${T}] = context.components && context.components[componentType] || components[componentType]\n      if(!components[${T}]) {\n        throw new Error('Component "${e[Symbol.for("componentType")]}" not found')\n      }\n    } else if(typeof componentType === 'function' && componentType[Symbol.for('isComponent')] === true) {\n      components[${T}] = componentType\n    }\n\n    ${s} = components[${T}].call(null, {props: props[${T}]}, ${o}, component)\n\n    if (${s}[Symbol.for('slots')][0]) {\n      parent = ${s}[Symbol.for('slots')][0]\n      slotComponent = ${s}\n      inSlot = true\n    } else {\n      parent = ${s}[Symbol.for('children')][0]\n    }\n  `),this.cleanupCode.push(`components[${T}] = null`),r.forloop&&i.push("}"),n&&(r.forloop||i.push(`\n        if(inSlot === true) {\n          slotChildCounter = ${n.length}  + 1\n        }\n      `),T++,_.call(this,{children:n},!1,t({},r))),r.forloop||i.push("\n      if (inSlot === true && slotChildCounter === 0) {\n        inSlot = false\n      }\n    ")},A=function(e,t){const o=e[":for"];delete e[":for"];const r=e.range||e[":range"]||"{}";delete e.range,delete e[":range"];const i=e.key,n=T,s=M(i,"scope."),a=!(e.$shallow&&"false"===e.$shallow.toLowerCase());delete e.$shallow,delete e.key;const l=/(.+)\s+in\s+(.+)/gi.exec(o),[h,d]=l[1].replace("(","").replace(")","").split(/\s*,\s*/),c=new RegExp(`(scope\\.(?!${h}\\.|${d}|key)([\\w$]+))`,"gi"),u={renderCode:[],effectsCode:[],cleanupCode:[],context:{props:[],components:this.components}};if(t&&u.renderCode.push(`parent = ${t}`),void 0!==d){const e=new RegExp(`\\$${d}(?!['\\w])`).exec(i);Array.isArray(e)&&u.renderCode.push(`console.warn(" Using '${d}' in the key, like key=${i},  is not recommended")`)}u.renderCode.push(`\n    created[${n}] = []\n    effects[${n}] = []\n\n    let from${n}\n    let to${n}\n\n    forloops[${n}] = (collection = [], elms, created) => {\n      const rawCollection = getRaw(collection)\n      const keys = new Set()\n      let l = rawCollection.length\n\n      const range = ${M(r,"component?.")} || {}\n      from${n} = range['from'] || 0\n      to${n} = 'to' in range ? range['to'] : rawCollection.length\n\n      while(l--) {\n        const ${h} = rawCollection[l]\n  `),u.cleanupCode.push(`\n    created[${n}].length = 0\n  `),void 0!==d&&u.renderCode.push(`\n        const ${d} = l\n    `),u.renderCode.push(`\n        if(l < to${n} && l >= from${n}) {\n          keys.add('' +  ${M(i,"")||"l"})\n        }\n      }\n  `);const p=u.renderCode.length;u.renderCode.push(`\n      created.length = 0\n      const length = rawCollection.length\n\n      component !== null && component[Symbol.for('removeGlobalEffects')](effects[${n}])\n\n      for(let i = 0; i < effects[${n}].length; i++) {\n        const value = effects[${n}][i]\n        const index = component[Symbol.for('effects')].indexOf(value)\n        if (index > -1) component[Symbol.for('effects')].splice(index, 1)\n      }\n\n      effects[${n}].length = 0\n      for(let __index = 0; __index < length; __index++) {\n        if(__index < from${n} || __index >= to${n}) continue\n        let scope = Object.create(component)\n        parent = ${t}\n        scope['${h}'] = rawCollection[__index]\n  `),""!==d&&u.renderCode.push(`\n        scope['${d}'] = __index\n    `),u.renderCode.push(`\n        scope['key'] = '' + ${s||"__index"}\n  `),"ref"in e&&-1===e.ref.indexOf("$")&&(u.renderCode.push(`\n        scope['__ref'] = '${e.ref}' + __index\n    `),e.ref="$__ref"),u.renderCode.push("\n        created.push(scope.key)\n  "),"Element"===e[Symbol.for("componentType")]||"Slot"===e[Symbol.for("componentType")]||"Text"===e[Symbol.for("componentType")]?("Text"===e[Symbol.for("componentType")]&&(e.__textnode="true"),_.call(u,e,t,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0})):C.call(u,e,!1,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0});const f=u.effectsCode.filter(e=>0===[...e.matchAll(c)].length),m=u.effectsCode.filter(e=>0!==[...e.matchAll(c)].length);!1===a&&u.renderCode.push("\n      scope = Object.assign(collection[__index], scope)\n  "),f.forEach((e,t)=>{const o=e.indexOf(`scope.${t}`)>-1?`'${M(l[2],"")}'`:null;-1===e.indexOf("Symbol.for('props')")?u.renderCode.push(`\n        let eff${t} = () => {\n          ${e}\n        }\n        effect(eff${t}, ${o})\n        effects[${n}].push(eff${t})\n        component[Symbol.for('effects')].push(eff${t})\n      `):u.renderCode.push(`\n        ${e}\n      `)}),u.renderCode.push("\n    }\n    return effects\n  }");const g=[];g.push("\n      let i = created.length\n\n      while (i--) {\n        if (keys.has(created[i]) === false) {\n          const key = created[i]\n  ");const y=T;for(let b=n;b<=y;b++)g.push(`\n        elms[${b}][key] && elms[${b}][key].destroy()\n        elms[${b}][key] = null\n        delete elms[${b}][key]\n    `);g.push("\n      }\n    }\n  "),u.renderCode.splice(p,0,...g);let x=`${M(l[2],"")}`;x&&x.includes(".")&&(x=x.match(/[^.]+$/)[0]);const v=[...r.matchAll(/\$([^,} ]+)/g)].map(e=>`'${e[1]}'`);u.renderCode.push(`\n    let eff${n} = () => {\n      forloops[${n}](${O(l[2],":for")}, elms, created[${n}])\n    }\n\n    component[Symbol.for('effects')].push(eff${n})\n\n    effect(eff${n}, ['${x}', ${v.join(",")}])\n  `),u.cleanupCode.push(`\n    eff${n} = null\n    // call loop with empty array\n    forloops[${n}]([], elms, created[${n}])\n    forloops[${n}] = null\n  `),m.forEach((e,t)=>{const o=[...e.matchAll(c)];let r=o.length;const i=[];for(;r--;){const t=o[r],n=`component.${t[2]}`;-1===i.indexOf(n)&&i.push(n),t[2]!==h&&(e=e.substring(0,t.index)+n+e.substring(t.index+t[1].length))}u.renderCode.push(`\n      let eff${n}_${t} = () => {\n        void ${i.join(", ")}\n        for(let __index = 0; __index < ${M(l[2])}.length; __index++) {\n          if(__index < from${n} || __index >= to${n}) continue\n          const scope = {}\n          scope['${d}'] = __index\n          scope['${h}'] = ${M(l[2])}[__index]\n          scope['key'] = ${s||"__index"}\n    `),u.cleanupCode.push(`eff${n}_${t} = null`),u.renderCode.push(`\n          ${e}\n        }\n      }\n      component[Symbol.for('effects')].push(eff${n}_${t})\n      effect(eff${n}_${t})\n    `)}),this.renderCode.push(u.renderCode.join("\n")),this.cleanupCode.push(u.cleanupCode.join("\n"))},k=function(e,t=!1,o={}){e.children&&e.children.forEach(e=>{T++,Object.keys(e).indexOf(":for")>-1?A.call(this,e,t):"Element"===e[Symbol.for("componentType")]||"Slot"===e[Symbol.for("componentType")]||"Text"===e[Symbol.for("componentType")]||"Layout"===e[Symbol.for("componentType")]?("Text"===e[Symbol.for("componentType")]&&(e.__textnode="true"),"Layout"===e[Symbol.for("componentType")]&&(e.__layout="true"),_.call(this,e,t,o)):C.call(this,e,t,o)})},M=(e,t="component.")=>{if(void 0===e)return e;const o=e.matchAll(/('.*?')+/gi),r=[];let i=0;for(const n of o)r.push(n[0]),e=e.replace(n[0],`[@@REPLACEMENT${i}@@]`),i++;return e=e.replace(/\$(\$(?=\$)|\$?)/g,(e,o)=>""===o?t:"$"===o?t+"$":void 0),r.forEach((t,o)=>{e=e.replace(`[@@REPLACEMENT${o}@@]`,t)}),e},O=(e="",t=!1,o="component.")=>{let r;if("content"===t)if(e.startsWith("$"))r=`${o}${e.replace("$","")}`;else{const t=e.replace(/\\\\/g,"__DOUBLE_BACKSLASH__").replace(/(^|[^\\])'/g,"$1\\'").replace(/__DOUBLE_BACKSLASH__/g,"\\\\");r=`'${P(t,o)}'`}else if("color"===t||!1!==/[^0-9%\s.eE]/.test(e)||isNaN(parseFloat(e)))if("true"===e.toLowerCase())r=!0;else if("false"===e.toLowerCase())r=!1;else if(t.startsWith("@")&&e){const t=o.slice(0,-1);r=`${t}['${e.replace("$","")}'] && ${t}['${e.replace("$","")}'].bind(${t})`}else if(e.startsWith("$"))r=`${o}${e.replace("$","")}`;else{if(/\$\w+/gi.exec(e)){const t=/\w+\s*:\s*(?:[^\s,}]+|".*?"|'.*?')/g,i=e.match(t);if(r={},i)for(let e=0;e<i.length;e++){const t=i[e].split(/\s*:\s*/);t&&L(t[0],t[1],o,r)}return F(r)}r=`"${e}"`}else if(r=parseFloat(e),e.endsWith("%")){const e={w:"width",width:"width",x:"width",h:"height",height:"height",y:"height"}[t];e&&(r=`parent.node.${e} * (${r} / 100)`)}return r},I=e=>e.startsWith(":"),P=(e,t)=>{const o=[...e.matchAll(/\{\{\s*(\$\S+)\s*\}\}/g)];if(o.length)for(let[r,i]of o)e=e.replace(r,`${i.replace("$",`'+${t}`)}+'`);return e},L=(e,t,o,r)=>{t.startsWith("$")?r[e]=`${o}${t.replace("$","")}`:r[e]=t},F=e=>{const t=[];return Object.keys(e).forEach(o=>{t.push(`${o}: ${e[o]}`)}),` { ${t.join(", ")} }`},B={};let U=0;const $={},N=(e,t,o,r=[])=>{$[t]&&$[t][e]&&$[t][e].apply(o,r)};let D=null,j=null,z=!1;const W=new WeakMap,X=new Map,G=e=>{if(0!==X.size)for(const[t,o]of X){if(-1===e.indexOf(t))continue;const r=W.get(o);if(void 0!==r)for(const e of r.values())e.delete(t),X.delete(t)}},V=(e,t,o=!1)=>{if(null!==D){if(z)return;if(!0===Array.isArray(j)){if(!1===j.includes(t))return}else if(null!==j&&t!==j)return;let r=W.get(e);void 0===r&&(r=new Map,W.set(e,r));let i=r.get(t);void 0===i&&(i=new Set,r.set(t,i)),i.add(D),!0===o&&X.set(D,e)}},H=(e,t,o=!1)=>{if(!0===z)return;const r=W.get(e);if(void 0===r)return;const i=r.get(t);if(void 0!==i)for(let n of i)n(o)},Y=(e,t=null)=>{D=e,j=t,D(),D=null,j=null},q=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;let o=e.length;for(;o--;){const r=e[o],i=t[o];if(Array.isArray(r)&&Array.isArray(i)){if(!1===q(r,i))return!1}else if("object"==typeof r&&null!==r&&"object"==typeof i&&null!==i){if(!1===q(Object.entries(r),Object.entries(i)))return!1}else if(r!==i)return!1}return!0},K=["push","pop","shift","unshift","splice","sort"],Q=new WeakMap,Z=e=>{const t=e&&e[a.raw];return t?Z(t):e},J=(e,t=null,o,r)=>{if("object"==typeof e&&!1===Array.isArray(e)&&Object.getPrototypeOf(e)!==Object.prototype)return e;const i=Q.get(e);if(void 0!==i)return i;const n=new Proxy(e,{get:(i,n,s)=>n===a.isProxy||(n===a.raw?e:!0===Array.isArray(i)?"object"==typeof i[n]&&null!==i[n]?(!0===Array.isArray(i[n])&&V(i,n,r),J(Z(i[n]),i,n,r)):-1!==K.indexOf(n)?function(...e){z=!0;const r=i[n].apply(this,e);return z=!1,H(t,o),r}:"length"===n?e.length:Reflect.get(i,n,s):"object"==typeof i[n]&&null!==i[n]?(!0===Array.isArray(i[n])&&V(i,n,r),J(Z(i[n]),i,n,r)):(V(i,n,r),Reflect.get(i,n,s))),set(e,r,i,n){const s=Z(e[r]),a=Z(i);let l=!0,h=!1;return!0===Array.isArray(a)&&!0===Array.isArray(s)?h=q(s,a):s===a&&(h=!0),!1===h&&("object"==typeof i&&(!0===Array.isArray(i)?i=Z(i).slice(0):null!==i&&null!==e[r]&&void 0!==e[r]&&!1===Array.isArray(e)&&Object.getPrototypeOf(i)===Object.prototype&&(i=Object.assign(n[r],i))),l=Reflect.set(e,r,i,n)),!0===l&&!1===h&&(!0===Array.isArray(e)&&r in e==!0&&H(t,o,!0),H(e,r,!0)),l}});return Q.set(e,n),n},ee=(e,t)=>(Object.keys(e).forEach(o=>{let r=e[o];if(null!==e[o]&&"object"==typeof e[o]){if(Object.getPrototypeOf(e[o])===Object.prototype)return ee(e[o]);if(!0===Array.isArray(e[o]))for(let t=0;t<K.length;t++)e[o][K[t]]=function(r){Array.prototype[K[t]].call(this,r),H(e,o)}}Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>(V(e,o,t),r),set(t){r!==t&&(r=t,H(e,o))}})}),e),te="undefined"!=typeof Proxy,oe=(e,t="Proxy",o=!1)=>(!1===te&&(t="defineProperty"),"defineProperty"===t?ee(e,o):J(e,void 0,void 0,o)),re=["init","ready","focus","unfocus","destroy","attach","detach","enter","exit"],ie={previous:null,current:null,get state(){return this.current},set state(e){if(re.indexOf(e)>-1&&e!==this.current||"refocus"===e){if(f.debug(`Setting lifecycle state from ${this.current} to ${e} for ${this.component.componentId}`),this.previous=this.current,this.current=e,"refocus"===e)return;((e,t,o)=>{const r=a[e];$[t]&&$[t][r]&&$[t][r].apply(o)})(e,this.component[a.identifier],this.component),N(e,this.component[a.identifier],this.component),"focus"===e&&(this.component[a.state].hasFocus=!0),"unfocus"===e&&(this.component[a.state].hasFocus=!1)}}},ne=function(e,t,o){let r=Promise.resolve();function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})};function se(e,t){}function ae(e,t,o){const r=Math.trunc(e>>>24),i=Math.trunc(e>>>16&255),n=Math.trunc(e>>>8&255),s=Math.trunc(255&e),a=Math.trunc(t>>>24),l=Math.trunc(t>>>16&255),h=Math.trunc(t>>>8&255),d=Math.trunc(255&t);return(Math.round(a*o+r*(1-o))<<24|Math.round(l*o+i*(1-o))<<16|Math.round(h*o+n*(1-o))<<8|Math.round(d*o+s*(1-o)))>>>0}function le(e,t){return(e>>>24<<24|(e>>>16&255)<<16|(e>>>8&255)<<8|Math.trunc((255&e)*t))>>>0}let he=!0;function de(e,t,o=!1){const r=(255&e)/255*t,i=he?r:1,n=Math.trunc((e>>>24)*i),s=Math.trunc((e>>>16&255)*i),a=Math.trunc((e>>>8&255)*i),l=Math.trunc(255*r);return o?(l<<24|a<<16|s<<8|n)>>>0:(n<<24|s<<16|a<<8|l)>>>0}function ce(e,t){return Object.prototype.hasOwnProperty.call(e,t)}let ue=1;class pe{constructor(){o(this,"eventListeners",{})}on(e,t){let o=this.eventListeners[e];o||(o=[]),o.push(t),this.eventListeners[e]=o}off(e,t){const o=this.eventListeners[e];if(!o)return;if(!t)return void delete this.eventListeners[e];const r=o.indexOf(t);r>=0&&o.splice(r,1)}once(e,t){const o=(r,i)=>{this.off(e,o),t(r,i)};this.on(e,o)}emit(e,t){const o=this.eventListeners[e];o&&[...o].forEach(e=>{e(this,t)})}removeAllListeners(){this.eventListeners={}}}var fe;!function(e){e[e.generic=0]="generic",e[e.color=1]="color",e[e.image=2]="image",e[e.noise=3]="noise",e[e.renderToTexture=4]="renderToTexture",e[e.subTexture=5]="subTexture"}(fe||(fe={}));class me extends pe{constructor(e){super(),o(this,"txManager",void 0),o(this,"_dimensions",null),o(this,"_error",null),o(this,"state","initial"),o(this,"renderableOwners",[]),o(this,"renderable",!1),o(this,"type",fe.generic),o(this,"preventCleanup",!1),o(this,"ctxTexture",void 0),o(this,"textureData",null),o(this,"memUsed",0),o(this,"retryCount",0),o(this,"maxRetryCount",void 0),o(this,"createdAt",Date.now()),o(this,"gracePeriodExpired",!1),this.txManager=e,this.maxRetryCount=e.maxRetryCount}get dimensions(){return this._dimensions}get error(){return this._error}isWithinStartupGracePeriod(){if(this.gracePeriodExpired)return!1;return!(Date.now()-this.createdAt>=me.STARTUP_GRACE_PERIOD)||(this.gracePeriodExpired=!0,!1)}canBeCleanedUp(){return!this.preventCleanup&&(!this.isWithinStartupGracePeriod()&&(!0!==this.renderable&&!(this.renderableOwners.length>0)))}setRenderableOwner(e,t){const o=this.renderableOwners.length,r=this.renderableOwners.indexOf(e);if(!0===t){-1===r&&this.renderableOwners.push(e);const t=this.renderableOwners.length;var i;if(o!==t&&1===t)this.renderable=!0,null===(i=this.onChangeIsRenderable)||void 0===i||i.call(this,!0),this.load()}else{-1!==r&&this.renderableOwners.splice(r,1);const e=this.renderableOwners.length;var n;if(o!==e&&0===e)this.renderable=!1,null===(n=this.onChangeIsRenderable)||void 0===n||n.call(this,!1)}}load(){this.retryCount>this.maxRetryCount||this.txManager.loadTexture(this)}loadCtxTexture(){return void 0===this.ctxTexture&&(this.ctxTexture=this.txManager.renderer.createCtxTexture(this)),this.ctxTexture}free(){var e;null===(e=this.ctxTexture)||void 0===e||e.free()}release(){var e;null===(e=this.ctxTexture)||void 0===e||e.release(),this.ctxTexture=void 0,this.freeTextureData()}destroy(){"loaded"===this.state&&this.free(),this.freeTextureData()}freeTextureData(){queueMicrotask(()=>{this.textureData=null})}setState(e,t){if(this.state===e)return;let o=null;"loaded"===e?(this._error=null,void 0!==t&&"width"in t==!0&&"height"in t==!0&&void 0!==t.width&&void 0!==t.height&&(this._dimensions=t),o=this._dimensions):"failed"===e?(this._error=t,o=this._error,this.retryCount+=1,queueMicrotask(()=>{this.release()})):"loading"===e?(this._error=null,this._dimensions=null):this._error=null,this.state=e,this.emit(e,o)}async getTextureData(){return null===this.textureData&&(this.textureData=await this.getTextureSource()),this.textureData}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}retry(){this.release(),this.retryCount=0,this.load()}}o(me,"STARTUP_GRACE_PERIOD",2e3);const ge=/^(data|ftps?|https?):/,ye=e=>[(e>>>24)/255,(e>>>16&255)/255,(e>>>8&255)/255,(255&e)/255],xe=e=>[e>>>24,e>>>16&255,e>>>8&255,255&e];function ve(e){return(255&e)/255}function be(e){return`rgba(${Math.floor(255*e[0])},${Math.floor(255*e[1])},${Math.floor(255*e[2])},${Math.floor(255*e[3]).toFixed(4)})`}function we(e,t,o,r,i){return i?(i.x1=e,i.y1=t,i.x2=o,i.y2=r,i):{x1:e,y1:t,x2:o,y2:r}}function Te(e,t){return e.x1<t.x2&&e.x2>t.x1&&e.y1<t.y2&&e.y2>t.y1}function Se(e,t,o){const r=Math.max(e.x,t.x),i=Math.max(e.y,t.y),n=Math.min(e.x+e.width,t.x+t.width)-r,s=Math.min(e.y+e.height,t.y+t.height)-i;return n>0&&s>0?o?(o.x=r,o.y=i,o.width=n,o.height=s,o):{x:r,y:i,width:n,height:s}:o?(o.x=0,o.y=0,o.width=0,o.height=0,o):{x:0,y:0,width:0,height:0}}function Re(e,t){return t?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):{x:e.x,y:e.y,width:e.width,height:e.height}}function Ee(e,t){return e.x1<=t.x2&&e.y1<=t.y2&&e.x2>=t.x1&&e.y2>=t.y1}function _e(e,t,o){return!(e<o.x1||e>o.x2||t<o.y1||t>o.y2)}function Ce(e,t){return we(e.x1-t[3],e.y1-t[0],e.x2+t[1],e.y2+t[2])}function Ae(e){return!0===e.startsWith("data:")}class ke{constructor(){o(this,"ta",void 0),o(this,"tb",void 0),o(this,"tx",void 0),o(this,"tc",void 0),o(this,"td",void 0),o(this,"ty",void 0),o(this,"_floatArr",null),o(this,"mutation",void 0),this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return Me}static multiply(e,t,o){const r=e.ta*t.ta+e.tb*t.tc,i=e.ta*t.tb+e.tb*t.td,n=e.ta*t.tx+e.tb*t.ty+e.tx,s=e.tc*t.ta+e.td*t.tc,a=e.tc*t.tb+e.td*t.td,l=e.tc*t.tx+e.td*t.ty+e.ty;return o||(o=new ke),o.ta=r,o.tb=i,o.tx=n,o.tc=s,o.td=a,o.ty=l,o.mutation=!0,o}static identity(e){return e||(e=new ke),e.ta=1,e.tb=0,e.tx=0,e.tc=0,e.td=1,e.ty=0,e.mutation=!0,e}static translate(e,t,o){return o||(o=new ke),o.ta=1,o.tb=0,o.tx=e,o.tc=0,o.td=1,o.ty=t,o.mutation=!0,o}static scale(e,t,o){return o||(o=new ke),o.ta=e,o.tb=0,o.tx=0,o.tc=0,o.td=t,o.ty=0,o.mutation=!0,o}static rotate(e,t){const o=Math.cos(e),r=Math.sin(e);return t||(t=new ke),t.ta=o,t.tb=-r,t.tx=0,t.tc=r,t.td=o,t.ty=0,t.mutation=!0,t}static copy(e,t){return t||(t=new ke),t.ta=e.ta,t.tc=e.tc,t.tb=e.tb,t.td=e.td,t.tx=e.tx,t.ty=e.ty,t.mutation=!0,t}translate(e,t){return this.tx=this.ta*e+this.tb*t+this.tx,this.ty=this.tc*e+this.td*t+this.ty,this.mutation=!0,this}scale(e,t){return this.ta=this.ta*e,this.tb=this.tb*t,this.tc=this.tc*e,this.td=this.td*t,this.mutation=!0,this}rotate(e){if(0===e||!(e%Math.PI*2))return this;const t=Math.cos(e),o=Math.sin(e),r=this.ta*t+this.tb*o,i=this.tb*t-this.ta*o,n=this.tc*t+this.td*o,s=this.td*t-this.tc*o;return this.ta=r,this.tb=i,this.tc=n,this.td=s,this.mutation=!0,this}multiply(e){return ke.multiply(this,e,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const Me=new ke;class Oe{constructor(e){o(this,"data",void 0),this.data=new Float32Array(8),e&&(this.data[0]=e[0],this.data[2]=e[2],this.data[4]=e[4],this.data[6]=e[6],this.data[1]=e[1],this.data[3]=e[3],this.data[5]=e[5],this.data[7]=e[7])}static translate(e,t,o,r,i,n,s,a,l){return l||(l=new Oe),l.data[0]=e,l.data[2]=o,l.data[4]=i,l.data[6]=s,l.data[1]=t,l.data[3]=r,l.data[5]=n,l.data[7]=a,l}get x1(){return this.data[0]}get x2(){return this.data[2]}get x3(){return this.data[4]}get x4(){return this.data[6]}get y1(){return this.data[1]}get y2(){return this.data[3]}get y3(){return this.data[5]}get y4(){return this.data[7]}}const Ie=(e,t,o,r)=>{const i=3*e,n=3*(o-e)-i,s=1-i-n,a=3*t,l=3*(r-t)-a,h=1-a-l;return function(e){if(e>=1)return 1;if(e<=0)return 0;let t,o,r,d=.5;for(let p=0;p<20;p++){if(t=d*(d*(d*s+n)+i),r=e-t,r>-1e-8&&r<1e-8)return d*(d*(d*h+l)+a);if(o=d*(d*(3*s)+2*n)+i,o>1e-10&&o<1e-10)break;d+=r/o}let c=0,u=1;for(let p=0;p<20;p++){if(d=.5*(c+u),t=d*(d*(d*s+n)+i),r=e-t,r>-1e-8&&r<1e-8)return d*(d*(d*h+l)+a);r<0?u=d:c=d}}},Pe={},Le={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},Fe=e=>e,Be=e=>{if("linear"===e)return Fe;if(void 0!==Pe[e])return Pe[e]||Fe;if("step-start"===e)return()=>1;if("step-end"===e)return e=>1===e?1:0;const t=Le[e];if(void 0!==t){const[o,r,i,n]=t,s=Ie(o,r,i,n);return Pe[e]=s,s}return e.startsWith("cubic-bezier")?(e=>{const t=e.match(/-?\d*\.?\d+/g);if(t){const[o,r,i,n]=t,s=parseFloat(o||"0.42"),a=parseFloat(r||"0"),l=parseFloat(i||"1"),h=parseFloat(n||"1"),d=Ie(s,a,l,h);return Pe[e]=d,d}return console.warn("Unknown cubic-bezier timing: "+e),Fe})(e):(console.warn("Unknown timing function: "+e),Fe)};function Ue(e){return(e/1024/1024).toFixed(2)}class $e extends pe{constructor(e,t,r){var i,n,s,a,l,h;super(),o(this,"node",void 0),o(this,"props",void 0),o(this,"settings",void 0),o(this,"progress",0),o(this,"delayFor",0),o(this,"delay",0),o(this,"timingFunction",void 0),o(this,"propValuesMap",{}),o(this,"dynPropValuesMap",void 0),this.node=e,this.props=t;for(const o in t)if("shaderProps"!==o)void 0===this.propValuesMap.props&&(this.propValuesMap.props={}),this.propValuesMap.props[o]={start:e[o]||0,target:t[o]};else if("DynamicShader"!==e.shader.type){this.propValuesMap.shaderProps={};for(const o in t.shaderProps)this.propValuesMap.shaderProps[o]={start:e.shader.props[o],target:t.shaderProps[o]}}else{const o=Object.keys(t.shaderProps),r=o.length;this.dynPropValuesMap={};for(let i=0;i<r;i++){const r=o[i],n=t.shaderProps[r];this.dynPropValuesMap[r]={};const s=Object.entries(n),a=s.length;for(let t=0;t<a;t++){const[o,i]=s[t];this.dynPropValuesMap[r][o]={start:e.shader.props[r][o],target:i}}}}const d=r.easing||"linear",c=null!==(i=r.delay)&&void 0!==i?i:0;this.settings={duration:null!==(n=r.duration)&&void 0!==n?n:0,delay:c,easing:d,loop:null!==(s=r.loop)&&void 0!==s&&s,repeat:null!==(a=r.repeat)&&void 0!==a?a:0,repeatDelay:null!==(l=r.repeatDelay)&&void 0!==l?l:0,stopMethod:null!==(h=r.stopMethod)&&void 0!==h&&h},this.timingFunction=Be(d),this.delayFor=c,this.delay=c}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,t){const o=Object.entries(t),r=o.length;for(let i=0;i<r;i++){const[t,r]=o[i];e[t]=r.start}}restore(){if(this.reset(),void 0!==this.propValuesMap.props&&this.restoreValues(this.node,this.propValuesMap.props),void 0!==this.propValuesMap.shaderProps&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),void 0!==this.dynPropValuesMap){const e=Object.keys(this.dynPropValuesMap),t=e.length;if(t>0)for(let o=0;o<t;o++){const t=e[o];this.restoreValues(this.node.shader.props[t],this.dynPropValuesMap[t])}}}reverseValues(e){const t=Object.entries(e),o=t.length;for(let r=0;r<o;r++){const[o,i]=t[r];e[o]={start:i.target,target:i.start}}}reverse(){if(this.progress=0,void 0!==this.propValuesMap.props&&this.reverseValues(this.propValuesMap.props),void 0!==this.propValuesMap.shaderProps&&this.reverseValues(this.propValuesMap.shaderProps),void 0!==this.dynPropValuesMap){const e=Object.keys(this.dynPropValuesMap),t=e.length;if(t>0)for(let o=0;o<t;o++){const t=e[o];this.reverseValues(this.dynPropValuesMap[t])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,t,o){return(this.timingFunction(e)||e)*(o-t)+t}updateValue(e,t,o,r){if(1===this.progress)return t;if(0===this.progress)return o;const i=t;if(-1!==e.indexOf("color")){if(o===i)return o;if(r){return ae(o,i,this.timingFunction(this.progress)||this.progress)}return ae(o,i,this.progress)}return r?this.applyEasing(this.progress,o,i):o+(i-o)*this.progress}updateValues(e,t,o){const r=Object.entries(t),i=r.length;for(let n=0;n<i;n++){const[t,i]=r[n];e[t]=this.updateValue(t,i.target,i.start,o)}}update(e){const{duration:t,loop:o,easing:r,stopMethod:i}=this.settings,{delayFor:n}=this;if(this.node.destroyed)this.emit("destroyed",{});else if(0!==t||0!==n){if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(0!==t)if(0===this.progress&&this.emit("animating",{}),this.progress+=e/t,this.progress>1&&(this.progress=o?0:1,this.delayFor=this.delay,i))this.emit("finished",{});else{if(void 0!==this.propValuesMap.props&&this.updateValues(this.node,this.propValuesMap.props,r),void 0!==this.propValuesMap.shaderProps&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,r),void 0!==this.dynPropValuesMap){const e=Object.keys(this.dynPropValuesMap),t=e.length;if(t>0)for(let o=0;o<t;o++){const t=e[o];this.updateValues(this.node.shader.props[t],this.dynPropValuesMap[t],r)}}this.progress<1&&this.emit("tick",{progress:this.progress}),1===this.progress&&this.emit("finished",{})}else this.emit("finished",{})}else this.emit("finished",{})}}class Ne extends pe{constructor(e,t){super(),o(this,"manager",void 0),o(this,"animation",void 0),o(this,"stoppedPromise",void 0),o(this,"stoppedResolve",null),o(this,"state",void 0),this.manager=e,this.animation=t,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this),this.onTick=this.onTick.bind(this),this.onDestroy=this.onDestroy.bind(this)}start(){return"running"!==this.state&&"scheduled"!==this.state&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="scheduled"),this}stop(){return this.unregisterAnimation(),null!==this.stoppedResolve&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.animation.on("tick",this.onTick),this.animation.on("destroyed",this.onDestroy),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating),this.animation.off("tick",this.onTick),this.animation.off("destroy",this.onDestroy)}makeStoppedPromise(){null===this.stoppedResolve&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onDestroy(){this.unregisterAnimation(),this.state="stopped"}onFinished(){const{loop:e,stopMethod:t}=this.animation.settings;if("reverse"===t)return this.animation.once("finished",this.onFinished),void this.animation.reverse();e||(this.unregisterAnimation(),null!==this.stoppedResolve&&(this.stoppedResolve(),this.stoppedResolve=null),this.emit("stopped",this),this.state="stopped")}onAnimating(){this.state="running",this.emit("animating",this)}onTick(e,t){this.emit("tick",t)}}var De;!function(e){e[e.Init=0]="Init",e[e.OutOfBounds=2]="OutOfBounds",e[e.InBounds=4]="InBounds",e[e.InViewport=8]="InViewport"}(De||(De={}));const je=new Map;var ze;je.set(De.Init,"init"),je.set(De.OutOfBounds,"outOfBounds"),je.set(De.InBounds,"inBounds"),je.set(De.InViewport,"inViewport"),function(e){e[e.Children=1]="Children",e[e.ScaleRotate=2]="ScaleRotate",e[e.Local=4]="Local",e[e.Global=8]="Global",e[e.Clipping=16]="Clipping",e[e.CalculatedZIndex=32]="CalculatedZIndex",e[e.ZIndexSortedChildren=64]="ZIndexSortedChildren",e[e.PremultipliedColors=128]="PremultipliedColors",e[e.WorldAlpha=256]="WorldAlpha",e[e.RenderState=512]="RenderState",e[e.IsRenderable=1024]="IsRenderable",e[e.RenderTexture=2048]="RenderTexture",e[e.ParentRenderTexture=4096]="ParentRenderTexture",e[e.RenderBounds=8192]="RenderBounds",e[e.None=0]="None",e[e.All=14335]="All"}(ze||(ze={}));class We extends pe{constructor(e,r){super(),o(this,"stage",void 0),o(this,"children",[]),o(this,"_id",ue++),o(this,"props",void 0),o(this,"updateType",ze.All),o(this,"childUpdateType",ze.None),o(this,"globalTransform",void 0),o(this,"scaleRotateTransform",void 0),o(this,"localTransform",void 0),o(this,"sceneGlobalTransform",void 0),o(this,"renderCoords",void 0),o(this,"sceneRenderCoords",void 0),o(this,"renderBound",void 0),o(this,"strictBound",void 0),o(this,"preloadBound",void 0),o(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1}),o(this,"isRenderable",!1),o(this,"renderState",De.Init),o(this,"worldAlpha",1),o(this,"premultipliedColorTl",0),o(this,"premultipliedColorTr",0),o(this,"premultipliedColorBl",0),o(this,"premultipliedColorBr",0),o(this,"calcZIndex",0),o(this,"hasRTTupdates",!1),o(this,"parentHasRenderTexture",!1),o(this,"rttParent",null),o(this,"destroyed",!1),o(this,"onTextureLoaded",(e,t)=>{var o;this.autosizeNode(t),this.setUpdateType(ze.IsRenderable),this.stage.requestRender(),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),t.width>1&&t.height>1&&this.emit("loaded",{type:"texture",dimensions:t}),"contain"===(null===(o=this.props.textureOptions)||void 0===o||null===(o=o.resizeMode)||void 0===o?void 0:o.type)&&this.setUpdateType(ze.Local)}),o(this,"onTextureFailed",(e,t)=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(ze.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),null!==this.texture&&this.texture.retryCount>this.texture.maxRetryCount&&this.emit("failed",{type:"texture",error:t})}),o(this,"onTextureFreed",()=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(ze.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.emit("freed",{type:"texture"})}),this.stage=e,this.props=t(t({},r),{},{parent:null,texture:null,src:null,rtt:!1}),this.parent=r.parent,this.texture=r.texture,this.src=r.src,this.rtt=r.rtt,this.interactive=r.interactive,r.boundsMargin&&(this.boundsMargin=Array.isArray(r.boundsMargin)?r.boundsMargin:[r.boundsMargin,r.boundsMargin,r.boundsMargin,r.boundsMargin]),this.setUpdateType(ze.ScaleRotate|ze.Local|ze.RenderBounds|ze.RenderState),this.stage.defaultTexture&&"loaded"!==this.stage.defaultTexture.state&&this.stage.defaultTexture.once("loaded",()=>{this.setUpdateType(ze.IsRenderable)})}loadTexture(){const{texture:e}=this.props;queueMicrotask(()=>{var t,o;!0===this.textureOptions.preload&&this.stage.txManager.loadTexture(e),e.preventCleanup=null!==(t=null===(o=this.props.textureOptions)||void 0===o?void 0:o.preventCleanup)&&void 0!==t&&t,e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed),"loaded"===e.state?(e.dimensions,this.onTextureLoaded(e,e.dimensions)):"failed"===e.state?(e.error,this.onTextureFailed(e,e.error)):"freed"===e.state&&this.onTextureFreed(e),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate()})}unloadTexture(){null!==this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this._id,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const t=this.props.parent;t&&0===(t.updateType&ze.Children)&&t.setUpdateType(ze.Children)}sortChildren(){this.children.sort((e,t)=>e.calcZIndex-t.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:t,scaleY:o}=this.props;this.scaleRotateTransform=0!==e||1!==t||1!==o?ke.rotate(e,this.scaleRotateTransform).scale(t,o):void 0}updateLocalTransform(){var e;const{x:t,y:o,width:r,height:i}=this.props,n=this.props.mountX*r,s=this.props.mountY*i;if(this.scaleRotateTransform){const e=this.props.pivotX*r,a=this.props.pivotY*i;this.localTransform=ke.translate(t-n+e,o-s+a,this.localTransform).multiply(this.scaleRotateTransform).translate(-e,-a)}else this.localTransform=ke.translate(t-n,o-s,this.localTransform);const a=this.props.texture;if(a&&a.dimensions&&"contain"===(null===(e=this.props.textureOptions)||void 0===e||null===(e=e.resizeMode)||void 0===e?void 0:e.type)){let e=1,t=1,o=0,n=0;const{width:s,height:l}=a.dimensions;if(s/l>r/i){const e=l*(r/s);n=(i-e)/2,t=e/i}else{const t=s*(i/l);o=(r-t)/2,e=t/r}this.localTransform.translate(o,n).scale(e,t)}this.setUpdateType(ze.Global)}update(e,t){this.updateType&ze.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(ze.Local)),this.updateType&ze.Local&&(this.updateLocalTransform(),this.setUpdateType(ze.Global));const o=this.props.parent;let r=null;if(this.updateType&ze.RenderTexture&&this.rtt&&(this.hasRTTupdates=!0),this.updateType&ze.Global&&(this.localTransform,!0===this.parentHasRenderTexture&&!0===(null==o?void 0:o.rtt)?(this.globalTransform=ke.identity(),this.sceneGlobalTransform=ke.copy((null==o?void 0:o.globalTransform)||ke.identity()).multiply(this.localTransform)):!0===this.parentHasRenderTexture&&!1===(null==o?void 0:o.rtt)?(this.sceneGlobalTransform=ke.copy((null==o?void 0:o.sceneGlobalTransform)||this.localTransform).multiply(this.localTransform),this.globalTransform=ke.copy((null==o?void 0:o.globalTransform)||this.localTransform,this.globalTransform)):this.globalTransform=ke.copy((null==o?void 0:o.globalTransform)||this.localTransform,this.globalTransform),null!==o&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(ze.RenderState|ze.Children),this.childUpdateType|=ze.Global,!0===this.clipping&&(this.setUpdateType(ze.Clipping|ze.RenderBounds),this.childUpdateType|=ze.RenderBounds)),this.updateType&ze.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(ze.RenderState),this.setUpdateType(ze.Children),this.childUpdateType|=ze.RenderBounds),this.updateType&ze.RenderState&&(r=this.checkRenderBounds(),this.setUpdateType(ze.IsRenderable),r!==De.OutOfBounds&&this.updateRenderState(r)),this.updateType&ze.WorldAlpha&&(this.worldAlpha=o?o.worldAlpha*this.props.alpha:this.props.alpha,this.setUpdateType(ze.Children|ze.PremultipliedColors|ze.IsRenderable),this.childUpdateType|=ze.WorldAlpha),this.updateType&ze.IsRenderable&&this.updateIsRenderable(),this.updateType&ze.Clipping&&(this.calculateClippingRect(t),this.setUpdateType(ze.Children),this.childUpdateType|=ze.Clipping,this.childUpdateType|=ze.RenderBounds),this.updateType&ze.PremultipliedColors&&(this.premultipliedColorTl=de(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=de(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=de(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=de(this.props.colorBr,this.worldAlpha,!0))),null!==o&&this.updateType&ze.CalculatedZIndex&&(this.calculateZIndex(),o.setUpdateType(ze.ZIndexSortedChildren)),!0!==this.props.strictBounds||this.renderState!==De.OutOfBounds){if(this.updateType&ze.Children&&this.children.length>0)for(let t=0,o=this.children.length;t<o;t++){const o=this.children[t];if(o.setUpdateType(this.childUpdateType),0===o.updateType)continue;let r=this.clippingRect;!0===this.rtt&&(r={x:0,y:0,width:0,height:0,valid:!1}),o.update(e,r)}this.parentHasRenderTexture&&this.updateType>0&&this.notifyParentRTTOfUpdate(),this.updateType&ze.ZIndexSortedChildren&&this.sortChildren(),r===De.OutOfBounds&&(this.updateRenderState(r),this.updateIsRenderable(),!0===this.rtt&&r===De.OutOfBounds&&this.notifyChildrenRTTOfUpdate(r)),this.updateType=0,this.childUpdateType=0}else this.updateType&=~ze.RenderBounds}findParentRTTNode(){let e=this.parent;for(;e&&!e.rtt;)e=e.parent;return e}getRTTParentRenderState(){const e=this.rttParent||this.findParentRTTNode();return e?e.renderState:null}notifyChildrenRTTOfUpdate(e){for(const t of this.children)t.updateRenderState(e),t.updateIsRenderable(),t.notifyChildrenRTTOfUpdate(e)}notifyParentRTTOfUpdate(){if(null===this.parent)return;const e=this.rttParent||this.findParentRTTNode();e&&(e.hasRTTupdates=!0,e.setUpdateType(ze.RenderTexture),!0===e.parentHasRenderTexture&&e.notifyParentRTTOfUpdate())}checkRenderBounds(){return this.renderBound,this.strictBound,this.preloadBound,Ee(this.renderBound,this.strictBound)?De.InViewport:Ee(this.renderBound,this.preloadBound)?De.InBounds:(e=this.renderBound,t=this.strictBound,e.x1<t.x1&&e.x2>t.x2&&e.y1<t.y1&&e.y2>t.y2?De.InViewport:null===this.parent||0!==this.props.width&&0!==this.props.height?De.OutOfBounds:this.parent.renderState);var e,t}updateBoundingRect(){const e=this.sceneGlobalTransform||this.globalTransform,t=this.sceneRenderCoords||this.renderCoords,{tb:o,tc:r}=e,{x1:i,y1:n,x3:s,y3:a}=t;if(0===o||0===r)this.renderBound=we(i,n,s,a,this.renderBound);else{const{x2:e,x4:o,y2:r,y4:l}=t;this.renderBound=we(Math.min(i,e,s,o),Math.min(n,r,a,l),Math.max(i,e,s,o),Math.max(n,r,a,l),this.renderBound)}}createRenderBounds(){if(this.stage,null!==this.parent&&void 0!==this.parent.strictBound){const e=this.parent.strictBound;this.strictBound=we(e.x1,e.y1,e.x2,e.y2),this.preloadBound=Ce(this.strictBound,this.boundsMargin)}else this.strictBound=this.stage.strictBound,this.preloadBound=this.stage.preloadBound;if(!1===this.props.clipping)return;if(void 0===this.renderBound)return;if(!1===Ee(this.renderBound,this.strictBound))return;const{x:e,y:t,width:o,height:r}=this.props,{tx:i,ty:n}=this.sceneGlobalTransform||this.globalTransform||{},s=null!=i?i:e,a=null!=n?n:t;this.strictBound=we(s,a,s+o,a+r,this.strictBound),this.preloadBound=Ce(this.strictBound,this.boundsMargin)}updateRenderState(e){if(e===this.renderState)return;const t=this.renderState;this.renderState=e;const o=je.get(e);this.emit(o,{previous:t,current:e})}updateIsRenderable(){let e=!1,t=!1;if(!1===this.checkBasicRenderability())return this.updateTextureOwnership(!1),void this.setRenderable(!1);if(null!==this.texture){if(this.texture.retryCount>this.texture.maxRetryCount)return this.updateTextureOwnership(!1),void this.setRenderable(!1);t=!0,e="loaded"===this.texture.state}else!this.hasShader()&&!0!==this.hasColorProperties()||!0!==this.hasDimensions()||this.stage.defaultTexture&&"loaded"===this.stage.defaultTexture.state&&(e=!0);this.updateTextureOwnership(t),this.setRenderable(e)}checkBasicRenderability(){return 0!==this.worldAlpha&&!0!==this.isOutOfBounds()}setRenderable(e){const t=this.isRenderable;this.isRenderable=e,t!==e&&this.emit("renderable",{type:"renderable",isRenderable:e})}updateTextureOwnership(e){var t;null===(t=this.texture)||void 0===t||t.setRenderableOwner(this._id,e)}isOutOfBounds(){return this.renderState<=De.OutOfBounds}hasDimensions(){return 0!==this.props.width&&0!==this.props.height}hasColorProperties(){return 0!==this.props.color||0!==this.props.colorTop||0!==this.props.colorBottom||0!==this.props.colorLeft||0!==this.props.colorRight||0!==this.props.colorTl||0!==this.props.colorTr||0!==this.props.colorBl||0!==this.props.colorBr}hasShader(){return null!==this.props.shader}calculateRenderCoords(){const{width:e,height:t}=this,{tx:o,ty:r,ta:i,tb:n,tc:s,td:a}=this.globalTransform;if(0===n&&0===s){const n=o,s=o+e*i,l=r,h=r+t*a;this.renderCoords=Oe.translate(n,l,s,l,s,h,n,h,this.renderCoords)}else this.renderCoords=Oe.translate(o,r,o+e*i,r+e*s,o+e*i+t*n,r+e*s+t*a,o+t*n,r+t*a,this.renderCoords);if(void 0===this.sceneGlobalTransform)return;const{tx:l,ty:h,ta:d,tb:c,tc:u,td:p}=this.sceneGlobalTransform;if(0===c&&0===u){const o=l,r=l+e*d,i=h,n=h+t*p;this.sceneRenderCoords=Oe.translate(o,i,r,i,r,n,o,n,this.sceneRenderCoords)}else this.sceneRenderCoords=Oe.translate(l,h,l+e*d,h+e*u,l+e*d+t*c,h+e*u+t*p,l+t*c,h+t*p,this.sceneRenderCoords)}calculateClippingRect(e){this.globalTransform;const{clippingRect:t,props:o,globalTransform:r}=this,{clipping:i}=o,n=0!==r.tb||0!==r.tc;!0===i&&!1===n?(t.x=r.tx,t.y=r.ty,t.width=this.width*r.ta,t.height=this.height*r.td,t.valid=!0):t.valid=!1,!0===e.valid&&!0===t.valid?Se(e,t,t):!0===e.valid&&(Re(e,t),t.valid=!0)}calculateZIndex(){var e,t;const o=this.props,r=o.zIndex||0,i=(null===(e=o.parent)||void 0===e?void 0:e.zIndex)||0;let n=r;null!==(t=o.parent)&&void 0!==t&&t.zIndexLocked&&(n=r<i?r:i),this.calcZIndex=n}destroy(){if(!0!==this.destroyed){for(this.destroyed=!0,this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,this.renderCoords=void 0,this.renderBound=void 0,this.strictBound=void 0,this.preloadBound=void 0,this.globalTransform=void 0,this.scaleRotateTransform=void 0,this.localTransform=void 0,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;this.children.length>0;){var e;null===(e=this.children[0])||void 0===e||e.destroy()}this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}}renderQuads(e){if(this.parentHasRenderTexture){if(!e.renderToTextureActive)return;if(this.parentRenderTexture!==e.activeRttNode)return}this.globalTransform,this.renderCoords,e.addQuad({width:this.props.width,height:this.props.height,colorTl:this.premultipliedColorTl,colorTr:this.premultipliedColorTr,colorBl:this.premultipliedColorBl,colorBr:this.premultipliedColorBr,texture:this.texture||this.stage.defaultTexture,textureOptions:this.textureOptions,zIndex:this.zIndex,shader:this.shader.shader,shaderProps:this.shader.getResolvedProps(),alpha:this.worldAlpha,clippingRect:this.clippingRect,tx:this.globalTransform.tx,ty:this.globalTransform.ty,ta:this.globalTransform.ta,tb:this.globalTransform.tb,tc:this.globalTransform.tc,td:this.globalTransform.td,renderCoords:this.renderCoords,rtt:this.rtt,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get data(){return this.props.data}set data(e){this.props.data=e}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(ze.Local))}get absX(){var e,t;return this.props.x+-this.props.width*this.props.mountX+((null===(e=this.props.parent)||void 0===e?void 0:e.absX)||(null===(t=this.props.parent)||void 0===t||null===(t=t.globalTransform)||void 0===t?void 0:t.tx)||0)}get absY(){var e,t;return this.props.y+-this.props.height*this.props.mountY+(null!==(e=null===(t=this.props.parent)||void 0===t?void 0:t.absY)&&void 0!==e?e:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(ze.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(ze.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(ze.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(ze.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(ze.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(ze.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(ze.ScaleRotate))}get mount(){return this.props.mount}set mount(e){this.props.mountX===e&&this.props.mountY===e||(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(ze.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(ze.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(ze.Local))}get pivot(){return this.props.pivot}set pivot(e){this.props.pivotX===e&&this.props.pivotY===e||(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(ze.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(ze.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(ze.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(ze.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(ze.PremultipliedColors|ze.WorldAlpha|ze.Children|ze.IsRenderable),this.childUpdateType|=ze.WorldAlpha}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get boundsMargin(){var e,t,o;return null!==(e=null!==(t=this.props.boundsMargin)&&void 0!==t?t:null===(o=this.parent)||void 0===o?void 0:o.boundsMargin)&&void 0!==e?e:this.stage.boundsMargin}set boundsMargin(e){if(e!==this.props.boundsMargin){if(null===e)this.props.boundsMargin=e;else{const t=Array.isArray(e)?e:[e,e,e,e];this.props.boundsMargin=t}this.setUpdateType(ze.RenderBounds)}}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(ze.Clipping|ze.RenderBounds|ze.Children),this.childUpdateType|=ze.Global|ze.Clipping}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(ze.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){this.props.colorTl===e&&this.props.colorTr===e||(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(ze.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){this.props.colorBl===e&&this.props.colorBr===e||(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(ze.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){this.props.colorTl===e&&this.props.colorBl===e||(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(ze.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){this.props.colorTr===e&&this.props.colorBr===e||(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(ze.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(ze.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(ze.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(ze.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(ze.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(ze.CalculatedZIndex|ze.Children);for(let t=0,o=this.children.length;t<o;t++)this.children[t].setUpdateType(ze.CalculatedZIndex)}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(ze.CalculatedZIndex|ze.Children);for(let t=0,o=this.children.length;t<o;t++)this.children[t].setUpdateType(ze.CalculatedZIndex)}get parent(){return this.props.parent}set parent(e){const t=this.props.parent;if(t!==e){if(this.props.parent=e,t){const e=t.children.indexOf(this);t.children.splice(e,1),t.setUpdateType(ze.Children|ze.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(ze.All),e.setUpdateType(ze.Children|ze.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.applyRTTInheritance(e)),this.updateScaleRotateTransform(),this.setUpdateType(ze.RenderBounds|ze.Children)}}get preventCleanup(){return this.props.textureOptions.preventCleanup||!1}set preventCleanup(e){this.props.textureOptions.preventCleanup=e}get rtt(){return this.props.rtt}set rtt(e){this.props.rtt!==e&&(this.props.rtt=e,!0===e?(this.initRenderTexture(),this.markChildrenWithRTT()):this.cleanupRenderTexture(),this.setUpdateType(ze.RenderTexture),!0===this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate())}initRenderTexture(){this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.stage.renderer.renderToTexture(this)}cleanupRenderTexture(){this.unloadTexture(),this.clearRTTInheritance(),this.hasRTTupdates=!1,this.texture=null}markChildrenWithRTT(e=null){const t=e||this;for(const o of t.children)o.setUpdateType(ze.All),o.parentHasRenderTexture=!0,o.markChildrenWithRTT()}applyRTTInheritance(e){e.rtt&&e.setUpdateType(ze.RenderTexture),this.markChildrenWithRTT(e)}clearRTTInheritance(){if(!this.rtt)for(const e of this.children)e.parentHasRenderTexture=!1,e.rttParent=null,e.setUpdateType(ze.All),e.clearRTTInheritance()}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(ze.IsRenderable))}get src(){return this.props.src}set src(e){this.props.src!==e&&(this.props.src=e,this.texture=e?this.stage.txManager.createTexture("ImageTexture",{src:e,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight,maxRetryCount:this.props.textureOptions.maxRetryCount}):null)}set imageType(e){this.props.imageType!==e&&(this.props.imageType=e)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(e){this.props.srcHeight=e}get srcWidth(){return this.props.srcWidth}set srcWidth(e){this.props.srcWidth=e}get srcX(){return this.props.srcX}set srcX(e){this.props.srcX=e}get srcY(){return this.props.srcY}set srcY(e){this.props.srcY=e}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;this.props.texture&&this.unloadTexture(),this.props.texture=e,null!==e&&(e.setRenderableOwner(this._id,this.isRenderable),this.loadTexture()),this.setUpdateType(ze.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}get strictBounds(){return this.props.strictBounds}set strictBounds(e){e!==this.props.strictBounds&&(this.props.strictBounds=e,this.setUpdateType(ze.RenderBounds|ze.Children),this.childUpdateType|=ze.RenderBounds|ze.Children)}set interactive(e){this.props.interactive=e,!0===e&&this.stage.interactiveNodes.add(this)}get interactive(){return this.props.interactive}animate(e,t){const o=new $e(this,e,t);return new Ne(this.stage.animationManager,o)}flush(){}}const Xe=()=>performance?performance.now():Date.now();class Ge{constructor(){o(this,"activeAnimations",new Set)}registerAnimation(e){this.activeAnimations.add(e)}unregisterAnimation(e){this.activeAnimations.delete(e)}update(e){this.activeAnimations.forEach(t=>{t.update(e)})}}function Ve(){self.onmessage=e=>{var t=e.data.src,o=e.data.id,r=e.data.premultiplyAlpha;e.data.sx,e.data.sy,e.data.sw,e.data.sh,function(e,t){return new Promise(function(o,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){if(200!==i.status&&0!==i.status)return r(new Error("Failed to load image: "+i.statusText));var e=i.response;void 0!==t||e.type.indexOf("image/png"),createImageBitmap(e).then(function(e){o({data:e,premultiplyAlpha:t})}).catch(function(e){r(e)})},i.onerror=function(){r(new Error("Network error occurred while trying to fetch the image."))},i.send()})}(t,r).then(function(e){self.postMessage({id:o,src:t,data:e},[e.data])}).catch(function(e){self.postMessage({id:o,src:t,error:e.message})})}}class He{constructor(e,t){o(this,"imageWorkersEnabled",!0),o(this,"messageManager",{}),o(this,"workers",[]),o(this,"workerIndex",0),o(this,"nextId",0),this.workers=this.createWorkers(e,t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(e){const{id:t,data:o,error:r}=e.data,i=this.messageManager[t];if(i){const[e,n]=i;delete this.messageManager[t],r?n(new Error(r)):e(o)}}createWorkers(e=1,t){let o=`(${Ve.toString()})()`;!0===t.options&&(o=o.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;")),!0===t.full&&(o=o.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;"),o=o.replace("var supportsFullCreateImageBitmap = false;","var supportsFullCreateImageBitmap = true;")),o=o.replace('"use strict";',"");const r=new Blob([o],{type:"application/javascript"}),i=(self.URL?URL:webkitURL).createObjectURL(r),n=[];for(let s=0;s<e;s++)n.push(new Worker(i));return n}getNextWorker(){const e=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,e}getImage(e,t,o,r,i,n){return new Promise((s,a)=>{try{if(this.workers){const l=this.nextId++;this.messageManager[l]=[s,a];const h=this.getNextWorker();h&&h.postMessage({id:l,src:e,premultiplyAlpha:t,sx:o,sy:r,sw:i,sh:n})}}catch(l){a(l)}})}}class Ye extends me{constructor(e,t){super(e),o(this,"type",fe.color),o(this,"props",void 0),this.props=Ye.resolveDefaults(t)}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureSource(){const e=new Uint8Array(4);return 4294967295===this.color?(e[0]=255,e[1]=255,e[2]=255,e[3]=255):(e[0]=this.color>>16&255,e[1]=this.color>>8&255,e[2]=255&this.color,e[3]=this.color>>>24&255),{data:e,premultiplyAlpha:!0}}static makeCacheKey(e){return`ColorTexture,${Ye.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}}o(Ye,"z$__type__Props",void 0);const qe={0:35841,1:35843,2:35840,3:35842,6:36196,7:33776,8:33778,9:33778,10:33779,11:33779},Ke={"4x4":37808,"5x5":37809,"6x6":37810,"8x8":37811,"10x10":37812,"12x12":37813},Qe=[171,75,84,88,32,49,49,187,13,10,26,10],Ze=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch compressed texture: ${t.status} ${t.statusText}`);const o=await t.arrayBuffer();if(o.byteLength<16)throw new Error(`File too small to be a valid compressed texture (${o.byteLength} bytes). Expected at least 16 bytes for header inspection.`);const r=new DataView(o),i=r.getUint32(0,!0);if(55727696===i)return rt(r);if(1554098963===i)return et(r);let n=!0;for(let e=0;e<Qe.length;e++)if(r.getUint8(e)!==Qe[e]){n=!1;break}if(!0===n)return tt(r);throw new Error("Unrecognized compressed texture format")}catch(t){throw new Error(`Failed to load compressed texture from ${e}: ${t}`)}};function Je(e,t){return e.getUint8(t)+(e.getUint8(t+1)<<8)+(e.getUint8(t+2)<<16)}const et=async function(e){const t=e.getUint8(4),o=e.getUint8(5),r=Je(e,7),i=Je(e,10);if(0===r||0===i)throw new Error(`Invalid ASTC texture dimensions: ${r}x${i}`);const n=Math.ceil(r/t)*Math.ceil(i/o)*16,s=e.byteLength-16;if(n!==s)throw new Error(`Invalid ASTC texture data size: expected ${n}, got ${s}`);const a=Ke[`${t}x${o}`];if(void 0===a)throw new Error(`Unsupported ASTC block size: ${t}x${o}`);const l=e.buffer,h=[];return h.push(l.slice(16)),{data:{blockInfo:ut[a],glInternalFormat:a,mipmaps:h,width:r,height:i,type:"astc"},premultiplyAlpha:!1}},tt=async function(e){const t=e.getUint32(12,!0),o=67305985===t;if(!1===o&&16909060!==t)throw new Error("Invalid KTX endianness value");const r=e.getUint32(16,o),i=e.getUint32(24,o);if(0!==r||0!==i)throw new Error(`KTX texture is not compressed (glType: ${r}, glFormat: ${i})`);const n=e.getUint32(28,o);if(void 0===ut[n])throw new Error(`Unsupported KTX compressed texture format: 0x${n.toString(16)}`);const s=e.getUint32(36,o),a=e.getUint32(40,o);if(0===s||0===a)throw new Error(`Invalid KTX texture dimensions: ${s}x${a}`);const l=e.getUint32(56,o);if(0===l)throw new Error("KTX texture has no mipmap levels");const h=e.getUint32(60,o),d=[],c=e.buffer;let u=64+h;if(u>e.byteLength)throw new Error("Invalid KTX file: key/value data exceeds file size");for(let p=0;p<l;p++){const t=e.getUint32(u,o);u+=4;const r=u+t;d.push(c.slice(u,r)),u=r,u%4!=0&&(u+=4-u%4)}return{data:{blockInfo:ut[n],glInternalFormat:n,mipmaps:d,width:s,height:a,type:"ktx"},premultiplyAlpha:!1}};function ot(e,t,o){const r=2===o?16:8;return Math.max(e,r)*Math.max(t,8)*o/8}const rt=async function(e){const t=e.getUint32(8,!0),o=qe[t];if(void 0===o)throw new Error(`Unsupported PVR pixel format: 0x${t.toString(16)}`);const r=e.getInt32(24,!0),i=e.getInt32(28,!0);if(0===i||0===r)throw new Error(`Invalid PVR texture dimensions: ${i}x${r}`);const n=e.getInt32(44,!0),s=e.getUint32(48,!0),a=e.buffer;let l=52+s;if(l>a.byteLength)throw new Error("Invalid PVR file: metadata exceeds file size");const h=[],d=ut[o];for(let c=0;c<n;c++){const o=e.getUint32(l,!0),n=a.byteLength-(l+4);if(o>0&&o<=n){l+=4;const e=l,t=l+o;h.push(a.slice(e,t)),l=t,l=l+3&-4;continue}if(0===t||1===t||2===t||3===t){const e=ot(i>>c,r>>c,0===t||1===t?2:4);h.push(a.slice(l,l+e)),l+=e,l=l+3&-4;continue}if(void 0!==d){const e=Math.ceil((i>>c)/d.width)*Math.ceil((r>>c)/d.height)*d.bytes;h.push(a.slice(l,l+e)),l+=e,l=l+3&-4}}return{data:{blockInfo:ut[o],glInternalFormat:o,mipmaps:h,width:i,height:r,type:"pvr"},premultiplyAlpha:!1}},it={width:4,height:4,bytes:8},nt={width:4,height:4,bytes:16},st={width:5,height:5,bytes:16},at={width:6,height:6,bytes:16},lt={width:8,height:4,bytes:8},ht={width:8,height:8,bytes:16},dt={width:10,height:10,bytes:16},ct={width:12,height:12,bytes:16},ut={33776:it,33777:it,33778:nt,33779:nt,36196:it,37492:it,37493:it,37496:nt,37497:nt,35840:it,35842:it,35841:lt,35843:lt,37808:nt,37840:nt,37809:st,37841:st,37810:at,37842:at,37811:ht,37843:ht,37812:dt,37844:dt,37813:ct,37845:ct},pt={ktx:function(e,t,o){const{glInternalFormat:r,mipmaps:i,width:n,height:s,blockInfo:a}=o;e.bindTexture(t);const l=a.width,h=a.height;let d=n,c=s;for(let u=0;u<i.length;u++){let t=new Uint8Array(i[u]);const o=Math.ceil(d/l)*l,n=Math.ceil(c/h)*h,s=Math.ceil(d/l)*Math.ceil(c/h)*a.bytes;if(t.byteLength<s){const e=new Uint8Array(s);e.set(t),t=e}e.compressedTexImage2D(u,r,o,n,0,t),d=Math.max(1,d>>1),c=Math.max(1,c>>1)}e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,i.length>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)},pvr:function(e,t,o){const{glInternalFormat:r,mipmaps:i,width:n,height:s}=o;e.bindTexture(t);let a=n,l=s;for(let h=0;h<i.length;h++)e.compressedTexImage2D(h,r,a,l,0,new Uint8Array(i[h])),a=Math.max(1,a>>1),l=Math.max(1,l>>1);e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,i.length>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)},astc:function(e,t,o){if(null===e.getExtension("WEBGL_compressed_texture_astc"))throw new Error("ASTC compressed textures not supported by this device");e.bindTexture(t);const{glInternalFormat:r,mipmaps:i,width:n,height:s}=o,a=new Uint8Array(i[0]);e.compressedTexImage2D(0,r,n,s,0,a),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR)}};const ft=(e,t,o,r,i,n,s)=>new Promise((a,l)=>{const h=document.createElement("canvas"),d=h.getContext("2d");d.imageSmoothingEnabled=!0;const c=new Image;c.onload=()=>{const e=null!=r?r:0,l=null!=i?i:0,u=t||c.width,p=o||c.height;h.width=u,h.height=p,d.drawImage(c,0,0,u,p),a({data:d.getImageData(e,l,null!=n?n:u,null!=s?s:p),premultiplyAlpha:!1})},c.onerror=e=>{l(e)},c.src=e});function mt(e,t=""){return new Promise((o,r)=>{const i=new XMLHttpRequest;i.responseType=t,i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(0===i.status||200===i.status?o(i.response):r(i.statusText))},i.open("GET",e,!0),i.send(null)})}class gt extends me{constructor(e,t){var r;const i=gt.resolveDefaults(t);super(e),o(this,"type",fe.image),o(this,"props",void 0),this.props=i,this.maxRetryCount=null!==(r=i.maxRetryCount)&&void 0!==r?r:this.txManager.maxRetryCount}hasAlphaChannel(e){return-1!==e.indexOf("image/png")}async loadImageFallback(e,t){const o=new Image;return"string"==typeof e&&!1===Ae(e)&&(o.crossOrigin="anonymous"),new Promise((r,i)=>{o.onload=()=>{r({data:o,premultiplyAlpha:t})},o.onerror=e=>{const t=e instanceof Error?e.message:e instanceof Event?`Image loading failed for ${o.src}`:"Unknown image loading error";i(new Error(`Image loading failed: ${t}`))},e instanceof Blob?o.src=URL.createObjectURL(e):o.src=e})}async createImageBitmap(e,t,o,r,i,n){const s=null!=t?t:e.type.includes("image/png"),a=this.txManager.imageBitmapSupported;if(!0===a.full&&null!==i&&null!==n)try{return{data:await createImageBitmap(e,o||0,r||0,i,n,{premultiplyAlpha:s?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:s}}catch(l){throw new Error(`Failed to create image bitmap with crop: ${l}`)}else if(!0===a.basic)try{return{data:await createImageBitmap(e),premultiplyAlpha:s}}catch(l){throw new Error(`Failed to create basic image bitmap: ${l}`)}try{return{data:await createImageBitmap(e,{premultiplyAlpha:s?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:s}}catch(l){throw new Error(`Failed to create image bitmap with options: ${l}`)}}async loadImage(e){const{premultiplyAlpha:t,sx:o,sy:r,sw:i,sh:n}=this.props;if(!0===this.txManager.hasCreateImageBitmap){if(!1===Ae(e)&&!0===this.txManager.hasWorker&&null!==this.txManager.imageWorkerManager)try{return this.txManager.imageWorkerManager.getImage(e,t,o,r,i,n)}catch(s){throw new Error(`Failed to load image via worker: ${s}`)}let a;if(!0===Ae(e))a=function(e){var t;const o=(null===(t=(e=e.replace(/^data:/,"")).match(/image\/[^;]+/))||void 0===t?void 0:t[0])||"",r=e.replace(/^[^,]+,/,""),i=1024,n=atob(r),s=n.length,a=Math.ceil(s/i),l=new Array(a);for(let d=0;d<a;++d){const e=d*i,t=Math.min(e+i,s),o=new Array(t-e);for(let r=e,i=0;r<t;++i,++r){var h;o[i]=null===(h=n[r])||void 0===h?void 0:h.charCodeAt(0)}l[d]=new Uint8Array(o)}return new Blob(l,{type:o})}(e);else try{a=await mt(e,"blob")}catch(s){throw new Error(`Failed to fetch image blob from ${e}: ${s}`)}return this.createImageBitmap(a,t,o,r,i,n)}return this.loadImageFallback(e,null==t||t)}async getTextureSource(){var e;let t;try{t=await this.determineImageTypeAndLoadImage()}catch(o){return this.setState("failed",o),{data:null}}return null===t.data?(this.setState("failed",Error("ImageTexture: No image data")),{data:null}):{data:t.data,premultiplyAlpha:null===(e=this.props.premultiplyAlpha)||void 0===e||e}}determineImageTypeAndLoadImage(){const{src:e,premultiplyAlpha:t,type:o}=this.props;if(null===e)return{data:null};if("string"!=typeof e){if(e instanceof Blob){if(!0===this.txManager.hasCreateImageBitmap){const{sx:o,sy:r,sw:i,sh:n}=this.props;return this.createImageBitmap(e,t,o,r,i,n)}return this.loadImageFallback(e,null==t||t)}return e instanceof ImageData?{data:e,premultiplyAlpha:t}:{data:e(),premultiplyAlpha:t}}const r=function(e){if("file:"===self.location.protocol&&!ge.test(e)){const t=self.location.pathname.split("/");t.pop();const o=t.join("/"),r=self.location.protocol+"//"+o;return"."===e.charAt(0)&&(e=e.slice(1)),"/"===e.charAt(0)&&(e=e.slice(1)),r+"/"+e}return new URL(e,self.location.href).href}(e);return"regular"===o?this.loadImage(r):"svg"===o||!0===/\.(svg)(\?.*)?$/.test(e)?ft(r,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):"compressed"===o||!0===function(e){return/\.(ktx|pvr)$/.test(e)}(e)?Ze(r):this.loadImage(r)}static makeCacheKey(e){var t;const o=gt.resolveDefaults(e),r=o.key||o.src;if("string"!=typeof r)return!1;let i="";var n,s;null!==o.sh&&null!==o.sw&&(i+=",",i+=null!==(n=o.sx)&&void 0!==n?n:"",i+=null!==(s=o.sy)&&void 0!==s?s:"",i+=o.sw||"",i+=o.sh||"");return`ImageTexture,${r},${null!==(t=o.premultiplyAlpha)&&void 0!==t?t:"true"}${i}`}static resolveDefaults(e){var t,o,r,i,n,s,a,l,h,d,c;return{src:null!==(t=e.src)&&void 0!==t?t:"",premultiplyAlpha:null===(o=e.premultiplyAlpha)||void 0===o||o,key:null!==(r=e.key)&&void 0!==r?r:null,type:null!==(i=e.type)&&void 0!==i?i:null,width:null!==(n=e.width)&&void 0!==n?n:null,height:null!==(s=e.height)&&void 0!==s?s:null,sx:null!==(a=e.sx)&&void 0!==a?a:null,sy:null!==(l=e.sy)&&void 0!==l?l:null,sw:null!==(h=e.sw)&&void 0!==h?h:null,sh:null!==(d=e.sh)&&void 0!==d?d:null,maxRetryCount:null!==(c=e.maxRetryCount)&&void 0!==c?c:null}}}o(gt,"z$__type__Props",void 0);class yt extends me{constructor(e,t){super(e),o(this,"props",void 0),o(this,"type",fe.noise),this.props=yt.resolveDefaults(t)}async getTextureSource(){const{width:e,height:t}=this.props,o=e*t*4,r=new Uint8ClampedArray(o);for(let i=0;i<o;i+=4){const e=Math.floor(256*Math.random());r[i]=e,r[i+1]=e,r[i+2]=e,r[i+3]=255}return{data:new ImageData(r,e,t)}}static makeCacheKey(e){if(void 0===e.cacheId)return!1;const t=yt.resolveDefaults(e);return`NoiseTexture,${t.width},${t.height},${t.cacheId}`}static resolveDefaults(e){var t,o,r;return{width:null!==(t=e.width)&&void 0!==t?t:128,height:null!==(o=e.height)&&void 0!==o?o:128,cacheId:null!==(r=e.cacheId)&&void 0!==r?r:0}}}o(yt,"z$__type__Props",void 0);let xt=0;class vt extends me{constructor(e,t){super(e),o(this,"props",void 0),o(this,"parentTexture",void 0),o(this,"type",fe.subTexture),o(this,"subtextureId","subtexture-"+xt++),o(this,"onParentTxLoaded",()=>{this.forwardParentTxState("loaded",{width:this.props.width,height:this.props.height})}),o(this,"onParentTxFailed",(e,t)=>{this.retryCount=this.parentTexture.retryCount-1,this.forwardParentTxState("failed",t)}),o(this,"onParentTxLoading",()=>{this.forwardParentTxState("loading")}),o(this,"onParentTxFreed",()=>{this.forwardParentTxState("freed")}),this.props=vt.resolveDefaults(t||{}),this.props.texture,this.props.texture,this.parentTexture=e.resolveParentTexture(this.props.texture),this.renderableOwners.length>0&&this.parentTexture.setRenderableOwner(this.subtextureId,!0),queueMicrotask(()=>{const e=this.parentTexture;"loaded"===e.state&&e.dimensions?this.onParentTxLoaded(e,e.dimensions):"loading"===e.state?this.onParentTxLoading():"failed"===e.state&&e.error?this.onParentTxFailed(e,e.error):"freed"===e.state&&this.onParentTxFreed(),e.on("loading",this.onParentTxLoading),e.on("loaded",this.onParentTxLoaded),e.on("failed",this.onParentTxFailed),e.on("freed",this.onParentTxFreed)})}forwardParentTxState(e,t){this.setState(e,t)}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this.subtextureId,e)}async getTextureSource(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}}o(vt,"z$__type__Props",void 0);class bt extends me{constructor(e,t){super(e),o(this,"props",void 0),o(this,"type",fe.renderToTexture),this.props=bt.resolveDefaults(t||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureSource(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}}var wt;o(bt,"z$__type__Props",void 0),function(e){e.MEMORY_THRESHOLD_EXCEEDED="MEMORY_THRESHOLD_EXCEEDED",e.TEXTURE_DATA_NULL="TEXTURE_DATA_NULL",e.TEXTURE_TYPE_NOT_REGISTERED="TEXTURE_TYPE_NOT_REGISTERED"}(wt||(wt={}));const Tt={[wt.MEMORY_THRESHOLD_EXCEEDED]:"Memory threshold exceeded",[wt.TEXTURE_DATA_NULL]:"Texture data is null",[wt.TEXTURE_TYPE_NOT_REGISTERED]:"Texture type is not registered"};class St extends Error{constructor(e,t){const r=Object.values(wt).includes(e),i=r?e:void 0;let n;n=r&&i?null!=t?t:Tt[i]:String(e),super(n),o(this,"code",void 0),this.name=new.target.name,i&&(this.code=i)}}class Rt extends pe{constructor(e,t){super(),o(this,"keyCache",new Map),o(this,"inverseKeyCache",new WeakMap),o(this,"txConstructors",{}),o(this,"maxRetryCount",void 0),o(this,"priorityQueue",[]),o(this,"uploadTextureQueue",[]),o(this,"initialized",!1),o(this,"stage",void 0),o(this,"numImageWorkers",void 0),o(this,"imageWorkerManager",null),o(this,"hasCreateImageBitmap",!!self.createImageBitmap),o(this,"imageBitmapSupported",{basic:!1,options:!1,full:!1}),o(this,"hasWorker",!!self.Worker),o(this,"renderer",void 0),o(this,"frameTime",0);const{numImageWorkers:r,createImageBitmapSupport:i,maxRetryCount:n}=t;this.stage=e,this.numImageWorkers=r,this.maxRetryCount=n,"auto"===i?async function(){var e;const t=new Uint8Array([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1,0,0,0,1,1,3,0,0,0,37,219,86,202,0,0,0,3,80,76,84,69,0,0,0,167,122,61,218,0,0,0,1,116,82,78,83,0,64,230,216,102,0,0,0,10,73,68,65,84,8,215,99,96,0,0,0,2,0,1,226,33,188,51,0,0,0,0,73,69,78,68,174,66,96,130]),o={basic:!1,options:!1,full:!1},r=new Blob([t],{type:"image/png"}),i=await createImageBitmap(r);null===(e=i.close)||void 0===e||e.call(i),o.basic=!0;try{var n;const e={premultiplyAlpha:"none"},t=await createImageBitmap(r,e);null===(n=t.close)||void 0===n||n.call(t),o.options=!0}catch(a){}try{var s;const e=await createImageBitmap(r,0,0,1,1,{premultiplyAlpha:"none"});null===(s=e.close)||void 0===s||s.call(e),o.full=!0}catch(a){}return o}().then(e=>{this.initialize(e)}).catch(()=>{console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.initialized=!0,this.emit("initialized")}):this.initialize({basic:"basic"===i,options:"options"===i,full:"full"===i}),this.registerTextureType("ImageTexture",gt),this.registerTextureType("ColorTexture",Ye),this.registerTextureType("NoiseTexture",yt),this.registerTextureType("SubTexture",vt),this.registerTextureType("RenderTexture",bt)}registerTextureType(e,t){this.txConstructors[e]=t}initialize(e){this.hasCreateImageBitmap=e.basic||e.options||e.full,this.imageBitmapSupported=e,this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.hasCreateImageBitmap&&this.hasWorker&&this.numImageWorkers>0?this.imageWorkerManager=new He(this.numImageWorkers,e):console.warn("[Lightning] Imageworker is 0 or not supported on this browser. Image loading will be slower."),this.initialized=!0,this.emit("initialized")}enqueueUploadTexture(e){!1===this.uploadTextureQueue.includes(e)&&this.uploadTextureQueue.push(e)}createTexture(e,t){let o;const r=this.txConstructors[e];if(!r)throw new St(wt.TEXTURE_TYPE_NOT_REGISTERED,`Texture type "${e}" is not registered`);const i=r.makeCacheKey(t);return i&&this.keyCache.has(i)?o=this.keyCache.get(i):(o=new r(this,t),i&&this.initTextureToCache(o,i)),o}async loadTexture(e,t){if(e.type===fe.subTexture)return;if("loaded"===e.state)return;if("loading"===e.state)return;if(!1===this.initialized)return void this.priorityQueue.push(e);e.setState("loading");if(null===await e.getTextureData().catch(t=>(console.error(t),e.setState("failed"),null))||"failed"===e.state)return;!0!==(e.type!==fe.image||!0===t)?this.enqueueUploadTexture(e):await this.uploadTexture(e).catch(t=>{console.error("Failed to upload texture:",t),e.setState("failed")})}async uploadTexture(e){if(!0===this.stage.txMemManager.doNotExceedCriticalThreshold&&!0===this.stage.txMemManager.criticalCleanupRequested)return void e.setState("failed",new St(wt.MEMORY_THRESHOLD_EXCEEDED));if("failed"===e.state||"freed"===e.state)return;if("loaded"===e.state)return;if(null===e.textureData)return void e.setState("failed",new St(wt.TEXTURE_DATA_NULL,"Texture data is null, cannot upload texture"));const t=e.loadCtxTexture();null===t||"loaded"!==t.state?await t.load():e.setState("loaded")}isProcessingTexture(e){return!0===this.uploadTextureQueue.includes(e)}async processSome(e){if(!1===this.initialized)return;const t=Xe();for(;this.priorityQueue.length>0&&Xe()-t<e;){const e=this.priorityQueue.pop();try{await e.getTextureData(),await this.uploadTexture(e)}catch(o){console.error("Failed to process priority texture:",o)}}for(;this.uploadTextureQueue.length>0&&Xe()-t<e;){const e=this.uploadTextureQueue.shift();try{await this.uploadTexture(e)}catch(o){console.error("Failed to upload texture:",o)}}}hasUpdates(){return this.uploadTextureQueue.length>0}initTextureToCache(e,t){const{keyCache:o,inverseKeyCache:r}=this;o.set(t,e),r.set(e,t)}getTextureFromCache(e){return this.keyCache.get(e)}removeTextureFromCache(e){const{inverseKeyCache:t,keyCache:o}=this,r=t.get(e);r&&o.delete(r)}resolveParentTexture(e){if(null==e||!e.props)return e;const t=gt.makeCacheKey(e.props),o=t?this.getTextureFromCache(t):void 0;return null!=o?o:e}}const Et={normal:400,bold:700,bolder:900,lighter:100},_t=e=>"number"==typeof e?e:Et[e]||400;class Ct{constructor(e){o(this,"textRenderers",void 0),o(this,"fontCache",new Map),this.textRenderers=e}addFontFace(e){for(const t in this.textRenderers){const o=this.textRenderers[t];o&&o.isFontFaceSupported(e)&&o.addFontFace(e)}}resolveFontFace(e,t,o){const{fontFamily:r,fontWeight:i,fontStyle:n,fontStretch:s}=t,a=`${o}_${r}_${n}_${i}_${s}`;if(!0===this.fontCache.has(a))return this.fontCache.get(a);const l=function(e,t,o,r,i){let n=_t(o);for(const s of e){const e=s[t];if(!e)continue;if(1===e.size)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),e.values().next().value;const o=new Map;for(const t of e){const e=_t(t.descriptors.weight);if(e===n&&t.descriptors.style===r&&t.descriptors.stretch===i)return t;o.set(e,t)}const a=`TrFontManager: No exact match: '${t} Weight: ${n} Style: ${r} Stretch: ${i}'`;if(console.error(a),400===n&&o.has(500))return o.get(500);if(500===n&&o.has(400))return o.get(400);if(n<400){for(;n>0;){if(o.has(n))return o.get(n);n-=100}n=600}for(;n<1e3;){if(o.has(n))return o.get(n);n+=100}for(n=500;n>0;){if(o.has(n))return o.get(n);n-=100}}}(e,r,i,n,s);return void 0!==l&&this.fontCache.set(a,l),l}}class At{static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}function kt(e,t,o){const r=e.createShader(t);if(!r){const o=e.getError();throw new Error(`Unable to create the shader: ${t===e.VERTEX_SHADER?"VERTEX_SHADER":"FRAGMENT_SHADER"}.${o?` WebGlContext Error: ${o}`:""}`)}e.shaderSource(r,o),e.compileShader(r);if(!!e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.error(e.getShaderInfoLog(r)),e.deleteShader(r)}class Mt extends At{constructor(e){super(),o(this,"buffersBound",!1),o(this,"program",void 0),o(this,"vao",void 0),o(this,"renderer",void 0),o(this,"glw",void 0),o(this,"attributeLocations",void 0),o(this,"uniformLocations",void 0),o(this,"supportsIndexedTextures",void 0);const t=this.renderer=e.renderer,r=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const i=r.isWebGl2(),n=i&&e.webgl2Extensions||!i&&e.webgl1Extensions||[],s=i?"2.0":"1.0";n.forEach(e=>{if(!r.getExtension(e))throw new Error(`Shader "${this.constructor.name}" requires extension "${e}" for WebGL ${s} but wasn't found`)});const a=e.shaderSources||this.constructor.shaderSources;if(!a)throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);i&&null!=a&&a.webGl2&&(a.fragment=a.webGl2.fragment,a.vertex=a.webGl2.vertex,delete a.webGl2);const l=t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,h=a.vertex instanceof Function?a.vertex(l):a.vertex,d=a.fragment instanceof Function?a.fragment(l):a.fragment,c=kt(r,r.VERTEX_SHADER,h),u=kt(r,r.FRAGMENT_SHADER,d);if(!c||!u)throw new Error(`Unable to create the following shader(s): ${[!c&&"VERTEX_SHADER",!u&&"FRAGMENT_SHADER"].filter(Boolean).join(" and ")}`);const p=function(e,t,o){const r=e.createProgram();if(!r)throw new Error("Unable to create program");if(e.attachShader(r,t),e.attachShader(r,o),e.linkProgram(r),!!e.getProgramParameter(r,e.LINK_STATUS))return r;console.warn(e.getProgramInfoLog(r)),e.deleteProgram(r)}(r,c,u);if(!p)throw new Error("Unable to create program");this.program=p,this.attributeLocations=r.getAttributeLocations(this.program),this.uniformLocations=r.getUniformLocations(this.program)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){const e=this.glw,t=this.attributeLocations.length;for(let o=0;o<t;o++)e.disableVertexAttribArray(o)}canBatchShaderProps(e,t){return!1}bindRenderOp(e,t){var o;this.bindBufferCollection(e.buffers),e.textures.length>0&&null!==(o=e.textures[0])&&void 0!==o&&o.ctxTexture&&this.bindTextures(e.textures);const{glw:r,parentHasRenderTexture:i,renderToTexture:n}=e;if(!n||!i){if(i){const{width:t,height:o}=e.framebufferDimensions||{};r.uniform1f(this.getUniformLocation("u_pixelRatio"),1),r.uniform2f(this.getUniformLocation("u_resolution"),null!=t?t:0,null!=o?o:0)}else r.uniform1f(this.getUniformLocation("u_pixelRatio"),e.options.pixelRatio),r.uniform2f(this.getUniformLocation("u_resolution"),r.canvas.width,r.canvas.height);if(t){if(ce(t,"$dimensions")){let o=t.$dimensions;o||(o=e.dimensions),r.uniform2f(this.getUniformLocation("u_dimensions"),o.width,o.height)}if(ce(t,"$alpha")){let o=t.$alpha;o||(o=e.alpha),r.uniform1f(this.getUniformLocation("u_alpha"),o)}this.bindProps(t)}}}getUniformLocation(e){return this.uniformLocations[e]||null}bindBufferCollection(e){const{glw:t}=this,o=this.attributeLocations,r=o.length;for(let i=0;i<r;i++){const r=o[i],n=e.getBuffer(r),s=e.getAttributeInfo(r);void 0!==n&&void 0!==s&&(t.enableVertexAttribArray(i),t.vertexAttribPointer(n,i,s.size,s.type,s.normalized,s.stride,s.offset))}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}o(Mt,"shaderSources",void 0);class Ot extends Mt{constructor(e){super({renderer:e})}bindTextures(e){const{glw:t}=this;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}}o(Ot,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_nodeCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class It extends Mt{constructor(e){super({renderer:e}),o(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:t,glw:o}=this;if(e.length>t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((e,t)=>{o.activeTexture(t),o.bindTexture(e.ctxTexture)});const r=Array.from(Array(e.length).keys());this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"),r)}}o(It,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>`\n      #define txUnits ${e}\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {\n        ${Array.from(Array(e).keys()).map(e=>`\n          ${0!==e?"else ":""}if (idx == ${e}) {\n            return texture2D(textures[${e}], uv);\n          }\n        `).join("")}\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    `});class Pt{static getEffectKey(e){return""}static getMethodParameters(e,t){const o=[];for(const r in e){const i=e[r];let n="";i.size&&(n=`[${i.size(t)}]`),o.push(`${i.type} ${r}${n}`)}return o.join(",")}constructor(e){o(this,"priority",1),o(this,"name",""),o(this,"ref",void 0),o(this,"target",void 0),o(this,"passParameters",""),o(this,"declaredUniforms",""),o(this,"uniformInfo",{});const{ref:t,target:r,props:i={}}=e;this.ref=t,this.target=r;const n={},s=[];let a="";const l=this.constructor.uniforms||{};for(const o in l){const e=l[o],r=e.type,h=`${t}_${o}`;let d="";e.size&&(d=`[${e.size(i)}]`),s.push(h),a+=`uniform ${r} ${h}${d};`,n[o]={name:h,uniform:l[o].method}}this.passParameters=s.join(","),this.declaredUniforms=a,this.uniformInfo=n}static resolveDefaults(e){return{}}static makeEffectKey(e){return!1}}o(Pt,"uniforms",{}),o(Pt,"methods",void 0),o(Pt,"onShaderMask",void 0),o(Pt,"onColorize",void 0),o(Pt,"onEffectMask",void 0);const Lt=new Map,Ft=(e,t)=>{const o=JSON.stringify(e);if(Lt.has(o))return Lt.get(o);const r=[],i=(e=null!=e?e:[]).length;let n=0;for(;n<i;n++){const{name:o,type:i,props:s}=e[n],a={name:o,type:i,props:{}},l=t[i],h=l.resolveDefaults(s),d=l.uniforms,c=Object.keys(d),u=c.length;let p=0;for(;p<u;p++){const e=c[p],t=d[e],o={value:h[e],programValue:void 0,method:t.method,updateOnBind:t.updateOnBind||!1,hasValidator:void 0!==t.validator,hasProgramValueUpdater:void 0!==t.updateProgramValue},r=o.hasValidator&&t.validator(h[e],h)||h[e];h[e]!==r&&(o.validatedValue=r),o.hasProgramValueUpdater&&t.updateProgramValue(o),void 0===o.programValue&&(o.programValue=o.value),a.props[e]=o}r.push(a)}return Lt.set(o,r),r};class Bt extends Mt{constructor(e,t,r){const i=Bt.createShader(t,r);super({renderer:e,shaderSources:{vertex:i.vertex,fragment:i.fragment}}),o(this,"effects",[]),this.effects=i.effects}bindTextures(e){const{glw:t}=this;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindUniformMethods(e){const t=this.glw,o=e.effects,r=o.length;for(let i=0;i<r;i++){const e=this.effects[i].uniformInfo,r=o[i],n=Object.keys(r.props),s=n.length;for(let o=0;o<s;o++){const i=n[o],s=r.props[i].method,a=this.getUniformLocation(e[i].name);"uniform2fv"!==s&&"uniform2iv"!==s&&"uniform3iv"!==s&&"uniform4fv"!==s&&"uniform4iv"!==s&&"uniformMatrix2fv"!==s&&"uniformMatrix3fv"!==s&&"uniformMatrix4fv"!==s&&"uniform1f"!==s&&"uniform1fv"!==s&&"uniform1i"!==s&&"uniform1iv"!==s?"uniform2f"!==s&&"uniform2i"!==s?"uniform3f"!==s&&"uniform3i"!==s?"uniform4f"!==s&&"uniform4i"!==s||(r.props[i].setUniformValue=function(){t[s](a,this.programValue[0],this.programValue[1],this.programValue[2],this.programValue[3])}):r.props[i].setUniformValue=function(){t[s](a,this.programValue[0],this.programValue[1],this.programValue[2])}:r.props[i].setUniformValue=function(){t[s](a,this.programValue[0],this.programValue[1])}:r.props[i].setUniformValue=function(){t[s](a,this.programValue)}}}}bindProps(e){const t=e.effects,o=t.length;let r=0;for(;r<o;r++){const o=t[r],n=Object.keys(o.props),s=n.length;let a=0;for(;a<s;a++){const t=n[a],r=o.props[t];if(!0===r.updateOnBind){var i;const r=null===(i=this.renderer.shManager.getRegisteredEffects()[o.type])||void 0===i?void 0:i.uniforms[t];null==r||r.updateProgramValue(o.props[t],e)}r.setUniformValue()}}}canBatchShaderProps(e,t){if(e.$alpha!==t.$alpha||e.$dimensions.width!==t.$dimensions.width||e.$dimensions.height!==t.$dimensions.height||e.effects.length!==t.effects.length)return!1;const o=e.effects.length;let r=0;for(;r<o;r++){const o=e.effects[r],i=t.effects[r];if(o.type!==i.type)return!1;for(const e in o.props)if(i.props&&!i.props[e]||o.props[e].value!==i.props[e].value)return!1}return!0}static createShader(e,t){const o={},r={};let i="";const n=[],s=[],a=e.effects.map(e=>{const r=t[e.type],a=r.getEffectKey(e.props||{});o[a]=o[a]?++o[a]:1;const l=o[a];1===l&&s.push({key:a,type:e.type,props:e.props});const h=new r({ref:`${a}${1===l?"":l}`,target:a,props:e.props});return i+=h.declaredUniforms,n.push(...Object.values(h.uniformInfo)),h});let l="";null==s||s.forEach(e=>{var o;const i=t[e.type],n=i.resolveDefaults(null!==(o=e.props)&&void 0!==o?o:{}),s=[];for(const t in i.methods){let e=t;const o=i.methods[t];r[t]&&r[t]!==o&&(e=Bt.resolveMethodDuplicate(t,o,r)),r[e]=o.replace("function",e),s.push({m:t,cm:e})}let a=i.onShaderMask instanceof Function?i.onShaderMask(n):i.onShaderMask,h=i.onColorize instanceof Function?i.onColorize(n):i.onColorize,d=i.onEffectMask instanceof Function?i.onEffectMask(n):i.onEffectMask;s.forEach(e=>{const{m:t,cm:o}=e,r=new RegExp(`\\$${t}`,"g");a&&(a=a.replace(r,o)),h&&(h=h.replace(r,o)),d&&(d=d.replace(r,o))});const c=i.getMethodParameters(i.uniforms,n),u=c.length>0?`, ${c}`:"";a&&(l+=`\n        float fx_${e.key}_onShaderMask(float shaderMask ${u}) {\n          ${a}\n        }\n        `),h&&(l+=`\n          vec4 fx_${e.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${u}) {\n            ${h}\n          }\n        `),d&&(l+=`\n          vec4 fx_${e.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${u}) {\n            ${d}\n          }\n        `)});let h="";for(const u in r)h+=r[u];let d="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",c="\n\n    ";for(let u=0;u<a.length;u++){const e=a[u],o=e.passParameters.length>0?`, ${e.passParameters}`:"",r=t[e.name];r.onShaderMask&&(c+=`\n        shaderMask = fx_${e.target}_onShaderMask(shaderMask ${o});\n        `),r.onColorize&&(c+=`\n        maskColor = fx_${e.target}_onColorize(shaderMask, maskColor, shaderColor${o});\n        `),r.onEffectMask&&(d=`fx_${e.target}_onEffectMask(shaderMask, maskColor, shaderColor${o})`);const i=a[u+1];(void 0===i||t[i.name].onEffectMask)&&(c+=`\n          shaderColor = ${d};\n        `)}return{effects:a,uniforms:n,fragment:Bt.fragment(i,h,l,c),vertex:Bt.vertex()}}static resolveMethodDuplicate(e,t,o,r=0){const i=e+(r>0?r:"");return o[i]&&o[i]!==t?this.resolveMethodDuplicate(e,t,o,++r):i}static resolveDefaults(e,t){var o;return{effects:Ft(null!==(o=e.effects)&&void 0!==o?o:[],t),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,t){var o;let r="";return null===(o=e.effects)||void 0===o||o.forEach(e=>{const o=t[e.type].getEffectKey(e.props||{});r+=`,${o}`}),`DynamicShader${r}`}}o(Bt,"z$__type__Props",void 0),o(Bt,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_nodeCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n    varying vec2 v_nodeCoordinate;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n      v_nodeCoordinate = a_nodeCoordinate;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),o(Bt,"fragment",(e,t,o,r)=>`\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ${e}\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying vec2 v_nodeCoordinate;\n\n    ${t}\n\n    ${o}\n\n    void main() {\n      vec2 p = v_nodeCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ${r}\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  `);class Ut extends Mt{constructor(e){super({renderer:e})}static resolveDefaults(e){return{radius:e.radius||10,$dimensions:{width:0,height:0}}}bindTextures(e){const{glw:t}=this;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindProps(e){const t=Math.min(e.$dimensions.width,e.$dimensions.height)/(2*e.radius);this.glw.uniform1f(this.getUniformLocation("u_radius"),e.radius*Math.min(t,1))}canBatchShaderProps(e,t){return e.radius===t.radius&&e.$dimensions.width===t.$dimensions.width&&e.$dimensions.height===t.$dimensions.height}}o(Ut,"z$__type__Props",void 0),o(Ut,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute vec2 a_nodeCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_nodeCoordinate = a_nodeCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying vec2 v_nodeCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const $t=new Float32Array([1,0,0,0,1,0,0,0,1]);class Nt extends Mt{constructor(e){super({renderer:e})}bindTextures(e){const{glw:t}=this;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindProps(e){const t=Nt.resolveDefaults(e);for(const o in t)if("transform"===o)this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"),t[o]);else if("scrollY"===o)this.glw.uniform1f(this.getUniformLocation("u_scrollY"),t[o]);else if("color"===o){const e=ye(t.color);this.glw.uniform4fv(this.getUniformLocation("u_color"),e)}else"size"===o?this.glw.uniform1f(this.getUniformLocation("u_size"),t[o]):"distanceRange"===o?this.glw.uniform1f(this.getUniformLocation("u_distanceRange"),t[o]):"debug"===o&&this.glw.uniform1i(this.getUniformLocation("u_debug"),t[o]?1:0)}static resolveDefaults(e={}){var t,o,r,i,n,s;return{transform:null!==(t=e.transform)&&void 0!==t?t:$t,scrollY:null!==(o=e.scrollY)&&void 0!==o?o:0,color:null!==(r=e.color)&&void 0!==r?r:4294967295,size:null!==(i=e.size)&&void 0!==i?i:16,distanceRange:null!==(n=e.distanceRange)&&void 0!==n?n:1,debug:null!==(s=e.debug)&&void 0!==s&&s}}}o(Nt,"z$__type__Props",void 0),o(Nt,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});const Dt=e=>{void 0===e.programValue&&(e.programValue=new Float32Array(4));const t=e.value,o=e.programValue;o[0]=(t>>>24)/255,o[1]=(t>>>16&255)/255,o[2]=(t>>>8&255)/255,o[3]=(255&t)/255},jt=e=>{const t=e.validatedValue||e.value;if(e.programValue instanceof Float32Array){const o=t.length,r=e.programValue;for(let e=0;e<o;e++)r[e]=t[e]}else e.programValue=new Float32Array(t)},zt=e=>{const t=Array.isArray(e);return t?t&&4===e.length?e:t&&2===e.length?[e[0],e[1],e[0],e[1]]:t&&3===e.length?[e[0],e[1],e[2],e[0]]:[e[0],e[0],e[0],e[0]]:[e,e,e,e]},Wt=(e,t)=>{void 0===e.programValue&&(e.programValue=new Float32Array(4));const o=e.programValue,r=e.validatedValue||e.value;if(void 0===t&&void 0===e.$dimensions)return o[0]=r[0],o[1]=r[1],o[2]=r[2],void(o[3]=r[3]);let i=e.$dimensions;if(void 0!==t){const{$dimensions:o}=t;if(void 0!==i&&(i.width===o.width||i.height===o.height))return;void 0===i&&(i={width:null==o?void 0:o.width,height:null==o?void 0:o.height},e.$dimensions=i)}const{width:n,height:s}=i,[a,l,h,d]=r,c=Math.min(Math.min(Math.min(n/Math.max(n,a+l),n/Math.max(n,h+d)),Math.min(s/Math.max(s,a+h),s/Math.max(s,l+d))),1);o[0]=a*c,o[1]=l*c,o[2]=h*c,o[3]=d*c};class Xt extends Pt{constructor(...e){super(...e),o(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var t;return{radius:null!==(t=e.radius)&&void 0!==t?t:10}}}o(Xt,"z$__type__Props",void 0),o(Xt,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:zt,updateProgramValue:Wt}}),o(Xt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),o(Xt,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 p = v_nodeCoordinate.xy * u_dimensions - halfDimensions;\n  vec4 r = radius;\n  r.xy = (p.x > 0.0) ? r.yz : r.xw;\n  float cornerRadius = (p.y > 0.0) ? r.y : r.x;\n  return $boxDist(p, halfDimensions, cornerRadius);\n  "),o(Xt,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class Gt extends Pt{constructor(...e){super(...e),o(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var t,o;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(o=e.color)&&void 0!==o?o:4294967295}}}o(Gt,"z$__type__Props",void 0),o(Gt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Dt,method:"uniform4fv",type:"vec4"}}),o(Gt,"onEffectMask","\n  float intR = shaderMask + 1.0;\n  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  "),o(Gt,"onColorize","\n    return color;\n  ");class Vt extends Pt{constructor(...e){super(...e),o(this,"name","linearGradient")}static getEffectKey(e){return e.colors.value?`linearGradient${e.colors.value.length}`:`linearGradient${e.colors.length}`}static resolveDefaults(e){var t,o;const r=null!==(t=e.colors)&&void 0!==t?t:[4278190080,4294967295];let i=e.stops||[];if(0===i.length||i.length!==r.length){const e=r.length;let t=0;const o=i;for(;t<e;t++)i[t]?(o[t]=i[t],void 0===i[t-1]&&void 0!==o[t-2]&&(o[t-1]=o[t-2]+(i[t]-o[t-2])/2)):o[t]=t*(1/(r.length-1));i=o}return{colors:r,stops:i,angle:null!==(o=e.angle)&&void 0!==o?o:0}}}o(Vt,"z$__type__Props",void 0),o(Vt,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((e,t)=>e.concat(ye(t)),[]),updateProgramValue:jt,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),o(Vt,"methods",{calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),o(Vt,"ColorLoop",e=>{let t="";for(let o=2;o<e;o++)t+=`colorOut = mix(colorOut, colors[${o}], clamp((dist - stops[${o-1}]) / (stops[${o}] - stops[${o-1}]), 0.0, 1.0));`;return t}),o(Vt,"onColorize",e=>`\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_nodeCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ${e.colors.length||1};\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    `);class Ht extends Pt{constructor(...e){super(...e),o(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){var t;return{amount:null!==(t=e.amount)&&void 0!==t?t:1}}}o(Ht,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),o(Ht,"onColorize","\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ");class Yt extends Pt{constructor(...e){super(...e),o(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var t,o;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(o=e.color)&&void 0!==o?o:4294967295}}}o(Yt,"z$__type__Props",void 0),o(Yt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Dt,method:"uniform4fv",type:"vec4"}}),o(Yt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),o(Yt,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),o(Yt,"onColorize","\n    return color;\n  ");class qt extends Pt{constructor(...e){super(...e),o(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var t,o;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(o=e.color)&&void 0!==o?o:4294967295}}}o(qt,"z$__type__Props",void 0),o(qt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Dt,method:"uniform4fv",type:"vec4"}}),o(qt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),o(qt,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),o(qt,"onColorize","\n    return color;\n  ");class Kt extends Pt{constructor(...e){super(...e),o(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var t,o;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(o=e.color)&&void 0!==o?o:4294967295}}}o(Kt,"z$__type__Props",void 0),o(Kt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Dt,method:"uniform4fv",type:"vec4"}}),o(Kt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),o(Kt,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),o(Kt,"onColorize","\n    return color;\n  ");class Qt extends Pt{constructor(...e){super(...e),o(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var t,o;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(o=e.color)&&void 0!==o?o:4294967295}}}o(Qt,"z$__type__Props",void 0),o(Qt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Dt,method:"uniform4fv",type:"vec4"}}),o(Qt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),o(Qt,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),o(Qt,"onColorize","\n    return color;\n  ");class Zt extends Pt{constructor(...e){super(...e),o(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var t,o,r,i,n;return{amplitude:null!==(t=e.amplitude)&&void 0!==t?t:.2,narrowness:null!==(o=e.narrowness)&&void 0!==o?o:4,blockiness:null!==(r=e.blockiness)&&void 0!==r?r:2,minimizer:null!==(i=e.minimizer)&&void 0!==i?i:8,time:null!==(n=e.time)&&void 0!==n?n:Date.now()}}}o(Zt,"z$__type__Props",void 0),o(Zt,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const t=e.value=(Date.now()-e.value)%1e3;e.programValue=t},type:"float"}}),o(Zt,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),o(Zt,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class Jt extends Pt{constructor(...e){super(...e),o(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var t;return{fade:null!==(t=e.fade)&&void 0!==t?t:10}}}o(Jt,"z$__type__Props",void 0),o(Jt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:zt,updateProgramValue:e=>{const t=e.validatedValue||e.value;if(e.programValue instanceof Float32Array){const o=e.programValue;o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3]}else e.programValue=new Float32Array(t)}}}),o(Jt,"onColorize","\n  vec2 point = v_nodeCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_nodeCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_nodeCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class eo extends Pt{constructor(...e){super(...e),o(this,"name","radialGradient")}static getEffectKey(e){return e.colors.value?`radialGradient${e.colors.value.length}`:`radialGradient${e.colors.length}`}static resolveDefaults(e){var t,o,r,i,n;const s=null!==(t=e.colors)&&void 0!==t?t:[4278190080,4294967295];let a=e.stops||[];if(0===a.length||a.length!==s.length){const e=s.length;let t=0;const o=a;for(;t<e;t++)a[t]?(o[t]=a[t],void 0===a[t-1]&&void 0!==o[t-2]&&(o[t-1]=o[t-2]+(a[t]-o[t-2])/2)):o[t]=t*(1/(s.length-1));a=o}return{colors:s,stops:a,width:null!==(o=e.width)&&void 0!==o?o:0,height:null!==(r=null!==(i=e.height)&&void 0!==i?i:e.width)&&void 0!==r?r:0,pivot:null!==(n=e.pivot)&&void 0!==n?n:[.5,.5]}}}o(eo,"z$__type__Props",void 0),o(eo,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:e=>{const t=e.validatedValue||e.value;if(e.programValue instanceof Float32Array){const o=e.programValue;o[0]=t[0],o[1]=t[1]}else e.programValue=new Float32Array(t)},method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((e,t)=>e.concat(ye(t)),[]),updateProgramValue:jt,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),o(eo,"methods",{getGradientColor:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    "}),o(eo,"ColorLoop",e=>{let t="";for(let o=2;o<e;o++)t+=`colorOut = mix(colorOut, colors[${o}], clamp((dist - stops[${o-1}]) / (stops[${o}] - stops[${o-1}]), 0.0, 1.0));`;return t}),o(eo,"onColorize",e=>`\n      vec2 point = v_nodeCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      dist = clamp(dist, 0.0, 1.0);\n      //return early if dist is lower or equal to first stop\n      if(dist <= stops[0]) {\n        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));\n      }\n      const int amount = ${e.colors.length||1};\n      const int last = amount - 1;\n\n      if(dist >= stops[last]) {\n        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n      }\n\n      for(int i = 0; i < last; i++) {\n        float left = stops[i];\n        float right = stops[i + 1];\n        if(dist >= left && dist <= right) {\n          float localDist = smoothstep(left, right, dist);\n          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);\n          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n        }\n      }\n\n      //final fallback\n      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));\n    `);class to extends Pt{constructor(...e){super(...e),o(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var t,o,r,i,n,s,a;return{width:null!==(t=e.width)&&void 0!==t?t:10,progress:null!==(o=e.progress)&&void 0!==o?o:.5,offset:null!==(r=e.offset)&&void 0!==r?r:0,range:null!==(i=e.range)&&void 0!==i?i:2*Math.PI,rounded:null!==(n=e.rounded)&&void 0!==n&&n,radius:null!==(s=e.radius)&&void 0!==s?s:1,color:null!==(a=e.color)&&void 0!==a?a:4294967295}}}o(to,"z$__type__Props",void 0),o(to,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Dt,method:"uniform4fv",type:"vec4"}}),o(to,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),o(to,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_nodeCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),o(to,"onColorize","\n    return color;\n  ");class oo extends Pt{constructor(...e){super(...e),o(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){var t;return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:null!==(t=e.radius)&&void 0!==t?t:0}}}o(oo,"z$__type__Props",void 0),o(oo,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:zt,updateProgramValue:Wt}}),o(oo,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),o(oo,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_nodeCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  "),o(oo,"onEffectMask","\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  ");class ro extends At{constructor(e){super(),o(this,"shType",void 0),this.shType=e}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class io{constructor(e,t,r,i){o(this,"type",void 0),o(this,"shader",void 0),o(this,"resolvedProps",void 0),o(this,"props",void 0),this.type=e,this.shader=t,this.resolvedProps=r;const n=Object.keys(r),s=n.length,a={};for(let o=0;o<s;o++){const e=n[o];Object.defineProperty(a,e,{get:()=>this.resolvedProps[e],set:t=>{this.resolvedProps[e]=t,i.requestRender()}})}this.props=a}getResolvedProps(){return this.resolvedProps}}class no{constructor(e,t,r){o(this,"shader",void 0),o(this,"resolvedProps",void 0),o(this,"props",void 0),o(this,"type",void 0),this.shader=e,this.type="DynamicShader",this.resolvedProps=t;const i=r.getRegisteredEffects(),n={},s=t.effects,a=s.length;for(let o=0;o<a;o++){const{name:e,props:t,type:a}=s[o];if(void 0===e)continue;const l={},h=Object.keys(t),d=h.length;for(let n=0;n<d;n++){const e=h[n];Object.defineProperty(l,e,{get:()=>this.resolvedProps.effects[o].props[e].value,set:n=>{const s=this.resolvedProps.effects[o].props[e];var l,h;(s.value=n,s.hasValidator)&&(n=s.validatedValue=null===(l=i[a].uniforms[e])||void 0===l?void 0:l.validator(n,t));s.hasProgramValueUpdater?null===(h=i[a].uniforms[e])||void 0===h||h.updateProgramValue(s):s.programValue=n;r.renderer.stage.requestRender()}})}Object.defineProperty(n,e,{get:()=>l})}this.props=n}getResolvedProps(){return this.resolvedProps}}class so{constructor(){o(this,"shCache",new Map),o(this,"shConstructors",{}),o(this,"attachedShader",null),o(this,"effectConstructors",{}),o(this,"renderer",void 0),this.registerShaderType("DefaultShader",Ot),this.registerShaderType("DefaultShaderBatched",It),this.registerShaderType("RoundedRectangle",Ut),this.registerShaderType("DynamicShader",Bt),this.registerShaderType("SdfShader",Nt),this.registerEffectType("border",Gt),this.registerEffectType("borderBottom",Kt),this.registerEffectType("borderLeft",Qt),this.registerEffectType("borderRight",Yt),this.registerEffectType("borderTop",qt),this.registerEffectType("fadeOut",Jt),this.registerEffectType("linearGradient",Vt),this.registerEffectType("radialGradient",eo),this.registerEffectType("grayscale",Ht),this.registerEffectType("glitch",Zt),this.registerEffectType("radius",Xt),this.registerEffectType("radialProgress",to),this.registerEffectType("holePunch",oo)}registerShaderType(e,t){this.shConstructors[e]=t}registerEffectType(e,t){this.effectConstructors[e]=t}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(e,t){if(!this.renderer)throw new Error("Renderer is not been defined");const o=this.shConstructors[e];if(!o)throw new Error(`Shader type "${e}" is not registered`);if("canvas"===this.renderer.mode&&o.prototype instanceof Mt)return this._createShaderCtr(e,new ro(e),t);if("DynamicShader"===e)return this.loadDynamicShader(t);const r=o.resolveDefaults(t),i=o.makeCacheKey(r)||o.name;if(i&&this.shCache.has(i))return this._createShaderCtr(e,this.shCache.get(i),r);const n=new o(this.renderer,t);return i&&this.shCache.set(i,n),this._createShaderCtr(e,n,r)}loadDynamicShader(e){if(!this.renderer)throw new Error("Renderer is not been defined");const t=Bt.resolveDefaults(e,this.effectConstructors),o=Bt.makeCacheKey(t,this.effectConstructors);if(o&&this.shCache.has(o))return this._createDynShaderCtr(this.shCache.get(o),t);const r=new Bt(this.renderer,e,this.effectConstructors);return o&&this.shCache.set(o,r),this._createDynShaderCtr(r,t)}_createShaderCtr(e,t,o){return new io(e,t,o,this.renderer.stage)}_createDynShaderCtr(e,t){return e.bindUniformMethods(t),new no(e,t,this)}useShader(e){this.attachedShader!==e&&(this.attachedShader&&this.attachedShader.detach(),e.attach(),this.attachedShader=e)}}const ao={x:(e,t)=>{e.props.x=t},y:(e,t)=>{e.props.y=t},width:(e,t)=>{e.props.width=t},height:(e,t)=>{e.props.height=t},color:(e,t)=>{e.props.color=t},zIndex:(e,t)=>{e.props.zIndex=t},fontFamily:(e,t)=>{e.props.fontFamily=t},fontWeight:(e,t)=>{e.props.fontWeight=t},fontStyle:(e,t)=>{e.props.fontStyle=t},fontStretch:(e,t)=>{e.props.fontStretch=t},fontSize:(e,t)=>{e.props.fontSize=t},text:(e,t)=>{e.props.text=t},textAlign:(e,t)=>{e.props.textAlign=t},contain:(e,t)=>{e.props.contain=t},offsetY:(e,t)=>{e.props.offsetY=t},scrollable:(e,t)=>{e.props.scrollable=t},scrollY:(e,t)=>{e.props.scrollY=t},letterSpacing:(e,t)=>{e.props.letterSpacing=t},lineHeight:(e,t)=>{e.props.lineHeight=t},maxLines:(e,t)=>{e.props.maxLines=t},textBaseline:(e,t)=>{e.props.textBaseline=t},verticalAlign:(e,t)=>{e.props.verticalAlign=t},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t},debug:(e,t)=>{e.props.debug=t}};class lo{constructor(e){o(this,"stage",void 0),o(this,"set",void 0),this.stage=e;const r=t(t({},ao),this.getPropertySetters()),i={};Object.keys(r).forEach(e=>{Object.defineProperty(i,e,{value:(t,o)=>{t.props[e]!==o&&(r[e](t,o),this.stage.requestRender())},writable:!1,configurable:!1})}),this.set=i}setStatus(e,t,o){e.status!==t&&(e.status=t,e.emitter.emit(t,o))}setIsRenderable(e,t){e.isRenderable=t}destroyState(e){this.setStatus(e,"destroyed"),e.emitter.removeAllListeners()}scheduleUpdateState(e){e.updateScheduled||(e.updateScheduled=!0,queueMicrotask(()=>{"destroyed"!==e.status&&(e.updateScheduled=!1,this.updateState(e))}))}}class ho{constructor(){o(this,"data",{})}reset(){this.data={}}increment(e){this.data[e]||(this.data[e]=0),this.data[e]++}getData(){return t({},this.data)}}class co{constructor(e,t){o(this,"stage",void 0),o(this,"memUsed",0),o(this,"loadedTextures",[]),o(this,"criticalThreshold",void 0),o(this,"targetThreshold",void 0),o(this,"cleanupInterval",void 0),o(this,"debugLogging",void 0),o(this,"lastCleanupTime",0),o(this,"baselineMemoryAllocation",void 0),o(this,"hasWarnedAboveCritical",!1),o(this,"criticalCleanupRequested",!1),o(this,"doNotExceedCriticalThreshold",void 0),o(this,"frameTime",0),this.stage=e;const{criticalThreshold:r,doNotExceedCriticalThreshold:i}=t;this.doNotExceedCriticalThreshold=i||!1,this.criticalThreshold=Math.round(r);const n=Math.max(0,Math.min(1,t.targetThresholdLevel));if(this.cleanupInterval=t.cleanupInterval,this.debugLogging=t.debugLogging,this.baselineMemoryAllocation=Math.round(t.baselineMemoryAllocation),this.targetThreshold=Math.max(Math.round(r*n),this.baselineMemoryAllocation),this.memUsed=Math.round(t.baselineMemoryAllocation),t.debugLogging){let e=0;setInterval(()=>{e!==this.memUsed&&(e=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${Ue(this.memUsed)} mb / ${Ue(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}0===r&&(this.setTextureMemUse=()=>{})}setTextureMemUse(e,t){if(this.memUsed-=e.memUsed,0===t){const t=this.loadedTextures.indexOf(e);return-1!==t&&(this.loadedTextures[t]=null),void(e.memUsed=0)}if(e.memUsed=t,this.memUsed+=t,-1===this.loadedTextures.indexOf(e)){const t=this.loadedTextures.indexOf(null);-1!==t?this.loadedTextures[t]=e:this.loadedTextures.push(e)}this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}checkCriticalCleanup(){return this.memUsed>this.criticalThreshold}destroyTexture(e){!0===this.debugLogging&&console.log(`[TextureMemoryManager] Destroying texture. State: ${e.state}`);const t=this.loadedTextures.indexOf(e);-1!==t&&(this.loadedTextures[t]=null);this.stage.txManager.removeTextureFromCache(e),e.destroy(),this.memUsed-=e.memUsed,e.memUsed=0}cleanup(){const e=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,!0===e&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),!0===this.debugLogging&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${e}.`);const t=e?this.criticalThreshold:this.targetThreshold;let o=this.memUsed;for(let r=0;r<this.loadedTextures.length&&!(o<t);r++){const e=this.loadedTextures[r];if(!e)continue;if((e.type===fe.image||e.type===fe.noise||e.type===fe.renderToTexture)&&!0===e.canBeCleanedUp()){const t=e.memUsed;this.destroyTexture(e),o-=t}}this.memUsed>=this.criticalThreshold?(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.hasWarnedAboveCritical||!0!==this.debugLogging||(console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`),this.hasWarnedAboveCritical=!0)):(this.criticalCleanupRequested=!1,this.hasWarnedAboveCritical=!1)}getMemoryInfo(){let e=0,t=this.baselineMemoryAllocation;for(const r of this.loadedTextures)r&&r.renderable&&(e+=1,t+=r.memUsed);const o=this.loadedTextures.filter(e=>null!==e).length;return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:t,memUsed:this.memUsed,renderableTexturesLoaded:e,loadedTextures:o,baselineMemoryAllocation:this.baselineMemoryAllocation}}}class uo{constructor(e,t){o(this,"textureSource",void 0),o(this,"memManager",void 0),o(this,"state","freed"),this.memManager=e,this.textureSource=t}setTextureMemUse(e){this.memManager.setTextureMemUse(this.textureSource,e)}get renderable(){return this.textureSource.renderable}}class po{constructor(e){o(this,"options",void 0),o(this,"mode",void 0),o(this,"stage",void 0),o(this,"txManager",void 0),o(this,"txMemManager",void 0),o(this,"shManager",void 0),o(this,"rttNodes",[]),this.options=e,this.stage=e.stage,this.txManager=e.txManager,this.txMemManager=e.txMemManager,this.shManager=e.shManager}}class fo extends We{constructor(e,t,r){super(e,t),o(this,"textRenderer",void 0),o(this,"trState",void 0),o(this,"_textRendererOverride",null),o(this,"onTextLoaded",()=>{const{contain:e}=this,t=this.trState.props.width,o=this.trState.props.height,r=this.trState.textW||0,i=this.trState.textH||0;"both"===e?(this.props.width=t,this.props.height=o):"width"===e?(this.props.width=t,this.props.height=i):"none"===e&&(this.props.width=r,this.props.height=i),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})}),o(this,"onTextFailed",(e,t)=>{this.emit("failed",{type:"text",error:t})}),this._textRendererOverride=t.textRendererOverride,this.textRenderer=r;const i=this.createState({x:0,y:0,width:t.width,height:t.height,textAlign:t.textAlign,color:t.color,zIndex:t.zIndex,contain:t.contain,scrollable:t.scrollable,scrollY:t.scrollY,offsetY:t.offsetY,letterSpacing:t.letterSpacing,debug:t.debug,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStretch:t.fontStretch,fontStyle:t.fontStyle,fontWeight:t.fontWeight,text:t.text,lineHeight:t.lineHeight,maxLines:t.maxLines,textBaseline:t.textBaseline,verticalAlign:t.verticalAlign,overflowSuffix:t.overflowSuffix});this.trState=i}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),"none"===this.contain&&this.setUpdateType(ze.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),"both"!==this.contain&&this.setUpdateType(ze.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const t=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);t?(this.textRenderer=t,this.trState=this.createState(this.trState.props)):console.warn("Text Renderer not found for font",this.trState.props.fontFamily)}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,t){super.update(e,t),this.globalTransform,this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkBasicRenderability(){return 0!==this.worldAlpha&&!0!==this.isOutOfBounds()&&!(!this.trState||""===this.trState.props.text)}setRenderable(e){super.setRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var t;if(this.globalTransform,this.textRenderer.renderQuads){if(this.parentHasRenderTexture){if(!e.renderToTextureActive)return;if(this.parentRenderTexture!==e.activeRttNode)return}this.parentHasRenderTexture&&null!==(t=this.props.parent)&&void 0!==t&&t.rtt&&(this.globalTransform=ke.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),this.globalTransform,this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions)}else super.renderQuads(e)}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(e){const t=this.textRenderer.createState(e,this);return t.emitter.on("loaded",this.onTextLoaded),t.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(t),t}}class mo{constructor(e){o(this,"options",void 0),o(this,"animationManager",void 0),o(this,"txManager",void 0),o(this,"txMemManager",void 0),o(this,"fontManager",void 0),o(this,"textRenderers",void 0),o(this,"shManager",void 0),o(this,"renderer",void 0),o(this,"root",void 0),o(this,"interactiveNodes",new Set),o(this,"boundsMargin",void 0),o(this,"defShaderCtr",void 0),o(this,"strictBound",void 0),o(this,"preloadBound",void 0),o(this,"strictBounds",void 0),o(this,"defaultTexture",null),o(this,"targetFrameTime",0),o(this,"eventBus",void 0),o(this,"deltaTime",0),o(this,"lastFrameTime",0),o(this,"currentFrameTime",0),o(this,"fpsNumFrames",0),o(this,"fpsElapsedTime",0),o(this,"numQuadsRendered",0),o(this,"renderRequested",!1),o(this,"frameEventQueue",[]),o(this,"fontResolveMap",{}),o(this,"contextSpy",null),this.options=e;const{canvas:t,clearColor:r,appWidth:i,appHeight:n,boundsMargin:s,enableContextSpy:a,forceWebGL2:l,numImageWorkers:h,textureMemory:d,renderEngine:c,fontEngines:u,createImageBitmapSupport:p,maxRetryCount:f}=e;this.eventBus=e.eventBus,this.targetFrameTime=e.targetFPS>0?1e3/e.targetFPS:0,this.txManager=new Rt(this,{numImageWorkers:h,createImageBitmapSupport:p,maxRetryCount:f}),this.txManager.on("initialized",()=>{this.requestRender()}),this.txMemManager=new co(this,d),this.shManager=new so,this.animationManager=new Ge,this.contextSpy=a?new ho:null,this.strictBounds=e.strictBounds;let m=[0,0,0,0];s&&(m=Array.isArray(s)?s:[s,s,s,s]),this.boundsMargin=m,this.strictBound=we(0,0,i,n),this.preloadBound=Ce(this.strictBound,m);const g={stage:this,canvas:t,pixelRatio:e.devicePhysicalPixelRatio*e.deviceLogicalPixelRatio,clearColor:null!=r?r:4278190080,bufferMemory:2e6,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy,forceWebGL2:l};this.renderer=new c(g);const y=this.renderer.mode||"webgl";this.createDefaultTexture(),this.defShaderCtr=this.renderer.getDefShaderCtr(),he="webgl"===y,this.txManager.renderer=this.renderer,this.textRenderers={},u.forEach(e=>{const t=new e(this),o=t.type;"sdf"!==o||"canvas"!==y?t instanceof lo&&("canvas"===o?this.textRenderers.canvas=t:"sdf"===o&&(this.textRenderers.sdf=t)):console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...")}),0===Object.keys(this.textRenderers).length&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new Ct(this.textRenderers);const x=new We(this,{x:0,y:0,width:i,height:n,alpha:1,autosize:!1,boundsMargin:null,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1,strictBounds:this.strictBounds});this.root=x,(e=>{let t=!1,o=0;const r=(i=0)=>{const n=e.targetFrameTime;if(n>0&&i-o<n)setTimeout(()=>requestAnimationFrame(r),n-(i-o));else{if(o=i,e.updateFrameTime(),e.updateAnimations(),!e.hasSceneUpdates())return e.calculateFps(),n>0?setTimeout(()=>requestAnimationFrame(r),Math.max(n,16.666666666666668)):setTimeout(()=>requestAnimationFrame(r),16.666666666666668),t||(e.eventBus.emit("idle"),t=!0),!0===e.txMemManager.checkCleanup()&&e.txMemManager.cleanup(),void e.flushFrameEvents();if(t=!1,e.drawFrame(),e.flushFrameEvents(),n>0){const e=Math.max(0,n-(performance.now()-i));setTimeout(()=>requestAnimationFrame(r),e)}else requestAnimationFrame(r)}};requestAnimationFrame(r)})(this)}setClearColor(e){this.renderer.updateClearColor(e),this.renderRequested=!0}updateTargetFrameTime(){this.targetFrameTime=this.options.targetFPS>0?1e3/this.options.targetFPS:0}updateFrameTime(){const e=Xe();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=e,this.deltaTime=this.lastFrameTime?e-this.lastFrameTime:100/6,this.txManager.frameTime=e,this.txMemManager.frameTime=e,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}createDefaultTexture(){this.defaultTexture=this.txManager.createTexture("ColorTexture",{color:4294967295}),this.defaultTexture,this.txManager.loadTexture(this.defaultTexture,!0),this.defaultTexture.setRenderableOwner("stage",!0),this.defaultTexture.once("loaded",()=>{this.requestRender()})}updateAnimations(){const{animationManager:e}=this;this.root&&e.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested||this.txManager.hasUpdates()}drawFrame(){const{renderer:e,renderRequested:t}=this;0!==this.root.updateType&&this.root.update(this.deltaTime,this.root.clippingRect),this.txManager.processSome(this.options.textureProcessingTimeLimit).catch(e=>{console.error("Error processing textures:",e)}),e.reset(),e.rttNodes.length>0&&e.renderRTTNodes(),this.addQuads(this.root),null==e||e.render(),this.calculateFps(),this.calculateQuads(),t&&(this.renderRequested=!1),!0===this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup()}queueFrameEvent(e,t){this.frameEventQueue.push([e,t])}flushFrameEvents(){for(const[e,t]of this.frameEventQueue)this.eventBus.emit(e,t);this.frameEventQueue=[]}calculateFps(){const{fpsUpdateInterval:e}=this.options;if(e&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=e)){var t,o,r;const e=Math.round(1e3*this.fpsNumFrames/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:e,contextSpyData:null!==(t=null===(o=this.contextSpy)||void 0===o?void 0:o.getData())&&void 0!==t?t:null}),null===(r=this.contextSpy)||void 0===r||r.reset()}}calculateQuads(){const e=this.renderer.getQuadCount();e&&e!==this.numQuadsRendered&&(this.numQuadsRendered=e,this.queueFrameEvent("quadsUpdate",{quads:e}))}addQuads(e){this.renderer,!0===e.isRenderable&&e.renderQuads(this.renderer);for(let t=0;t<e.children.length;t++){const o=e.children[t];void 0!==o&&(0===o.worldAlpha||!0===o.strictBounds&&o.renderState===De.OutOfBounds||this.addQuads(o))}}requestRender(){this.renderRequested=!0}findNodesAtPoint(e){const t=e.x/this.options.deviceLogicalPixelRatio,o=e.y/this.options.deviceLogicalPixelRatio,r=[];for(const i of this.interactiveNodes)!1!==i.isRenderable&&!0===_e(t,o,i.renderBound)&&r.push(i);return r}getNodeFromPosition(e){const t=this.findNodesAtPoint(e);if(0===t.length)return null;let o=t[t.length-1];for(let r=0;r<t.length;r++)t[r].zIndex>o.zIndex&&(o=t[r]);return o||null}resolveTextRenderer(e,t=null){const o=`${e.fontFamily}${e.fontStyle}${e.fontWeight}${e.fontStretch}${t||""}`;if(void 0!==this.fontResolveMap[o])return this.fontResolveMap[o];let r=t,i=!1;if(r){const t=this.textRenderers[r];t?t.canRenderFont(e)||(console.warn(`Cannot use override text renderer '${r}' for font`,e),r=null,i=!0):(console.warn(`Text renderer override '${r}' not found.`),r=null,i=!0)}if(!r){for(const[t,o]of Object.entries(this.textRenderers))if(o.canRenderFont(e)){r=t;break}r||void 0===this.textRenderers.canvas||(r="canvas")}if(i&&console.warn(`Falling back to text renderer ${String(r)}`),!r)return null;const n=this.textRenderers[r];return this.fontResolveMap[o]=n,n}createShaderCtr(e,t){return this.shManager.loadShader(e,t)}createNode(e){const t=this.resolveNodeDefaults(e);return new We(this,t)}createTextNode(e){var o,r,i,n,s,a,l,h,d,c,u,p,f,m,g,y,x,v;const b=null!==(o=e.fontSize)&&void 0!==o?o:16,w=t(t({},this.resolveNodeDefaults(e)),{},{text:null!==(r=e.text)&&void 0!==r?r:"",textRendererOverride:null!==(i=e.textRendererOverride)&&void 0!==i?i:null,fontSize:b,fontFamily:null!==(n=e.fontFamily)&&void 0!==n?n:"sans-serif",fontStyle:null!==(s=e.fontStyle)&&void 0!==s?s:"normal",fontWeight:null!==(a=e.fontWeight)&&void 0!==a?a:"normal",fontStretch:null!==(l=e.fontStretch)&&void 0!==l?l:"normal",textAlign:null!==(h=e.textAlign)&&void 0!==h?h:"left",contain:null!==(d=e.contain)&&void 0!==d?d:"none",scrollable:null!==(c=e.scrollable)&&void 0!==c&&c,scrollY:null!==(u=e.scrollY)&&void 0!==u?u:0,offsetY:null!==(p=e.offsetY)&&void 0!==p?p:0,letterSpacing:null!==(f=e.letterSpacing)&&void 0!==f?f:0,lineHeight:e.lineHeight,maxLines:null!==(m=e.maxLines)&&void 0!==m?m:0,textBaseline:null!==(g=e.textBaseline)&&void 0!==g?g:"alphabetic",verticalAlign:null!==(y=e.verticalAlign)&&void 0!==y?y:"middle",overflowSuffix:null!==(x=e.overflowSuffix)&&void 0!==x?x:"...",debug:null!==(v=e.debug)&&void 0!==v?v:{},shaderProps:null}),T=this.resolveTextRenderer(w,e.textRendererOverride);if(!T)throw new Error(`No compatible text renderer found for ${w.fontFamily}`);return new fo(this,w,T)}setBoundsMargin(e){this.boundsMargin=Array.isArray(e)?e:[e,e,e,e],this.root.setUpdateType(ze.RenderBounds)}resolveNodeDefaults(e){var t,o,r,i,n,s,a,l,h,d,c,u,p,f,m,g,y,x,v,b,w,T,S,R,E,_,C,A,k,M,O,I,P,L,F,B,U,$,N,D,j,z,W,X,G,V,H,Y,q,K,Q,Z;const J=null!==(t=e.color)&&void 0!==t?t:4294967295,ee=null!==(o=null!==(r=null!==(i=e.colorTl)&&void 0!==i?i:e.colorTop)&&void 0!==r?r:e.colorLeft)&&void 0!==o?o:J,te=null!==(n=null!==(s=null!==(a=e.colorTr)&&void 0!==a?a:e.colorTop)&&void 0!==s?s:e.colorRight)&&void 0!==n?n:J,oe=null!==(l=null!==(h=null!==(d=e.colorBl)&&void 0!==d?d:e.colorBottom)&&void 0!==h?h:e.colorLeft)&&void 0!==l?l:J,re=null!==(c=null!==(u=null!==(p=e.colorBr)&&void 0!==p?p:e.colorBottom)&&void 0!==u?u:e.colorRight)&&void 0!==c?c:J;let ie={};var ne;!0===this.options.inspector&&(ie=function(e){const t={boolean:!0,string:!0,number:!0,undefined:!0},o=Object.keys(e);for(let r=0;r<o.length;r++){const i=o[r];if(!i)continue;const n=e[i],s=typeof n;"string"===s&&n.length>2048&&(console.warn(`Custom Data value for ${i} is too long, it will be truncated to 2048 characters`),e[i]=n.substring(0,2048)),t[s]||(console.warn(`Custom Data value for ${i} is not a boolean, string, or number, it will be ignored`),delete e[i])}return e}(null!==(ne=e.data)&&void 0!==ne?ne:{}));return{x:null!==(f=e.x)&&void 0!==f?f:0,y:null!==(m=e.y)&&void 0!==m?m:0,width:null!==(g=e.width)&&void 0!==g?g:0,height:null!==(y=e.height)&&void 0!==y?y:0,alpha:null!==(x=e.alpha)&&void 0!==x?x:1,autosize:null!==(v=e.autosize)&&void 0!==v&&v,boundsMargin:null!==(b=e.boundsMargin)&&void 0!==b?b:null,clipping:null!==(w=e.clipping)&&void 0!==w&&w,color:J,colorTop:null!==(T=e.colorTop)&&void 0!==T?T:J,colorBottom:null!==(S=e.colorBottom)&&void 0!==S?S:J,colorLeft:null!==(R=e.colorLeft)&&void 0!==R?R:J,colorRight:null!==(E=e.colorRight)&&void 0!==E?E:J,colorBl:oe,colorBr:re,colorTl:ee,colorTr:te,zIndex:null!==(_=e.zIndex)&&void 0!==_?_:0,zIndexLocked:null!==(C=e.zIndexLocked)&&void 0!==C?C:0,parent:null!==(A=e.parent)&&void 0!==A?A:null,texture:null!==(k=e.texture)&&void 0!==k?k:null,textureOptions:null!==(M=e.textureOptions)&&void 0!==M?M:{},shader:null!==(O=e.shader)&&void 0!==O?O:this.defShaderCtr,src:null!==(I=e.src)&&void 0!==I?I:null,srcHeight:e.srcHeight,srcWidth:e.srcWidth,srcX:e.srcX,srcY:e.srcY,scale:null!==(P=e.scale)&&void 0!==P?P:null,scaleX:null!==(L=null!==(F=e.scaleX)&&void 0!==F?F:e.scale)&&void 0!==L?L:1,scaleY:null!==(B=null!==(U=e.scaleY)&&void 0!==U?U:e.scale)&&void 0!==B?B:1,mount:null!==($=e.mount)&&void 0!==$?$:0,mountX:null!==(N=null!==(D=e.mountX)&&void 0!==D?D:e.mount)&&void 0!==N?N:0,mountY:null!==(j=null!==(z=e.mountY)&&void 0!==z?z:e.mount)&&void 0!==j?j:0,pivot:null!==(W=e.pivot)&&void 0!==W?W:.5,pivotX:null!==(X=null!==(G=e.pivotX)&&void 0!==G?G:e.pivot)&&void 0!==X?X:.5,pivotY:null!==(V=null!==(H=e.pivotY)&&void 0!==H?H:e.pivot)&&void 0!==V?V:.5,rotation:null!==(Y=e.rotation)&&void 0!==Y?Y:0,rtt:null!==(q=e.rtt)&&void 0!==q&&q,data:ie,preventCleanup:null!==(K=e.preventCleanup)&&void 0!==K&&K,imageType:e.imageType,interactive:null!==(Q=e.interactive)&&void 0!==Q&&Q,strictBounds:null!==(Z=e.strictBounds)&&void 0!==Z?Z:this.strictBounds}}cleanup(){this.txMemManager.cleanup()}}class go extends pe{constructor(e,t){var r,i,n,s,a,l,h,d,c,u,p,f,m;super(),o(this,"root",void 0),o(this,"canvas",void 0),o(this,"settings",void 0),o(this,"stage",void 0),o(this,"inspector",null);const g={criticalThreshold:(null===(r=e.textureMemory)||void 0===r?void 0:r.criticalThreshold)||124e6,targetThresholdLevel:(null===(i=e.textureMemory)||void 0===i?void 0:i.targetThresholdLevel)||.5,cleanupInterval:(null===(n=e.textureMemory)||void 0===n?void 0:n.cleanupInterval)||5e3,debugLogging:(null===(s=e.textureMemory)||void 0===s?void 0:s.debugLogging)||!1,baselineMemoryAllocation:(null===(a=e.textureMemory)||void 0===a?void 0:a.baselineMemoryAllocation)||26e6,doNotExceedCriticalThreshold:(null===(l=e.textureMemory)||void 0===l?void 0:l.doNotExceedCriticalThreshold)||!1},y={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:g,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:null!==(h=e.clearColor)&&void 0!==h?h:0,fpsUpdateInterval:e.fpsUpdateInterval||0,targetFPS:e.targetFPS||0,numImageWorkers:void 0!==e.numImageWorkers?e.numImageWorkers:2,enableContextSpy:null!==(d=e.enableContextSpy)&&void 0!==d&&d,forceWebGL2:null!==(c=e.forceWebGL2)&&void 0!==c&&c,inspector:null!==(u=e.inspector)&&void 0!==u&&u,renderEngine:e.renderEngine,quadBufferSize:null!==(p=e.quadBufferSize)&&void 0!==p?p:4194304,fontEngines:e.fontEngines,strictBounds:null===(f=e.strictBounds)||void 0===f||f,textureProcessingTimeLimit:e.textureProcessingTimeLimit||42,canvas:e.canvas||document.createElement("canvas"),createImageBitmapSupport:e.createImageBitmapSupport||"full",maxRetryCount:null!==(m=e.maxRetryCount)&&void 0!==m?m:5};this.settings=y;const{appWidth:x,appHeight:v,deviceLogicalPixelRatio:b,devicePhysicalPixelRatio:w,inspector:T,canvas:S}=y,R=x*b,E=v*b;let _;if(this.canvas=S,S.width=R*w,S.height=E*w,S.style.width=`${R}px`,S.style.height=`${E}px`,this.stage=new mo({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,forceWebGL2:this.settings.forceWebGL2,fpsUpdateInterval:this.settings.fpsUpdateInterval,targetFPS:this.settings.targetFPS,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:g,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines,inspector:null!==this.settings.inspector,strictBounds:this.settings.strictBounds,textureProcessingTimeLimit:this.settings.textureProcessingTimeLimit,createImageBitmapSupport:this.settings.createImageBitmapSupport,maxRetryCount:this.settings.maxRetryCount}),this.root=this.stage.root,_="string"==typeof t?document.getElementById(t):t,!_)throw new Error("Could not find target element");_.appendChild(S)}createNode(e){const t=this.stage.createNode(e);return this.inspector?this.inspector.createNode(t):t}createTextNode(e){const t=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(t):t}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,t){return this.stage.txManager.createTexture(e,t)}createShader(e,t){return this.stage.shManager.loadShader(e,t)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,t,o){return{name:o,type:e,props:t}}getNodeById(e){var t;const o=null===(t=this.stage)||void 0===t?void 0:t.root;if(!o)return null;const r=t=>{if(t.id===e)return t;for(const e of t.children){const t=r(e);if(t)return t}return null};return r(o)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){this.stage.requestRender()}cleanup(){this.stage.cleanup()}setClearColor(e){this.stage.setClearColor(e)}get targetFPS(){return this.stage.options.targetFPS}set targetFPS(e){this.stage.options.targetFPS=e>0?e:0,this.stage.updateTargetFrameTime()}}class yo extends pe{constructor(e){super(),o(this,"fontFamily",void 0),o(this,"descriptors",void 0),o(this,"loaded",!1),o(this,"metrics",null);const{fontFamily:r,descriptors:i,metrics:n}=e;n&&(this.metrics={ascender:n.ascender/n.unitsPerEm,descender:n.descender/n.unitsPerEm,lineGap:n.lineGap/n.unitsPerEm}),this.fontFamily=r,this.descriptors=t({style:"normal",weight:"normal",stretch:"normal"},i)}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:"number"==typeof e.weight?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}class xo extends yo{constructor(e){super(e),o(this,"fontFace",void 0),o(this,"fontUrl",void 0);const{fontFamily:t,fontUrl:r}=e,i=r.replace(/\(|\)/g,""),n=this.descriptors;let s={style:n.style,weight:"number"==typeof n.weight?`${n.weight}`:n.weight,stretch:n.stretch,unicodeRange:n.unicodeRange,featureSettings:n.featureSettings,display:n.display};for(const o in s){const e=o;void 0===s[e]&&delete s[e]}const a=new FontFace(t,`url(${i})`,s);i.length>0?a.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=a,this.fontUrl=r}}class vo{}class bo extends vo{constructor(e,t,r,i,n,s,a,l,h,d,c,u,p){super(),o(this,"glw",void 0),o(this,"options",void 0),o(this,"buffers",void 0),o(this,"shader",void 0),o(this,"shaderProps",void 0),o(this,"alpha",void 0),o(this,"clippingRect",void 0),o(this,"dimensions",void 0),o(this,"bufferIdx",void 0),o(this,"zIndex",void 0),o(this,"renderToTexture",void 0),o(this,"parentHasRenderTexture",void 0),o(this,"framebufferDimensions",void 0),o(this,"length",0),o(this,"numQuads",0),o(this,"textures",[]),o(this,"maxTextures",void 0),this.glw=e,this.options=t,this.buffers=r,this.shader=i,this.shaderProps=n,this.alpha=s,this.clippingRect=a,this.dimensions=l,this.bufferIdx=h,this.zIndex=d,this.renderToTexture=c,this.parentHasRenderTexture=u,this.framebufferDimensions=p,this.maxTextures=i.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:t,maxTextures:o}=this;let r=-1;const i=t.length;for(let n=0;n<i;n++){if(t[n]===e){r=n;break}}return-1!==r?r:i>=o?4294967295:(this.textures.push(e),i)}draw(){const{glw:e,shader:t,shaderProps:o,options:r}=this,{shManager:i}=r;i.useShader(t),t.bindRenderOp(this,o);const n=this.bufferIdx/32*6*2;if(this.clippingRect.valid){const{x:t,y:o,width:i,height:n}=this.clippingRect,s=this.parentHasRenderTexture?1:r.pixelRatio,a=r.canvas.height,l=Math.round(t*s),h=Math.round(i*s),d=Math.round(n*s);let c=Math.round(a-d-o*s);this.parentHasRenderTexture&&(c=this.framebufferDimensions?this.framebufferDimensions.height-this.dimensions.height:0),e.setScissorTest(!0),e.scissor(l,c,h,d)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,n)}}function wo(e){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(o=>{t[o]=e.getParameter(e[o])}),t}function To(e){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(o=>{t[o]=e.getExtension(o)}),t}const So=new Uint8Array([0,0,0,0]);class Ro extends uo{constructor(e,t,r){super(t,r),o(this,"glw",void 0),o(this,"_nativeCtxTexture",null),o(this,"_w",0),o(this,"_h",0),o(this,"txCoordX1",0),o(this,"txCoordY1",0),o(this,"txCoordX2",1),o(this,"txCoordY2",1),this.glw=e}checkGLError(){if("failed"===this.state)return!0;const e=this.glw.getError();return 0!==e&&(this.state="failed",this.textureSource.setState("failed",new Error(`WebGL Error: ${e}`)),!0)}get ctxTexture(){return"freed"===this.state?(this.load(),null):(this._nativeCtxTexture,this._nativeCtxTexture)}get w(){return this._w}get h(){return this._h}async load(){if("loading"===this.state||"loaded"===this.state)return Promise.resolve();if(this.state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),null===this._nativeCtxTexture)return this.state="failed",void this.textureSource.setState("failed",new Error("WebGL Texture creation failed"));try{const{width:e,height:t}=await this.onLoadRequest();if("freed"===this.state)return;this.state="loaded",this._w=e,this._h=t,this.textureSource.setState("loaded",{width:e,height:t}),this.textureSource.freeTextureData()}catch(e){if("freed"===this.state)return;this.state="failed",this.textureSource.setState("failed")}}async onLoadRequest(){const{glw:e}=this,t=this.textureSource.textureData;if("failed"===this.state)return{width:0,height:0};if(null===t||null===this._nativeCtxTexture)return this.state="failed",this.textureSource.setState("failed",new Error("No texture data available")),{width:0,height:0};e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(So.byteLength);let o=0,r=0;if(e.activeTexture(0),!0===this.checkGLError())return{width:0,height:0};const i=t.data,n=e.RGBA;if("undefined"!=typeof ImageBitmap&&i instanceof ImageBitmap||i instanceof ImageData||null!==(l=i)&&("object"==typeof l&&l.constructor&&"HTMLImageElement"===l.constructor.name||"undefined"!=typeof HTMLImageElement&&l instanceof HTMLImageElement)){if(o=i.width,r=i.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!t.premultiplyAlpha),e.texImage2D(0,n,n,e.UNSIGNED_BYTE,i),!0===this.checkGLError())return{width:0,height:0};this.setTextureMemUse(r*o*4*1.1)}else if(i&&"mipmaps"in i&&i.mipmaps){var s,a;const{mipmaps:t,type:n,blockInfo:l}=i;if(pt[n](e,this._nativeCtxTexture,i),!0===this.checkGLError())return{width:0,height:0};o=i.width,r=i.height,this.txCoordX2=o/(Math.ceil(o/l.width)*l.width),this.txCoordY2=r/(Math.ceil(r/l.height)*l.height),this.setTextureMemUse(null!==(s=null===(a=t[0])||void 0===a?void 0:a.byteLength)&&void 0!==s?s:0)}else{if(!(i&&i instanceof Uint8Array))return console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",t),this.state="failed",this.textureSource.setState("failed",new Error("Unexpected texture data")),{width:0,height:0};if(o=1,r=1,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!t.premultiplyAlpha),e.texImage2D(0,n,o,r,0,n,e.UNSIGNED_BYTE,i),!0===this.checkGLError())return{width:0,height:0};this.setTextureMemUse(o*r*4)}var l;return{width:o,height:r}}free(){"freed"!==this.state&&(this.state="freed",this.textureSource.setState("freed"),this.release())}release(){this._w=0,this._h=0,null!==this._nativeCtxTexture&&(this.glw.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null),this.textureSource.freeTextureData()}createNativeCtxTexture(){const{glw:e}=this,t=e.createTexture();if(!t)return null;e.activeTexture(0),e.bindTexture(t),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);return 0!==e.getError()?null:t}}class Eo extends Ro{constructor(e,t,o){super(e,t,o)}async onLoadRequest(){var e,t;const o=this.textureSource.textureData;return o.data instanceof Uint8Array?{width:1,height:1}:{width:(null===(e=o.data)||void 0===e?void 0:e.width)||0,height:(null===(t=o.data)||void 0===t?void 0:t.height)||0}}}class _o{constructor(e){o(this,"config",void 0),this.config=e}getBuffer(e){var t;return null===(t=this.config.find(t=>t.attributes[e]))||void 0===t?void 0:t.buffer}getAttributeInfo(e){var t;return null===(t=this.config.find(t=>t.attributes[e]))||void 0===t?void 0:t.attributes[e]}}class Co{constructor(e){o(this,"gl",void 0),o(this,"activeTextureUnit",0),o(this,"texture2dUnits",void 0),o(this,"texture2dParams",new WeakMap),o(this,"scissorEnabled",void 0),o(this,"scissorX",void 0),o(this,"scissorY",void 0),o(this,"scissorWidth",void 0),o(this,"scissorHeight",void 0),o(this,"blendEnabled",void 0),o(this,"blendSrcRgb",void 0),o(this,"blendDstRgb",void 0),o(this,"blendSrcAlpha",void 0),o(this,"blendDstAlpha",void 0),o(this,"boundArrayBuffer",void 0),o(this,"boundElementArrayBuffer",void 0),o(this,"curProgram",void 0),o(this,"canvas",void 0),o(this,"MAX_RENDERBUFFER_SIZE",void 0),o(this,"MAX_TEXTURE_SIZE",void 0),o(this,"MAX_VIEWPORT_DIMS",void 0),o(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS",void 0),o(this,"MAX_TEXTURE_IMAGE_UNITS",void 0),o(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS",void 0),o(this,"MAX_VERTEX_ATTRIBS",void 0),o(this,"MAX_VARYING_VECTORS",void 0),o(this,"MAX_VERTEX_UNIFORM_VECTORS",void 0),o(this,"MAX_FRAGMENT_UNIFORM_VECTORS",void 0),o(this,"TEXTURE_MAG_FILTER",void 0),o(this,"TEXTURE_MIN_FILTER",void 0),o(this,"TEXTURE_WRAP_S",void 0),o(this,"TEXTURE_WRAP_T",void 0),o(this,"LINEAR",void 0),o(this,"LINEAR_MIPMAP_LINEAR",void 0),o(this,"CLAMP_TO_EDGE",void 0),o(this,"RGB",void 0),o(this,"RGBA",void 0),o(this,"UNSIGNED_BYTE",void 0),o(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL",void 0),o(this,"UNPACK_FLIP_Y_WEBGL",void 0),o(this,"FLOAT",void 0),o(this,"TRIANGLES",void 0),o(this,"UNSIGNED_SHORT",void 0),o(this,"ONE",void 0),o(this,"ONE_MINUS_SRC_ALPHA",void 0),o(this,"VERTEX_SHADER",void 0),o(this,"FRAGMENT_SHADER",void 0),o(this,"STATIC_DRAW",void 0),o(this,"COMPILE_STATUS",void 0),o(this,"LINK_STATUS",void 0),o(this,"DYNAMIC_DRAW",void 0),o(this,"COLOR_ATTACHMENT0",void 0),o(this,"INVALID_ENUM",void 0),o(this,"INVALID_OPERATION",void 0),this.gl=e,this.activeTextureUnit=e.getParameter(e.ACTIVE_TEXTURE)-e.TEXTURE0;const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(t).fill(void 0).map((t,o)=>(this.activeTexture(o),e.getParameter(e.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=e.isEnabled(e.SCISSOR_TEST);const r=e.getParameter(e.SCISSOR_BOX);this.scissorX=r[0],this.scissorY=r[1],this.scissorWidth=r[2],this.scissorHeight=r[3],this.blendEnabled=e.isEnabled(e.BLEND),this.blendSrcRgb=e.getParameter(e.BLEND_SRC_RGB),this.blendDstRgb=e.getParameter(e.BLEND_DST_RGB),this.blendSrcAlpha=e.getParameter(e.BLEND_SRC_ALPHA),this.blendDstAlpha=e.getParameter(e.BLEND_DST_ALPHA),this.boundArrayBuffer=e.getParameter(e.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=e.getParameter(e.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=e.getParameter(e.CURRENT_PROGRAM),this.canvas=e.canvas,this.MAX_RENDERBUFFER_SIZE=e.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=e.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=e.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=e.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=e.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=e.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=e.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=e.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=e.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=e.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=e.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=e.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=e.TEXTURE_WRAP_T,this.LINEAR=e.LINEAR,this.LINEAR_MIPMAP_LINEAR=e.LINEAR_MIPMAP_LINEAR,this.CLAMP_TO_EDGE=e.CLAMP_TO_EDGE,this.RGB=e.RGB,this.RGBA=e.RGBA,this.UNSIGNED_BYTE=e.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=e.UNPACK_FLIP_Y_WEBGL,this.FLOAT=e.FLOAT,this.TRIANGLES=e.TRIANGLES,this.UNSIGNED_SHORT=e.UNSIGNED_SHORT,this.ONE=e.ONE,this.ONE_MINUS_SRC_ALPHA=e.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=e.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=e.TRIANGLES,this.UNSIGNED_SHORT=e.UNSIGNED_SHORT,this.VERTEX_SHADER=e.VERTEX_SHADER,this.FRAGMENT_SHADER=e.FRAGMENT_SHADER,this.STATIC_DRAW=e.STATIC_DRAW,this.COMPILE_STATUS=e.COMPILE_STATUS,this.LINK_STATUS=e.LINK_STATUS,this.DYNAMIC_DRAW=e.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=e.COLOR_ATTACHMENT0,this.INVALID_ENUM=e.INVALID_ENUM,this.INVALID_OPERATION=e.INVALID_OPERATION}isWebGl2(){return e=this.gl,self.WebGL2RenderingContext&&e instanceof self.WebGL2RenderingContext;var e}activeTexture(e){const{gl:t}=this;this.activeTextureUnit!==e&&(t.activeTexture(e+t.TEXTURE0),this.activeTextureUnit=e)}bindTexture(e){const{gl:t,activeTextureUnit:o,texture2dUnits:r}=this;r[o]!==e&&(r[o]=e,t.bindTexture(this.gl.TEXTURE_2D,e))}_getActiveTexture(){const{activeTextureUnit:e,texture2dUnits:t}=this;return t[e]}texParameteri(e,t){const{gl:o,texture2dParams:r}=this,i=this._getActiveTexture();if(!i)throw new Error("No active texture");let n=r.get(i);n||(n={},r.set(i,n)),n[e]!==t&&(n[e]=t,o.texParameteri(o.TEXTURE_2D,e,t))}texImage2D(e,t,o,r,i,n,s,a){const{gl:l}=this;n?l.texImage2D(l.TEXTURE_2D,e,t,o,r,i,n,s,a):l.texImage2D(l.TEXTURE_2D,e,t,o,r,i)}compressedTexImage2D(e,t,o,r,i,n){const{gl:s}=this;s.compressedTexImage2D(s.TEXTURE_2D,e,t,o,r,i,n)}pixelStorei(e,t){const{gl:o}=this;o.pixelStorei(e,t)}generateMipmap(){const{gl:e}=this;e.generateMipmap(e.TEXTURE_2D)}createTexture(){const{gl:e}=this;return e.createTexture()}deleteTexture(e){const{gl:t}=this;e&&this.texture2dParams.delete(e),t.deleteTexture(e)}deleteFramebuffer(e){this.gl.deleteFramebuffer(e)}viewport(e,t,o,r){const{gl:i}=this;i.viewport(e,t,o,r)}clearColor(e,t,o,r){const{gl:i}=this;i.clearColor(e,t,o,r)}setScissorTest(e){const{gl:t,scissorEnabled:o}=this;e!==o&&(e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST),this.scissorEnabled=e)}scissor(e,t,o,r){const{gl:i,scissorX:n,scissorY:s,scissorWidth:a,scissorHeight:l}=this;e===n&&t===s&&o===a&&r===l||(i.scissor(e,t,o,r),this.scissorX=e,this.scissorY=t,this.scissorWidth=o,this.scissorHeight=r)}setBlend(e){const{gl:t,blendEnabled:o}=this;e!==o&&(e?t.enable(t.BLEND):t.disable(t.BLEND),this.blendEnabled=e)}blendFunc(e,t){const{gl:o,blendSrcRgb:r,blendDstRgb:i,blendSrcAlpha:n,blendDstAlpha:s}=this;e===r&&t===i&&e===n&&t===s||(o.blendFunc(e,t),this.blendSrcRgb=e,this.blendDstRgb=t,this.blendSrcAlpha=e,this.blendDstAlpha=t)}createBuffer(){const{gl:e}=this;return e.createBuffer()}createFramebuffer(){const{gl:e}=this;return e.createFramebuffer()}bindFramebuffer(e){const{gl:t}=this;t.bindFramebuffer(t.FRAMEBUFFER,e)}framebufferTexture2D(e,t,o){const{gl:r}=this;r.framebufferTexture2D(r.FRAMEBUFFER,e,r.TEXTURE_2D,t,o)}clear(){const{gl:e}=this;e.clear(e.COLOR_BUFFER_BIT)}arrayBufferData(e,t,o){const{gl:r,boundArrayBuffer:i}=this;i!==e&&(r.bindBuffer(r.ARRAY_BUFFER,e),this.boundArrayBuffer=e),r.bufferData(r.ARRAY_BUFFER,t,o)}elementArrayBufferData(e,t,o){const{gl:r,boundElementArrayBuffer:i}=this;i!==e&&(r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.boundElementArrayBuffer=e),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,o)}vertexAttribPointer(e,t,o,r,i,n,s){const{gl:a,boundArrayBuffer:l}=this;l!==e&&(a.bindBuffer(a.ARRAY_BUFFER,e),this.boundArrayBuffer=e),a.vertexAttribPointer(t,o,r,i,n,s)}getUniformLocations(e){const t=this.gl,o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r={};for(let i=0;i<o;i++){let o=t.getActiveUniform(e,i).name.replace(/\[.*?\]/g,"");r[o]=t.getUniformLocation(e,o)}return r}getAttributeLocations(e){const t=this.gl,o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=[];for(let i=0;i<o;i++){const{name:o}=t.getActiveAttrib(e,i);r[t.getAttribLocation(e,o)]=o}return r}useProgram(e){const{gl:t,curProgram:o}=this;o!==e&&(t.useProgram(e),this.curProgram=e)}uniform1f(e,t){const{gl:o}=this;o.uniform1f(e,t)}uniform1fv(e,t){const{gl:o}=this;o.uniform1fv(e,t)}uniform1i(e,t){const{gl:o}=this;o.uniform1i(e,t)}uniform1iv(e,t){const{gl:o}=this;o.uniform1iv(e,t)}uniform2f(e,t,o){const{gl:r}=this;r.uniform2f(e,t,o)}uniform2fv(e,t){const{gl:o}=this;o.uniform2fv(e,t)}uniform2i(e,t,o){const{gl:r}=this;r.uniform2i(e,t,o)}uniform2iv(e,t){const{gl:o}=this;o.uniform2iv(e,t)}uniform3f(e,t,o,r){const{gl:i}=this;i.uniform3f(e,t,o,r)}uniform3fv(e,t){const{gl:o}=this;o.uniform3fv(e,t)}uniform3i(e,t,o,r){const{gl:i}=this;i.uniform3i(e,t,o,r)}uniform3iv(e,t){const{gl:o}=this;o.uniform3iv(e,t)}uniform4f(e,t,o,r,i){const{gl:n}=this;n.uniform4f(e,t,o,r,i)}uniform4fv(e,t){const{gl:o}=this;o.uniform4fv(e,t)}uniform4i(e,t,o,r,i){const{gl:n}=this;n.uniform4i(e,t,o,r,i)}uniform4iv(e,t){const{gl:o}=this;o.uniform4iv(e,t)}uniformMatrix2fv(e,t){const{gl:o}=this;o.uniformMatrix2fv(e,!1,t)}uniformMatrix3fv(e,t){const{gl:o}=this;o.uniformMatrix3fv(e,!1,t)}uniformMatrix4fv(e,t){const{gl:o}=this;o.uniformMatrix4fv(e,!1,t)}getParameter(e){const{gl:t}=this;return t.getParameter(e)}drawElements(e,t,o,r){const{gl:i}=this;i.drawElements(e,t,o,r)}getExtension(e){const{gl:t}=this;return t.getExtension(e)}getError(){const{gl:e}=this;return e.getError()}createVertexArray(){const{gl:e}=this;return e.createVertexArray()}bindVertexArray(e){const{gl:t}=this;t.bindVertexArray(e)}getAttribLocation(e,t){const{gl:o}=this;return o.getAttribLocation(e,t)}getUniformLocation(e,t){const{gl:o}=this;return o.getUniformLocation(e,t)}enableVertexAttribArray(e){const{gl:t}=this;t.enableVertexAttribArray(e)}disableVertexAttribArray(e){const{gl:t}=this;t.disableVertexAttribArray(e)}createShader(e){const{gl:t}=this;return t.createShader(e)}compileShader(e){const{gl:t}=this;t.compileShader(e)}attachShader(e,t){const{gl:o}=this;o.attachShader(e,t)}linkProgram(e){const{gl:t}=this;t.linkProgram(e)}deleteProgram(e){const{gl:t}=this;t.deleteProgram(e)}getShaderParameter(e,t){const{gl:o}=this;return o.getShaderParameter(e,t)}getShaderInfoLog(e){const{gl:t}=this;return t.getShaderInfoLog(e)}createProgram(){const{gl:e}=this;return e.createProgram()}getProgramParameter(e,t){const{gl:o}=this;return o.getProgramParameter(e,t)}getProgramInfoLog(e){const{gl:t}=this;return t.getProgramInfoLog(e)}shaderSource(e,t){const{gl:o}=this;o.shaderSource(e,t)}deleteShader(e){const{gl:t}=this;t.deleteShader(e)}checkError(e){const t=this.getError();if(0!==t){let o="UNKNOWN_ERROR";switch(t){case this.INVALID_ENUM:o="INVALID_ENUM";break;case 1281:o="INVALID_VALUE";break;case this.INVALID_OPERATION:o="INVALID_OPERATION";break;case 1285:o="OUT_OF_MEMORY";break;case 37442:o="CONTEXT_LOST_WEBGL"}const r=`WebGL ${o} (0x${t.toString(16)}) during ${e}`;return{error:t,errorName:o,message:r}}return null}}class Ao extends Ro{constructor(e,t,r){super(e,t,r),o(this,"framebuffer",null)}async onLoadRequest(){const{glw:e}=this,t=this._nativeCtxTexture=this.createNativeCtxTexture();if(!t)throw new Error("Failed to create native texture for RenderTexture");const{width:o,height:r}=this.textureSource;return this.framebuffer=e.createFramebuffer(),e.texImage2D(0,e.RGBA,o,r,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(o*r*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,t,0),e.bindFramebuffer(null),{width:o,height:r}}free(){super.free(),this.glw.deleteFramebuffer(this.framebuffer),this.framebuffer=null}}class ko extends po{constructor(e){super(e),o(this,"glw",void 0),o(this,"system",void 0),o(this,"quadBuffer",void 0),o(this,"fQuadBuffer",void 0),o(this,"uiQuadBuffer",void 0),o(this,"renderOps",[]),o(this,"curBufferIdx",0),o(this,"curRenderOp",null),o(this,"rttNodes",[]),o(this,"activeRttNode",null),o(this,"defShaderCtrl",void 0),o(this,"defaultShader",void 0),o(this,"quadBufferCollection",void 0),o(this,"clearColor",{raw:0,normalized:[0,0,0,0]}),o(this,"quadBufferUsage",0),o(this,"numQuadsRendered",0),o(this,"renderToTextureActive",!1),this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:t,clearColor:r,bufferMemory:i}=e,n=function(e,t=!1,o){const r={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},i=e.getContext(t?"webgl2":"webgl",r)||e.getContext("experimental-webgl",r);if(!i)throw new Error("Unable to create WebGL context");return o?new Proxy(i,{get(e,t){const r=e[t];return"function"==typeof r?(o.increment(String(t)),r.bind(e)):r}}):i}(t,e.forceWebGL2,e.contextSpy),s=this.glw=new Co(n);s.viewport(0,0,t.width,t.height),this.updateClearColor(r),s.setBlend(!0),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),function(e,t){const o=~~(t/80),r=new Uint16Array(6*o);for(let n=0,s=0;n<o;n+=6,s+=4)r[n]=s,r[n+1]=s+1,r[n+2]=s+2,r[n+3]=s+2,r[n+4]=s+1,r[n+5]=s+3;const i=e.createBuffer();e.elementArrayBufferData(i,r,e.STATIC_DRAW)}(s,i),this.system={parameters:wo(this.glw),extensions:To(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const a=s.createBuffer(),l=8*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new _o([{buffer:a,attributes:{a_position:{name:"a_position",size:2,type:s.FLOAT,normalized:!1,stride:l,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:s.FLOAT,normalized:!1,stride:l,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:s.UNSIGNED_BYTE,normalized:!0,stride:l,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:s.FLOAT,normalized:!1,stride:l,offset:5*Float32Array.BYTES_PER_ELEMENT},a_nodeCoordinate:{name:"a_nodeCoordinate",size:2,type:s.FLOAT,normalized:!1,stride:l,offset:6*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof vt?new Eo(this.glw,this.txMemManager,e):e instanceof bt?new Ao(this.glw,this.txMemManager,e):new Ro(this.glw,this.txMemManager,e)}addQuad(e){const{fQuadBuffer:t,uiQuadBuffer:o}=this;let r=e.texture;if(e.shader!==this.defaultShader){if(1==ce(e.shaderProps,"$dimensions")){const t=e.shaderProps.$dimensions;t.width=e.width,t.height=e.height}!0===ce(e.shaderProps,"$alpha")&&(e.shaderProps.$alpha=e.alpha)}let{curBufferIdx:i,curRenderOp:n}=this;const s={width:e.width,height:e.height};let a;!1===this.reuseRenderOp(e)&&(this.newRenderOp(e.shader,e.shaderProps,e.alpha,s,e.clippingRect,i,e.rtt,e.parentHasRenderTexture,e.framebufferDimensions),n=this.curRenderOp);let l=0,h=0,d=1,c=1;if(r.type===fe.subTexture){const{x:e,y:t,width:o,height:i}=r.props,{width:n=0,height:s=0}=r.parentTexture.dimensions||{width:0,height:0};l=e/n,d=l+o/n,h=t/s,c=h+i/s,r=r.parentTexture,a=r.ctxTexture}else{var u;if(a=r.ctxTexture,void 0===a)a=null===(u=this.stage.defaultTexture)||void 0===u?void 0:u.ctxTexture,console.warn("WebGL Renderer: Texture does not have a ctxTexture, using default texture instead");l=a.txCoordX1,h=a.txCoordY1,d=a.txCoordX2,c=a.txCoordY2}if(r.type===fe.image&&null!==e.textureOptions&&void 0!==e.textureOptions.resizeMode&&null!==r.dimensions){const t=e.textureOptions.resizeMode,{width:o,height:i}=r.dimensions;if("cover"===t.type){const r=e.width/o,n=e.height/i,s=Math.max(r,n),a=1/s;if(s&&r&&r<s){var p;const r=a*e.width;l=(1-r/o)*(null!==(p=t.clipX)&&void 0!==p?p:.5),d=l+r/o}if(s&&n&&n<s){var f;const o=a*e.height;h=(1-o/i)*(null!==(f=t.clipY)&&void 0!==f?f:.5),c=h+o/i}}}let m=0;null!==e.textureOptions&&(!0===e.textureOptions.flipX&&([l,d]=[d,l]),m=+(e.textureOptions.flipY||!1)),m^+(r.type===fe.renderToTexture)&&([h,c]=[c,h]);const g=this.addTexture(a,i);if(this.curRenderOp,e.renderCoords)t[i++]=e.renderCoords.x1,t[i++]=e.renderCoords.y1,t[i++]=l,t[i++]=h,o[i++]=e.colorTl,t[i++]=g,t[i++]=0,t[i++]=0,t[i++]=e.renderCoords.x2,t[i++]=e.renderCoords.y2,t[i++]=d,t[i++]=h,o[i++]=e.colorTr,t[i++]=g,t[i++]=1,t[i++]=0,t[i++]=e.renderCoords.x4,t[i++]=e.renderCoords.y4,t[i++]=l,t[i++]=c,o[i++]=e.colorBl,t[i++]=g,t[i++]=0,t[i++]=1,t[i++]=e.renderCoords.x3,t[i++]=e.renderCoords.y3,t[i++]=d,t[i++]=c,o[i++]=e.colorBr,t[i++]=g,t[i++]=1,t[i++]=1;else if(0!==e.tb||0!==e.tc)t[i++]=e.tx,t[i++]=e.ty,t[i++]=l,t[i++]=h,o[i++]=e.colorTl,t[i++]=g,t[i++]=0,t[i++]=0,t[i++]=e.tx+e.width*e.ta,t[i++]=e.ty+e.width*e.tc,t[i++]=d,t[i++]=h,o[i++]=e.colorTr,t[i++]=g,t[i++]=1,t[i++]=0,t[i++]=e.tx+e.height*e.tb,t[i++]=e.ty+e.height*e.td,t[i++]=l,t[i++]=c,o[i++]=e.colorBl,t[i++]=g,t[i++]=0,t[i++]=1,t[i++]=e.tx+e.width*e.ta+e.height*e.tb,t[i++]=e.ty+e.width*e.tc+e.height*e.td,t[i++]=d,t[i++]=c,o[i++]=e.colorBr,t[i++]=g,t[i++]=1,t[i++]=1;else{const r=e.tx+e.width*e.ta,n=e.ty+e.height*e.td;t[i++]=e.tx,t[i++]=e.ty,t[i++]=l,t[i++]=h,o[i++]=e.colorTl,t[i++]=g,t[i++]=0,t[i++]=0,t[i++]=r,t[i++]=e.ty,t[i++]=d,t[i++]=h,o[i++]=e.colorTr,t[i++]=g,t[i++]=1,t[i++]=0,t[i++]=e.tx,t[i++]=n,t[i++]=l,t[i++]=c,o[i++]=e.colorBl,t[i++]=g,t[i++]=0,t[i++]=1,t[i++]=r,t[i++]=n,t[i++]=d,t[i++]=c,o[i++]=e.colorBr,t[i++]=g,t[i++]=1,t[i++]=1}this.curRenderOp.numQuads++,this.curBufferIdx=i}newRenderOp(e,t,o,r,i,n,s,a,l){const h=new bo(this.glw,this.options,this.quadBufferCollection,e,t,o,i,r,n,0,s,a,l);this.curRenderOp=h,this.renderOps.push(h)}addTexture(e,t,o){const{curRenderOp:r}=this,i=r.addTexture(e);if(4294967295===i){if(o)throw new Error("Unable to add texture to render op");return this.newRenderOp(r.shader,r.shaderProps,r.alpha,r.dimensions,r.clippingRect,t),this.addTexture(e,t,!0)}return i}reuseRenderOp(e){var t;const{shader:o,shaderProps:r,parentHasRenderTexture:i,rtt:n,clippingRect:s}=e;return(null===(t=this.curRenderOp)||void 0===t?void 0:t.shader)===o&&(!1!=((a=this.curRenderOp.clippingRect)===(l=s)||null!==a&&null!==l&&a.x===l.x&&a.y===l.y&&a.width===l.width&&a.height===l.height)&&(!0!==i&&!0!==n&&(this.curRenderOp.shader===this.defaultShader||!1!==this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,r))));var a,l}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){const{glw:t,quadBuffer:o}=this,r=new Float32Array(o,0,this.curBufferIdx),i=this.quadBufferCollection.getBuffer("a_position")||null;t.arrayBufferData(i,r,t.STATIC_DRAW);for(let s=0,a=this.renderOps.length;s<a;s++)this.renderOps[s].draw();this.quadBufferUsage=this.curBufferIdx*r.BYTES_PER_ELEMENT;const n=8*r.BYTES_PER_ELEMENT*4;this.numQuadsRendered=this.quadBufferUsage/n}getQuadCount(){return this.numQuadsRendered}renderToTexture(e){for(let t=0;t<this.rttNodes.length;t++)if(this.rttNodes[t]===e)return;this.insertRTTNodeInOrder(e)}insertRTTNodeInOrder(e){let t=this.rttNodes.length,o=e;for(;o&&o.parent;){const e=this.rttNodes.indexOf(o.parent);if(-1!==e){t=e;break}o=o.parent}const r=this.findMaxChildRTTIndex(e);-1!==r&&(t=Math.max(t,r+1)),this.rttNodes.splice(t,0,e)}findMaxChildRTTIndex(e){let t=-1;const o=e=>{const r=this.rttNodes.indexOf(e);-1!==r&&(t=Math.max(t,r));for(const t of e.children)o(t)};return o(e),t}renderRTTNodes(){const{glw:e}=this,{txManager:t}=this.stage;for(let r=0;r<this.rttNodes.length;r++){const t=this.rttNodes[r];if(void 0===t||!1===t.hasRTTupdates)continue;if(0===t.worldAlpha||!0===t.strictBounds&&t.renderState===De.OutOfBounds)continue;if(null===t.texture||"loaded"!==t.texture.state)continue;this.activeRttNode=t,se(t.texture);const o=t.texture.ctxTexture;this.renderToTextureActive=!0,e.bindFramebuffer(o.framebuffer),e.viewport(0,0,o.w,o.h),e.clearColor(0,0,0,0),e.clear();for(let e=0;e<t.children.length;e++){const o=t.children[e];void 0!==o&&(this.stage.addQuads(o),o.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,t.hasRTTupdates=!1}const o=this.clearColor.normalized;e.clearColor(o[0],o[1],o[2],o[3]),e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const t=this.rttNodes.indexOf(e);-1!==t&&this.rttNodes.splice(t,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}updateClearColor(e){if(this.clearColor.raw===e)return;const t=this.glw,o=ye(e);t.clearColor(o[0],o[1],o[2],o[3]),this.clearColor={raw:e,normalized:o},t.clear()}}const Mo=10;class Oo{}class Io extends Oo{constructor(e,t){super(),o(this,"data",void 0),o(this,"glyphMap",void 0),o(this,"kernings",void 0),this.data=e,this.glyphMap=t;const r=this.kernings={};e.kernings.forEach(e=>{const t=e.second;(r[t]=r[t]||{})[e.first]=e.amount}),this.kernings=r}*shapeText(e,t){let o,r;for(;(o=t.peek())&&!o.done;){const n=o.value,s=this.glyphMap.get(n);if(t.next(),void 0!==s){var i;const o=void 0!==r?((null===(i=this.kernings[s.id])||void 0===i?void 0:i[r])||0)+e.letterSpacing:0;r=s.id,yield{mapped:!0,glyphId:s.id,codepoint:n,cluster:t.lastIndex,xAdvance:s.xadvance+o,yAdvance:0,xOffset:s.xoffset+o,yOffset:s.yoffset,xBearing:0,yBearing:0,width:s.width,height:s.height}}else n===Mo&&(r=void 0),yield{mapped:!1,codepoint:n,cluster:t.lastIndex}}}}class Po extends yo{constructor(e,t){super(t),o(this,"type",void 0),o(this,"texture",void 0),o(this,"maxCharHeight",0),o(this,"shaper",void 0),o(this,"glyphMap",new Map),o(this,"data",void 0);const{atlasUrl:r,atlasDataUrl:i,stage:n}=t;this.type=e,n.renderer,this.texture=n.txManager.createTexture("ImageTexture",{src:r,premultiplyAlpha:!1}),n.txManager.loadTexture(this.texture,!0),this.texture.preventCleanup=!0,this.texture.on("loaded",()=>{this.checkLoaded(),n.requestRender()}),mt(i).then(e=>{this.data=JSON.parse(e),this.data;let t=0;if(this.data.chars.forEach(e=>{this.glyphMap.set(e.id,e);const o=e.yoffset+e.height;o>t&&(t=o)}),this.maxCharHeight=t,this.shaper=new Io(this.data,this.glyphMap),!this.metrics){var o;if(null===(o=this.data)||void 0===o||!o.lightningMetrics)throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);{const{ascender:e,descender:t,lineGap:o,unitsPerEm:r}=this.data.lightningMetrics;this.metrics={ascender:e/r,descender:t/r,lineGap:o/r}}}this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const t=this.glyphMap.get(e);if(void 0===t)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:t.x,y:t.y,width:t.width,height:t.height}}checkLoaded(){this.loaded||"loaded"===this.texture.state&&this.data&&(this.loaded=!0,this.emit("loaded"))}}class Lo{constructor(e,t=0){o(this,"iterator",void 0),o(this,"peekBuffer",[]),o(this,"_lastIndex",void 0),this.iterator=e,this.iterator=e,this._lastIndex=t-1,this.peekBuffer=[]}next(){const e=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return e.done?this._lastIndex=-1:this._lastIndex++,e}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const e=this.iterator.next();return this.peekBuffer.push(e),e}get lastIndex(){return this._lastIndex}}function*Fo(e,t=0){let o=t;for(;o<e.length;){const t=e.codePointAt(o);if(void 0===t)throw new Error("Invalid Unicode code point");yield t,o+=t<=65535?1:2}}function Bo(e,t,o,r,i,n,s,a,l,h,d,c,u,p,f,m,g,y,x){f.loaded,f.data,f.shaper;const v=a/f.data.info.size,b=l/v,w=n/v,T=h/v,S=u[e],R=(null==S?void 0:S.codepointIndex)||0;let E=(null==S?void 0:S.maxX)||0,_=(null==S?void 0:S.maxY)||0,C=t,A=o,k=0;const M={codepointIndex:-1,bufferOffset:-1,xStart:-1},O=f.shaper,I={letterSpacing:T};r.endsWith(" ")&&(r+=" ");let P,L=O.shapeText(I,new Lo(Fo(r,R),R)),F=-1;const B=[],U=s/v,$=function(e,t,o){const r=o.shapeText(t,new Lo(Fo(e,0),0));let i=0;for(const n of r)n.mapped&&8203!==n.codepoint&&(i+=n.xAdvance);return i}(y,I,O);let N=!0;for(;N;){const t=(0===x||e+1<x)&&("both"!==c||g||A+b+f.maxCharHeight<=U),o=t?w:w-$;let i=0;const n=A+f.maxCharHeight>=p.y1,s=A<=p.y2,a=n&&s;for(;(P=L.next())&&!P.done;){const n=P.value;if(e===u.length)u.push({codepointIndex:n.cluster,maxY:_,maxX:E});else if(e>u.length)throw new Error("Unexpected lineCache length");if(32===n.codepoint||10===n.codepoint||8203===n.codepoint?-1!==M.codepointIndex&&(M.codepointIndex=-1,i=C):-1===M.codepointIndex&&(M.codepointIndex=n.cluster,M.bufferOffset=k,M.xStart=i),n.mapped){const e=C+n.xOffset+n.width;if("none"!==c&&e>=o&&-1!==M.codepointIndex&&M.xStart>0){if(t){L=O.shapeText(I,new Lo(Fo(r,M.codepointIndex),M.codepointIndex)),k=M.bufferOffset;break}L=O.shapeText(I,new Lo(Fo(y,0),0)),C=M.xStart,k=M.bufferOffset,c="none"}else{const e=C+n.xOffset,t=A+n.yOffset;if(a){-1===F&&(F=k);const o=f.getAtlasEntry(n.glyphId),r=o.x/f.data.common.scaleW,i=o.y/f.data.common.scaleH,s=o.width/f.data.common.scaleW,a=o.height/f.data.common.scaleH;d[k++]=e,d[k++]=t,d[k++]=r,d[k++]=i,d[k++]=e+n.width,d[k++]=t,d[k++]=r+s,d[k++]=i,d[k++]=e,d[k++]=t+n.height,d[k++]=r,d[k++]=i+a,d[k++]=e+n.width,d[k++]=t+n.height,d[k++]=r+s,d[k++]=i+a}_=Math.max(_,t+n.height),E=Math.max(E,e+n.width),C+=n.xAdvance}}else if(10===n.codepoint){if(t)break;L=O.shapeText(I,new Lo(Fo(y,0),0)),c="none"}}-1!==F&&(B.push({bufferStart:F,bufferEnd:k}),F=-1),C=0,A+=b,e++,M.codepointIndex=-1,i=0,!m&&"both"===c&&A>p.y2||P&&P.done?N=!1:t||(N=!1)}if("center"===i){const e="none"===c?E:w;for(let t=0;t<B.length;t++){const o=B[t],r=(e-(d[o.bufferEnd-4]-d[o.bufferStart]))/2;for(let e=o.bufferStart;e<o.bufferEnd;e+=4)d[e]+=r}}else if("right"===i){const e="none"===c?E:w;for(let t=0;t<B.length;t++){const o=B[t],r=e-(o.bufferEnd===o.bufferStart?0:d[o.bufferEnd-4]-d[o.bufferStart]);for(let e=o.bufferStart;e<o.bufferEnd;e+=4)d[e]+=r}}return{bufferNumFloats:k,bufferNumQuads:k/16,layoutNumCharacters:P.done?r.length-R:P.value.cluster-R+1,fullyProcessed:!!P.done,maxX:E,maxY:_,numLines:u.length}}function Uo(e,t,o,r,i,n,s,a){const{screen:l,sdf:h}=e;if((u=s).x1<u.x2&&u.y1<u.y2){const u=s.x1-t,p=u+(s.x2-s.x1),f=s.y1-o+r,m=(d=f-n,c=i||1,Math.floor(d/c)*c),g=function(e,t){return Math.ceil(e/t)*t}(f+(s.y2-s.y1)+n,i||1);l.x1=u,l.y1=m,l.x2=p,l.y2=g,h.x1=u/a,h.y1=m/a,h.x2=p/a,h.y2=g/a,e.numLines=Math.ceil((g-m)/i),e.firstLineIdx=i?Math.floor(m/i):0}else l.x1=0,l.y1=0,l.x2=0,l.y2=0,h.x1=0,h.y1=0,h.x2=0,h.y2=0,e.numLines=0,e.firstLineIdx=0;var d,c,u;e.valid=!0}function $o(e,t){return t*(e.ascender-e.descender+e.lineGap)}const No={x:0,y:0,width:0,height:0};class Do extends lo{constructor(e){super(e),o(this,"ssdfFontFamilies",{}),o(this,"msdfFontFamilies",{}),o(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]),o(this,"sdfShader",void 0),o(this,"rendererBounds",void 0),o(this,"type","sdf"),this.sdfShader=this.stage.shManager.loadShader("SdfShader",{transform:new Float32Array,color:0,size:0,scrollY:0,distanceRange:0,debug:!1}).shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t},x:(e,t)=>{e.props.x=t,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&Te(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,t)=>{e.props.y=t,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&Te(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,"none"!==e.props.contain&&this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,"both"===e.props.contain&&this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollable:(e,t)=>{e.props.scrollable=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t,this.scheduleUpdateState(e)},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)},lineHeight:(e,t)=>{e.props.lineHeight=t,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,t)=>{e.props.maxLines=t,this.invalidateLayoutCache(e)},textBaseline:(e,t)=>{e.props.textBaseline=t,this.invalidateLayoutCache(e)},verticalAlign:(e,t)=>{e.props.verticalAlign=t,this.invalidateLayoutCache(e)},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t,this.invalidateLayoutCache(e)},debug:(e,t)=>{e.props.debug=t}}}canRenderFont(e){const{fontFamily:t}=e;return t in this.ssdfFontFamilies||t in this.msdfFontFamilies||"$$SDF_FAILURE_TEST$$"===t}isFontFaceSupported(e){return e instanceof Po}addFontFace(e){const t=e.fontFamily,o="ssdf"===e.type?this.ssdfFontFamilies:"msdf"===e.type?this.msdfFontFamilies:void 0;if(!o)return void console.warn(`Invalid font face type: ${e.type}`);let r=o[t];r||(r=new Set,o[t]=r),r.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new pe,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:t}=e;const{textH:o,lineCache:r,debugData:i,forceFullLayoutCalc:n}=e;if(i.updateCount++,"initialState"===e.status&&this.setStatus(e,"loading"),void 0===t){if(t=this.resolveFontFace(e.props),e.trFontFace=t,void 0===t){const t=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;return console.error(t),void this.setStatus(e,"failed",new Error(t))}t.texture.setRenderableOwner(e.props.fontFamily,!0)}if(!1===t.loaded)return void t.once("loaded",()=>{this.scheduleUpdateState(e)});t.data,t.metrics;const{text:s,fontSize:a,x:l,y:h,contain:d,width:c,height:u,verticalAlign:p,scrollable:f,overflowSuffix:m,maxLines:g}=e.props,y="both"===d&&f?e.props.scrollY:0,{renderWindow:x}=e,v=t.data.info.size,b=a/v;let w=e.resLineHeight;if(void 0===w){const o=e.props.lineHeight;w=void 0===o?$o(t.metrics,a):o,e.resLineHeight=w}const T=w/b;e.distanceRange=b*t.data.distanceField.distanceRange;const S=24*s.length;let R=e.vertexBuffer;(!R||R.length<S)&&(R=new Float32Array(2*S));const E=e.elementBounds;if(E.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),E.valid=!0),!n&&x.valid){const t=x.screen;if(l+t.x1<=E.x1&&l+t.x2>=E.x2&&h-y+t.y1<=E.y1&&h-y+t.y2>=E.y2)return void this.setStatus(e,"loaded");x.valid=!1,this.setStatus(e,"loading")}const{offsetY:_,textAlign:C}=e.props;if(!x.valid){if(!Te(E,this.rendererBounds))return;Uo(x,l,h,y,w,"both"===d?E.y2-E.y1:0,E,b)}const A=function(e,t,o,r,i,n,s,a,l){const h=Math.min(Math.max(s.firstLineIdx,0),a.length),{metrics:d}=o;o.data;const c=(d.ascender-d.descender)*e;let u=0;"middle"===r?u=(t-c)/2:"bottom"===r&&(u=t-c);const p=i/n,f=o.data.common.base,m=p+(d.ascender*e-f)+h*t+u;if(!(l&&m>=l/n))return{sdfX:0,sdfY:m,lineIndex:h}}(v,T,t,p,_,b,x,r,o);if(!A)return void this.setStatus(e,"loaded");const{letterSpacing:k}=e.props,M=Bo(A.lineIndex,A.sdfX,A.sdfY,s,C,c,u,a,w,k,R,d,r,x.sdf,t,n,f,m,g);e.bufferUploaded=!1,e.bufferNumFloats=M.bufferNumFloats,e.bufferNumQuads=M.bufferNumQuads,e.vertexBuffer=R,e.renderWindow=x,i.lastLayoutNumCharacters=M.layoutNumCharacters,i.bufferSize=R.byteLength,M.fullyProcessed&&(e.textW=M.maxX*b,e.textH=M.numLines*T*b),this.setStatus(e,"loaded")}renderQuads(e,t,o,r,i,n){var s,a;if(!e.vertexBuffer)return;const l=this.stage.renderer,{fontSize:h,color:d,contain:c,scrollable:u,zIndex:p,debug:f}=e.props,m="both"===c&&u?e.props.scrollY:0,{textW:g=0,textH:y=0,distanceRange:x,vertexBuffer:v,bufferUploaded:b,trFontFace:w,elementBounds:T}=e;let{webGlBuffers:S}=e;if(!S){const t=l.glw,o=4*Float32Array.BYTES_PER_ELEMENT,r=t.createBuffer();e.webGlBuffers=new _o([{buffer:r,attributes:{a_position:{name:"a_position",size:2,type:t.FLOAT,normalized:!1,stride:o,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:t.FLOAT,normalized:!1,stride:o,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,e.webGlBuffers,S=e.webGlBuffers}if(!b){var R,E;const t=l.glw,o=null!==(R=null===(E=S)||void 0===E?void 0:E.getBuffer("a_textureCoordinate"))&&void 0!==R?R:null;t.arrayBufferData(o,v,t.STATIC_DRAW),e.bufferUploaded=!0}if(u&&"both"===c){T.valid;const t=(_=T,(C=No)?(C.x=_.x1,C.y=_.y1,C.width=_.x2-_.x1,C.height=_.y2-_.y1,C):{x:_.x1,y:_.y1,width:_.x2-_.x1,height:_.y2-_.y1});o.valid?(e.clippingRect.valid=!0,o=Se(o,t,e.clippingRect)):(e.clippingRect.valid=!0,o=Re(t,e.clippingRect))}var _,C;const A=new bo(l.glw,l.options,S,this.sdfShader,{transform:t.getFloatArr(),color:le(d,r),size:h/((null===(s=w.data)||void 0===s?void 0:s.info.size)||0),scrollY:m,distanceRange:x,debug:f.sdfShaderDebug},r,o,{height:y,width:g},0,p,!1,i,n),k=(null===(a=e.trFontFace)||void 0===a?void 0:a.texture).ctxTexture;A.addTexture(k),A.length=e.bufferNumFloats,A.numQuads=e.bufferNumQuads,l.addRenderOp(A)}setIsRenderable(e,t){var o;super.setIsRenderable(e,t),null===(o=e.trFontFace)||void 0===o||o.texture.setRenderableOwner(e.props.fontFamily,t)}destroyState(e){var t;super.destroyState(e),null===(t=e.trFontFace)||void 0===t||t.texture.setRenderableOwner(e.props.fontFamily,!1)}resolveFontFace(e){return this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e,"sdf")}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e.props.fontFamily,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:t,contain:o,width:r}=e.props,{elementBounds:i}=e;i.x1=t,i.x2="none"!==o?t+r:1/0}setElementBoundsY(e){const{y:t,contain:o,height:r}=e.props,{elementBounds:i}=e;i.y1=t,i.y2="both"===o?t+r:1/0}}function jo(e){return""===e||"​"===e}function zo(e,t,o,r,i){return o*(r-1)+("bottom"!==e?.5*t:0)+Math.max(o,t)+(i||0)}class Wo{constructor(e,t){o(this,"_canvas",void 0),o(this,"_context",void 0),o(this,"_settings",void 0),this._canvas=e,this._context=t,this._settings=this.mergeDefaults({})}set settings(e){this._settings=this.mergeDefaults(e)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const e=[this._settings.fontFamily],t=[];for(let o=0,r=e.length;o<r;o++)"serif"===e[o]||"sans-serif"===e[o]?t.push(e[o]):t.push(`"${e[o]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${t.join(",")}`}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch(e){console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const e={},t=this.getPrecision(),o=this._settings.paddingLeft*t,r=this._settings.paddingRight*t,i=this._settings.fontSize*t;let n=null===this._settings.offsetY?null:this._settings.offsetY*t;const s=this._settings.w*t,a=this._settings.h*t;let l=this._settings.wordWrapWidth*t;const h=this._settings.cutSx*t,d=this._settings.cutEx*t,c=this._settings.cutSy*t,u=this._settings.cutEy*t,p=(this._settings.letterSpacing||0)*t,f=this._settings.textIndent*t,m=this._settings.trFontFace;this.setFontProperties();const g=function(e,t,o){if(t.metrics)return t.metrics;const r=e.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");let i;return console.warn(`Font metrics not provided for Canvas Web font ${t.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`),i=r.actualBoundingBoxDescent&&r.actualBoundingBoxAscent?{ascender:r.actualBoundingBoxAscent/o,descender:-r.actualBoundingBoxDescent/o,lineGap:.2}:{ascender:.8,descender:-.2,lineGap:.2},t.metrics=i,i}(this._context,m,i),y=$o(g,i)*t,x=null!==this._settings.lineHeight?this._settings.lineHeight*t:y,v=this._settings.maxHeight,b=null!==v&&x>0?Math.floor(v/x):0,w=this._settings.maxLines,T=b>0&&w>0?Math.min(b,w):Math.max(b,w);let S,R=s||2048/this.getPrecision(),E=R-o;if(E<10&&(R+=10-E,E=10),l||(l=E),this._settings.textOverflow&&!this._settings.wordWrap){let e;switch(this._settings.textOverflow){case"clip":e="";break;case"ellipsis":e=this._settings.overflowSuffix;break;default:e=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,l-f,e)}if(this._settings.wordWrap)S=this.wrapText(this._settings.text,l,p,f);else{S={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const e=S.l.length;for(let t=0;t<e-1;t++)S.n.push(t)}let _=S.l;if(T&&_.length>T){const t=_.slice(0,T);let o,r=null;if(this._settings.overflowSuffix){const e=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,o=this.wrapText(t[t.length-1],l-e,p,f);t[t.length-1]=`${o.l[0]}${this._settings.overflowSuffix}`,r=[o.l.length>1?o.l[1]:""]}else r=[""];const i=_.length;let n=0;const s=S.n.length;for(o=T;o<i;o++)r[n]+=`${r[n]?" ":""}${_[o]}`,o+1<s&&S.n[o+1]&&n++;e.remainingText=r.join("\n"),e.moreTextLines=!0,_=t}else e.moreTextLines=!1,e.remainingText="";let C=0;const A=[];for(let M=0;M<_.length;M++){const e=this.measureText(_[M],p)+(0===M?f:0);A.push(e),C=Math.max(C,e)}let k;return e.lineWidths=A,s||(R=C+o+r,E=C),this._settings.wordWrap&&s>C&&"left"===this._settings.textAlign&&1===_.length&&(R=C+o+r),k=a||zo(this._settings.textBaseline,i,x,_.length,n),null===n&&(n=i),e.w=R,e.h=k,e.lines=_,e.precision=t,R||(R=1),k||(k=1),(h||d)&&(R=Math.min(R,d-h)),(c||u)&&(k=Math.min(k,u-c)),e.width=R,e.innerWidth=E,e.height=k,e.fontSize=i,e.cutSx=h,e.cutSy=c,e.cutEx=d,e.cutEy=u,e.lineHeight=x,e.defLineHeight=y,e.lineWidths=A,e.offsetY=n,e.paddingLeft=o,e.paddingRight=r,e.letterSpacing=p,e.textIndent=f,e.metrics=g,e}draw(e,t){const o=this.getPrecision(),r=(null==t?void 0:t.lines)||e.lines,i=(null==t?void 0:t.lineWidths)||e.lineWidths,n=t?zo(this._settings.textBaseline,e.fontSize,e.lineHeight,t.lines.length,null===this._settings.offsetY?null:this._settings.offsetY*o):e.height;let s,a;this._canvas.width=Math.min(Math.ceil(e.width+this._settings.textRenderIssueMargin),2048),this._canvas.height=Math.min(Math.ceil(n),2048),this.setFontProperties(),e.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(e.cutSx||e.cutSy)&&this._context.translate(-e.cutSx,-e.cutSy);const l=[],{metrics:h}=e,d=h?h.ascender*e.fontSize:e.fontSize,c=(h.ascender-h.descender)*e.fontSize;for(let p=0,f=r.length;p<f;p++)s=0===p?e.textIndent:0,a=p*e.lineHeight+d,"middle"==this._settings.verticalAlign?a+=(e.lineHeight-c)/2:"bottom"==this._settings.verticalAlign&&(a+=e.lineHeight-c),"right"===this._settings.textAlign?s+=e.innerWidth-i[p]:"center"===this._settings.textAlign&&(s+=(e.innerWidth-i[p])/2),s+=e.paddingLeft,l.push({text:r[p],x:s,y:a,w:i[p]});if(this._settings.highlight){const t=this._settings.highlightColor,r=this._settings.highlightHeight*o||1.5*e.fontSize,i=this._settings.highlightOffset*o,n=null!==this._settings.highlightPaddingLeft?this._settings.highlightPaddingLeft*o:e.paddingLeft,s=null!==this._settings.highlightPaddingRight?this._settings.highlightPaddingRight*o:e.paddingRight;this._context.fillStyle=be(t);for(let o=0;o<l.length;o++){const t=l[o];this._context.fillRect(t.x-n,t.y-e.offsetY+i,t.w+s+n,r)}}let u=null;this._settings.shadow&&(u=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=be(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*o,this._context.shadowOffsetY=this._settings.shadowOffsetY*o,this._context.shadowBlur=this._settings.shadowBlur*o),this._context.fillStyle=be(this._settings.textColor);for(let p=0,f=l.length;p<f;p++){const t=l[p];if(0===e.letterSpacing)this._context.fillText(t.text,t.x,t.y);else{const o=t.text.split("");let r=t.x;for(let i=0,n=o.length;i<n;i++)this._context.fillText(o[i],r,t.y),r+=this.measureText(o[i],e.letterSpacing)}}u&&(this._context.shadowColor=u[0],this._context.shadowOffsetX=u[1],this._context.shadowOffsetY=u[2],this._context.shadowBlur=u[3]),(e.cutSx||e.cutSy)&&this._context.translate(e.cutSx,e.cutSy)}wrapWord(e,t,o){const r=this._context.measureText(o).width,i=e.length,n=this._context.measureText(e).width;if(n<=t)return e;let s=Math.floor(t*i/n),a=this._context.measureText(e.substring(0,s)).width+r;if(a>t)for(;s>0&&(a=this._context.measureText(e.substring(0,s)).width+r,a>t);)s-=1;else for(;s<i;){if(a=this._context.measureText(e.substring(0,s)).width+r,!(a<t)){s-=1;break}s+=1}return e.substring(0,s)+(t>=r?o:"")}wrapText(e,t,o,r=0){const i=/ |\u200B/g,n=e.split(/\r?\n/g);let s=[];const a=[];for(let l=0;l<n.length;l++){const e=[];let h="",d=t-r;const c=n[l].split(i),u=n[l].match(i)||[];for(let i=0;i<c.length;i++){const n=u[i-1]||"",s=c[i],a=this.measureText(s,o),l=jo(n)?a:a+this.measureText(n,o);0===i||l>d?(i>0&&(e.push(h),h=""),h+=s,d=t-a-(0===i?r:0)):(d-=l,h+=n+s)}e.push(h),h="",s=s.concat(e),l<n.length-1&&a.push(s.length)}return{l:s,n:a}}measureText(e,t=0){return t?e.split("").reduce((e,o)=>jo(o)?e:e+this._context.measureText(o).width+t,0):this._context.measureText(e).width}mergeDefaults(e){return t({text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0},e)}}const Xo="undefined"==typeof self?globalThis:self,Go=(null===(e=Xo.document)||void 0===e?void 0:e.fonts)||Xo.fonts;class Vo extends lo{constructor(e){super(e),o(this,"canvas",void 0),o(this,"context",void 0),o(this,"fontFamilies",{}),o(this,"fontFamilyArray",[this.fontFamilies]),o(this,"type","canvas"),o(this,"loadFont",e=>{const t=function(e){const{fontFamily:t,fontStyle:o,fontWeight:r,fontStretch:i,fontSize:n}=e;return[o,r,i,`${n}px`,t].join(" ")}(e.props),o=this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e.props,"canvas");e.fontInfo={fontFace:o,cssString:t,loaded:!1},e.fontInfo.loaded||Go.load(t).then(this.onFontLoaded.bind(this,e,t)).catch(this.onFontLoadError.bind(this,e,t))}),"undefined"!=typeof OffscreenCanvas?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let t=this.canvas.getContext("2d",{willReadFrequently:!0});t||(this.canvas=document.createElement("canvas"),t=this.canvas.getContext("2d",{willReadFrequently:!0})),this.context=t,this.addFontFace(new xo({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t,this.invalidateLayoutCache(e)},x:(e,t)=>{e.props.x=t},y:(e,t)=>{e.props.y=t},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,"none"!==e.props.contain&&this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,"both"===e.props.contain&&this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)},lineHeight:(e,t)=>{e.props.lineHeight=t,this.invalidateLayoutCache(e)},maxLines:(e,t)=>{e.props.maxLines=t,this.invalidateLayoutCache(e)},textBaseline:(e,t)=>{e.props.textBaseline=t,this.invalidateLayoutCache(e)},verticalAlign:(e,t)=>{e.props.verticalAlign=t,this.invalidateLayoutCache(e)},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof xo}addFontFace(e){const t=e.fontFamily;"sans-serif"!==t&&Go.add(e.fontFace);let o=this.fontFamilies[t];o||(o=new Set,this.fontFamilies[t]=o),o.add(e)}createState(e,t){return{node:t,props:e,status:"initialState",updateScheduled:!1,emitter:new pe,textureNode:void 0,lightning2TextRenderer:new Wo(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if("initialState"===e.status&&this.setStatus(e,"loading"),"loaded"!==e.status)return e.fontInfo?void(e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))):this.loadFont(e)}renderSingleCanvasPage(e){e.renderInfo;const t=e.node,o=this.stage.txManager.createTexture("ImageTexture",{premultiplyAlpha:!0,src:function(e,t){return e.draw(t,{lines:t.lines,lineWidths:t.lineWidths}),0===this.canvas.width||0===this.canvas.height?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}.bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=o,e.textureNode.alpha=ve(e.props.color);else{const r=this.stage.createNode({parent:t,texture:o,autosize:!0,alpha:ve(e.props.color)});e.textureNode=r}this.setStatus(e,"loaded")}calculateRenderInfo(e){var t,o;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:null===(t=e.fontInfo)||void 0===t?void 0:t.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:ye(e.props.color),offsetY:e.props.offsetY,wordWrap:"none"!==e.props.contain,wordWrapWidth:"none"===e.props.contain?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:null!==(o=e.props.lineHeight)&&void 0!==o?o:null,maxLines:e.props.maxLines,maxHeight:"both"===e.props.contain?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:"none"!==e.props.contain?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){"destroyed"!==e.status&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,t){var o;t===(null===(o=e.fontInfo)||void 0===o?void 0:o.cssString)&&e.fontInfo&&(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,t,o){var r;t===(null===(r=e.fontInfo)||void 0===r?void 0:r.cssString)&&e.fontInfo&&(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,o),this.scheduleUpdateState(e))}}const Ho={isWhite:!0,a:1,r:255,g:255,b:255};function Yo(e){if(4294967295===e)return Ho;return{isWhite:!1,a:(e>>>24&255)/255,r:255&e,g:255&e>>>8,b:255&e>>>16}}function qo(e){if(4294967295===e)return Ho;return{isWhite:!1,r:e>>>24&255,g:255&e>>>16,b:255&e>>>8,a:(255&e)/255}}function Ko({a:e,r:t,g:o,b:r}){return`rgba(${t},${o},${r},${e})`}class Qo extends uo{constructor(...e){super(...e),o(this,"image",void 0),o(this,"tintCache",void 0)}async load(){this.textureSource.setState("loading");try{const e=await this.onLoadRequest();this.textureSource.setState("loaded",e),this.updateMemSize()}catch(e){throw this.textureSource.setState("failed",e),e}}release(){this.image=void 0,this.tintCache=void 0}free(){this.release(),this.textureSource.setState("freed"),this.setTextureMemUse(0),this.textureSource.freeTextureData()}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:t,height:o}=this.textureSource.dimensions;this.setTextureMemUse(t*o*e)}}hasImage(){return void 0!==this.image}getImage(e){var t;const o=this.image;if(e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),o;const r=Ko(e);if((null===(t=this.tintCache)||void 0===t?void 0:t.key)===r)return this.tintCache.image;const i=this.tintTexture(o,r);return this.tintCache={key:r,image:i},this.updateMemSize(),i}tintTexture(e,t){const{width:o,height:r}=e,i=document.createElement("canvas");i.width=o,i.height=r;const n=i.getContext("2d");return n&&(n.fillStyle=t,n.globalCompositeOperation="copy",n.fillRect(0,0,o,r),n.globalCompositeOperation="multiply",n.drawImage(e,0,0,o,r,0,0,o,r),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0,o,r,0,0,o,r)),i}async onLoadRequest(){var e;null===(e=this.textureSource)||void 0===e||null===(e=e.textureData)||void 0===e||e.data;const{data:t}=this.textureSource.textureData;if(t instanceof ImageData){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const o=e.getContext("2d");return o&&o.putImageData(t,0,0),this.image=e,{width:t.width,height:t.height}}return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||t instanceof HTMLImageElement?(this.image=t,{width:t.width,height:t.height}):{width:0,height:0}}}function Zo(e,t=""){if(e.shader instanceof ro){if("DynamicShader"===e.shader.shType){var o;const r=null===(o=e.shaderProps)||void 0===o?void 0:o.effects;if(r&&r.length){const e=r.find(e=>e.type===`border${t}`&&e.props&&e.props.width);return e&&e.props}}}}function Jo(e,o,r,i,n){if(Object.getPrototypeOf(this).roundRect)this.roundRect(e,o,r,i,n);else{const s=e=>{const t=Math.min(r/2,i/2),o=e.topLeft+e.topRight+e.bottomRight+e.bottomLeft;if(o>r||o>i){const o=t/Math.max(e.topLeft,e.topRight,e.bottomRight,e.bottomLeft);e.topLeft*=o,e.topRight*=o,e.bottomRight*=o,e.bottomLeft*=o}},a="number"==typeof n?{topLeft:n,topRight:n,bottomRight:n,bottomLeft:n}:t({topLeft:0,topRight:0,bottomRight:0,bottomLeft:0},n);s(a),this.moveTo(e+a.topLeft,o),this.lineTo(e+r-a.topRight,o),this.ellipse(e+r-a.topRight,o+a.topRight,a.topRight,a.topRight,0,1.5*Math.PI,2*Math.PI),this.lineTo(e+r,o+i-a.bottomRight),this.ellipse(e+r-a.bottomRight,o+i-a.bottomRight,a.bottomRight,a.bottomRight,0,0,.5*Math.PI),this.lineTo(e+a.bottomLeft,o+i),this.ellipse(e+a.bottomLeft,o+i-a.bottomLeft,a.bottomLeft,a.bottomLeft,0,.5*Math.PI,Math.PI),this.lineTo(e,o+a.topLeft),this.ellipse(e+a.topLeft,o+a.topLeft,a.topLeft,a.topLeft,0,Math.PI,1.5*Math.PI)}}function er(e,t,o,r,i,n=0,s,a){if(!n)return;let l,h,d=0,c=0;switch(a){case"Top":l=t,d=o,h=r+t,c=o;break;case"Right":l=t+r,d=o,h=t+r,c=o+i;break;case"Bottom":l=t,d=o+i,h=t+r,c=o+i;break;case"Left":l=t,d=o,h=t,c=o+i}e.beginPath(),e.lineWidth=n,e.strokeStyle=Ko(qo(null!=s?s:0)),e.moveTo(l,d),e.lineTo(h,c),e.stroke()}class tr extends po{constructor(e){super(e),o(this,"context",void 0),o(this,"canvas",void 0),o(this,"pixelRatio",void 0),o(this,"clearColor",void 0),o(this,"renderToTextureActive",!1),o(this,"activeRttNode",null),o(this,"defShaderCtr",void 0),this.mode="canvas",this.shManager.renderer=this;const{canvas:t,pixelRatio:r,clearColor:i}=e;this.canvas=t,this.context=t.getContext("2d"),this.pixelRatio=r,this.clearColor=i?xe(i):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new ro("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[t,o,r,i]=this.clearColor;e.fillStyle=`rgba(${t}, ${o}, ${r}, ${i/255})`,e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){var t;const o=this.context,{tx:r,ty:i,width:n,height:s,alpha:a,colorTl:l,colorTr:h,colorBr:d,ta:c,tb:u,tc:p,td:f,clippingRect:m}=e;let g,y,x=e.texture;const v=null===(t=x)||void 0===t?void 0:t.type;if(v!==fe.image&&v!==fe.color&&v!==fe.subTexture&&v!==fe.noise)return;if(x){if(x instanceof vt&&(y=x.props,x=x.parentTexture),g=x.ctxTexture,"freed"===x.state)return;if("loaded"!==x.state)return}const b=Yo(l),w=1!==c,T=0!==m.width&&0!==m.height,S=l!==h||l!==d,R=Boolean(e.shader),E=R?function(e){if(e.shader instanceof ro){const i=e.shader.shType;var t,o;if("RoundedRectangle"===i)return null!==(t=null===(o=e.shaderProps)||void 0===o?void 0:o.radius)&&void 0!==t?t:0;if("DynamicShader"===i){var r;const t=null===(r=e.shaderProps)||void 0===r?void 0:r.effects;if(t){const e=t.find(e=>{var t;return"radius"===e.type&&(null==e||null===(t=e.props)||void 0===t?void 0:t.radius)});return e&&"radius"===e.type&&e.props.radius||0}}}return 0}(e):0,_=R?Zo(e):void 0;if((w||T||E)&&o.save(),T){const e=new Path2D,{x:t,y:r,width:i,height:n}=m;e.rect(t,r,i,n),o.clip(e)}if(w){const e=this.pixelRatio;o.setTransform(c,p,u,f,r*e,i*e),o.scale(e,e),o.translate(-r,-i)}if(E){const e=new Path2D;Jo.call(e,r,i,n,s,E),o.clip(e)}if(v!==fe.image&&v!==fe.subTexture&&v!==fe.noise||!g)if(v===fe.color&&S){let e,t=r,a=i;l===h?(t=r,a=i+s,e=Yo(d)):(t=r+n,a=i,e=Yo(h));const c=o.createLinearGradient(r,i,t,a);c.addColorStop(0,Ko(b)),c.addColorStop(1,Ko(e)),o.fillStyle=c,o.fillRect(r,i,n,s)}else v===fe.color&&(o.fillStyle=Ko(b),o.fillRect(r,i,n,s));else{var C;const e=g.getImage(b);if(o.globalAlpha=null!==(C=b.a)&&void 0!==C?C:a,y)o.drawImage(e,y.x,y.y,y.width,y.height,r,i,n,s);else try{o.drawImage(e,r,i,n,s)}catch(k){}o.globalAlpha=1}if(_&&_.width){var A;const e=_.width,t=_.width/2,l=Ko(qo(null!==(A=_.color)&&void 0!==A?A:0));o.beginPath(),o.lineWidth=e,o.strokeStyle=l,o.globalAlpha=a,E?(Jo.call(o,r+t,i+t,n-e,s-e,E),o.stroke()):o.strokeRect(r+t,i+t,n-e,s-e),o.globalAlpha=1}else if(R){const t=Zo(e,"Top"),a=Zo(e,"Right"),l=Zo(e,"Bottom"),h=Zo(e,"Left");t&&er(o,r,i,n,s,t.width,t.color,"Top"),a&&er(o,r,i,n,s,a.width,a.color,"Right"),l&&er(o,r,i,n,s,l.width,l.color,"Bottom"),h&&er(o,r,i,n,s,h.width,h.color,"Left")}(w||T||E)&&o.restore()}createCtxTexture(e){return new Qo(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}getQuadCount(){return null}updateClearColor(e){this.clearColor=e?xe(e):void 0}}const or={alpha:e=>1===e?null:{prop:"opacity",value:`${e}`},x:e=>({prop:"left",value:`${e}px`}),y:e=>({prop:"top",value:`${e}px`}),width:e=>0===e?{prop:"width",value:"auto"}:{prop:"width",value:`${e}px`},height:e=>0===e?{prop:"height",value:"auto"}:{prop:"height",value:`${e}px`},fontSize:e=>0===e?null:{prop:"font-size",value:`${e}px`},lineHeight:e=>0===e?null:{prop:"line-height",value:`${e}px`},zIndex:()=>"z-index",fontFamily:()=>"font-family",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:e=>!1===e?null:{prop:"overflow",value:e?"hidden":"visible"},rotation:e=>0===e?null:{prop:"transform",value:`rotate(${e}rad)`},scale:e=>1===e?null:{prop:"transform",value:`scale(${e})`},scaleX:e=>1===e?null:{prop:"transform",value:`scaleX(${e})`},scaleY:e=>1===e?null:{prop:"transform",value:`scaleY(${e})`},color:e=>0===e?null:{prop:"color",value:rr(e)}},rr=e=>`rgba(${e>>24&255},${e>>16&255},${e>>8&255},${(255&e)/255})`,ir={id:"test-id"},nr={[fe.generic]:"generic",[fe.color]:"color",[fe.image]:"image",[fe.noise]:"noise",[fe.renderToTexture]:"renderToTexture",[fe.subTexture]:"subTexture"},sr=new Set([...Object.keys(or),...Object.keys(ir),"src","parent","data","text","texture"]);class ar{constructor(e,t){o(this,"root",null),o(this,"canvas",null),o(this,"height",1080),o(this,"width",1920),o(this,"scaleX",1),o(this,"scaleY",1),o(this,"textureMetrics",new Map)}setRootPosition(){if(null===this.root||null===this.canvas)return;const e=this.canvas.getBoundingClientRect(),t=document.documentElement.scrollTop+e.top,o=document.documentElement.scrollLeft+e.left;this.root.id="root",this.root.style.left=`${o}px`,this.root.style.top=`${t}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(e,t){const o=document.createElement("div");o.style.position="absolute",o.id=e.toString();for(const r in t)this.updateNodeProperty(o,r,t[r],t);return o}createNode(e){const t=this.createDiv(e.id,e.props);return t.node=e,e.div=t,e.on("inViewport",()=>t.setAttribute("state","inViewport")),e.on("inBounds",()=>t.setAttribute("state","inBounds")),e.on("outOfBounds",()=>t.setAttribute("state","outOfBounds")),this.createProxy(e,t)}createTextNode(e){const t=this.createDiv(e.id,e.props);return t.node=e,e.div=t,this.createProxy(e,t)}createProxy(e,t){const o=new Map,r=e=>{if(o.forEach((e,t)=>{t.off("loaded",e.onLoaded),t.off("failed",e.onFailed),t.off("freed",e.onFreed)}),o.clear(),e){this.textureMetrics.has(e)||this.textureMetrics.set(e,{previousState:e.state,loadedCount:0,failedCount:0,freedCount:0});const r=()=>{const o=this.textureMetrics.get(e);o&&(o.previousState=o.previousState!==e.state?o.previousState:"loading",o.loadedCount++),this.updateTextureAttributes(t,e)},i=()=>{const o=this.textureMetrics.get(e);o&&(o.previousState=o.previousState!==e.state?o.previousState:"loading",o.failedCount++),this.updateTextureAttributes(t,e)},n=()=>{const o=this.textureMetrics.get(e);o&&(o.previousState=o.previousState!==e.state?o.previousState:e.state,o.freedCount++),this.updateTextureAttributes(t,e)};e.on("loaded",r),e.on("failed",i),e.on("freed",n),o.set(e,{onLoaded:r,onFailed:i,onFreed:n})}};sr.forEach(o=>{let i=Object.getOwnPropertyDescriptor(e,o);if(void 0===i){const t=Object.getPrototypeOf(e);i=Object.getOwnPropertyDescriptor(t,o)}void 0!==i&&Object.defineProperty(e,o,{get(){var t;return null===(t=i)||void 0===t||null===(t=t.get)||void 0===t?void 0:t.call(e)},set:n=>{var s;if(null===(s=i)||void 0===s||null===(s=s.set)||void 0===s||s.call(e,n),this.updateNodeProperty(t,o,n,e.props),"texture"===o){r(n&&"object"==typeof n&&"state"in n?n:null)}},configurable:!0,enumerable:!0})});const i=e.destroy;Object.defineProperty(e,"destroy",{value:()=>{o.forEach((e,t)=>{t.off("loaded",e.onLoaded),t.off("failed",e.onFailed),t.off("freed",e.onFreed),this.textureMetrics.delete(t)}),o.clear(),this.destroyNode(e.id),i.call(e)}}),e.texture&&r(e.texture);const n=e.animate;return Object.defineProperty(e,"animate",{value:(o,r)=>{const i=n.call(e,o,r),s=i.start.bind(i);return i.start=()=>(this.animateNode(t,o,r),s()),i}}),e}destroyNode(e){const t=document.getElementById(e.toString());null==t||t.remove()}updateTextureAttributes(e,t){e.setAttribute("data-texture-state",t.state),e.setAttribute("data-texture-type",nr[t.type]||"unknown"),t.dimensions?(e.setAttribute("data-texture-width",String(t.dimensions.width)),e.setAttribute("data-texture-height",String(t.dimensions.height))):(e.removeAttribute("data-texture-width"),e.removeAttribute("data-texture-height")),e.setAttribute("data-texture-owners",String(t.renderableOwners.length)),e.setAttribute("data-texture-retry-count",String(t.retryCount)),null!==t.maxRetryCount?e.setAttribute("data-texture-max-retry-count",String(t.maxRetryCount)):e.removeAttribute("data-texture-max-retry-count");const o=this.textureMetrics.get(t);o?(e.setAttribute("data-texture-previous-state",o.previousState),e.setAttribute("data-texture-loaded-count",String(o.loadedCount)),e.setAttribute("data-texture-failed-count",String(o.failedCount)),e.setAttribute("data-texture-freed-count",String(o.freedCount))):(e.removeAttribute("data-texture-previous-state"),e.removeAttribute("data-texture-loaded-count"),e.removeAttribute("data-texture-failed-count"),e.removeAttribute("data-texture-freed-count")),t.error?e.setAttribute("data-texture-error",t.error.code||t.error.message):e.removeAttribute("data-texture-error")}updateNodeProperty(e,t,o,r){if(null!==this.root&&null!=o){if("parent"===t){const t=o.id;if(1===t)return void this.root.appendChild(e);const r=document.getElementById(t.toString());return void(null==r||r.appendChild(e))}if("text"===t)return e.innerHTML=String(o),e.style.opacity="0.001",e.style.pointerEvents="none",void(e.style.userSelect="none");if("src"===t&&o)e.setAttribute("data-src",String(o));else if("rtt"===t&&o)e.setAttribute("data-rtt",String(o));else if("texture"!==t){if(or[t]){var i;const n=null===(i=or[t])||void 0===i?void 0:i.call(or,o);if(null===n)return;if("string"==typeof n)return void e.style.setProperty(n,String(o));if("object"==typeof n){let o=n.value;if("x"===t){const e=r.mountX,t=r.width;e&&(o=parseInt(o)-t*e+"px")}else if("y"===t){const e=r.mountY,t=r.height;e&&(o=parseInt(o)-t*e+"px")}e.style.setProperty(n.prop,o)}return}if(ir[t]){const r=ir[t];if(!r)return;return void e.setAttribute(String(r),String(o))}if("data"!==t);else for(const t in o){const r=o[t];void 0===r?e.removeAttribute(`data-${t}`):e.setAttribute(`data-${t}`,String(r))}}else if(o&&"object"==typeof o&&"state"in o){const t=o;this.updateTextureAttributes(e,t)}else e.removeAttribute("data-texture-state"),e.removeAttribute("data-texture-type"),e.removeAttribute("data-texture-width"),e.removeAttribute("data-texture-height"),e.removeAttribute("data-texture-owners"),e.removeAttribute("data-texture-error")}}animateNode(e,t,o){const{duration:r=1e3,delay:i=0}=o,{x:n,y:s,width:a,height:l,alpha:h=1,rotation:d=0,scale:c=1,color:u,mountX:p,mountY:f}=t;setTimeout(function(){setTimeout(()=>{e.style.top=s-l*f+"px",e.style.left=n-a*p+"px",e.style.width=`${a}px`,e.style.height=`${l}px`,e.style.opacity=`${h}`,e.style.rotate=`${d}rad`,e.style.scale=`${c}`,e.style.color=rr(u)},r)},i)}}const lr={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Enter:"enter"," ":"space",Backspace:"back",Escape:"escape",37:"left",39:"right",38:"up",40:"down",13:"enter",32:"space",8:"back",27:"escape"},hr={hd:.66666667,"720p":.66666667,720:.66666667,fhd:1,fullhd:1,"1080p":1,1080:1,"4k":2,"2160p":2,2160:2},dr={low:.66666667,medium:.85,high:1,retina:2},cr=()=>{const e=pr.stage;h.get("fonts",[]).forEach(t=>{"sdf"===t.type||"msdf"===t.type?(!t.png&&t.file&&(t.png=t.file.replace(/\.[^.]+$/,`.${t.type}.png`)),!t.json&&t.file&&(t.json=t.file.replace(/\.[^.]+$/,`.${t.type}.json`)),e.fontManager.addFontFace(new Po(t.type,{fontFamily:t.family,descriptors:{},atlasUrl:t.png,atlasDataUrl:t.json,stage:e,metrics:t.metrics}))):"web"===t.type&&e.fontManager.addFontFace(new xo({fontFamily:t.family,fontUrl:t.file,descriptors:{},metrics:t.metrics}))})},ur=()=>{const e=pr.stage;h.get("shaders",[]).forEach(t=>{e.shManager.registerShaderType(t.name,t.type)}),h.get("effects",[]).forEach(t=>{e.shManager.registerShaderType(t.name,t.type)})};let pr={};const fr=e=>{const t="renderMode"in e?e.renderMode:"webgl";return"webgl"===t?ko:"canvas"===t?tr:void 0},mr=e=>{const t="renderMode"in e?e.renderMode:"webgl";return"webgl"===t?[Do,Vo]:"canvas"===t?[Vo]:void 0},gr=e=>{const o=t(t({},{max:200,target:.8,cleanupInterval:5e3,baseline:25,strict:!1}),"gpuMemory"in e==!0?e.gpuMemory:{});return{criticalThreshold:1024*o.max*1024,targetThresholdLevel:o.target,cleanupInterval:o.cleanupInterval,baselineMemoryAllocation:1024*o.baseline*1024,doNotExceedCriticalThreshold:o.strict}},yr=function(e){const t="vertical"===e.direction?"y":"x",o="vertical"===e.direction?"x":"y",r="vertical"===e.direction?"mountX":"mountY",i="vertical"===e.direction?"height":"width",n="vertical"===e.direction?"width":"height",s=((e,t)=>{if(void 0===e)return{start:0,end:0,oppositeStart:0,oppositeEnd:0};if("number"==typeof e)return{start:e,end:e,oppositeStart:e,oppositeEnd:e};if(!0===vr(e)&&(e=br(e)),"object"==typeof e){const{top:o,right:r,bottom:i,left:n,x:s=0,y:a=0}=e;return"vertical"===t?{start:void 0!==o?o:a,end:void 0!==i?i:a,oppositeStart:void 0!==n?n:s,oppositeEnd:void 0!==r?r:s}:{start:void 0!==n?n:s,end:void 0!==r?r:s,oppositeStart:void 0!==o?o:a,oppositeEnd:void 0!==i?i:a}}return{start:0,end:0,oppositeStart:0,oppositeEnd:0}})(e.padding,e.direction);let a=s.start;const l=this.node.children,h=l.length,d=this.children;let c=0;const u=e.gap||0;for(let f=0;f<h;f++){if(void 0!==d[f]&&!1===d[f].props.raw.show)continue;const e=l[f];e[t]=a,e[o]=s.oppositeStart,a+="width"===i?e.width+(e.width!==("text"in e?1:0)?u:0):"text"in e?e.width>1?e.height+u:0:0!==e.height?e.height+u:0,c=Math.max(c,e[n]+s.oppositeStart+s.oppositeEnd)}this.node[i]=a-u+s.end,this.node[n]=c;const p={start:0,end:1,center:.5}[e["align-items"]||"start"];if(0!==p)for(let f=0;f<h;f++){const e=l[f];e[o]=c*p,e[r]=p}void 0!==e["@updated"]&&e["@updated"]({w:this.node.width,h:this.node.height},this),this.config.parent&&!0===this.config.parent.props.__layout&&this.config.parent.triggerLayout(this.config.parent.props)},xr=e=>null!==e&&"object"==typeof e&&"transition"in e==!0,vr=e=>"string"==typeof e&&e.startsWith("{")&&e.endsWith("}"),br=e=>JSON.parse(e.replace(/'/g,'"').replace(/([{,]\s*)([\w-_]+)(\s*:)/g,'$1"$2"$3')),wr=function(e,t){return"string"!=typeof e?e:e.indexOf("%")===e.length-1?this.element.config.parent&&(this.element.config.parent.node[t]||0)*(parseFloat(e)/100)||0:e},Tr=e=>{if("object"!=typeof e||null===e)return e;if(e.constructor===Object){if("value"in e==!0)return e.value;if("transition"in e==!0)return Tr(e.transition)}return e},Sr={top:"colorTop",bottom:"colorBottom",left:"colorLeft",right:"colorRight"};let Rr=null,Er=null;const _r={set parent(e){this.props.parent="root"===e?pr.root:e.node},set rotation(e){this.props.rotation=e*(Math.PI/180)},set w(e){this.props.width=wr.call(this,e,"width")},set width(e){this.props.width=wr.call(this,e,"width")},set h(e){this.props.height=wr.call(this,e,"height")},set height(e){this.props.height=wr.call(this,e,"height")},set x(e){this.props.x=wr.call(this,e,"width")},set y(e){this.props.y=wr.call(this,e,"height")},set z(e){this.props.zIndex=e},set zIndex(e){this.props.zIndex=e},set color(e){"string"==typeof e&&!1===e.startsWith("{")?this.props.color=w(e):("object"==typeof e||!0===vr(e)&&(e=br(e)))&&(this.props.color=0,Object.entries(e).forEach(e=>{this.props[Sr[e[0]]]=w(e[1])}))},set src(e){"object"==typeof e||!0===vr(e)&&(e=br(e))?(this.props.src=e.src,this.props.imageType=e.type):this.props.src=e,void 0===this.raw.color&&(this.props.color=this.props.src?4294967295:0),"w"in this.raw||"w"in this.raw||"h"in this.raw||"height"in this.raw||(this.props.autosize=!0)},set texture(e){this.props.texture=e,void 0===this.raw.color&&null==e?this.props.color=0:void 0===this.raw.color&&(this.props.color=4294967295)},set fit(e){const t={};"cover"!==e&&"contain"!==e?("object"==typeof e||!0===vr(e)&&(e=br(e)))&&(t.type=e.type||"cover","number"==typeof e.position&&(t.clipY=t.clipX=e.position),"object"==typeof e.position&&(t.clipX="x"in e.position==!0?e.position.x:null,t.clipY="y"in e.position==!0?e.position.y:null),this.props.textureOptions={resizeMode:t}):this.props.textureOptions={resizeMode:{type:e}}},set rtt(e){this.props.rtt=e,void 0===this.raw.color&&(this.props.color=!0===e?4294967295:0)},set mount(e){"object"==typeof e||!0===vr(e)&&(e=br(e))?("x"in e==!0&&(this.props.mountX=e.x),"y"in e==!0&&(this.props.mountY=e.y)):(this.props.mountX=e,this.props.mountY=e)},set pivot(e){"object"==typeof e||!0===vr(e)&&(e=br(e))?("x"in e==!0&&(this.props.pivotX=e.x),"y"in e==!0&&(this.props.pivotY=e.y)):(this.props.pivotX=e,this.props.pivotY=e)},set scale(e){"object"==typeof e||!0===vr(e)&&(e=br(e))?("x"in e==!0&&(this.props.scaleX=e.x),"y"in e==!0&&(this.props.scaleY=e.y)):(this.props.scaleX=e,this.props.scaleY=e)},set show(e){this.props.alpha=e?void 0!==this.raw.alpha?this.raw.alpha:1:0},set alpha(e){void 0!==this.raw.show&&1!=this.raw.show||(this.props.alpha=e)},set shader(e){const t=void 0!==this.element.node?this.element.node:this.props;if(null!==e){if("object"==typeof e||!0===vr(e)&&(e=br(e))){if(void 0!==t.shader&&t.shader.type===e.type){for(const o in e.props)t.shader.props[o]=e.props[o];return}t.shader=pr.createShader(e.type,e.props)}}else t.shader=null},set effects(e){for(let t=0;t<e.length;t++)e[t].props&&e[t].props.color&&(e[t].props.color=w(e[t].props.color));void 0===this.element.node&&(this.props.shader=pr.createShader("DynamicShader",{effects:e.map(e=>pr.createEffect(e.type,e.props))}))},set clipping(e){this.props.clipping=e},set overflow(e){this.props.clipping=!e},set font(e){this.props.fontFamily=e},set size(e){this.props.fontSize=e},set wordwrap(e){f.warn("The wordwrap attribute is deprecated, use maxwidth instead"),this.props.width=e,this.props.contain="width"},set maxwidth(e){this.props.width=e,this.props.contain="width"},set maxheight(e){this.props.height=e,this.props.contain="both"},set contain(e){this.props.contain=e},set maxlines(e){this.props.maxLines=e},set textoverflow(e){this.props.overflowSuffix=!1===e?" ":!0===e?void 0:e},set letterspacing(e){this.props.letterSpacing=e||1},set lineheight(e){this.props.lineHeight=e},set align(e){this.props.textAlign=e},set content(e){this.props.text=""+e},set placement(e){let t,o;"object"==typeof e||!0===vr(e)&&(e=br(e))?("x"in e==!0&&(t=e.x),"y"in e==!0&&(o=e.y)):"center"===e||"right"===e?t=e:o=e,"center"===t?(this.x="50%",this.props.mountX=.5):"right"===t&&(this.x="100%",this.props.mountX=1),"middle"===o?(this.y="50%",this.props.mountY=.5):"bottom"===o&&(this.y="100%",this.props.mountY=1)},set"inspector-data"(e){!1!==Er&&("object"==typeof e||!0===vr(e)&&(e=br(e)))&&(this.props.data=e)}},Cr={populate(e){const o=e;o.node=this.config.node,!0===o[a.isSlot]&&(this[a.isSlot]=!0),this.props.element=this,this.props.parent=o.parent||this.config.parent,delete o.parent,this.props.raw=e;const r=Object.keys(o),i=r.length;for(let t=0;t<i;t++){const e=r[t],i=o[e];void 0!==i&&(this.props[e]=Tr(i))}void 0===this.props.props.color&&"__textnode"in o==!1&&(this.props.props.color=0),this.node=o.__textnode?pr.createTextNode(t(t({},Rr),this.props.props)):pr.createNode(this.props.props),void 0!==o["@loaded"]&&"function"==typeof o["@loaded"]&&this.node.on("loaded",(e,{type:t,dimensions:r})=>{o["@loaded"]({w:r.width,h:r.height,type:t},this)}),void 0!==o["@error"]&&"function"==typeof o["@error"]&&this.node.on("failed",(e,t)=>{o["@error"](t,this)}),!0===o.__layout&&(this.triggerLayout=yr.bind(this)),void 0!==this.config.parent.props&&!0===this.config.parent.props.__layout&&(this.config.parent.triggerLayout(this.config.parent.props),this.node.on("loaded",()=>{this.config.parent.triggerLayout(this.config.parent.props)}))},set(e,t){if(void 0===t)return;if(this.props.raw[e]===t)return;this.props.raw[e]=t,this.props.props={},this.props[e]=Tr(t);const o=Object.keys(this.props.props);if(1===o.length){if(!0===xr(t))return this.animate(o[0],this.props.props[o[0]],t.transition);this.node[o[0]]=this.props.props[o[0]]}else for(let r=0;r<o.length;r++)!0===xr(t)?this.animate(o[r],this.props.props[o[r]],t.transition):this.node[o[r]]=this.props.props[o[r]];this.config.parent.props&&!0===this.config.parent.props.__layout&&this.config.parent.triggerLayout(this.config.parent.props)},animate(e,t,o){if(void 0!==this.scheduledTransitions[e]&&"scheduled"===this.scheduledTransitions[e].f.state&&this.scheduledTransitions[e].f.stop(),this.node[e]===t)return;const r={};r[e]=t;const i=this.node.animate(r,{duration:"object"==typeof o&&"duration"in o?o.duration:300,easing:"object"==typeof o&&"easing"in o?o.easing:"ease",delay:"object"==typeof o&&"delay"in o?o.delay:0}),n=this.node[e];if(this.scheduledTransitions[e]={v:r[e],f:i},void 0!==o.start&&"function"==typeof o.start&&i.once("animating",()=>{o.start.call(this.component,this,e,n)}),this.config.parent.props&&!0===this.config.parent.props.__layout&&i.on("tick",()=>{this.config.parent.triggerLayout(this.config.parent.props)}),void 0!==o.progress&&"function"==typeof o.progress){let t=0;i.on("tick",(r,{progress:i})=>{o.progress.call(this.component,this,e,i,t),t=i})}i.once("stopped",()=>{void 0!==this.scheduledTransitions[e]&&!0===this.scheduledTransitions[e].canceled||(void 0!==this.node&&o.end&&"function"==typeof o.end&&o.end.call(this.component,this,e,this.node[e]),delete this.scheduledTransitions[e])}),i.start()},destroy(){if(null===this.node)return;f.debug("Deleting Node",this.nodeId);const e=Object.keys(this.scheduledTransitions);for(let t=0;t<e.length;t++){const o=this.scheduledTransitions[e[t]];void 0!==o&&(o.canceled=!0,void 0!==o.f&&o.f.stop())}this.scheduledTransitions={},this.component=null,delete this.component,this.config=null,delete this.config,this.props.raw={},this.props.element=null,this.props.props=null,this.props={},delete this.props,this.triggerLayout=null,delete this.triggerLayout,this.forComponent=null,delete this.forComponent,this.node.destroy(),this.node=null},get nodeId(){return this.node&&this.node.id},get ref(){return this.props.ref||null},get parent(){return this.node&&this.node.parent},get children(){const e=this.component[a.getChildren](),t=[],o=e.length;for(let r=0;r<o;r++){const o=e[r];void 0!==o&&o.parent===(this[a.isSlot]?this.node.children[0]:this.node)&&t.push(o)}return t}},Ar=(e,t)=>(null===Rr&&(Rr={fontSize:32,fontFamily:h.get("defaultFont","sans-serif")}),null===Er&&(Er=h.get("inspector",!1)),Object.assign(Object.create(Cr),{props:Object.assign(Object.create(_r),{props:{}}),scheduledTransitions:{},config:e,component:t})),kr=(e,o,r={})=>{pr=new go(t(t({},{appWidth:r.w||1920,appHeight:r.h||1080,fpsUpdateInterval:r.fpsInterval||1e3,devicePhysicalPixelRatio:dr[r.renderQuality]||r.renderQuality||1,deviceLogicalPixelRatio:r.pixelRatio||hr[r.screenResolution]||hr[window.innerHeight]||1,numImageWorkers:"webWorkersLimit"in r?r.webWorkersLimit:window.navigator.hardwareConcurrency||2,clearColor:r.canvasColor&&w(r.canvasColor)||0,inspector:!0===r.inspector?ar:void 0,boundsMargin:r.viewportMargin||0,renderEngine:fr(r),fontEngines:mr(r),canvas:r.canvas,textureProcessingTimeLimit:r.textureProcessingTimeLimit,textureMemory:gr(r),createImageBitmapSupport:"auto",targetFPS:"maxFPS"in r?r.maxFPS:0}),r.advanced||{}),o);return ur(),cr(),(()=>{let t=e();t.quit=()=>{f.info("Closing App"),t.destroy(),t=null,pr=null}})(),pr},Mr="1.45.2",Or={"@lightningjs/renderer":"^2.20.2"};let Ir={};const Pr={};const Lr={before:{prop:"alpha",value:0},in:{prop:"alpha",value:1,duration:200},out:{prop:"alpha",value:0,duration:100}},Fr=window.speechSynthesis,Br=/android/i.test((window.navigator||{}).userAgent||""),Ur=new Map;let $r=!1,Nr=null;const Dr=()=>{Nr&&(clearTimeout(Nr),Nr=null)},jr=e=>{if(!e||Nr)return Dr();Fr.pause(),setTimeout(()=>{Fr.resume()},0),Nr=setTimeout(()=>{jr(e)},5e3)},zr={lang:"en-US",pitch:1,rate:1,voice:null,volume:1},Wr={speak:e=>void 0!==Fr?(!1===$r&&(()=>{const e=Fr.getVoices();zr.voice=e[0]||null,$r=!0})(),(e=>{const t=new SpeechSynthesisUtterance(e.message),o=e.id;return t.lang=e.lang||zr.lang,t.pitch=e.pitch||zr.pitch,t.rate=e.rate||zr.rate,t.voice=e.voice||zr.voice,t.volume=e.volume||zr.volume,Ur.set(o,t),!1===Br&&(t.onstart=()=>{jr(t)},t.onresume=()=>{jr(t)}),new Promise((e,r)=>{t.onend=()=>{Dr(),Ur.delete(o),e()},t.onerror=e=>{Dr(),Ur.delete(o),r(e)},Fr.speak(t)})})(e)):(f.error("speechSynthesis web API not available"),Promise.reject({error:"unavailable"})),cancel(){void 0!==Fr&&(Fr.cancel(),Dr())}};let Xr=!1,Gr=0;const Vr=[];let Hr=!1,Yr=null,qr=null,Kr={};const Qr={then(){},done(){},cancel(){},remove(){},stop(){}},Zr=(e,t="off",o={})=>!1===Xr?Qr:Jr(e,t,!1,o),Jr=(e,t,o=!1,r={})=>{const i=Gr++;let n;const s=new Promise(e=>{n=e});return s.remove=s.cancel=()=>{const t=Vr.findIndex(e=>e.id===i);-1!==t&&Vr.splice(t,1),f.debug(`Announcer - removed from queue: "${e}" (id: ${i})`),n("canceled")},s.stop=()=>{i===Yr&&(Wr.cancel(),Hr=!1,n("interupted"))},!1===o?"assertive"===t?Vr.unshift({message:e,resolveFn:n,id:i,options:r}):Vr.push({message:e,resolveFn:n,id:i,options:r}):Vr.push({delay:o,resolveFn:n,id:i}),f.debug(`Announcer - added to queue: "${e}" (id: ${i})`),setTimeout(()=>{ei()},100),s},ei=async()=>{if(!0===Hr||0===Vr.length)return;Hr=!0;const{message:e,resolveFn:o,delay:r,id:i,options:n={}}=Vr.shift();Yr=i,r?setTimeout(()=>{Hr=!1,Yr=null,o("finished"),ei()},r):(null!==qr&&clearTimeout(qr),qr=setTimeout(()=>{f.debug(`Announcer - speaking: "${e}" (id: ${i})`),Wr.speak(t(t({message:e,id:i},Kr),n)).then(()=>{f.debug(`Announcer - finished speaking: "${e}" (id: ${i})`),Yr=null,Hr=!1,o("finished"),ei()}).catch(t=>{Yr=null,Hr=!1,f.debug(`Announcer - error ("${t.error}") while speaking: "${e}" (id: ${i})`),o(t.error),ei()}),qr=null},200))},ti={speak:Zr,polite:(e,t={})=>Zr(e,"polite",t),assertive:(e,t={})=>Zr(e,"assertive",t),stop:()=>{Wr.cancel()},enable:()=>{Xr=!0},disable:()=>{Xr=!1},toggle:e=>{Xr=!!e},clear:()=>{Hr=!1,Vr.length=0},pause:e=>!1===Xr?Qr:Jr(void 0,void 0,e),configure:(e={})=>{Kr=t(t({},Kr),e)}};let oi;const ri=oe({path:"",navigating:!1,data:null,params:null,hash:""},h.get("reactivityMode"),!0),ii=[];let ni,si,ai={},li={},hi=!1,di=!1;const ci=e=>{e||(e="/");const t=e.replace(/^#/,"").split("?");return{path:t[0],queryParams:new URLSearchParams(t[1]),hash:e}},ui=e=>e.replace(/^\/+|\/+$/g,"").toLowerCase(),pi=e=>"object"==typeof e&&null!==e,fi=e=>"string"==typeof e,mi=e=>{if(!e)return{};const t={},o=[...e.entries()];for(let r=0;r<o.length;r++)t[o[r][0]]=o[r][1];return t},gi=({hash:e,path:t,queryParams:o},r=[])=>{const i=t.replace(/^\/+|\/+$/g,""),n=ui(t),s={hash:e,queryParams:mi(o)};let a=!1,l=0;for(;!a&&l<r.length;){const e=r[l],t=ui(e.path);if(ui(t)===n)a=xi(e,s);else if(t.indexOf(":")>-1){const o=[...t.matchAll(/:([^\s/]+)/gi)];let r=t;o.reverse().forEach(e=>{r=r.substring(0,e.index)+"([^\\s/]+)"+r.substring(e.index+e[0].length)}),r="^"+r;const n=i.match(new RegExp(`${r}`,"i"));n&&(s.params=o.reverse().reduce((e,t,o)=>(e[t[1]]=n[o+1],e),{}),a=xi(e,s))}else if(t.endsWith("*")){const o=new RegExp(t.replace(/\/?\*/,"/?([^\\s]*)"),"i"),r=n.match(o);r&&(s.params={},r[1]&&(s.params.path=r[1]),a=xi(e,s))}l++}return a},yi={inHistory:!0,keepAlive:!1,passFocus:!0,reuseComponent:!1},xi=(e,o)=>({hash:o.hash,path:e.path,component:e.component,transition:"transition"in e?e.transition:Lr,options:t(t(t({},yi),e.options),ai),announce:e.announce||!1,hooks:e.hooks||{},data:t(t(t({},e.data),li),o.queryParams),params:o.params||{},meta:e.meta||{}}),vi=async(e,t,o,r)=>{if(o)if(Array.isArray(o))for(let i=0;i<o.length;i++)i===o.length-1?await bi(t[a.holder],o[i]):bi(t[a.holder],o[i]);else await bi(t[a.holder],o);if(!1===r&&e.options&&!0===e.options.keepAlive&&!0===e.options.inHistory){const e=ii[ii.length-1];void 0!==e&&(e.view=t,e.focus=si)}!e.options||!0===e.options.keepAlive&&!0!==r||(t.destroy(),t=null),si=null,e=null},bi=(e,t,o=!0)=>new Promise(r=>{if(!0===o){let o=t.end;t.end=(...e)=>{o&&o(e),o=null,r()},void 0!==e?e.set(t.prop,{transition:t}):r()}else void 0!==e&&e.set(t.prop,t.value),r()}),wi=(e,t={},o={})=>{li=t,ai=o,window.location.hash=e},Ti=function(){const e=ii.pop();if(e&&oi!==e)return hi=!0,ni=e,wi(e.hash,e.data,e.options),!0;const t=oi&&oi.options.backtrack||!1;if(!1===t)return!1;const o=/(\/:?[\w%\s-]+)$/;let r=oi.path,i=r.split("/").length;if(i<=1)return!1;for(;i--;){if(!o.test(r))return!1;r=r.replace(o,"");const e=gi(ci(r),this.parent[a.routes]);if(e&&t)return wi(e.path,e.data,e.options),!0}return!1},Si={navigate:async function(){ti.stop(),ti.clear(),ri.navigating=!0;let e=!1;if(!1===di&&this.parent[a.routes]){let r=oi,i=gi(ci(document.location.hash),this.parent[a.routes]);if(oi=i,i){const n=oi.path;let s,l,h,d,c;if(this.parent[a.routerHooks]){const e=this.parent[a.routerHooks];if(e.beforeEach){try{if(s=await e.beforeEach.call(this.parent,i,r),fi(s))return oi=r,void wi(s)}catch(o){if(f.error('Error or Rejected Promise in "BeforeEach" Hook',o),ii.length>0)return di=!0,oi=r,window.history.back(),hi=!1,void(ri.navigating=!1)}if(!0===pi(s)&&s.path!==n)return oi=r,void wi(s.path,s.data,s.options);if(!1===s&&ii.length>0)return di=!0,oi=r,window.history.back(),hi=!1,void(ri.navigating=!1)}}if(i.hooks.before){try{if(l=await i.hooks.before.call(this.parent,i,r),fi(l))return oi=r,void wi(l)}catch(o){if(f.error('Error or Rejected Promise in "Before" Hook',o),ii.length>0)return di=!0,oi=r,window.history.back(),hi=!1,void(ri.navigating=!1)}if(!0===pi(l)&&l.path!==n)return oi=r,void wi(l.path,l.data,l.options);if(!1===l&&ii.length>0)return di=!0,oi=r,window.history.back(),hi=!1,void(ri.navigating=!1)}void 0!==r&&!0===r.options.inHistory&&!1===hi&&ii.push(r),"function"==typeof i.transition&&(i.transition=i.transition(r,i)),!0===hi&&void 0!==ni&&(d=ni.view,c=ni.focus,ni=null);const u=t(t(t({},this[a.props]),i.params),i.data);if(r&&!0===i.options.reuseComponent&&!0!==i.options.keepAlive&&i.component===r.component){e=!0,d=this[a.children][this[a.children].length-1];for(const e in u)d[a.props][e]=u[e]}if(i.announce&&("string"==typeof i.announce&&(i.announce={message:i.announce}),ti.speak(i.announce.message,i.announce.politeness)),ri.path=i.path,ri.params=i.params||{},ri.hash=i.hash,ri.data=null,ri.data=i.data||{},d){h=d[a.holder];let e=!1;if(i.transition.before)if(Array.isArray(i.transition.before)){for(let t=0;t<i.transition.before.length;t++)if("alpha"===i.transition.before[t].prop){e=!0;break}}else"alpha"===i.transition.before.prop&&(e=!0);!1===e&&h.set("alpha",1)}else h=Pr.element({parent:this[a.children][0]}),h.populate({}),h.set("w","100%"),h.set("h","100%"),d=await i.component({props:u},h,this),"Module"===d[Symbol.toStringTag]&&(d.default&&"function"==typeof d.default?d=d.default({props:u},h,this):f.error("Dynamic import doesn't have a default export or default is not a function")),"function"==typeof d&&(d=d({props:u},h,this));!1===e&&this[a.children].push(d),si=Ai.get();const p=this[a.children];if(this.activeView=p[p.length-1],!1!==i.options.passFocus&&(c?c.$focus():d.$focus()),i.transition.before)if(Array.isArray(i.transition.before))for(let e=0;e<i.transition.before.length;e++)h.set(i.transition.before[e].prop,i.transition.before[e].value);else h.set(i.transition.before.prop,i.transition.before.value);let m=!1;if(void 0!==r&&!1===e){m=!0;const e=this[a.children].splice(1,1).pop();e&&vi(r,e,i.transition.out,hi)}if(i.transition.in)if(Array.isArray(i.transition.in))for(let e=0;e<i.transition.in.length;e++)e===i.transition.length-1?await bi(h,i.transition.in[e],m):bi(h,i.transition.in[e],m);else await bi(h,i.transition.in,m)}else{f.error(`Route ${i.hash} not found`);const e=this.parent[a.routerHooks];e&&"function"==typeof e.error&&e.error.call(this.parent,`Route ${i.hash} not found`)}}hi=!1,ri.navigating=!1,di=!1},back:Ti};let Ri,Ei=null,_i=[];const Ci=new Map,Ai={_hold:!1,set hold(e){this._hold=e},get hold(){return this._hold},get:()=>Ei,set(e,t){if(clearTimeout(Ri),e===Ei)return;if(null===Ei&&(_i=ki([e])),null!==Ei)if(_i[_i.length-1]===e.parent)_i.push(e);else{const t=ki([e]);let o=_i.length;for(;o--&&!(t.indexOf(_i[o])>-1);)_i[o].lifecycle.state="unfocus";_i=t}let o=0;for(;o<_i.length-1;)_i[o].lifecycle.state="focus",o++;Ri=setTimeout(()=>Oi(e,t),!0===this.hold?h.get("holdTimeout",50):0)},input(e,t){if(!0===ri.navigating)return;const o=Mi(Ei,e);if(null===o)return;const r=o[a.inputEvents];let i;r[e]?i=r[e].call(o,t):r.any&&(i=r.any.call(o,t)),void 0!==i&&Ci.set(t.code,i)}},ki=e=>void 0!==e[0].parent?(e.unshift(e[0].parent),ki(e)):e,Mi=(e,t)=>!e[a.inputEvents]||"function"!=typeof e[a.inputEvents][t]&&"function"!=typeof e[a.inputEvents].any?void 0!==e.parent?Mi(e.parent,t):null:e,Oi=(e,t)=>{if(f.info("\nFocus chain:\n",_i.map((e,t)=>"\t".repeat(t)+"↳ "+e.componentId).join("\n")),Ei=e,e.lifecycle.state="focus",t instanceof KeyboardEvent){const e=new KeyboardEvent("keydown",t);e[a.internalEvent]=!0,document.dispatchEvent(e)}},Ii=new Map,Pi=new Map;function Li(e){if(null===e||"object"!=typeof e)return e;const t=function(e){return e&&"object"==typeof e&&!0===e[a.isProxy]}(e)?Z(e):e,o=Array.isArray(t)?[]:{};for(const r of Object.keys(t)){const e=t[r];o[r]=e&&"object"==typeof e?Li(e):e}return o}const Fi={registerListener(e,t,o,r=0){let i=Ii.get(t);void 0===i&&(i=new Map,Ii.set(t,i));let n=i.get(e);void 0===n&&(n=new Set,i.set(e,n)),n.add({cb:o,priority:r}),Pi.delete(t)},deregisterListener(e,t){let o=Ii.get(t);void 0!==o&&o.has(e)&&(o.delete(e),Ii.set(t,o),Pi.delete(t))},executeListeners(e,o,r){!1===r&&(o=Li(o));const i=Ii.get(e);if(void 0===i||0===i.size)return!0;if(!1===Pi.has(e)){const o=[];for(const[e,r]of i)for(const i of r)o.push(t(t({},i),{},{component:e}));o.sort((e,t)=>t.priority-e.priority),Pi.set(e,o)}const n=Pi.get(e);for(let t=0;t<n.length;t++){const{cb:e,component:r}=n[t];if(!1===e.call(r,o))return!1}return!0},removeListeners(e){for(const[t,o]of Ii)o.has(e)&&(o.delete(e),Pi.delete(t),0===o.size&&Ii.delete(t))}};let Bi={};const Ui={focus:{value:function(e){return f.warn("this.focus is deprecated, use this.$focus instead"),this.$focus(e)},writable:!1,enumerable:!0,configurable:!1},$focus:{value:function(e){"focus"===this.lifecycle.state&&(this.lifecycle.state="refocus"),Ai.set(this,e)},writable:!1,enumerable:!0,configurable:!1},$input:{value:function(e){if(null==e||e instanceof KeyboardEvent==!1)return!1;const t=Bi[e.key]||Bi[e.keyCode]||e.key||e.keyCode,o=Mi(this,t);if(null===o)return!1;const r=o[a.inputEvents]||{};let i;return r[t]?i=r[t].call(o,e):r.any&&(i=r.any.call(o,e)),void 0!==i&&e.code&&Ci.set(e.code,i),!0},writable:!1,enumerable:!0,configurable:!1},unfocus:{value:function(){this[a.state].hasFocus=!1,this.lifecycle.state="unfocus"},writable:!1,enumerable:!0,configurable:!1},destroy:{value:function(){this.eol=!0,this.lifecycle.state="destroy",!0===this.hasFocus&&this.parent.$focus();for(let t in this[a.state])Array.isArray(this[a.state][t])&&(this[a.state][t]=[]);this.$clearTimeouts(),this.$clearIntervals(),Fi.removeListeners(this);const e=this[a.rendererEventListeners].length;if(e>0)for(let t=0;t<e;t++){const e=this[a.rendererEventListeners][t];Ir.off(e.event,e.cb)}this[a.rendererEventListeners]=null,$i(this[a.children]),this[a.children].length=0,G(this[a.effects]),this[a.state]={},this[a.props]={},this[a.computed]=null,this.lifecycle={},this[a.effects].length=0,this.parent=null,this.rootParent=null,this[a.wrapper]=null,this[a.originalState]=null,this[a.slots].length=0,delete this[a.computed],delete this.parent,delete this.rootParent,delete this[a.wrapper],delete this[a.originalState],delete this[a.children],delete this[a.slots],delete this.componentId,delete this[a.id],delete this.ref,delete this[a.state].hasFocus,this[a.holder].destroy(),this[a.holder]=null,delete this[a.holder],this[a.cleanup](),delete this[a.cleanup],delete this[a.effects],f.debug(`Destroyed component ${this.componentId}`)},writable:!1,enumerable:!0,configurable:!1},[a.removeGlobalEffects]:{value:function(e=[]){G(e)},writable:!1,enumerable:!1,configurable:!1},select:{value:function(e){return f.warn("this.select is deprecated, use this.$select instead"),this.$select(e)},writable:!1,enumerable:!0,configurable:!1},$select:{value:function(e){if(!0===this.eol)return;let t=null;return this[a.children].forEach(o=>{Array.isArray(o)?o.forEach(o=>{o.ref===e&&(t=o)}):Object.getPrototypeOf(o)===Object.prototype?Object.keys(o).forEach(r=>{o[r].ref===e&&(t=o[r])}):o.ref===e&&(t=o)}),t},writable:!1,enumerable:!0,configurable:!1},trigger:{value:function(e){return f.warn("this.trigger is deprecated, use this.$trigger instead"),this.$trigger(e)},writable:!1,enumerable:!0,configurable:!1},$trigger:{value:function(e){let t=this[a.originalState];if(e.indexOf(".")>-1){const o=e.split(".");e=o.pop(o);for(let e=0;e<o.length;e++)t=t[o[e]]}H(t,e,!0)},writable:!1,enumerable:!0,configurable:!1},shader:{value:function(e,t){return{type:e,props:t}},writable:!1,enumerable:!0,configurable:!1}},$i=function(e){for(let t=0;t<e.length;t++){if(!e[t])return;e[t].destroy&&"function"==typeof e[t].destroy?e[t].destroy():Object.getPrototypeOf(e[t])===Object.prototype&&$i(Object.values(e[t])),e[t]=null}e.length=0},Ni={$setTimeout:{value:function(e,t,...o){if(!0===this.eol)return;const r=setTimeout(()=>{this.$clearTimeout(r),e.apply(null,o)},t,o);return this[a.timeouts].push(r),r},writable:!1,enumerable:!0,configurable:!1},$clearTimeout:{value:function(e){const t=this[a.timeouts].indexOf(e);t>-1&&(this[a.timeouts].splice(t,1),clearTimeout(e))},writable:!1,enumerable:!0,configurable:!1},$clearTimeouts:{value:function(){for(let e=0;e<this[a.timeouts].length;e++)clearTimeout(this[a.timeouts][e]);this[a.timeouts]=[]},writable:!1,enumerable:!0,configurable:!1},$setInterval:{value:function(e,t,...o){if(!0===this.eol)return;const r=setInterval(()=>e.apply(null,o),t,o);return this[a.intervals].push(r),r},writable:!1,enumerable:!0,configurable:!1},$clearInterval:{value:function(e){const t=this[a.intervals].indexOf(e);t>-1&&(this[a.intervals].splice(t,1),clearInterval(e))},writable:!1,enumerable:!0,configurable:!1},$clearIntervals:{value:function(){for(let e=0;e<this[a.intervals].length;e++)clearInterval(this[a.intervals][e]);this[a.intervals]=[]},writable:!1,enumerable:!0,configurable:!1}},Di={$emit:{value:function(e,t,o=!0){if(!0!==this.eol)return Fi.executeListeners(e,t,o)},writable:!1,enumerable:!0,configurable:!1},$listen:{value:function(e,t,o=0){!0!==this.eol&&Fi.registerListener(this,e,t,o)},writable:!1,enumerable:!0,configurable:!1},$unlisten:{value:function(e){Fi.deregisterListener(this,e)},writable:!1,enumerable:!0,configurable:!1},$clearListeners:{value:function(){Fi.removeListeners(this)},writable:!1,enumerable:!0,configurable:!1}},ji={$router:{value:{to:wi,back:Ti,get currentRoute(){return oi},get routes(){return this[a.routes]},get navigating(){return ri.navigating},state:ri},writable:!1,enumerable:!0,configurable:!1}},zi={$announcer:{value:ti,writable:!1,enumerable:!0,configurable:!1}},Wi={$size:{value:function(e={w:0,h:0}){this[a.holder].set("w",e.w||0),this[a.holder].set("h",e.h||0)},writable:!1,enumerable:!0,configurable:!1},[a.renderer]:{value:()=>Ir,writable:!1,enumerable:!0,configurable:!1},[a.getChildren]:{value(){const e=this.rootParent||this.parent;return(this[a.children]||[]).concat(e&&e[a.getChildren]().map(e=>Object.getPrototypeOf(e)===Object.prototype?Object.values(e).map(e=>(e.forComponent=e[Symbol.for("config")]&&e[Symbol.for("config")].parent.component,e)):e).flat().filter(e=>{if(e&&e.component)return e.component&&e.component.componentId===this.componentId||e.forComponent&&e.forComponent.componentId===this.componentId})||[])},writable:!1,enumerable:!0,configurable:!1}},Xi=t(t(t({},Di),ji),zi),Gi=Object.defineProperties({[a.launched]:!1},t(t(t(t({},Ui),Ni),Xi),Wi)),Vi={cast:e=>e,required:!1},Hi=(e,o=[])=>{-1===o.indexOf("ref")&&o.push("ref"),e[a.propKeys]=[];const r=o.length;for(let i=0;i<r;i++){const r=t(t({},Vi),"object"==typeof o[i]?o[i]:{key:o[i]});e[a.propKeys].push(r.key),Object.defineProperty(e,r.key,{get(){const e=r.cast(void 0!==this[a.props]&&r.key in this[a.props]?this[a.props][r.key]:"default"in r?r.default:void 0);return!0===r.required&&void 0===e&&f.warn(`${r.key} is required`),e},set(e){f.warn(`Warning! Avoid mutating props directly (prop "${r.key}" in component "${this.componentId}")`),this[a.props][r.key]=e}})}},Yi=(e,t=()=>{})=>{Object.defineProperty(e,a.stateKeys,{value:[],enumerable:!1,configurable:!1,writable:!1});const o=Object.keys(t.apply(e)||{});o.indexOf("hasFocus")>-1?f.warn("State `hasFocus` already exists as a built-in Component variable (to indicate whether the component currently has focus). Avoid using your own `hasFocus` key in the Component state"):o.push(["hasFocus"]);const r=o.length;for(let i=0;i<r;i++){const t=o[i];void 0!==e[a.propKeys]&&e[a.propKeys].indexOf(t)>-1&&f.error(`State ${t} already exists as a prop`),void 0!==e[a.methodKeys]&&e[a.methodKeys].indexOf(t)>-1&&f.error(`State ${t} already exists as a method`),e[a.stateKeys].push(t),Object.defineProperty(e,t,{get(){return this[a.state][t]},set(e){this[a.state][t]=e}})}},qi=(e,t)=>{e[a.computedKeys]=[];for(let o in t)e[a.stateKeys]&&e[a.stateKeys].indexOf(o)>-1?f.error(`${o} already exists as a state variable`):e[a.propKeys]&&e[a.propKeys].indexOf(o)>-1?f.error(`${o} already exists as a prop`):e[a.methodKeys]&&e[a.methodKeys].indexOf(o)>-1?f.error(`${o} already exists as a method`):("function"!=typeof t[o]&&f.warn(`${o} is not a function`),e[a.computedKeys].push(o),Object.defineProperty(e,o,{get(){return t[o].apply(this)}}))},Ki=(e,t)=>{e[a.watchKeys]=[],e[a.watchers]={};for(let o in t)"function"!=typeof t[o]&&console.warn(`${o} is not a function`),e[a.watchKeys].push(o),e[a.watchers][o]=function(e,r){t[o].call(this,e,r)}};let Qi=0;function Zi(e,o){e[a.identifier]=++Qi,((e={},t)=>{$[t]={},[...Object.keys(e),...Object.getOwnPropertySymbols(e)].forEach(o=>{"function"==typeof e[o]&&($[t][o]=e[o])})})(o.hooks,e[a.identifier]),Hi(e,o.props),o.methods&&((e,t)=>{e[a.methodKeys]=[];for(let o in t)e[a.propKeys]&&e[a.propKeys].indexOf(o)>-1?f.error(`${o} already exists as a prop`):("function"!=typeof t[o]&&f.warn(`${o} is not a function`),e[a.methodKeys].push(o),e[o]=t[o])})(e,o.methods),Yi(e,o.state),o.computed&&qi(e,o.computed),o.watch&&Ki(e,o.watch);const r=void 0!==o.router?o.router:o.routes;return void 0!==r&&((e,o)=>{let r=o;!1===Array.isArray(o)&&(e[a.routerHooks]=o.hooks,r=o.routes),e[a.routes]=[];const i=r.length;for(let n=0;n<i;n++)e[a.routes][n]=r[n],e[a.routes][n].options=t(t({},{inHistory:!0}),r[n].options)})(e,r),o.input&&((e,t)=>{e[a.inputEvents]=[],Object.keys(t).forEach(o=>{"function"!=typeof t[o]&&f.warn(`${t[o]} is not a function`),e[a.inputEvents][o]=t[o]})})(e,o.input),e}const Ji=()=>hn("Circle",{code:{render:function(e,t,o,r,i,n,s){const a=[],l=[];return l[0]={},a[0]=this.element({parent:e||"root"},t),l[0].color=t.color,l[0].w=t.size,l[0].h=t.size,l[0].effects=[t.shader("radius",{radius:t.radius})],a[0].populate(l[0]),{elms:a,cleanup:()=>{e=null,t=null,a.length=0,r.length=0,l.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("color",e.color)},function(e,t,o,r,i,n){t[0].set("w",e.size)},function(e,t,o,r,i,n){t[0].set("h",e.size)},function(e,t,o,r,i,n){t[0].set("effects",[e.shader("radius",{radius:e.radius})])}],context:{}},props:[{key:"size",default:40},"color"],computed:{radius(){return this.size/2}}});let en=null;const tn=()=>hn("RouterView",{code:{render:function(e,t,o,r,i,n,s){const a=[],l=[];return l[0]={},a[0]=this.element({parent:e||"root"},t),l[0].w=1*e.node.width,l[0].height=1*e.node.height,a[0].populate(l[0]),{elms:a,cleanup:()=>{e=null,t=null,a.length=0,r.length=0,l.length=0}}},effects:[],context:{}},state:()=>({activeView:null}),hooks:{async ready(){this.parent[a.routerHooks]&&this.parent[a.routerHooks].init&&await this.parent[a.routerHooks].init.apply(this.parent),en=()=>Si.navigate.apply(this),Si.navigate.apply(this),window.addEventListener("hashchange",en)},destroy(){window.removeEventListener("hashchange",en,!1)},focus(){this.activeView&&Ai.get()===this&&this.activeView.$focus()}},input:{back(e){!1===Si.back.call(this)&&this.parent.$focus(e)}}}),on=()=>hn("Sprite",{code:{render:function(e,t,o,r,i,n,s){const a=[],l=[];return l[0]={},a[0]=this.element({parent:e||"root"},t),l[0].w=1*e.node.width,l[0].h=1*e.node.height,l[0].texture=t.texture,l[0].color=t.color,l[0].effects=t.effects,a[0].populate(l[0]),{elms:a,cleanup:()=>{e=null,t=null,a.length=0,r.length=0,l.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("texture",e.texture)},function(e,t,o,r,i,n){t[0].set("color",e.color)}],context:{}},props:["image","map","frame","color","effects"],state:()=>({spriteTexture:null,currentSrc:null}),computed:{texture(){if(void 0===this.image||null===this.image)return null;const e=this[a.renderer]();if(null==e||void 0===e.createTexture)return null;void 0!==this.spriteTexture&&null!==this.spriteTexture&&this.currentSrc===this.image||(this.spriteTexture=e.createTexture("ImageTexture",{src:this.image}),this.currentSrc=this.image);let t=null;return null!==this.map&&void 0!==this.map&&null!==this.frame&&void 0!==this.frame&&(null!==this.map.frames&&void 0!==this.map.frames&&this.frame in this.map.frames?t=Object.assign({},this.map.defaults||{},this.map.frames[this.frame]):this.frame in this.map&&(t=this.map[this.frame])),null==t&&"object"==typeof this.frame&&(t=this.frame),null!=t?e.createTexture("SubTexture",{texture:this.spriteTexture,x:t.x,y:t.y,width:t.w,height:t.h}):this.spriteTexture}}}),rn=()=>hn("FPScounter",{code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[];let c,u,p,f=!1,m=0,g=[];if(l[0]={},a[0]=this.element({parent:e||"root"},!0===f?p:t),a[0].populate(l[0]),!0===f&&(m-=1),e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},!0===f?p:t),l[1].y=15,l[1].x=20,a[1].populate(l[1]),!0===f&&(m-=1),e=a[1],l[2]={},a[2]=this.element({parent:e||"root"},!0===f?p:t),a[2].populate(l[2]),!0===f&&(m-=1),g[3]=o.components&&o.components.Sprite||r.Sprite,e=a[2],l[3]={},a[3]=this.element({parent:e||"root"},!0===f?p:t),l[3].image=t.image,l[3].w=43,l[3].h=25,l[3].map=t.sprite,l[3].frame="fps",d[3]=[],void 0!==g[3])for(let y in g[3][Symbol.for("config")].props)delete l[3][g[3][Symbol.for("config")].props[y]],d[3].push(g[3][Symbol.for("config")].props[y]);if(a[3].populate(l[3]),!0===f&&(m-=1),e=a[3],h[4]={},h[4].image=t.image,h[4].w=43,h[4].h=25,h[4].map=t.sprite,h[4].frame="fps",c=h[4].is||"Sprite",r[4],"string"==typeof c){if(r[4]=o.components&&o.components[c]||r[c],!r[4])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[4]=c);if(a[4]=r[4].call(null,{props:h[4]},a[3],t),a[4][Symbol.for("slots")][0]?(e=a[4][Symbol.for("slots")][0],p=a[4],f=!0):e=a[4][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[2],l[5]={},a[5]=this.element({parent:e||"root"},!0===f?p:t),l[5].x=58,l[5].y=2,a[5].populate(l[5]),!0===f&&(m-=1),g[6]=o.components&&o.components.Sprite||r.Sprite,e=a[5],l[6]={},a[6]=this.element({parent:e||"root"},!0===f?p:t),l[6].image=t.image,l[6].x=0,l[6].h=20,l[6].w=20,l[6].map=t.sprite,l[6].frame=t.fps[0],d[6]=[],void 0!==g[6])for(let y in g[6][Symbol.for("config")].props)delete l[6][g[6][Symbol.for("config")].props[y]],d[6].push(g[6][Symbol.for("config")].props[y]);if(a[6].populate(l[6]),!0===f&&(m-=1),e=a[6],h[7]={},h[7].image=t.image,h[7].x=0,h[7].h=20,h[7].w=20,h[7].map=t.sprite,u=t.fps[0],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[7].frame=u,c=h[7].is||"Sprite",r[7],"string"==typeof c){if(r[7]=o.components&&o.components[c]||r[c],!r[7])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[7]=c);if(a[7]=r[7].call(null,{props:h[7]},a[6],t),a[7][Symbol.for("slots")][0]?(e=a[7][Symbol.for("slots")][0],p=a[7],f=!0):e=a[7][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[8]=o.components&&o.components.Sprite||r.Sprite,e=a[5],l[8]={},a[8]=this.element({parent:e||"root"},!0===f?p:t),l[8].image=t.image,l[8].x=18,l[8].h=20,l[8].w=20,l[8].map=t.sprite,l[8].frame=t.fps[1],d[8]=[],void 0!==g[8])for(let y in g[8][Symbol.for("config")].props)delete l[8][g[8][Symbol.for("config")].props[y]],d[8].push(g[8][Symbol.for("config")].props[y]);if(a[8].populate(l[8]),!0===f&&(m-=1),e=a[8],h[9]={},h[9].image=t.image,h[9].x=18,h[9].h=20,h[9].w=20,h[9].map=t.sprite,u=t.fps[1],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[9].frame=u,c=h[9].is||"Sprite",r[9],"string"==typeof c){if(r[9]=o.components&&o.components[c]||r[c],!r[9])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[9]=c);if(a[9]=r[9].call(null,{props:h[9]},a[8],t),a[9][Symbol.for("slots")][0]?(e=a[9][Symbol.for("slots")][0],p=a[9],f=!0):e=a[9][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[10]=o.components&&o.components.Sprite||r.Sprite,e=a[5],l[10]={},a[10]=this.element({parent:e||"root"},!0===f?p:t),l[10].image=t.image,l[10].x=36,l[10].h=20,l[10].w=20,l[10].map=t.sprite,l[10].frame=t.fps[2],d[10]=[],void 0!==g[10])for(let y in g[10][Symbol.for("config")].props)delete l[10][g[10][Symbol.for("config")].props[y]],d[10].push(g[10][Symbol.for("config")].props[y]);if(a[10].populate(l[10]),!0===f&&(m-=1),e=a[10],h[11]={},h[11].image=t.image,h[11].x=36,h[11].h=20,h[11].w=20,h[11].map=t.sprite,u=t.fps[2],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[11].frame=u,c=h[11].is||"Sprite",r[11],"string"==typeof c){if(r[11]=o.components&&o.components[c]||r[c],!r[11])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[11]=c);if(a[11]=r[11].call(null,{props:h[11]},a[10],t),a[11][Symbol.for("slots")][0]?(e=a[11][Symbol.for("slots")][0],p=a[11],f=!0):e=a[11][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[1],l[12]={},a[12]=this.element({parent:e||"root"},!0===f?p:t),l[12].x=150,a[12].populate(l[12]),!0===f&&(m-=1),g[13]=o.components&&o.components.Sprite||r.Sprite,e=a[12],l[13]={},a[13]=this.element({parent:e||"root"},!0===f?p:t),l[13].image=t.image,l[13].y=2,l[13].w=48,l[13].h=25,l[13].map=t.sprite,l[13].frame="avg",d[13]=[],void 0!==g[13])for(let y in g[13][Symbol.for("config")].props)delete l[13][g[13][Symbol.for("config")].props[y]],d[13].push(g[13][Symbol.for("config")].props[y]);if(a[13].populate(l[13]),!0===f&&(m-=1),e=a[13],h[14]={},h[14].image=t.image,h[14].y=2,h[14].w=48,h[14].h=25,h[14].map=t.sprite,h[14].frame="avg",c=h[14].is||"Sprite",r[14],"string"==typeof c){if(r[14]=o.components&&o.components[c]||r[c],!r[14])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[14]=c);if(a[14]=r[14].call(null,{props:h[14]},a[13],t),a[14][Symbol.for("slots")][0]?(e=a[14][Symbol.for("slots")][0],p=a[14],f=!0):e=a[14][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[12],l[15]={},a[15]=this.element({parent:e||"root"},!0===f?p:t),l[15].x=63,l[15].y=2,a[15].populate(l[15]),!0===f&&(m-=1),g[16]=o.components&&o.components.Sprite||r.Sprite,e=a[15],l[16]={},a[16]=this.element({parent:e||"root"},!0===f?p:t),l[16].image=t.image,l[16].x=0,l[16].h=20,l[16].w=20,l[16].map=t.sprite,l[16].frame=t.avgFps[0],d[16]=[],void 0!==g[16])for(let y in g[16][Symbol.for("config")].props)delete l[16][g[16][Symbol.for("config")].props[y]],d[16].push(g[16][Symbol.for("config")].props[y]);if(a[16].populate(l[16]),!0===f&&(m-=1),e=a[16],h[17]={},h[17].image=t.image,h[17].x=0,h[17].h=20,h[17].w=20,h[17].map=t.sprite,u=t.avgFps[0],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[17].frame=u,c=h[17].is||"Sprite",r[17],"string"==typeof c){if(r[17]=o.components&&o.components[c]||r[c],!r[17])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[17]=c);if(a[17]=r[17].call(null,{props:h[17]},a[16],t),a[17][Symbol.for("slots")][0]?(e=a[17][Symbol.for("slots")][0],p=a[17],f=!0):e=a[17][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[18]=o.components&&o.components.Sprite||r.Sprite,e=a[15],l[18]={},a[18]=this.element({parent:e||"root"},!0===f?p:t),l[18].image=t.image,l[18].x=18,l[18].h=20,l[18].w=20,l[18].map=t.sprite,l[18].frame=t.avgFps[1],d[18]=[],void 0!==g[18])for(let y in g[18][Symbol.for("config")].props)delete l[18][g[18][Symbol.for("config")].props[y]],d[18].push(g[18][Symbol.for("config")].props[y]);if(a[18].populate(l[18]),!0===f&&(m-=1),e=a[18],h[19]={},h[19].image=t.image,h[19].x=18,h[19].h=20,h[19].w=20,h[19].map=t.sprite,u=t.avgFps[1],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[19].frame=u,c=h[19].is||"Sprite",r[19],"string"==typeof c){if(r[19]=o.components&&o.components[c]||r[c],!r[19])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[19]=c);if(a[19]=r[19].call(null,{props:h[19]},a[18],t),a[19][Symbol.for("slots")][0]?(e=a[19][Symbol.for("slots")][0],p=a[19],f=!0):e=a[19][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[20]=o.components&&o.components.Sprite||r.Sprite,e=a[15],l[20]={},a[20]=this.element({parent:e||"root"},!0===f?p:t),l[20].image=t.image,l[20].x=36,l[20].h=20,l[20].w=20,l[20].map=t.sprite,l[20].frame=t.avgFps[2],d[20]=[],void 0!==g[20])for(let y in g[20][Symbol.for("config")].props)delete l[20][g[20][Symbol.for("config")].props[y]],d[20].push(g[20][Symbol.for("config")].props[y]);if(a[20].populate(l[20]),!0===f&&(m-=1),e=a[20],h[21]={},h[21].image=t.image,h[21].x=36,h[21].h=20,h[21].w=20,h[21].map=t.sprite,u=t.avgFps[2],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[21].frame=u,c=h[21].is||"Sprite",r[21],"string"==typeof c){if(r[21]=o.components&&o.components[c]||r[c],!r[21])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[21]=c);if(a[21]=r[21].call(null,{props:h[21]},a[20],t),a[21][Symbol.for("slots")][0]?(e=a[21][Symbol.for("slots")][0],p=a[21],f=!0):e=a[21][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[1],l[22]={},a[22]=this.element({parent:e||"root"},!0===f?p:t),l[22].x=0,l[22].y=40,a[22].populate(l[22]),!0===f&&(m-=1),g[23]=o.components&&o.components.Sprite||r.Sprite,e=a[22],l[23]={},a[23]=this.element({parent:e||"root"},!0===f?p:t),l[23].image=t.image,l[23].x="-2",l[23].w=47,l[23].h=25,l[23].map=t.sprite,l[23].frame="min",d[23]=[],void 0!==g[23])for(let y in g[23][Symbol.for("config")].props)delete l[23][g[23][Symbol.for("config")].props[y]],d[23].push(g[23][Symbol.for("config")].props[y]);if(a[23].populate(l[23]),!0===f&&(m-=1),e=a[23],h[24]={},h[24].image=t.image,h[24].x="-2",h[24].w=47,h[24].h=25,h[24].map=t.sprite,h[24].frame="min",c=h[24].is||"Sprite",r[24],"string"==typeof c){if(r[24]=o.components&&o.components[c]||r[c],!r[24])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[24]=c);if(a[24]=r[24].call(null,{props:h[24]},a[23],t),a[24][Symbol.for("slots")][0]?(e=a[24][Symbol.for("slots")][0],p=a[24],f=!0):e=a[24][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[22],l[25]={},a[25]=this.element({parent:e||"root"},!0===f?p:t),l[25].x=58,l[25].y=2,a[25].populate(l[25]),!0===f&&(m-=1),g[26]=o.components&&o.components.Sprite||r.Sprite,e=a[25],l[26]={},a[26]=this.element({parent:e||"root"},!0===f?p:t),l[26].image=t.image,l[26].x=0,l[26].h=20,l[26].w=20,l[26].map=t.sprite,l[26].frame=t.minFps[0],d[26]=[],void 0!==g[26])for(let y in g[26][Symbol.for("config")].props)delete l[26][g[26][Symbol.for("config")].props[y]],d[26].push(g[26][Symbol.for("config")].props[y]);if(a[26].populate(l[26]),!0===f&&(m-=1),e=a[26],h[27]={},h[27].image=t.image,h[27].x=0,h[27].h=20,h[27].w=20,h[27].map=t.sprite,u=t.minFps[0],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[27].frame=u,c=h[27].is||"Sprite",r[27],"string"==typeof c){if(r[27]=o.components&&o.components[c]||r[c],!r[27])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[27]=c);if(a[27]=r[27].call(null,{props:h[27]},a[26],t),a[27][Symbol.for("slots")][0]?(e=a[27][Symbol.for("slots")][0],p=a[27],f=!0):e=a[27][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[28]=o.components&&o.components.Sprite||r.Sprite,e=a[25],l[28]={},a[28]=this.element({parent:e||"root"},!0===f?p:t),l[28].image=t.image,l[28].x=18,l[28].h=20,l[28].w=20,l[28].map=t.sprite,l[28].frame=t.minFps[1],d[28]=[],void 0!==g[28])for(let y in g[28][Symbol.for("config")].props)delete l[28][g[28][Symbol.for("config")].props[y]],d[28].push(g[28][Symbol.for("config")].props[y]);if(a[28].populate(l[28]),!0===f&&(m-=1),e=a[28],h[29]={},h[29].image=t.image,h[29].x=18,h[29].h=20,h[29].w=20,h[29].map=t.sprite,u=t.minFps[1],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[29].frame=u,c=h[29].is||"Sprite",r[29],"string"==typeof c){if(r[29]=o.components&&o.components[c]||r[c],!r[29])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[29]=c);if(a[29]=r[29].call(null,{props:h[29]},a[28],t),a[29][Symbol.for("slots")][0]?(e=a[29][Symbol.for("slots")][0],p=a[29],f=!0):e=a[29][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[30]=o.components&&o.components.Sprite||r.Sprite,e=a[25],l[30]={},a[30]=this.element({parent:e||"root"},!0===f?p:t),l[30].image=t.image,l[30].x=36,l[30].h=20,l[30].w=20,l[30].map=t.sprite,l[30].frame=t.minFps[2],d[30]=[],void 0!==g[30])for(let y in g[30][Symbol.for("config")].props)delete l[30][g[30][Symbol.for("config")].props[y]],d[30].push(g[30][Symbol.for("config")].props[y]);if(a[30].populate(l[30]),!0===f&&(m-=1),e=a[30],h[31]={},h[31].image=t.image,h[31].x=36,h[31].h=20,h[31].w=20,h[31].map=t.sprite,u=t.minFps[2],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[31].frame=u,c=h[31].is||"Sprite",r[31],"string"==typeof c){if(r[31]=o.components&&o.components[c]||r[c],!r[31])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[31]=c);if(a[31]=r[31].call(null,{props:h[31]},a[30],t),a[31][Symbol.for("slots")][0]?(e=a[31][Symbol.for("slots")][0],p=a[31],f=!0):e=a[31][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[1],l[32]={},a[32]=this.element({parent:e||"root"},!0===f?p:t),l[32].x=150,l[32].y=40,a[32].populate(l[32]),!0===f&&(m-=1),g[33]=o.components&&o.components.Sprite||r.Sprite,e=a[32],l[33]={},a[33]=this.element({parent:e||"root"},!0===f?p:t),l[33].image=t.image,l[33].w=53,l[33].h=25,l[33].map=t.sprite,l[33].frame="max",d[33]=[],void 0!==g[33])for(let y in g[33][Symbol.for("config")].props)delete l[33][g[33][Symbol.for("config")].props[y]],d[33].push(g[33][Symbol.for("config")].props[y]);if(a[33].populate(l[33]),!0===f&&(m-=1),e=a[33],h[34]={},h[34].image=t.image,h[34].w=53,h[34].h=25,h[34].map=t.sprite,h[34].frame="max",c=h[34].is||"Sprite",r[34],"string"==typeof c){if(r[34]=o.components&&o.components[c]||r[c],!r[34])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[34]=c);if(a[34]=r[34].call(null,{props:h[34]},a[33],t),a[34][Symbol.for("slots")][0]?(e=a[34][Symbol.for("slots")][0],p=a[34],f=!0):e=a[34][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[32],l[35]={},a[35]=this.element({parent:e||"root"},!0===f?p:t),l[35].x=63,l[35].y=2,a[35].populate(l[35]),!0===f&&(m-=1),g[36]=o.components&&o.components.Sprite||r.Sprite,e=a[35],l[36]={},a[36]=this.element({parent:e||"root"},!0===f?p:t),l[36].image=t.image,l[36].x=0,l[36].h=20,l[36].w=20,l[36].map=t.sprite,l[36].frame=t.maxFps[0],d[36]=[],void 0!==g[36])for(let y in g[36][Symbol.for("config")].props)delete l[36][g[36][Symbol.for("config")].props[y]],d[36].push(g[36][Symbol.for("config")].props[y]);if(a[36].populate(l[36]),!0===f&&(m-=1),e=a[36],h[37]={},h[37].image=t.image,h[37].x=0,h[37].h=20,h[37].w=20,h[37].map=t.sprite,u=t.maxFps[0],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[37].frame=u,c=h[37].is||"Sprite",r[37],"string"==typeof c){if(r[37]=o.components&&o.components[c]||r[c],!r[37])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[37]=c);if(a[37]=r[37].call(null,{props:h[37]},a[36],t),a[37][Symbol.for("slots")][0]?(e=a[37][Symbol.for("slots")][0],p=a[37],f=!0):e=a[37][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[38]=o.components&&o.components.Sprite||r.Sprite,e=a[35],l[38]={},a[38]=this.element({parent:e||"root"},!0===f?p:t),l[38].image=t.image,l[38].x=18,l[38].h=20,l[38].w=20,l[38].map=t.sprite,l[38].frame=t.maxFps[1],d[38]=[],void 0!==g[38])for(let y in g[38][Symbol.for("config")].props)delete l[38][g[38][Symbol.for("config")].props[y]],d[38].push(g[38][Symbol.for("config")].props[y]);if(a[38].populate(l[38]),!0===f&&(m-=1),e=a[38],h[39]={},h[39].image=t.image,h[39].x=18,h[39].h=20,h[39].w=20,h[39].map=t.sprite,u=t.maxFps[1],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[39].frame=u,c=h[39].is||"Sprite",r[39],"string"==typeof c){if(r[39]=o.components&&o.components[c]||r[c],!r[39])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[39]=c);if(a[39]=r[39].call(null,{props:h[39]},a[38],t),a[39][Symbol.for("slots")][0]?(e=a[39][Symbol.for("slots")][0],p=a[39],f=!0):e=a[39][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),g[40]=o.components&&o.components.Sprite||r.Sprite,e=a[35],l[40]={},a[40]=this.element({parent:e||"root"},!0===f?p:t),l[40].image=t.image,l[40].x=36,l[40].h=20,l[40].w=20,l[40].map=t.sprite,l[40].frame=t.maxFps[2],d[40]=[],void 0!==g[40])for(let y in g[40][Symbol.for("config")].props)delete l[40][g[40][Symbol.for("config")].props[y]],d[40].push(g[40][Symbol.for("config")].props[y]);if(a[40].populate(l[40]),!0===f&&(m-=1),e=a[40],h[41]={},h[41].image=t.image,h[41].x=36,h[41].h=20,h[41].w=20,h[41].map=t.sprite,u=t.maxFps[2],!0===Array.isArray(u)&&(u=n(u).slice(0)),h[41].frame=u,c=h[41].is||"Sprite",r[41],"string"==typeof c){if(r[41]=o.components&&o.components[c]||r[c],!r[41])throw new Error('Component "Sprite" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[41]=c);return a[41]=r[41].call(null,{props:h[41]},a[40],t),a[41][Symbol.for("slots")][0]?(e=a[41][Symbol.for("slots")][0],p=a[41],f=!0):e=a[41][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),{elms:a,cleanup:()=>{u=null,p=null,e=null,g[3]=null,h[4]=null,r[4]=null,g[6]=null,h[7]=null,r[7]=null,g[8]=null,h[9]=null,r[9]=null,g[10]=null,h[11]=null,r[11]=null,g[13]=null,h[14]=null,r[14]=null,g[16]=null,h[17]=null,r[17]=null,g[18]=null,h[19]=null,r[19]=null,g[20]=null,h[21]=null,r[21]=null,g[23]=null,h[24]=null,r[24]=null,g[26]=null,h[27]=null,r[27]=null,g[28]=null,h[29]=null,r[29]=null,g[30]=null,h[31]=null,r[31]=null,g[33]=null,h[34]=null,r[34]=null,g[36]=null,h[37]=null,r[37]=null,g[38]=null,h[39]=null,r[39]=null,g[40]=null,h[41]=null,r[41]=null,t=null,g.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0}}},effects:[function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[6]&&-1!==skips[6].indexOf("frame")||t[6].set("frame",e.fps[0])},function(e,t,o,r,i,n){t[7][Symbol.for("props")].frame=e.fps[0]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[8]&&-1!==skips[8].indexOf("frame")||t[8].set("frame",e.fps[1])},function(e,t,o,r,i,n){t[9][Symbol.for("props")].frame=e.fps[1]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[10]&&-1!==skips[10].indexOf("frame")||t[10].set("frame",e.fps[2])},function(e,t,o,r,i,n){t[11][Symbol.for("props")].frame=e.fps[2]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[16]&&-1!==skips[16].indexOf("frame")||t[16].set("frame",e.avgFps[0])},function(e,t,o,r,i,n){t[17][Symbol.for("props")].frame=e.avgFps[0]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[18]&&-1!==skips[18].indexOf("frame")||t[18].set("frame",e.avgFps[1])},function(e,t,o,r,i,n){t[19][Symbol.for("props")].frame=e.avgFps[1]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[20]&&-1!==skips[20].indexOf("frame")||t[20].set("frame",e.avgFps[2])},function(e,t,o,r,i,n){t[21][Symbol.for("props")].frame=e.avgFps[2]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[26]&&-1!==skips[26].indexOf("frame")||t[26].set("frame",e.minFps[0])},function(e,t,o,r,i,n){t[27][Symbol.for("props")].frame=e.minFps[0]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[28]&&-1!==skips[28].indexOf("frame")||t[28].set("frame",e.minFps[1])},function(e,t,o,r,i,n){t[29][Symbol.for("props")].frame=e.minFps[1]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[30]&&-1!==skips[30].indexOf("frame")||t[30].set("frame",e.minFps[2])},function(e,t,o,r,i,n){t[31][Symbol.for("props")].frame=e.minFps[2]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[36]&&-1!==skips[36].indexOf("frame")||t[36].set("frame",e.maxFps[0])},function(e,t,o,r,i,n){t[37][Symbol.for("props")].frame=e.maxFps[0]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[38]&&-1!==skips[38].indexOf("frame")||t[38].set("frame",e.maxFps[1])},function(e,t,o,r,i,n){t[39][Symbol.for("props")].frame=e.maxFps[1]},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[40]&&-1!==skips[40].indexOf("frame")||t[40].set("frame",e.maxFps[2])},function(e,t,o,r,i,n){t[41][Symbol.for("props")].frame=e.maxFps[2]}],context:{}},state:()=>({image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAAAbCAYAAADRe+BYAAAAAXNSR0IArs4c6QAAGn9JREFUeF7tXQ1UVdWePxcWFg7ZA0sym5n0Tmk1z4+0YeVU4yo1h1jvPVBo1ETU8QvTdJlhsmKpi0he5jyXX0CKIWkpl3OlME3RGcdJixVEas+nJtq0sMwXN/kIgbxn1m+791n/ezifF0hr7lmrVV3O2Wfv/977//v//h/7uKTQFZJASAIhCYQkEJLADZaAy+j9iqIMkCRpliRJGeSeWkmSClwuV25X9VtRlOGSJI3m7wq6bd5Osqa/6OZSSZJKXC4X+h7UpSgKZABZQCbiKuHt4t+dvri8z5GG3E77rChKtCRJ9TY647ht0aaiKJAx5LCK/4Y5m23jneotiqJgvg84eCaYd6Cf4h/xqgo+ZwUO3h1wK5cx1oIYP/5eJUlSrsvl6tRakGUZbYr9tjQpKanL9lmw4w09F5LAzyUBXTDiih3KAspN76pwuVxjgu2koijYzGibbmg0tzQYoOPt5Zv0xydJ0hiXywWlYfviAAE5UBDSPu9YUep1QFEUvAdKWlyOAYPP26c2BhhM25ivXZo+4lWOxx8EGEHRw6iwdXHjQbu26LMwTlJsNUZusrEeHMuC9kGWZRgSYs/VJiUluZ32MXR/SAK/VAkYgREsdKaAKysr58fFxd0Di23Xrl1ScjKMTUl69913906cODHe6cDNFAVvcyAUHCxNO21rGIVv7969ufHx8djQGatWrZIyMq4bmj6frz4mJuYRSZJsMyQNQJS43e4/19bWThk+fPiA/Px8afhwkDpJKikpKUhJSXHEDujY9MDU7XZLtbWsq1BItvrMWQsAQxozZoxUUQEiYHrZapuzAYCcAOWSnJycv2RmZjZThiRJklMZGDIkyHfWLNgskkRkgXVh+g4N0NUuWLCgYN26dcMHDBiQjPUr5qyoqOjttLS0KVYC0syTui/q6+tX9O7duyU6OnoV2h09+rodEexakGUZG4vNnbiWL18uHT9+HCBsay84Gcv/13s9Hs/osLAwlZW7XK6KxMRES8Pa6/Ue4GuLic7v94+ZMGGC5Qb7OeXcXWMrLS3Nd7lcs+zKKtgxdwAjupnPnDlTNHDgwN9RhlRfXy9FR0dDuUsxMTGYDMuJ1GxooAO0eNWgQYNaX3jhhcfnzp2bhHuWLl0q5eayfWd7AyqKoro2uIJ5jr7vwIEDqqKIi4trqKysfJK7VUxlRl1ebW1tX99yyy3tlCFB+aBtroCklJQUS0Wp90L+Hii5ABYaJBhBtowRjBgxQqqqsiSCdsEISpJZIZcuXVp01113PaPHkKyAQmf8umCE9XXu3Dm2zgCoAFZ+YXGYMiS6HjZt2iSnp6eztYVLZ87gVrPFkCjQX758+d0+ffr8k1gP6Oenn34qDRgwgBkQbrfb8VqQZVnIGCyerYX9+/dLeXl5MERuSoYky7JiU/GoLE+r1A2eh4cEIKG7gD0ez4CwsDCsxwD2qygKmGlFUlKSobtUq7A5sLgnTJhgaPDx91EX+i8CjLpqbHSeXS7XCKN5sbkWDG/TAyNVuSckJHyzZ8+evvxpbNoSRVHgDmMmK1d4toFD0wumOGH9wgruBBip7q2YmBgGkiBCXDGiv6qCnj17tlRQUGBrc5PYgJSZmTk1JyfnAd5/LPTZBESowoTV7igeoSiKUEK1ly5dCo+Njf17vKezYERkAU0etAVHjZPm5uaiqKioxylD4uMNun0DgFbnbNq0aXveeustgB8TixVLpOuTsEPMeYqiKFgXTKkQkLM1ZxTkNPuCrf8rV678qVevXi+QfWGrXdxfXl4e3dbWxmJ933zzzbHz588/OnLkSKmpqUlKT0/Hv9U51CjGDq482hZk1aNHjxEJCQlsU3D2JYxB/MRiXTQG6Pf7TRUzna9uBCPxmg5xM1mW1bVhovxKkpKSdI0MPTAqLi6WvF6voWGt907OWtGFTu2vzipw+nx3jU0wo6+++qpu0aJF/bg+cURC7IxTD4xUK5goRNUipco9JSUFbgks9Bg7L9MBo+EbN24M7wwzIm3S4K+qCKgSIcpphB12xNumSQEqkFElDTYHVgewtmtp42ZqbX/99dfTzp07VzBq1KiIToCRaii4XOrUOhlrh2mk8nv66acr9u/fL+JatpWtk7VBmaLf778QHh5+O2cKtli4jvGB17O+0jkrKCiQYJzYnTMKcnpuQ+pqdWL0cJBQFeybb7557Nq1a4/OmTOHiS0vLw8MKYBpERYlaS1VjbsvNykpiS1MCyWOdc1csMGCUVKSSkDNprvW6/XWCncXUejqM2PHjpXE2PFjdXX10uzsbOYu0Shb39mzZ7MyMjL+BkYt5mTKlCnS4MGDWVunTp0qy8zM/IO2M3oKGyx8yZIlbNvpGTuyLMNFfd0nz69fChh18dgoE+6UXtFbJHpgpDINsulU9DfY7EF3jG7iYNx0ZFA0AQDg6KOK7erVqy2RkZGR/H4nihRgdD14cZ1xCaUGxT/A7/dfue+++27n8R1bCpMDEdoVcRgE1OH2SxaxhyCZEZMBxrpt27ZIEXPhfQdQMjeGQ3BgG7G9vb0pPj4+Cm2KuCFvJ6ikE6M+0PWgcbPZskDpnGNOYDBVVVWNURQFCheGFlMqRL625syAcdF9gTXCKD5Zx7b2hVB2iqL8MHXq1N+gjW3btjERcWWCdQdFyRiO1+udxfsjcateBSuakQcFi+fvvffeD9asWSPiu779+/e/lZeX9wRkAcUPABDX3Llz4Yo1VMx03igz6iowQvsUkI4fPy4tX76csU8Kwh6PZ/uOHTsm0/5ERUVJGzdulPBvXDNmzCjz+XwBgETBCOOMjY1l93JZdfDyeL3e4YqisKSgpqam+qioKGZ43+xg1E1jE8aurT3jRM/gXrtgpFoMBmDEXHhOX86Vst4mDtb1F9AFatVv3br18PTp0/+F32BLsdHGqDIiv1ekpqZuKy4uvq45rrs8bGV9kb75EhMTs3bv3r2OxreCBCM1wG4yFylOUpAVRWHWUEtLy9XIyMhbDdqtgoUezPxrn1EUhY0BivmOO+6Q6uvroZxtuVZFW8gqrKurK+vXrx9cCtqrdv369fnz588XSQG24jt03RNWRfeFyswJGFkaPVTZnT9//sTixYt/iw5v2LDhWN++fR8lilJti7riuLJWvRMiI6+xsVEFtldffbXsgQce+D3a2rdvn1xQUBBAY15//XUGzri6AIwMy0XQPo0ZGSl0Oj64KlNTU/FoCgdaxuBIP1WXPH7Pz88vvfPOO9n4Vq9eLR09ejRgT1Iw8nq9UmJiIhs3/ru4uBhuy4B1TMF93759344bN+4u3K/Xd85KA8oJYPwhlkXjWBp21sHVKsuyuo9RNpGYmGjL9d9dY6P9SUpKYvNL3cUYn6IoyHjNQKID2XCOyhO6CowsN52RoupCZhTwCtruTz/9VBMREYFYDNhIUG5FPTACW5gxY0ZzcXExzCu0i4VsmflG3UU8KwtZXQOqq6svDRs2jJlqQYIR3D0Zp0+fDp88eXKvqqoq9KkkIyNjFjILcTU3N7c9+eSTz1ZWVu62Ag9t7RMSItLT05EEMn7o0KGLNm/eHC+y04LNrqR9oG7L3bt3y4mJiUJpOlpfkK/f738zLCzsXu0YwWRnzpz5fWFhocgMtIxDoQ1togkHHGbUUKMH9zph+FTZbdiwofbgwYPol2/Lli0ro6Oj/8NIUVKWAGXd1NQ0AgpVWPFQnAUFBVCcPlmWsSYZI+T34j9VJU4B4mYAI3ROh3VV8PExNzF3XzKQ0jGEsc9pUhDzlHAlqmbTgVUOGTKEufbAJDB2vofVxAkB7j/88EPF+++/PxquQD0wEnEVkz0VoJg196t/o6wX4zKKfem9h4JRV47NCox4yAPrtkMpEIBq/PjxtrJsf5VgpEnv9Y0cOXLXsWPHhEA6y7ryR48ezZS7UMRz5sw5kZ+fD3eAJRBxxSYsHzAKUF6AiK+xsfHPUVFR/xwsGJEF2oEh0VRpriwt2SwFI7i8kLDiu54hwhYdssfgBsLFs8g6WJZWgKcBI9XVOnDgwK/PnDnzt1yJqC4qq/ZorVVTU9Op+Ph46ciRIw+gr5CBcIOmpqZeKi4uRualbbclBUudfqhxFx4zYrhklZYtlJ3f729IS0vrBSYAJVReXj5bJDUQdqC6/ajS4gxgqSzLeJZZHcJFB9esLMvMWqVsScTRONipacs3AxhRpUpiHj6v17tUuCcJIBkZE2r8lAKWVmE3NzerMSrOdlQmRe997733Prxy5crTemDk9XrB5JmLFvt50aJF2y9cuBDvdruTX3zxRdUVuGrVqvmVlZXrcR/YX0tLy/+Gh4dHYX7nzZt34Z133nm4ra1NgKjv+eefb7p48SL2AC5Lg6w7xob9oQEj1hmPx+MOCwtTMwyPHj0qFRYWFtXX168cMWLE6wsWLEgS7tL09PQV33777XKrvfurAyNt4eeMGTNyCgsLl3FBdEpZ8jbYIqeK+LPPPrv28MMPT7TjqqTunldeeSU9Ozt7I28XGw1WH7P8gmFGZLIZQ+LgiEVcpRO8D4hD6C0UCkaaFGvIkbXb0tJy4tZbb/1HPM8z+CwVsMG71DTv48ePVwwZMkQkSjhqj9aGpaamphYXF2MTMBZEU8YvXLjg79+//7/ZmTPa39OnT//hiy++2JmYmNgDv6N+LTo6+mVaxE3S6k37TpMNvvzyy7+89NJLg/i7mKFA2Y/W5URdWTwFvMrr9SJOOhqxjdTUVJFUBPcWq186ffp0w8svv9yLv0NlC13BjEwUTYAbyspNx2WCPcYMHsKAmK7XnFIhtbe3/xgREbHS7/eXmKVni/5pXVlgW1u2bGmJiIiI1KbSE/biS01NdT333HO/EfE16qaTZRl9ZWtsyZIlQ8+dO4d1xS64AQWA8bGoa4IaFHh3ZGTk3scff/xf8dwnn3wi5+bmCs+ArcSo7hibHTAirBJ6gTEkjFm4QPnatXSH282m040Z8Ww6W6httFi70k2nPTli/fr1GSQ2YNuNZoXg4u/Nzc0Xe/bsyVLfefaaKdtwcFyP2oUDBw6kjh07tthun0zkjEXCLJmSkhIW2Ley3Gl/CRiBAcBCZ24PnSwzR/Ed0V/aTkpKSnVJScnD/G+23GikHRbjunr1al1kZKSIGang2djY+D8a9mnJEHVk2qFAVRSEX7lyBSAXxksMTK1ZCjZW8wvLc/Xq1QEuZvG8SAEXSQ8ffPDBic2bNyP2xO4XLi+iNALm6EaBkdWYz58/v3Px4sXP8vtUQ3LatGn5Dz744CwR5yLtwNNQYBZjoQqbg4/0xhtvnOjfv/9vCQNl7lfBWuvq6vbMnz//GZrsYRDvUuPfnHGneL3eZE2yCbqrrumdO3f+V0REhIhls6EoinJh/PjxIovUtt7qrrFZMSMetxTTwEpfOBtnLJ0YFKoBpDf3pnVGBGwoGKmp38QCtKSQ3Q1G3IpH1guzqD766KOcxx57TDAi/GQrs4koNXFmHn4S7rSAYYhgOwEjU+alc/6c1X5Ehp0tMOLMR6Sf4rimgIJBg7RmS2uFxyCG8yJn9Dcgk4YyEVLbZLrotIOmcvnuu++qY2NjBRBZ9k+nLQZGFy9ebOnXr5/InqTrV5stGhR4kvMUkylLPnLkSOUTTzyBgljTNaepB7JcB7iBx3tU8KTMCjECYYFnZGQ0nD17FgyIyY+mJvM2AuawK8DIRjYdk7PNotdcj8fTtmPHjudJHEKrY5DOnYF4Dyxw4RLie7EiIiIiRdRXUeHqKewJEyaUTZo0iSV4CCtelmXIiDHKDRs27Dl48OAz8+bNa33qqaduwW96YJSVlfV2bGxsXN++ff9Bb0J55iP+pI6FJrCIZwoLCzeXl5f/O/9/256B7hqbAzBS9xItJbCI76miMj2BwSBriJ2fxY/XUV0BTt0dROl3OptOe2bY559/vm7o0KGIB4iAWjDZc1Ds4py3DmfxUQV64sSJ1sGDB7NFqpehqLMwdQ80NcimE4+bjkETz+hwRhplHiTAbkn/deq0VEWmiSn91e1238E765TNqP7911577ciyZctQWIsrmHlTa0K4q5PWhqmB7aampvbbbruN1XTZKaY1QwsKyMOGDfugpqYGadSmblC6WQmT6fAa6u7gykydMw5oLMYAqx4KuaGhoTYtLU0kZwgLX83044ohAIApWHVBzMhIVB3ASK/OyOBhoyxVcTDycIASAFHUGV2+fPnU7NmzH9S2p6eweVwNbUULBsrBCL/5ONBG5+Tk1A4aNIjJloJReXl5VVtbG4ycgFok7bsJGAUADJU/Ya943JGh1B1js+OmI8xI1Q0GYGRKWozOplM3NGdH4vQFlRWtXbv2xMKFC1kaqlPWQSeps2467blptbW1f3S73TNNLCozvRLwN8p8uMWbybOnsOigQNniW7hw4V/Xrl0rFLFpait/geoyoy/sDBihHdpfnt32Co8XqUWVyACMjY2N4m4kS+ZBs8jwzMSJE5s+/PDD2zgQqXU7mZmZp8gpFbaZEW2fH7skArZB1TLQmByy/yZNmoREiL/j71EPevV4PHXJycnCjecIPMWcaU9z52vvJf53U9lSBUSSDTqsTQAqUq9xkWC+Kl+tq+/QoUOH169fD7eP6tKjabgALQDS0aNHWRvaLDAKRvw5duaV3llsBnVGwaR2G+1JgBDWgVWSifBiZGzatCla1A5lZWVVnjx5cpxwKeMlVGETJYokD8iLHWQJGWzatIn1iRfPMta0devW6ttvv52xdgpGpaWlySKlGQkMa9asOYWkGbBnWjOlB0Z6ZxISJuHIGOuOsd0MYIQiR/gyr1ePdbzAFLAAYGk6Qm9tU10ARnaOB1Ff6yJHE1ihEmJQ165dOxQeHi6Cvh0eqaury7/nnntEpl6nEiSohR1MAgP629TUtCcqKup6JV/Hy5eQkPCfe/bsEYFRWy4Aq1O2OyMDCh55eXmVc+fOFS6uzrh+aSZVBym0trYevvvuu4fwGiZHqf4mspjtcrlgSYvEC0OAo66Z77//vm7mzJkCFHXnQwe41Pu0yoy46ALYhCZl2HDpUzAqLS1V60b0UnS7EIwsla5mnIYpz+vWrSvv168fOz6KK/UAo8ZIYXu9XtTKME8IQEowrJUrV1bU1NRgTpHNJxKBAsBIlmVWAI9n09LSahoaGoYKAdsAI5H56vvxxx979ezZM1xk1zU2Nva30lH0790xthsORhggLN+cnJz/XrZsGS0cFN8zAhBdP77bRvqqmUBvZjDicohesWLFl1OmTIlBbIBcBTt27KiZPHnyDELPg1ag/F16p184strBANDfBQsWxCB7jFxLR40aFXP48GFhuVtm09GHy8rKhp09e/bo4sWLaeFrRWVlZVlcXFxaMDKgrKgzRa566ys7O/vtuLi4ySKVm99TVV9fX967d2+kzwvQsGSHtH0NGDGr3e12R+I0d3JmnynIUzZSWlpat337drHHdOOa1OUhMudEcSZ11RHmhC53UPBZWVlTwsLCtglFC5der169cIIGTnRg8jBiRgZFnurxMCRmFAwzsgQjTYzN16NHD7deTIjGpHj8B8NS5WqgsBlg0dgIHmpvbz/57LPPskxRpOhzI4LJSZNNB8Yd3dra2jpx4kThrkebSLfH/SyQr2VGdF5ramq2f/zxx5PFUUh8nh3pk+4Y200BRnwCADqm3zVyemq3CTDRTBRbFrumLUcMyWZsR7zCSg5ssdo9fcEMnPnf6NFGjsCIzBs2iNF3mNj3nRyczye6bPVRvM7IgM5fMPOvJ1ZThiQynqgbx8bcWMnCiQKhcUk7rJqekaYFLno2oxnbo/uMjYWewECKYum6o3KkRw/9bGCEflLlDeA9dOjQsb17947E3wBWra2tq4S7rKGhgdVt8clS58RCYQfokLKysi+LiopEMgKKilfpnKsHEINMmXFOAAdZjAEfYaRg5PF4SkidTu3UqVPDGhsb783Ly/P36dMnDG1xlovCbXHQrehfLXebBtQ1dsfYuhqMPB5PBf+EB3RTQCGw3fiG9rh2xpCsCvocbGzcejODEfonzqjTfvEVckBQ2cqv7UQcnQUj2l8sYEqR2Jdv7Rbo6nRa7wvAGLuQg5NxintpxbwjxmbjZVi7mDP64UIofsigM98JosAs4hqQAVMcNi+q5O0AMFWWWkZH+9PBKOBuLgT5MW7ci7ZGI74i4iN1dXUN8+fPFwqcghFtW2UxP6ebTshz+/btf4qMjGSno5tcvqysrLMnT54ULl81A9FMYWs/FUGAmRkKRjVSvL7LyGhXi6H5kUPo9lKv1ztaABs9oikhIWHz9OnTWSYdZ7oU/E2PCeqOsXU1GPFTNMSHUANq0OyAkc19FbotJIGQBG5GCXAlK8oe6NEzOARUTcQpKir6qqysjH3ChJ/EbwqsNwKM0LGHHnoo9/77739Jm9INpt/Y2Fg+depU1P6JM9ICYtpmChttC8DR1M4wQ8GsYBcyrqqqOvDII48wb0R7ezsKaVf06NGjQJykITLlZs2aJY8bN47FbTWuQFbD5/V6dwmg4myKsWDBDFHUvGTJkphLly7hfhgHjCF119gcpHZbZtNRZrRz5876nTt3IpGGyTcERjej9gj1KSSBLpQAXFjt7e2qgtNruqGh4d20tDRxcoAdlyFthn5awK5OoezfMmak02fqljSSlpk7Wsts6fd5tNmu2uxQo76bufNVhqRx6dO2qIuX9k87H/S4Lz23cHeMjZE14voX80xlpZcBS9k87Sv1hDGDwe7C6cKtEWoqJIGQBG6EBHJzc5+vr69/Iy4ujh1lxK+S6urqquzsbLgzRZ2Mk7gXmrkRYIT3QhGKWiPqirbjhjVT2GhbgISegjUDUvQJCph+dgZuU7jb2AcUSQYyVch6BgB9D3XjqrEjyozInHbX2LoSjCAnjI/FjkLM6EZohNA7QxK4cRKAwlZrrQy64Si78MYNJfTmX5sEQszo1zajofGEJGAtAfHNHVGegSeQ2CD+sW4hdEdIAl0sgRAYdbFAQ82FJBCSQEgCIQk4l0AIjJzLLPRESAIhCYQkEJJAF0vg/wBMng85iZWBHAAAAABJRU5ErkJggg==",sprite:{defaults:{y:1,w:20,h:20},frames:{"-":{x:-1e3},0:{x:1},1:{x:23},2:{x:45},3:{x:67},4:{x:89},5:{x:111},6:{x:133},7:{x:155},8:{x:177},9:{x:199},avg:{x:221,w:48,h:25},fps:{x:271,w:43,h:25},max:{x:316,w:53,h:25},min:{x:371,w:47,h:25}}},fps:"---",avgFps:"---",minFps:"---",maxFps:"---"}),hooks:{ready(){}}}),nn={log:{name:"log",plugin:()=>p("App")}},sn=(e,t="",o={})=>{let r;if("object"==typeof t?o=t:r=t,"function"==typeof e){if(void 0===r||""===r)throw Error("Error registering plugin: name is required for plugin");nn[r]={plugin:e,options:o}}else e.plugin&&sn(e.plugin,r||e.name,o)};let an;const ln=e=>{throw new Error(`Parameter ${e} is required`)},hn=(e=ln("name"),o=ln("config"))=>{let r;const i=function(t,r,i,n){this.componentId=(e=>`BlitsComponent::${e}_${B[e]=(B[e]||0)+1}`)(e),this[a.effects]=[],this.lifecycle=Object.assign(Object.create(ie),{component:this,previous:null,current:null}),this.parent=i,this.rootParent=n,this[a.holder]=r,this[a.id]=++U,this[a.props]=oe(t.props||{},h.get("reactivityMode")),this[a.timeouts]=[],this[a.intervals]=[],this[a.originalState]=o.state&&"function"==typeof o.state&&o.state.apply(this)||{},this[a.originalState].hasFocus=!1,this[a.state]=oe(this[a.originalState],h.get("reactivityMode")),this.lifecycle.state="init";const{elms:s,cleanup:l}=o.code.render.apply(Pr,[r,this,o,an,Y,Z,f])||{elms:[],cleanup:()=>{}};this[a.children]=s,this[a.cleanup]=l,this[a.wrapper]=this[a.children][0],this[a.slots]=this[a.children].filter(e=>e[a.isSlot]),this[a.rendererEventListeners]=[],o.hooks&&(setTimeout(()=>{if(o.hooks.frameTick){const e=(e,t)=>N("frameTick",this[a.identifier],this,[t]);this[a.rendererEventListeners].push({event:"frameTick",cb:e}),Ir.on("frameTick",e)}if(o.hooks.idle){const e=()=>{N("idle",this[a.identifier],this)};this[a.rendererEventListeners].push({event:"idle",cb:e}),Ir.on("idle",e)}if(o.hooks.fpsUpdate){const e=(e,t)=>{N("fpsUpdate",this[a.identifier],this,[t.fps])};this[a.rendererEventListeners].push({event:"fpsUpdate",cb:e}),Ir.on("fpsUpdate",e)}}),o.hooks.attach&&this[a.wrapper].node.on("inBounds",()=>{this.lifecycle.state="attach"}),o.hooks.detach&&this[a.wrapper].node.on("outOfBounds",(e,{previous:t})=>{t>0&&(this.lifecycle.state="detach")}),o.hooks.enter&&this[a.wrapper].node.on("inViewport",()=>{this.lifecycle.state="enter"}),o.hooks.exit&&this[a.wrapper].node.on("outOfBounds",()=>{this.lifecycle.state="exit"}));const d=o.code.effects;for(let e=0;e<d.length;e++){const t=()=>{d[e](this,this[a.children],o,an,n,Y)};this[a.effects].push(t),Y(t)}if(this[a.watchers]){const e=Object.keys(this[a.watchers]),t=e.length;for(let o=0;o<t;o++){let t=this,r=e[o];const i=r;if(r.indexOf(".")>-1){const e=r.split(".");r=e.pop();for(let o=0;o<e.length;o++)t=t[e[o]]}let n=this[r];const s=(e=!1)=>{const o=t[r];n===o&&!0!==e||(this[a.watchers][i].apply(this,[o,n]),n=o)};this[a.effects].push(s),Y(s)}}return setTimeout(()=>this.lifecycle.state="ready"),this},n=(n={},s,l,h)=>{if(!1===Gi[a.launched]){const e=Object.keys(nn),t=e.length,o={};for(let r=0;r<t;r++){const t=e[r],i=`$${t}`;i in Gi&&f.warn(`"${t}" (this.${i}) already exists as a property or plugin on the Base Component. You may be overwriting built-in functionality. Proceed with care!`);const n=nn[t];o[i]={value:Object.defineProperties(n.plugin(n.options),Xi),writable:!1,enumerable:!0,configurable:!0}}Object.defineProperties(Gi,o);for(const r in o)Object.defineProperties(Gi[r],o),delete Gi[r][r];an={Circle:Ji(),RouterView:tn(),Sprite:on(),FPScounter:rn()},Gi[a.launched]=!0}return void 0===r&&(f.debug(`Setting up ${e} component`),r=Zi(Object.create(Gi),o)),void 0===o.code&&(f.debug(`Generating code for ${e} component`),o.code=R.call(o,((e="",o,r,i=null)=>{let n=0,s=0,l=[],h=null,d=0;const c=/^<\/?([a-zA-Z0-9_\-.]+)\s*/,u=/^\s*(\/?>)\s*/,p=/^([A-Za-z0-9:.\-_@$]+)=\s*(["'])/,f=/^<>\s*/,m=/^\s*(<\/>)\s*/,g=t=>{n>=e.length||t()},y=e=>e.replace(/<!--[^]*?-->/gm,"").replace(/\r?\n\s*\r\n/gm," ").replace(/\r?\n\s*(\S)/gm," $1").replace(/\r?\n/g,"").trim(),x=t=>{const o=e.slice(n).match(t);return o&&(s=n,n+=o[0].length),o},v=()=>{x(f)?(l.push({[Symbol.for("componentType")]:null,[a.type]:"opening",[a.level]:d,[a.cursorTagStart]:s}),d++,g(v)):g(b)},b=()=>{x(m)?(d--,l.push({[Symbol.for("componentType")]:null,[a.type]:"closing",[a.level]:d}),g(v)):g(T)},T=()=>{const e=x(c);if(!e)throw A("InvalidTag");h={[Symbol.for("componentType")]:e[1],[a.level]:d,[a.cursorTagStart]:s},e[0].startsWith("</")?(d--,h[a.type]="closing",h[a.level]=d):(h[a.type]="opening",d++),g(S)},S=()=>{const t=x(u);if(t){if("/>"===t[1]){if("closing"===h[a.type])throw A("InvalidClosingTag");h[a.type]="self-closing",d--}if("opening"===h[a.type]){const t=e.slice(n,e.indexOf("<",n));t&&(h.content=t,n+=t.length)}l.push(h),g(v)}else g(R)},R=()=>{const e=x(p);if(!e)throw A("InvalidAttribute");{if("closing"===h[a.type])throw A("AttributesInClosingTag");const t=e[2],o=new RegExp(`^(.*?)${t}\\s*`),r=x(o);if(!r)throw A("MissingOrInvalidAttributeValue");{const t=E(e[1],r[1]);h[t.name]=t.value,g(S)}}},E=(e,t)=>{if(e.includes(".")){const[o,r]=e.split(".");return{name:o,value:`{${r}: ${t}}`}}return["color",":color",":effects","effects"].includes(e)?_(e,t):{name:e,value:t}},_=(e,t)=>{let o=t,r=w(o,null);if(null===r){const e=/'([^']+)'/g;let i,n=0,s="";for(;null!==(i=e.exec(t));){const e=i[1],o=i.index,a=i[0].length;s+=t.slice(n,o),r=w(e,null),s+=null===r?t.slice(o,o+a):`'${r}'`,n=o+a}s+=t.slice(n),o=s}else o=r;return{name:e,value:o}},C=e=>{let o=[],r=!1,i={children:[]},n=i;for(let s=0;s<e.length;s++){let i=e[s];if(0===i[a.level]&&"closing"!==i[a.type]){if(r)throw k("MultipleTopLevelTags",i);if(void 0!==i[":for"])throw k("ForAttributeOnRootElement",i);r=!0}if("opening"===i[a.type])o.push({[a.level]:i[a.level],[a.type]:i[a.type],[a.cursorTagStart]:i[a.cursorTagStart],[Symbol.for("componentType")]:i[Symbol.for("componentType")],parent:n});else if("closing"===i[a.type]){const e=0===o.length;let t=!1,r=!1;if(e||(t=o[o.length-1][a.level]!==i[a.level],r=o[o.length-1][Symbol.for("componentType")]!==i[Symbol.for("componentType")]),e||t||r)throw k("MismatchedClosingTag",i);n=o.pop().parent}const l=t({},i);delete l[a.type],delete l[a.level],delete l[a.cursorTagStart],"opening"===i[a.type]?(s+1<e.length&&"closing"!==e[s+1][a.type]&&(l.children=[]),n.children.push(l),n=l):"self-closing"===i[a.type]&&n.children.push(l)}if(o.length>0)throw k("UnclosedTags",o);return i},A=t=>{t=`${t} in ${O()}`;const o=new Error(t);o.name="TemplateParseError";const r=Math.max(0,s-10),i=Math.min(e.length,n+50),a=e.slice(r,i),l=n-r;return o.context=M(l,a),o},k=(t,o)=>{t=`${t} in ${O()}`;const r=new Error(t);function i(t){const o=Math.max(0,t[a.cursorTagStart]-10),r=e.slice(o,o+50);return M(10,r)}return r.name="TemplateStructureError",Array.isArray(o)?r.context=o.map(e=>i(e)).join("\n"):r.context=i(o),r},M=(e,t)=>`\n${t}\n${" ".repeat(e)+"^"}\n`,O=()=>i||"Blits.Application";return(()=>{e=y(e);try{return g(v),C(l)}catch(t){throw"TemplateParseError"!=t.name&&"TemplateStructureError"!=t.name||(t.message=`${t.message}\n${t.context}`),t}})()})(o.template))),i.call(Object.create(r),n,s,l,h)};return n[Symbol.for("config")]=o,n[a.isComponent]=!0,n},dn={Component:hn,Application:e=>{let o,r,i;e.hooks=e.hooks||{};let n=0,s=null;return e.hooks[a.destroy]=function(){document.removeEventListener("keydown",o),document.removeEventListener("keyup",r)},e.hooks[a.init]=function(){this.$announcer.toggle(h.get("announcer",!1));const e=h.get("announcerOptions",null);e&&"object"==typeof e&&this.$announcer.configure(e),Bi=t(t({},lr),h.get("keymap",{}));const l=h.get("inputThrottle",0);o=async e=>{const t=performance.now(),o=Bi[e.key]||Bi[e.keyCode]||e.key||e.keyCode,r=s===o;if(s=o,0===l||!0===e[a.internalEvent]||!1===r)return await d.call(this,e,o);t-n<l||(n=t,await d.call(this,e,o))};const d=async function(e,t){void 0!==this[a.inputEvents]&&void 0!==this[a.inputEvents].intercept&&(e=await this[a.inputEvents].intercept.call(this,e))instanceof KeyboardEvent==!1||(Ai.input(t,e),clearTimeout(i),i=setTimeout(()=>{Ai.hold=!0},h.get("holdTimeout",50)))};r=e=>{const t=Ci.get(e.code);void 0!==t&&"function"==typeof t&&(Ci.delete(e.code),t()),clearTimeout(i),Ai.hold=!1},document.addEventListener("keydown",o),document.addEventListener("keyup",r),setTimeout(()=>Ai.set(this))},hn("App",e)},Launch:(e,t,o)=>{h.set(o),f=p("Blits"),async function(){let e;try{if(e=await ne(()=>i.import("./package-legacy-CXRM8mj1.js"),0,i.meta.url),void 0!==e)return e.version}catch(t){return Or["@lightningjs/renderer"]}}().then(e=>{f.info("Blits Version ",Mr),f.info("Renderer Version ",e)}),Pr.element=Ar,Ir=kr(e,t,o)},Plugin:sn};function cn(e,t="w1280"){return`https://image.tmdb.org/t/p/${t}${e}?api_key=c1e672f11dd715c09878f04137c94ba1`}const un=dn.Component("FocusBorder",{code:{render:function(e,t,o,r,i,n,s){const a=[],l=[];return l[0]={},a[0]=this.element({parent:e||"root"},t),l[0].y=t.calc,l[0].x=t.calc,l[0].w=t.width,l[0].h=t.height,l[0].effects=[{type:"radius",props:{radius:t.radius}},{type:"border",props:{width:t.bWidth,color:"0xffffffff"}}],a[0].populate(l[0]),{elms:a,cleanup:()=>{e=null,t=null,a.length=0,r.length=0,l.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("y",e.calc)},function(e,t,o,r,i,n){t[0].set("x",e.calc)},function(e,t,o,r,i,n){t[0].set("effects",[{type:"radius",props:{radius:e.radius}},{type:"border",props:{width:e.bWidth,color:"0xffffffff"}}])}],context:{}},props:["width","height","x","y",{key:"bWidth",default:8},{key:"radius",default:6}],computed:{calc(){return this.bWidth,-this.bWidth/2}}}),pn=""+new URL("red-CM8haZ7A.png",i.meta.url).href,fn=dn.Component("Card",{props:["key","items"],components:{FocusBorder:un},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[];let c,u,p,f=!1,m=0,g=[];if(l[0]={},a[0]=this.element({parent:e||"root"},!0===f?p:t),l[0].w=t.items.width,l[0].h=t.items.height,l[0].direction="vertical",l[0].scale=t.hasFocus?1.1:1,l[0].__layout=!0,a[0].populate(l[0]),!0===f&&(m-=1),g[1]=o.components&&o.components.FocusBorder||r.FocusBorder,e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},!0===f?p:t),l[1].width=t.items.width+6,l[1].height=t.items.height+6,l[1].bWidth=6,l[1].alpha=t.hasFocus?1:0,l[1].radius=t.items.radius,d[1]=[],void 0!==g[1])for(let y in g[1][Symbol.for("config")].props)delete l[1][g[1][Symbol.for("config")].props[y]],d[1].push(g[1][Symbol.for("config")].props[y]);if(a[1].populate(l[1]),!0===f&&(m-=1),e=a[1],h[2]={},h[2].width=t.items.width+6,h[2].height=t.items.height+6,h[2].bWidth=6,u=t.hasFocus?1:0,!0===Array.isArray(u)&&(u=n(u).slice(0)),h[2].alpha=u,u=t.items.radius,!0===Array.isArray(u)&&(u=n(u).slice(0)),h[2].radius=u,c=h[2].is||"FocusBorder",r[2],"string"==typeof c){if(r[2]=o.components&&o.components[c]||r[c],!r[2])throw new Error('Component "FocusBorder" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[2]=c);return a[2]=r[2].call(null,{props:h[2]},a[1],t),a[2][Symbol.for("slots")][0]?(e=a[2][Symbol.for("slots")][0],p=a[2],f=!0):e=a[2][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),e=a[0],l[3]={},a[3]=this.element({parent:e||"root"},!0===f?p:t),a[3].populate(l[3]),!0===f&&(m-=1),e=a[3],l[4]={},a[4]=this.element({parent:e||"root"},!0===f?p:t),l[4].w=t.items.width-2,l[4].h=t.items.height-2,l[4].x=1,l[4].y=1,l[4].effects=[{type:"radius",props:{radius:t.items.radius}}],l[4].src="assets/red.png",l[4].color="0x808080ff",l[4].fit="{ type: 'cover', position: { x: 0.5 } }",a[4].populate(l[4]),!0===f&&(m-=1),e=a[3],l[5]={},a[5]=this.element({parent:e||"root"},!0===f?p:t),l[5].w=t.items.width,l[5].h=t.items.height,l[5].effects=[{type:"radius",props:{radius:t.items.radius}}],l[5].src=t.backdrop,l[5].fit="{ type: 'cover', position: { x: 0.5 } }",l[5]["@loaded"]=t.revealPage&&t.revealPage.bind(t),l[5]["@error"]=t.showFallback&&t.showFallback.bind(t),a[5].populate(l[5]),!0===f&&(m-=1),e=a[0],l[6]={},a[6]=this.element({parent:e||"root"},!0===f?p:t),l[6].content=t.items.text,l[6].y=t.items.height,l[6].width=t.items.width,l[6].align="center",l[6].textoverflow=!0,l[6].maxlines=1,l[6].contain="width",l[6].size=16,l[6].color="0xffffffff",l[6].font="PoppinsSemiBold",l[6].__textnode=!0,a[6].populate(l[6]),!0===f&&(m-=1),e=a[0],l[7]={},a[7]=this.element({parent:e||"root"},!0===f?p:t),l[7].content=t.items.subText,l[7].y=t.items.height,l[7].width=t.items.width,l[7].align="center",l[7].textoverflow=!0,l[7].maxlines=1,l[7].contain="width",l[7].size=16,l[7].color="0x909090ff",l[7].font="PoppinsSemiBold",l[7].__textnode=!0,a[7].populate(l[7]),!0===f&&(m-=1),{elms:a,cleanup:()=>{u=null,p=null,e=null,g[1]=null,h[2]=null,r[2]=null,t=null,g.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("scale",e.hasFocus?1.1:1)},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[1]&&-1!==skips[1].indexOf("alpha")||t[1].set("alpha",e.hasFocus?1:0)},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[1]&&-1!==skips[1].indexOf("radius")||t[1].set("radius",e.items.radius)},function(e,t,o,r,i,n){t[2][Symbol.for("props")].alpha=e.hasFocus?1:0},function(e,t,o,r,i,n){t[2][Symbol.for("props")].radius=e.items.radius},function(e,t,o,r,i,n){t[4].set("effects",[{type:"radius",props:{radius:e.items.radius}}])},function(e,t,o,r,i,n){t[4].set("src","assets/red.png")},function(e,t,o,r,i,n){t[5].set("effects",[{type:"radius",props:{radius:e.items.radius}}])}],context:{}},state:()=>({backdrop:pn}),hooks:{init(){this.backdrop=this.items.data.backdrop_path?cn(this.items.data.backdrop_path,"w300"):cn(this.items.data.poster_path,"w300")},idle(){},focus(){this.$emit("changeBackground",{img:this.backdrop})}},input:{enter(){console.log("onEnter",this.items.onEnter),this.$router.to(this.items.onEnter(this.items.data.id),{inHistory:!1})}},methods:{revealPage(e){this.show=!0},showFallback(e){this.showBackupImage()}}}),mn=dn.Component("Button",{code:{render:function(e,t,o,r,i,n,s){const a=[],l=[];return l[0]={},a[0]=this.element({parent:e||"root"},t),l[0].ref="button",l[0].color=t.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x00000000",l[0].padding=16,l[0].effects=[{type:"radius",props:{radius:25}}],l[0].__layout=!0,a[0].populate(l[0]),e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},t),l[1].content="Season 213123132213",l[1].__textnode=!0,a[1].populate(l[1]),{elms:a,cleanup:()=>{e=null,t=null,a.length=0,r.length=0,l.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("color",e.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x00000000")},function(e,t,o,r,i,n){t[0].set("effects",[{type:"radius",props:{radius:25}}])}],context:{}},hooks:{focus(){this.$trigger("focused")}},methods:{focused(){const e=this.$select("button");e&&e.$focus&&e.$focus()}}}),gn=dn.Component("List",{components:{Card:fn,Button:mn},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[],c=[],u={},p=[];let f,m,g,y,x,v=!1,b=[];l[0]={},a[0]=this.element({parent:e||"root"},!0===v?g:t),l[0].x={transition:t.x},a[0].populate(l[0]),e=a[0],c[1]=[],u[1]=[],h[1]=(s=[],a,h)=>{const c=n(s),w=new Set;let T=c.length;const S={}||{};y=S.from||0,x="to"in S?S.to:c.length;for(;T--;)c[T],T<x&&T>=y&&w.add(""+T);let R=h.length;for(;R--;)if(!1===w.has(h[R])){const e=h[R];a[1][e]&&a[1][e].destroy(),a[1][e]=null,delete a[1][e],a[2][e]&&a[2][e].destroy(),a[2][e]=null,delete a[2][e]}h.length=0;const E=c.length;null!==t&&t[Symbol.for("removeGlobalEffects")](u[1]);for(let e=0;e<u[1].length;e++){const o=u[1][e],r=t[Symbol.for("effects")].indexOf(o);r>-1&&t[Symbol.for("effects")].splice(r,1)}u[1].length=0;for(let _=0;_<E;_++){if(_<y||_>=x)continue;let s=Object.create(t);if(e=a[0],s.item=c[_],s.index=_,s.key=""+_,h.push(s.key),b[1]=o.components&&o.components.Component||r.Component,void 0===a[1]&&(a[1]={}),l[1]={},void 0===a[1][s.key]&&(a[1][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[1].is=s.item.type,l[1].item=s.item,l[1].x=s.index*s.totalWidth,l[1].ref="list-item-"+s.item.data.id,l[1].key=s.item.data.id,p[1]=[],void 0!==b[1])for(let e in b[1][Symbol.for("config")].props)delete l[1][b[1][Symbol.for("config")].props[e]],p[1].push(b[1][Symbol.for("config")].props[e]);if(void 0===a[1][s.key].nodeId&&a[1][s.key].populate(l[1]),void 0===a[2]&&(a[2]={}),e=a[1][s.key],d[2]={},void 0===a[2][s.key]){if(d[2].is=s.item.type,m=s.item,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].item=m,m=s.index*s.totalWidth,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].x=m,m="list-item-"+s.item.data.id,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].ref=m,m=s.item.data.id,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].key=m,f=d[2].is||"Component",r[2],"string"==typeof f){if(r[2]=o.components&&o.components[f]||r[f],!r[2])throw new Error('Component "Component" not found')}else"function"==typeof f&&!0===f[Symbol.for("isComponent")]&&(r[2]=f);a[2][s.key]=r[2].call(null,{props:d[2]},a[1][s.key],t),a[2][s.key][Symbol.for("slots")][0]?(e=a[2][s.key][Symbol.for("slots")][0],g=a[2][s.key],v=!0):e=a[2][s.key][Symbol.for("children")][0]}let w=()=>{void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("ref")||a[1][s.key].set("ref","list-item-"+s.item.data.id)};i(w,null),u[1].push(w),t[Symbol.for("effects")].push(w);let T=()=>{void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("key")||a[1][s.key].set("key",s.item.data.id)};i(T,null),u[1].push(T),t[Symbol.for("effects")].push(T),a[2][s.key][Symbol.for("props")].ref="list-item-"+s.item.data.id,a[2][s.key][Symbol.for("props")].key=s.item.data.id}return u};let w=()=>{h[1](t.items,a,c[1])};t[Symbol.for("effects")].push(w),i(w,["items"]);let T=()=>{t.item;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("item")||a[1][o.key].set("item",o.item)}};t[Symbol.for("effects")].push(T),i(T);let S=()=>{t.totalWidth;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("x")||a[1][o.key].set("x",o.index*t.totalWidth)}};t[Symbol.for("effects")].push(S),i(S);let R=()=>{t.item;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[2][o.key][Symbol.for("props")].item=o.item}};t[Symbol.for("effects")].push(R),i(R);let E=()=>{t.totalWidth;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[2][o.key][Symbol.for("props")].x=o.index*t.totalWidth}};return t[Symbol.for("effects")].push(E),i(E),{elms:a,cleanup:()=>{m=null,g=null,e=null,c[1].length=0,b[1]=null,d[2]=null,r[2]=null,w=null,h[1]([],a,c[1]),h[1]=null,T=null,S=null,R=null,E=null,t=null,b.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0,p.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("x",{transition:e.x})}],context:{}},props:["autoScroll","autoscrollOffset","itemOffset","itemHeight","itemWidth","items","looping","containerWidth"],state:()=>({focused:0,x:0,borderWidth:0}),computed:{totalWidth(){return this.items,this.itemOffset,(this.items[0].width||300)+(this.itemOffset||0)}},hooks:{focus(){var e;this.$trigger("focused"),null===(e=this.$select(`list-item-${this.items[this.focused].data.id}`))||void 0===e||e.$focus()}},watch:{hasFocus(e){e&&this.$trigger("focused")},focused(e){const t=this.$select(`list-item-${this.items[e].data.id}`);t&&t.$focus&&(t.$focus(),this.scrollToFocus())}},methods:{changeFocus(e){const t=this.looping?(this.focused+e+this.items.length)%this.items.length:Math.max(0,Math.min(this.focused+e,this.items.length-1));this.focused=t},scrollToFocus(){this.autoScroll&&(this.x=0-(this.items.length-1770/(this.items[0].width+this.itemOffset)<0?0:Math.min(this.focused,this.items.length-1770/(this.items[0].width+this.itemOffset))*(this.items[0].width+this.itemOffset)))}},input:{left(){this.changeFocus(-1)},right(){this.changeFocus(1)},enter(){console.log("Selected item:",this.items[this.focused])}}}),yn=dn.Component("HorizontalContainer",{components:{Card:fn,Button:mn},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[],c=[],u={},p=[];let f,m,g,y,x,v=!1,b=[];l[0]={},a[0]=this.element({parent:e||"root"},!0===v?g:t),l[0].x={transition:t.x},l[0].ref="container",a[0].populate(l[0]),e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},!0===v?g:t),l[1].content=t.title,l[1].color="0xffffffff",l[1].h=50,l[1].__textnode=!0,a[1].populate(l[1]),e=a[0],c[2]=[],u[2]=[],h[2]=(s=[],a,h)=>{var c,w;const T=n(s),S=new Set;let R=T.length;const E={from:null===(c=t)||void 0===c?void 0:c.rangeFrom,to:null===(w=t)||void 0===w?void 0:w.rangeTo}||{};y=E.from||0,x="to"in E?E.to:T.length;for(;R--;)T[R],R<x&&R>=y&&S.add(""+R);let _=h.length;for(;_--;)if(!1===S.has(h[_])){const e=h[_];a[2][e]&&a[2][e].destroy(),a[2][e]=null,delete a[2][e],a[3][e]&&a[3][e].destroy(),a[3][e]=null,delete a[3][e]}h.length=0;const C=T.length;null!==t&&t[Symbol.for("removeGlobalEffects")](u[2]);for(let e=0;e<u[2].length;e++){const o=u[2][e],r=t[Symbol.for("effects")].indexOf(o);r>-1&&t[Symbol.for("effects")].splice(r,1)}u[2].length=0;for(let A=0;A<C;A++){if(A<y||A>=x)continue;let s=Object.create(t);if(e=a[0],s.item=T[A],s.index=A,s.key=""+A,h.push(s.key),b[2]=o.components&&o.components.Component||r.Component,void 0===a[2]&&(a[2]={}),l[2]={},void 0===a[2][s.key]&&(a[2][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[2].is=s.item.type,l[2].x=s.rowX(s.index),l[2].y=s.title?50:0,l[2].ref="list-item-"+s.index,l[2].key=s.index,l[2].items=s.item.items?s.item.items:s.item,l[2].autoScroll=!0,p[2]=[],void 0!==b[2])for(let e in b[2][Symbol.for("config")].props)delete l[2][b[2][Symbol.for("config")].props[e]],p[2].push(b[2][Symbol.for("config")].props[e]);if(void 0===a[2][s.key].nodeId&&a[2][s.key].populate(l[2]),void 0===a[3]&&(a[3]={}),e=a[2][s.key],d[3]={},void 0===a[3][s.key]){if(d[3].is=s.item.type,m=s.rowX(s.index),!0===Array.isArray(m)&&(m=n(m).slice(0)),d[3].x=m,m=s.title?50:0,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[3].y=m,m="list-item-"+s.index,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[3].ref=m,m=s.index,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[3].key=m,m=s.item.items?s.item.items:s.item,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[3].items=m,d[3].autoScroll=!0,f=d[3].is||"Component",r[3],"string"==typeof f){if(r[3]=o.components&&o.components[f]||r[f],!r[3])throw new Error('Component "Component" not found')}else"function"==typeof f&&!0===f[Symbol.for("isComponent")]&&(r[3]=f);a[3][s.key]=r[3].call(null,{props:d[3]},a[2][s.key],t),a[3][s.key][Symbol.for("slots")][0]?(e=a[3][s.key][Symbol.for("slots")][0],g=a[3][s.key],v=!0):e=a[3][s.key][Symbol.for("children")][0]}let c=()=>{void 0!==p&&void 0!==p[2]&&-1!==p[2].indexOf("ref")||a[2][s.key].set("ref","list-item-"+s.index)};i(c,null),u[2].push(c),t[Symbol.for("effects")].push(c);let w=()=>{void 0!==p&&void 0!==p[2]&&-1!==p[2].indexOf("key")||a[2][s.key].set("key",s.index)};i(w,null),u[2].push(w),t[Symbol.for("effects")].push(w),a[3][s.key][Symbol.for("props")].ref="list-item-"+s.index,a[3][s.key][Symbol.for("props")].key=s.index}return u};let w=()=>{h[2](t.items,a,c[2])};t[Symbol.for("effects")].push(w),i(w,["items","rangeFrom","rangeTo"]);let T=()=>{t.rowX;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[2]&&-1!==p[2].indexOf("x")||a[2][o.key].set("x",t.rowX(o.index))}};t[Symbol.for("effects")].push(T),i(T);let S=()=>{t.title;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[2]&&-1!==p[2].indexOf("y")||a[2][o.key].set("y",t.title?50:0)}};t[Symbol.for("effects")].push(S),i(S);let R=()=>{t.item;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[2]&&-1!==p[2].indexOf("items")||a[2][o.key].set("items",o.item.items?o.item.items:o.item)}};t[Symbol.for("effects")].push(R),i(R);let E=()=>{t.rowX;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[3][o.key][Symbol.for("props")].x=t.rowX(o.index)}};t[Symbol.for("effects")].push(E),i(E);let _=()=>{t.title;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[3][o.key][Symbol.for("props")].y=t.title?50:0}};t[Symbol.for("effects")].push(_),i(_);let C=()=>{t.item;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[3][o.key][Symbol.for("props")].items=o.item.items?o.item.items:o.item}};return t[Symbol.for("effects")].push(C),i(C),{elms:a,cleanup:()=>{m=null,g=null,e=null,c[2].length=0,b[2]=null,d[3]=null,r[3]=null,w=null,h[2]([],a,c[2]),h[2]=null,T=null,S=null,R=null,E=null,_=null,C=null,t=null,b.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0,p.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("x",{transition:e.x})}],context:{}},props:["autoScroll","autoscrollOffset","itemOffset","items","looping","title",{key:"gap",default:50}],state:()=>({focused:0,x:0,rangeFrom:0,rangeTo:5}),hooks:{init(){console.log(this.items)}},watch:{hasFocus(e){e&&this.$trigger("focused")},focused(e){const t=this.$select(`list-item-${e}`);t&&t.$focus&&(t.$focus(),this.scroll()),this.rangeFrom=this.focused+Math.min(-1,this.lastIndexToScroll-1-this.focused),this.rangeTo=this.focused+5,console.log("Range from ",this.rangeFrom," rangeTo",this.rangeTo)}},computed:{rangeStart(){return this.focused,console.log("Previous ",this.focused-1),this.focused-1},rangeEnd(){return this.focused,console.log("Next",this.focused+1),this.focused+5},itemTotalWidth(){return this.items,this.gap,this.items[0].width+this.gap},visibleCount(){return this.itemTotalWidth,1770/this.itemTotalWidth},lastIndexToScroll(){return this.items,this.visibleCount,this.items.length-this.visibleCount}},methods:{changeFocus(e){const t=this.looping?(this.focused+e+this.items.length)%this.items.length:Math.max(0,Math.min(this.focused+e,this.items.length-1));this.focused=t},rowOffset(e){return 0===e?0:this.items.slice(0,e).reduce((e,t)=>e+(null!=t&&t.items?null==t?void 0:t.items[0].width:t.width)+this.gap,0)},rowX(e){return this.rowOffset(e)},scroll(){this.autoScroll&&(this.x=0-(this.lastIndexToScroll<0?0:Math.min(this.focused,this.lastIndexToScroll)*this.itemTotalWidth)),console.log(this.x)}},input:{left(){this.changeFocus(-1)},right(){this.changeFocus(1)},enter(){console.log("Selected item:",this.items[this.focused])}}}),xn=dn.Component("Column",{props:["items","itemOffset","autoScroll","looping"],components:{List:gn,HorizontalContainer:yn},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[],c=[],u={},p=[];let f,m,g,y,x,v=!1,b=[];l[0]={},a[0]=this.element({parent:e||"root"},!0===v?g:t),l[0].w=1920,l[0].y={transition:t.y},l[0].ref="columnCont",a[0].populate(l[0]),e=a[0],c[1]=[],u[1]=[],h[1]=(s=[],a,h)=>{const c=n(s),w=new Set;let T=c.length;const S={}||{};y=S.from||0,x="to"in S?S.to:c.length;for(;T--;)c[T],T<x&&T>=y&&w.add(""+T);let R=h.length;for(;R--;)if(!1===w.has(h[R])){const e=h[R];a[1][e]&&a[1][e].destroy(),a[1][e]=null,delete a[1][e],a[2][e]&&a[2][e].destroy(),a[2][e]=null,delete a[2][e],a[3][e]&&a[3][e].destroy(),a[3][e]=null,delete a[3][e],a[4][e]&&a[4][e].destroy(),a[4][e]=null,delete a[4][e],a[5][e]&&a[5][e].destroy(),a[5][e]=null,delete a[5][e]}h.length=0;const E=c.length;null!==t&&t[Symbol.for("removeGlobalEffects")](u[1]);for(let e=0;e<u[1].length;e++){const o=u[1][e],r=t[Symbol.for("effects")].indexOf(o);r>-1&&t[Symbol.for("effects")].splice(r,1)}u[1].length=0;for(let _=0;_<E;_++){if(_<y||_>=x)continue;let s=Object.create(t);if(e=a[0],s.item=c[_],s.index=_,s.key=""+_,h.push(s.key),e=a[0],void 0===a[1]&&(a[1]={}),l[1]={},void 0===a[1][s.key]&&(a[1][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[1].x=64,l[1].y=s.rowY(s.index),void 0===a[1][s.key].nodeId&&a[1][s.key].populate(l[1]),e=a[1][s.key],void 0===a[2]&&(a[2]={}),l[2]={},void 0===a[2][s.key]&&(a[2][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[2].w=103,l[2].h=29,l[2].content=s.item.name,l[2].font="InterBold",l[2].size=24,l[2].letterspacing=6,l[2].__textnode=!0,void 0===a[2][s.key].nodeId&&a[2][s.key].populate(l[2]),e=a[1][s.key],void 0===a[3]&&(a[3]={}),l[3]={},void 0===a[3][s.key]&&(a[3][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[3].w=1*e.node.width,l[3].h=s.item.height,l[3].y=39,l[3].overflow=!0,l[3].ref="backgroundEl",void 0===a[3][s.key].nodeId&&a[3][s.key].populate(l[3]),b[4]=o.components&&o.components.HorizontalContainer||r.HorizontalContainer,e=a[3][s.key],void 0===a[4]&&(a[4]={}),l[4]={},void 0===a[4][s.key]&&(a[4][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[4].items=s.item.movies,l[4].type=s.item.type,l[4].itemWidth=s.item.width,l[4].itemHeight=s.item.height,l[4].ref="cardRow"+s.index,l[4].autoScroll=!0,l[4].looping=!0,l[4].itemOffset=s.item.itemOffset||30,l[4].wBorder=s.item.wBorder,p[4]=[],void 0!==b[4])for(let e in b[4][Symbol.for("config")].props)delete l[4][b[4][Symbol.for("config")].props[e]],p[4].push(b[4][Symbol.for("config")].props[e]);if(void 0===a[4][s.key].nodeId&&a[4][s.key].populate(l[4]),void 0===a[5]&&(a[5]={}),e=a[4][s.key],d[5]={},void 0===a[5][s.key]){if(m=s.item.movies,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].items=m,m=s.item.type,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].type=m,m=s.item.width,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].itemWidth=m,m=s.item.height,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].itemHeight=m,m="cardRow"+s.index,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].ref=m,d[5].autoScroll=!0,d[5].looping=!0,m=s.item.itemOffset||30,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].itemOffset=m,m=s.item.wBorder,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[5].wBorder=m,f=d[5].is||"HorizontalContainer",r[5],"string"==typeof f){if(r[5]=o.components&&o.components[f]||r[f],!r[5])throw new Error('Component "HorizontalContainer" not found')}else"function"==typeof f&&!0===f[Symbol.for("isComponent")]&&(r[5]=f);a[5][s.key]=r[5].call(null,{props:d[5]},a[4][s.key],t),a[5][s.key][Symbol.for("slots")][0]?(e=a[5][s.key][Symbol.for("slots")][0],g=a[5][s.key],v=!0):e=a[5][s.key][Symbol.for("children")][0]}let w=()=>{a[2][s.key].set("content",s.item.name)};i(w,null),u[1].push(w),t[Symbol.for("effects")].push(w);let T=()=>{a[3][s.key].set("h",s.item.height)};i(T,null),u[1].push(T),t[Symbol.for("effects")].push(T);let S=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("items")||a[4][s.key].set("items",s.item.movies)};i(S,null),u[1].push(S),t[Symbol.for("effects")].push(S);let R=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("type")||a[4][s.key].set("type",s.item.type)};i(R,null),u[1].push(R),t[Symbol.for("effects")].push(R);let E=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("itemWidth")||a[4][s.key].set("itemWidth",s.item.width)};i(E,null),u[1].push(E),t[Symbol.for("effects")].push(E);let C=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("itemHeight")||a[4][s.key].set("itemHeight",s.item.height)};i(C,null),u[1].push(C),t[Symbol.for("effects")].push(C);let A=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("ref")||a[4][s.key].set("ref","cardRow"+s.index)};i(A,null),u[1].push(A),t[Symbol.for("effects")].push(A);let k=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("itemOffset")||a[4][s.key].set("itemOffset",s.item.itemOffset||30)};i(k,null),u[1].push(k),t[Symbol.for("effects")].push(k);let M=()=>{void 0!==p&&void 0!==p[4]&&-1!==p[4].indexOf("wBorder")||a[4][s.key].set("wBorder",s.item.wBorder)};i(M,null),u[1].push(M),t[Symbol.for("effects")].push(M),a[5][s.key][Symbol.for("props")].items=s.item.movies,a[5][s.key][Symbol.for("props")].type=s.item.type,a[5][s.key][Symbol.for("props")].itemWidth=s.item.width,a[5][s.key][Symbol.for("props")].itemHeight=s.item.height,a[5][s.key][Symbol.for("props")].ref="cardRow"+s.index,a[5][s.key][Symbol.for("props")].itemOffset=s.item.itemOffset||30,a[5][s.key][Symbol.for("props")].wBorder=s.item.wBorder}return u};let w=()=>{h[1](t.items,a,c[1])};t[Symbol.for("effects")].push(w),i(w,["items"]);let T=()=>{t.rowY;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[1][o.key].set("y",t.rowY(o.index))}};return t[Symbol.for("effects")].push(T),i(T),{elms:a,cleanup:()=>{m=null,g=null,e=null,c[1].length=0,b[4]=null,d[5]=null,r[5]=null,w=null,h[1]([],a,c[1]),h[1]=null,T=null,t=null,b.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0,p.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("y",{transition:e.y})}],context:{}},state:()=>({y:0,focused:0}),hooks:{async init(){this.$trigger("focused")},focus(){this.$trigger("focused")}},watch:{focused(e){const t=this.$select("cardRow"+e);t&&t.$focus&&t.$focus()}},input:{up(){this.focused=0===this.focused&&this.looping?this.focused=this.items.length-1:Math.max(this.focused-1,0),this.scroll()},down(){this.focused=this.focused===this.items.length-1&&this.looping?this.focused=0:Math.min(this.focused+1,this.items.length-1),this.scroll()}},methods:{rowY(e){return 0===e?0:this.items.slice(0,e).reduce((e,t)=>e+29+24+t.height+this.itemOffset,0)},scroll(){this.autoScroll&&(this.y=0===this.focused?0:-this.items.slice(0,this.focused).reduce((e,t)=>e+29+24+t.type.height+this.itemOffset,0))}}});function vn(e,t){return function(){return e.apply(t,arguments)}}const{toString:bn}=Object.prototype,{getPrototypeOf:wn}=Object,{iterator:Tn,toStringTag:Sn}=Symbol,Rn=(En=Object.create(null),e=>{const t=bn.call(e);return En[t]||(En[t]=t.slice(8,-1).toLowerCase())});var En;const _n=e=>(e=e.toLowerCase(),t=>Rn(t)===e),Cn=e=>t=>typeof t===e,{isArray:An}=Array,kn=Cn("undefined");function Mn(e){return null!==e&&!kn(e)&&null!==e.constructor&&!kn(e.constructor)&&Pn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const On=_n("ArrayBuffer");const In=Cn("string"),Pn=Cn("function"),Ln=Cn("number"),Fn=e=>null!==e&&"object"==typeof e,Bn=e=>{if("object"!==Rn(e))return!1;const t=wn(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Sn in e||Tn in e)},Un=_n("Date"),$n=_n("File"),Nn=_n("Blob"),Dn=_n("FileList"),jn=_n("URLSearchParams"),[zn,Wn,Xn,Gn]=["ReadableStream","Request","Response","Headers"].map(_n);function Vn(e,t,{allOwnKeys:o=!1}={}){if(null==e)return;let r,i;if("object"!=typeof e&&(e=[e]),An(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{if(Mn(e))return;const i=o?Object.getOwnPropertyNames(e):Object.keys(e),n=i.length;let s;for(r=0;r<n;r++)s=i[r],t.call(null,e[s],s,e)}}function Hn(e,t){if(Mn(e))return null;t=t.toLowerCase();const o=Object.keys(e);let r,i=o.length;for(;i-- >0;)if(r=o[i],t===r.toLowerCase())return r;return null}const Yn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,qn=e=>!kn(e)&&e!==Yn;const Kn=(Qn="undefined"!=typeof Uint8Array&&wn(Uint8Array),e=>Qn&&e instanceof Qn);var Qn;const Zn=_n("HTMLFormElement"),Jn=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),es=_n("RegExp"),ts=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),r={};Vn(o,(o,i)=>{let n;!1!==(n=t(o,i,e))&&(r[i]=n||o)}),Object.defineProperties(e,r)};const os=_n("AsyncFunction"),rs=(is="function"==typeof setImmediate,ns=Pn(Yn.postMessage),is?setImmediate:ns?(ss=`axios@${Math.random()}`,as=[],Yn.addEventListener("message",({source:e,data:t})=>{e===Yn&&t===ss&&as.length&&as.shift()()},!1),e=>{as.push(e),Yn.postMessage(ss,"*")}):e=>setTimeout(e));var is,ns,ss,as;const ls="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Yn):"undefined"!=typeof process&&process.nextTick||rs,hs={isArray:An,isArrayBuffer:On,isBuffer:Mn,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Pn(e.append)&&("formdata"===(t=Rn(e))||"object"===t&&Pn(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&On(e.buffer),t},isString:In,isNumber:Ln,isBoolean:e=>!0===e||!1===e,isObject:Fn,isPlainObject:Bn,isEmptyObject:e=>{if(!Fn(e)||Mn(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(t){return!1}},isReadableStream:zn,isRequest:Wn,isResponse:Xn,isHeaders:Gn,isUndefined:kn,isDate:Un,isFile:$n,isBlob:Nn,isRegExp:es,isFunction:Pn,isStream:e=>Fn(e)&&Pn(e.pipe),isURLSearchParams:jn,isTypedArray:Kn,isFileList:Dn,forEach:Vn,merge:function e(){const{caseless:t,skipUndefined:o}=qn(this)&&this||{},r={},i=(i,n)=>{const s=t&&Hn(r,n)||n;Bn(r[s])&&Bn(i)?r[s]=e(r[s],i):Bn(i)?r[s]=e({},i):An(i)?r[s]=i.slice():o&&kn(i)||(r[s]=i)};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Vn(arguments[n],i);return r},extend:(e,t,o,{allOwnKeys:r}={})=>(Vn(t,(t,r)=>{o&&Pn(t)?Object.defineProperty(e,r,{value:vn(t,o),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,r,{value:t,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,o,r)=>{e.prototype=Object.create(t.prototype,r),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},toFlatObject:(e,t,o,r)=>{let i,n,s;const a={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),n=i.length;n-- >0;)s=i[n],r&&!r(s,e,t)||a[s]||(t[s]=e[s],a[s]=!0);e=!1!==o&&wn(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},kindOf:Rn,kindOfTest:_n,endsWith:(e,t,o)=>{e=String(e),(void 0===o||o>e.length)&&(o=e.length),o-=t.length;const r=e.indexOf(t,o);return-1!==r&&r===o},toArray:e=>{if(!e)return null;if(An(e))return e;let t=e.length;if(!Ln(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},forEachEntry:(e,t)=>{const o=(e&&e[Tn]).call(e);let r;for(;(r=o.next())&&!r.done;){const o=r.value;t.call(e,o[0],o[1])}},matchAll:(e,t)=>{let o;const r=[];for(;null!==(o=e.exec(t));)r.push(o);return r},isHTMLForm:Zn,hasOwnProperty:Jn,hasOwnProp:Jn,reduceDescriptors:ts,freezeMethods:e=>{ts(e,(t,o)=>{if(Pn(e)&&-1!==["arguments","caller","callee"].indexOf(o))return!1;const r=e[o];Pn(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")}))})},toObjectSet:(e,t)=>{const o={},r=e=>{e.forEach(e=>{o[e]=!0})};return An(e)?r(e):r(String(e).split(t)),o},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,o){return t.toUpperCase()+o}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Hn,global:Yn,isContextDefined:qn,isSpecCompliantForm:function(e){return!!(e&&Pn(e.append)&&"FormData"===e[Sn]&&e[Tn])},toJSONObject:e=>{const t=new Array(10),o=(e,r)=>{if(Fn(e)){if(t.indexOf(e)>=0)return;if(Mn(e))return e;if(!("toJSON"in e)){t[r]=e;const i=An(e)?[]:{};return Vn(e,(e,t)=>{const n=o(e,r+1);!kn(n)&&(i[t]=n)}),t[r]=void 0,i}}return e};return o(e,0)},isAsyncFn:os,isThenable:e=>e&&(Fn(e)||Pn(e))&&Pn(e.then)&&Pn(e.catch),setImmediate:rs,asap:ls,isIterable:e=>null!=e&&Pn(e[Tn])};let ds=class e extends Error{static from(t,o,r,i,n,s){const a=new e(t.message,o||t.code,r,i,n);return a.cause=t,a.name=t.name,s&&Object.assign(a,s),a}constructor(e,t,o,r,i){super(e),this.name="AxiosError",this.isAxiosError=!0,t&&(this.code=t),o&&(this.config=o),r&&(this.request=r),i&&(this.response=i,this.status=i.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:hs.toJSONObject(this.config),code:this.code,status:this.status}}};ds.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE",ds.ERR_BAD_OPTION="ERR_BAD_OPTION",ds.ECONNABORTED="ECONNABORTED",ds.ETIMEDOUT="ETIMEDOUT",ds.ERR_NETWORK="ERR_NETWORK",ds.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS",ds.ERR_DEPRECATED="ERR_DEPRECATED",ds.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE",ds.ERR_BAD_REQUEST="ERR_BAD_REQUEST",ds.ERR_CANCELED="ERR_CANCELED",ds.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT",ds.ERR_INVALID_URL="ERR_INVALID_URL";function cs(e){return hs.isPlainObject(e)||hs.isArray(e)}function us(e){return hs.endsWith(e,"[]")?e.slice(0,-2):e}function ps(e,t,o){return e?e.concat(t).map(function(e,t){return e=us(e),!o&&t?"["+e+"]":e}).join(o?".":""):t}const fs=hs.toFlatObject(hs,{},null,function(e){return/^is[A-Z]/.test(e)});function ms(e,t,o){if(!hs.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(o=hs.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!hs.isUndefined(t[e])})).metaTokens,i=o.visitor||h,n=o.dots,s=o.indexes,a=(o.Blob||"undefined"!=typeof Blob&&Blob)&&hs.isSpecCompliantForm(t);if(!hs.isFunction(i))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(hs.isDate(e))return e.toISOString();if(hs.isBoolean(e))return e.toString();if(!a&&hs.isBlob(e))throw new ds("Blob is not supported. Use a Buffer instead.");return hs.isArrayBuffer(e)||hs.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function h(e,o,i){let a=e;if(e&&!i&&"object"==typeof e)if(hs.endsWith(o,"{}"))o=r?o:o.slice(0,-2),e=JSON.stringify(e);else if(hs.isArray(e)&&function(e){return hs.isArray(e)&&!e.some(cs)}(e)||(hs.isFileList(e)||hs.endsWith(o,"[]"))&&(a=hs.toArray(e)))return o=us(o),a.forEach(function(e,r){!hs.isUndefined(e)&&null!==e&&t.append(!0===s?ps([o],r,n):null===s?o:o+"[]",l(e))}),!1;return!!cs(e)||(t.append(ps(i,o,n),l(e)),!1)}const d=[],c=Object.assign(fs,{defaultVisitor:h,convertValue:l,isVisitable:cs});if(!hs.isObject(e))throw new TypeError("data must be an object");return function e(o,r){if(!hs.isUndefined(o)){if(-1!==d.indexOf(o))throw Error("Circular reference detected in "+r.join("."));d.push(o),hs.forEach(o,function(o,n){!0===(!(hs.isUndefined(o)||null===o)&&i.call(t,o,hs.isString(n)?n.trim():n,r,c))&&e(o,r?r.concat(n):[n])}),d.pop()}}(e),t}function gs(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function ys(e,t){this._pairs=[],e&&ms(e,this,t)}const xs=ys.prototype;function vs(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function bs(e,t,o){if(!t)return e;const r=o&&o.encode||vs,i=hs.isFunction(o)?{serialize:o}:o,n=i&&i.serialize;let s;if(s=n?n(t,i):hs.isURLSearchParams(t)?t.toString():new ys(t,i).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}xs.append=function(e,t){this._pairs.push([e,t])},xs.toString=function(e){const t=e?function(t){return e.call(this,t,gs)}:gs;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};class ws{constructor(){this.handlers=[]}use(e,t,o){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!o&&o.synchronous,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){hs.forEach(this.handlers,function(t){null!==t&&e(t)})}}const Ts={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ss={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ys,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Rs="undefined"!=typeof window&&"undefined"!=typeof document,Es="object"==typeof navigator&&navigator||void 0,_s=Rs&&(!Es||["ReactNative","NativeScript","NS"].indexOf(Es.product)<0),Cs="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,As=Rs&&window.location.href||"http://localhost",ks=t(t({},Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rs,hasStandardBrowserEnv:_s,hasStandardBrowserWebWorkerEnv:Cs,navigator:Es,origin:As},Symbol.toStringTag,{value:"Module"}))),Ss);function Ms(e){function t(e,o,r,i){let n=e[i++];if("__proto__"===n)return!0;const s=Number.isFinite(+n),a=i>=e.length;if(n=!n&&hs.isArray(r)?r.length:n,a)return hs.hasOwnProp(r,n)?r[n]=[r[n],o]:r[n]=o,!s;r[n]&&hs.isObject(r[n])||(r[n]=[]);return t(e,o,r[n],i)&&hs.isArray(r[n])&&(r[n]=function(e){const t={},o=Object.keys(e);let r;const i=o.length;let n;for(r=0;r<i;r++)n=o[r],t[n]=e[n];return t}(r[n])),!s}if(hs.isFormData(e)&&hs.isFunction(e.entries)){const o={};return hs.forEachEntry(e,(e,r)=>{t(function(e){return hs.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,o,0)}),o}return null}const Os={transitional:Ts,adapter:["xhr","http","fetch"],transformRequest:[function(e,o){const r=o.getContentType()||"",i=r.indexOf("application/json")>-1,n=hs.isObject(e);n&&hs.isHTMLForm(e)&&(e=new FormData(e));if(hs.isFormData(e))return i?JSON.stringify(Ms(e)):e;if(hs.isArrayBuffer(e)||hs.isBuffer(e)||hs.isStream(e)||hs.isFile(e)||hs.isBlob(e)||hs.isReadableStream(e))return e;if(hs.isArrayBufferView(e))return e.buffer;if(hs.isURLSearchParams(e))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,o){return ms(e,new ks.classes.URLSearchParams,t({visitor:function(e,t,o,r){return ks.isNode&&hs.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},o))}(e,this.formSerializer).toString();if((s=hs.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ms(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return n||i?(o.setContentType("application/json",!1),function(e,t,o){if(hs.isString(e))try{return(t||JSON.parse)(e),hs.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(o||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Os.transitional,o=t&&t.forcedJSONParsing,r="json"===this.responseType;if(hs.isResponse(e)||hs.isReadableStream(e))return e;if(e&&hs.isString(e)&&(o&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(i){if(o){if("SyntaxError"===i.name)throw ds.from(i,ds.ERR_BAD_RESPONSE,this,null,this.response);throw i}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ks.classes.FormData,Blob:ks.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};hs.forEach(["delete","get","head","post","put","patch"],e=>{Os.headers[e]={}});const Is=hs.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ps=Symbol("internals");function Ls(e){return e&&String(e).trim().toLowerCase()}function Fs(e){return!1===e||null==e?e:hs.isArray(e)?e.map(Fs):String(e)}function Bs(e,t,o,r,i){return hs.isFunction(r)?r.call(this,t,o):(i&&(t=o),hs.isString(t)?hs.isString(r)?-1!==t.indexOf(r):hs.isRegExp(r)?r.test(t):void 0:void 0)}let Us=class{constructor(e){e&&this.set(e)}set(e,t,o){const r=this;function i(e,t,o){const i=Ls(t);if(!i)throw new Error("header name must be a non-empty string");const n=hs.findKey(r,i);(!n||void 0===r[n]||!0===o||void 0===o&&!1!==r[n])&&(r[n||t]=Fs(e))}const n=(e,t)=>hs.forEach(e,(e,o)=>i(e,o,t));if(hs.isPlainObject(e)||e instanceof this.constructor)n(e,t);else if(hs.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))n((e=>{const t={};let o,r,i;return e&&e.split("\n").forEach(function(e){i=e.indexOf(":"),o=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!o||t[o]&&Is[o]||("set-cookie"===o?t[o]?t[o].push(r):t[o]=[r]:t[o]=t[o]?t[o]+", "+r:r)}),t})(e),t);else if(hs.isObject(e)&&hs.isIterable(e)){let o,r,i={};for(const t of e){if(!hs.isArray(t))throw TypeError("Object iterator must return a key-value pair");i[r=t[0]]=(o=i[r])?hs.isArray(o)?[...o,t[1]]:[o,t[1]]:t[1]}n(i,t)}else null!=e&&i(t,e,o);return this}get(e,t){if(e=Ls(e)){const o=hs.findKey(this,e);if(o){const e=this[o];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=o.exec(e);)t[r[1]]=r[2];return t}(e);if(hs.isFunction(t))return t.call(this,e,o);if(hs.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ls(e)){const o=hs.findKey(this,e);return!(!o||void 0===this[o]||t&&!Bs(0,this[o],o,t))}return!1}delete(e,t){const o=this;let r=!1;function i(e){if(e=Ls(e)){const i=hs.findKey(o,e);!i||t&&!Bs(0,o[i],i,t)||(delete o[i],r=!0)}}return hs.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let o=t.length,r=!1;for(;o--;){const i=t[o];e&&!Bs(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,o={};return hs.forEach(this,(r,i)=>{const n=hs.findKey(o,i);if(n)return t[n]=Fs(r),void delete t[i];const s=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,o)=>t.toUpperCase()+o)}(i):String(i).trim();s!==i&&delete t[i],t[s]=Fs(r),o[s]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return hs.forEach(this,(o,r)=>{null!=o&&!1!==o&&(t[r]=e&&hs.isArray(o)?o.join(", "):o)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const o=new this(e);return t.forEach(e=>o.set(e)),o}static accessor(e){const t=(this[Ps]=this[Ps]={accessors:{}}).accessors,o=this.prototype;function r(e){const r=Ls(e);t[r]||(!function(e,t){const o=hs.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+o,{value:function(e,o,i){return this[r].call(this,t,e,o,i)},configurable:!0})})}(o,e),t[r]=!0)}return hs.isArray(e)?e.forEach(r):r(e),this}};function $s(e,t){const o=this||Os,r=t||o,i=Us.from(r.headers);let n=r.data;return hs.forEach(e,function(e){n=e.call(o,n,i.normalize(),t?t.status:void 0)}),i.normalize(),n}function Ns(e){return!(!e||!e.__CANCEL__)}Us.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),hs.reduceDescriptors(Us.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[o]=e}}}),hs.freezeMethods(Us);let Ds=class extends ds{constructor(e,t,o){super(null==e?"canceled":e,ds.ERR_CANCELED,t,o),this.name="CanceledError",this.__CANCEL__=!0}};function js(e,t,o){const r=o.config.validateStatus;o.status&&r&&!r(o.status)?t(new ds("Request failed with status code "+o.status,[ds.ERR_BAD_REQUEST,ds.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o)):e(o)}const zs=(e,t,o=3)=>{let r=0;const i=function(e,t){e=e||10;const o=new Array(e),r=new Array(e);let i,n=0,s=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),h=r[s];i||(i=l),o[n]=a,r[n]=l;let d=s,c=0;for(;d!==n;)c+=o[d++],d%=e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),l-i<t)return;const u=h&&l-h;return u?Math.round(1e3*c/u):void 0}}(50,250);return function(e,t){let o,r,i=0,n=1e3/t;const s=(t,n=Date.now())=>{i=n,o=null,r&&(clearTimeout(r),r=null),e(...t)};return[(...e)=>{const t=Date.now(),a=t-i;a>=n?s(e,t):(o=e,r||(r=setTimeout(()=>{r=null,s(o)},n-a)))},()=>o&&s(o)]}(o=>{const n=o.loaded,s=o.lengthComputable?o.total:void 0,a=n-r,l=i(a);r=n;e({loaded:n,total:s,progress:s?n/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&n<=s?(s-n)/l:void 0,event:o,lengthComputable:null!=s,[t?"download":"upload"]:!0})},o)},Ws=(e,t)=>{const o=null!=e;return[r=>t[0]({lengthComputable:o,total:e,loaded:r}),t[1]]},Xs=e=>(...t)=>hs.asap(()=>e(...t)),Gs=ks.hasStandardBrowserEnv?((e,t)=>o=>(o=new URL(o,ks.origin),e.protocol===o.protocol&&e.host===o.host&&(t||e.port===o.port)))(new URL(ks.origin),ks.navigator&&/(msie|trident)/i.test(ks.navigator.userAgent)):()=>!0,Vs=ks.hasStandardBrowserEnv?{write(e,t,o,r,i,n,s){if("undefined"==typeof document)return;const a=[`${e}=${encodeURIComponent(t)}`];hs.isNumber(o)&&a.push(`expires=${new Date(o).toUTCString()}`),hs.isString(r)&&a.push(`path=${r}`),hs.isString(i)&&a.push(`domain=${i}`),!0===n&&a.push("secure"),hs.isString(s)&&a.push(`SameSite=${s}`),document.cookie=a.join("; ")},read(e){if("undefined"==typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Hs(e,t,o){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==o)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Ys=e=>e instanceof Us?t({},e):e;function qs(e,o){o=o||{};const r={};function i(e,t,o,r){return hs.isPlainObject(e)&&hs.isPlainObject(t)?hs.merge.call({caseless:r},e,t):hs.isPlainObject(t)?hs.merge({},t):hs.isArray(t)?t.slice():t}function n(e,t,o,r){return hs.isUndefined(t)?hs.isUndefined(e)?void 0:i(void 0,e,0,r):i(e,t,0,r)}function s(e,t){if(!hs.isUndefined(t))return i(void 0,t)}function a(e,t){return hs.isUndefined(t)?hs.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function l(t,r,n){return n in o?i(t,r):n in e?i(void 0,t):void 0}const h={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(e,t,o)=>n(Ys(e),Ys(t),0,!0)};return hs.forEach(Object.keys(t(t({},e),o)),function(t){const i=h[t]||n,s=i(e[t],o[t],t);hs.isUndefined(s)&&i!==l||(r[t]=s)}),r}const Ks=e=>{const t=qs({},e);let{data:o,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:n,headers:s,auth:a}=t;if(t.headers=s=Us.from(s),t.url=bs(Hs(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&s.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),hs.isFormData(o))if(ks.hasStandardBrowserEnv||ks.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(hs.isFunction(o.getHeaders)){const e=o.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(([e,o])=>{t.includes(e.toLowerCase())&&s.set(e,o)})}if(ks.hasStandardBrowserEnv&&(r&&hs.isFunction(r)&&(r=r(t)),r||!1!==r&&Gs(t.url))){const e=i&&n&&Vs.read(n);e&&s.set(i,e)}return t},Qs="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,o){const r=Ks(e);let i=r.data;const n=Us.from(r.headers).normalize();let s,a,l,h,d,{responseType:c,onUploadProgress:u,onDownloadProgress:p}=r;function f(){h&&h(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(s),r.signal&&r.signal.removeEventListener("abort",s)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=Us.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());js(function(e){t(e),f()},function(e){o(e),f()},{data:c&&"text"!==c&&"json"!==c?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(o(new ds("Request aborted",ds.ECONNABORTED,e,m)),m=null)},m.onerror=function(t){const r=t&&t.message?t.message:"Network Error",i=new ds(r,ds.ERR_NETWORK,e,m);i.event=t||null,o(i),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||Ts;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),o(new ds(t,i.clarifyTimeoutError?ds.ETIMEDOUT:ds.ECONNABORTED,e,m)),m=null},void 0===i&&n.setContentType(null),"setRequestHeader"in m&&hs.forEach(n.toJSON(),function(e,t){m.setRequestHeader(t,e)}),hs.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),c&&"json"!==c&&(m.responseType=r.responseType),p&&([l,d]=zs(p,!0),m.addEventListener("progress",l)),u&&m.upload&&([a,h]=zs(u),m.upload.addEventListener("progress",a),m.upload.addEventListener("loadend",h)),(r.cancelToken||r.signal)&&(s=t=>{m&&(o(!t||t.type?new Ds(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(s),r.signal&&(r.signal.aborted?s():r.signal.addEventListener("abort",s)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);y&&-1===ks.protocols.indexOf(y)?o(new ds("Unsupported protocol "+y+":",ds.ERR_BAD_REQUEST,e)):m.send(i||null)})},Zs=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let o,r=new AbortController;const i=function(e){if(!o){o=!0,s();const t=e instanceof Error?e:this.reason;r.abort(t instanceof ds?t:new Ds(t instanceof Error?t.message:t))}};let n=t&&setTimeout(()=>{n=null,i(new ds(`timeout of ${t}ms exceeded`,ds.ETIMEDOUT))},t);const s=()=>{e&&(n&&clearTimeout(n),n=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)}),e=null)};e.forEach(e=>e.addEventListener("abort",i));const{signal:a}=r;return a.unsubscribe=()=>hs.asap(s),a}},Js=function*(e,t){let o=e.byteLength;if(o<t)return void(yield e);let r,i=0;for(;i<o;)r=i+t,yield e.slice(i,r),i=r},ea=function(){var e=r(function*(e,t){var o,r=!1,i=!1;try{for(var a,h=l(ta(e));r=!(a=yield n(h.next())).done;r=!1){const e=a.value;yield*s(l(Js(e,t)))}}catch(d){i=!0,o=d}finally{try{r&&null!=h.return&&(yield n(h.return()))}finally{if(i)throw o}}});return function(t,o){return e.apply(this,arguments)}}(),ta=function(){var e=r(function*(e){if(e[Symbol.asyncIterator])return void(yield*s(l(e)));const t=e.getReader();try{for(;;){const{done:e,value:o}=yield n(t.read());if(e)break;yield o}}finally{yield n(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),oa=(e,t,o,r)=>{const i=ea(e,t);let n,s=0,a=e=>{n||(n=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await i.next();if(t)return a(),void e.close();let n=r.byteLength;if(o){let e=s+=n;o(e)}e.enqueue(new Uint8Array(r))}catch(t){throw a(t),t}},cancel:e=>(a(e),i.return())},{highWaterMark:2})},{isFunction:ra}=hs,ia=(({Request:e,Response:t})=>({Request:e,Response:t}))(hs.global),{ReadableStream:na,TextEncoder:sa}=hs.global,aa=(e,...t)=>{try{return!!e(...t)}catch(o){return!1}},la=e=>{e=hs.merge.call({skipUndefined:!0},ia,e);const{fetch:o,Request:r,Response:i}=e,n=o?ra(o):"function"==typeof fetch,s=ra(r),a=ra(i);if(!n)return!1;const l=n&&ra(na),h=n&&("function"==typeof sa?(d=new sa,e=>d.encode(e)):async e=>new Uint8Array(await new r(e).arrayBuffer()));var d;const c=s&&l&&aa(()=>{let e=!1;const t=new r(ks.origin,{body:new na,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),u=a&&l&&aa(()=>hs.isReadableStream(new i("").body)),p={stream:u&&(e=>e.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!p[e]&&(p[e]=(t,o)=>{let r=t&&t[e];if(r)return r.call(t);throw new ds(`Response type '${e}' is not supported`,ds.ERR_NOT_SUPPORT,o)})});const f=async(e,t)=>{const o=hs.toFiniteNumber(e.getContentLength());return null==o?(async e=>{if(null==e)return 0;if(hs.isBlob(e))return e.size;if(hs.isSpecCompliantForm(e)){const t=new r(ks.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return hs.isArrayBufferView(e)||hs.isArrayBuffer(e)?e.byteLength:(hs.isURLSearchParams(e)&&(e+=""),hs.isString(e)?(await h(e)).byteLength:void 0)})(t):o};return async e=>{let{url:n,method:a,data:l,signal:h,cancelToken:d,timeout:m,onDownloadProgress:g,onUploadProgress:y,responseType:x,headers:v,withCredentials:b="same-origin",fetchOptions:w}=Ks(e),T=o||fetch;x=x?(x+"").toLowerCase():"text";let S=Zs([h,d&&d.toAbortSignal()],m),R=null;const E=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let _;try{if(y&&c&&"get"!==a&&"head"!==a&&0!==(_=await f(v,l))){let e,t=new r(n,{method:"POST",body:l,duplex:"half"});if(hs.isFormData(l)&&(e=t.headers.get("content-type"))&&v.setContentType(e),t.body){const[e,o]=Ws(_,zs(Xs(y)));l=oa(t.body,65536,e,o)}}hs.isString(b)||(b=b?"include":"omit");const o=s&&"credentials"in r.prototype,h=t(t({},w),{},{signal:S,method:a.toUpperCase(),headers:v.normalize().toJSON(),body:l,duplex:"half",credentials:o?b:void 0});R=s&&new r(n,h);let d=await(s?T(R,w):T(n,h));const m=u&&("stream"===x||"response"===x);if(u&&(g||m&&E)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=d[t]});const t=hs.toFiniteNumber(d.headers.get("content-length")),[o,r]=g&&Ws(t,zs(Xs(g),!0))||[];d=new i(oa(d.body,65536,o,()=>{r&&r(),E&&E()}),e)}x=x||"text";let C=await p[hs.findKey(p,x)||"text"](d,e);return!m&&E&&E(),await new Promise((t,o)=>{js(t,o,{data:C,headers:Us.from(d.headers),status:d.status,statusText:d.statusText,config:e,request:R})})}catch(C){if(E&&E(),C&&"TypeError"===C.name&&/Load failed|fetch/i.test(C.message))throw Object.assign(new ds("Network Error",ds.ERR_NETWORK,e,R),{cause:C.cause||C});throw ds.from(C,C&&C.code,e,R)}}},ha=new Map,da=e=>{let t=e&&e.env||{};const{fetch:o,Request:r,Response:i}=t,n=[r,i,o];let s,a,l=n.length,h=ha;for(;l--;)s=n[l],a=h.get(s),void 0===a&&h.set(s,a=l?new Map:la(t)),h=a;return a};da();const ca={http:null,xhr:Qs,fetch:{get:da}};hs.forEach(ca,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(o){}Object.defineProperty(e,"adapterName",{value:t})}});const ua=e=>`- ${e}`,pa=e=>hs.isFunction(e)||null===e||!1===e;const fa={getAdapter:function(e,t){e=hs.isArray(e)?e:[e];const{length:o}=e;let r,i;const n={};for(let s=0;s<o;s++){let o;if(r=e[s],i=r,!pa(r)&&(i=ca[(o=String(r)).toLowerCase()],void 0===i))throw new ds(`Unknown adapter '${o}'`);if(i&&(hs.isFunction(i)||(i=i.get(t))))break;n[o||"#"+s]=i}if(!i){const e=Object.entries(n).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));let t=o?e.length>1?"since :\n"+e.map(ua).join("\n"):" "+ua(e[0]):"as no adapter specified";throw new ds("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return i},adapters:ca};function ma(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ds(null,e)}function ga(e){ma(e),e.headers=Us.from(e.headers),e.data=$s.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return fa.getAdapter(e.adapter||Os.adapter,e)(e).then(function(t){return ma(e),t.data=$s.call(e,e.transformResponse,t),t.headers=Us.from(t.headers),t},function(t){return Ns(t)||(ma(e),t&&t.response&&(t.response.data=$s.call(e,e.transformResponse,t.response),t.response.headers=Us.from(t.response.headers))),Promise.reject(t)})}const ya="1.13.4",xa={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{xa[e]=function(o){return typeof o===e||"a"+(t<1?"n ":" ")+e}});const va={};xa.transitional=function(e,t,o){function r(e,t){return"[Axios v"+ya+"] Transitional option '"+e+"'"+t+(o?". "+o:"")}return(o,i,n)=>{if(!1===e)throw new ds(r(i," has been removed"+(t?" in "+t:"")),ds.ERR_DEPRECATED);return t&&!va[i]&&(va[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(o,i,n)}},xa.spelling=function(e){return(t,o)=>(console.warn(`${o} is likely a misspelling of ${e}`),!0)};const ba={assertOptions:function(e,t,o){if("object"!=typeof e)throw new ds("options must be an object",ds.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const n=r[i],s=t[n];if(s){const t=e[n],o=void 0===t||s(t,n,e);if(!0!==o)throw new ds("option "+n+" must be "+o,ds.ERR_BAD_OPTION_VALUE);continue}if(!0!==o)throw new ds("Unknown option "+n,ds.ERR_BAD_OPTION)}},validators:xa},wa=ba.validators;let Ta=class{constructor(e){this.defaults=e||{},this.interceptors={request:new ws,response:new ws}}async request(e,t){try{return await this._request(e,t)}catch(o){if(o instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{o.stack?t&&!String(o.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(o.stack+="\n"+t):o.stack=t}catch(r){}}throw o}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=qs(this.defaults,t);const{transitional:o,paramsSerializer:r,headers:i}=t;void 0!==o&&ba.assertOptions(o,{silentJSONParsing:wa.transitional(wa.boolean),forcedJSONParsing:wa.transitional(wa.boolean),clarifyTimeoutError:wa.transitional(wa.boolean)},!1),null!=r&&(hs.isFunction(r)?t.paramsSerializer={serialize:r}:ba.assertOptions(r,{encode:wa.function,serialize:wa.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),ba.assertOptions(t,{baseUrl:wa.spelling("baseURL"),withXsrfToken:wa.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let n=i&&hs.merge(i.common,i[t.method]);i&&hs.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=Us.concat(n,i);const s=[];let a=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,s.unshift(e.fulfilled,e.rejected))});const l=[];let h;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,c=0;if(!a){const e=[ga.bind(this),void 0];for(e.unshift(...s),e.push(...l),d=e.length,h=Promise.resolve(t);c<d;)h=h.then(e[c++],e[c++]);return h}d=s.length;let u=t;for(;c<d;){const e=s[c++],t=s[c++];try{u=e(u)}catch(p){t.call(this,p);break}}try{h=ga.call(this,u)}catch(p){return Promise.reject(p)}for(c=0,d=l.length;c<d;)h=h.then(l[c++],l[c++]);return h}getUri(e){return bs(Hs((e=qs(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};hs.forEach(["delete","get","head","options"],function(e){Ta.prototype[e]=function(t,o){return this.request(qs(o||{},{method:e,url:t,data:(o||{}).data}))}}),hs.forEach(["post","put","patch"],function(e){function t(t){return function(o,r,i){return this.request(qs(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}Ta.prototype[e]=t(),Ta.prototype[e+"Form"]=t(!0)});const Sa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Sa).forEach(([e,t])=>{Sa[t]=e});const Ra=function e(t){const o=new Ta(t),r=vn(Ta.prototype.request,o);return hs.extend(r,Ta.prototype,o,{allOwnKeys:!0}),hs.extend(r,o,null,{allOwnKeys:!0}),r.create=function(o){return e(qs(t,o))},r}(Os);Ra.Axios=Ta,Ra.CanceledError=Ds,Ra.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const o=this;this.promise.then(e=>{if(!o._listeners)return;let t=o._listeners.length;for(;t-- >0;)o._listeners[t](e);o._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{o.subscribe(e),t=e}).then(e);return r.cancel=function(){o.unsubscribe(t)},r},e(function(e,r,i){o.reason||(o.reason=new Ds(e,r,i),t(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e(function(e){t=e}),cancel:t}}},Ra.isCancel=Ns,Ra.VERSION=ya,Ra.toFormData=ms,Ra.AxiosError=ds,Ra.Cancel=Ra.CanceledError,Ra.all=function(e){return Promise.all(e)},Ra.spread=function(e){return function(t){return e.apply(null,t)}},Ra.isAxiosError=function(e){return hs.isObject(e)&&!0===e.isAxiosError},Ra.mergeConfig=qs,Ra.AxiosHeaders=Us,Ra.formToJSON=e=>Ms(hs.isHTMLForm(e)?new FormData(e):e),Ra.getAdapter=fa.getAdapter,Ra.HttpStatusCode=Sa,Ra.default=Ra;const{Axios:Ea,AxiosError:_a,CanceledError:Ca,isCancel:Aa,CancelToken:ka,VERSION:Ma,all:Oa,Cancel:Ia,isAxiosError:Pa,spread:La,toFormData:Fa,AxiosHeaders:Ba,HttpStatusCode:Ua,formToJSON:$a,getAdapter:Na,mergeConfig:Da}=Ra,ja=Ra.create({baseURL:"https://api.themoviedb.org/3",params:{api_key:"c1e672f11dd715c09878f04137c94ba1"}});const za=dn.Component("VerticalContainer",{components:{HorizontalContainer:yn},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[],c=[],u={},p=[];let f,m,g,y,x,v=!1,b=[];l[0]={},a[0]=this.element({parent:e||"root"},!0===v?g:t),l[0].y={transition:t.y},a[0].populate(l[0]),e=a[0],c[1]=[],u[1]=[],h[1]=(s=[],a,h)=>{const c=n(s),w=new Set;let T=c.length;const S={}||{};y=S.from||0,x="to"in S?S.to:c.length;for(;T--;)c[T],T<x&&T>=y&&w.add(""+T);let R=h.length;for(;R--;)if(!1===w.has(h[R])){const e=h[R];a[1][e]&&a[1][e].destroy(),a[1][e]=null,delete a[1][e],a[2][e]&&a[2][e].destroy(),a[2][e]=null,delete a[2][e]}h.length=0;const E=c.length;null!==t&&t[Symbol.for("removeGlobalEffects")](u[1]);for(let e=0;e<u[1].length;e++){const o=u[1][e],r=t[Symbol.for("effects")].indexOf(o);r>-1&&t[Symbol.for("effects")].splice(r,1)}u[1].length=0;for(let _=0;_<E;_++){if(_<y||_>=x)continue;let s=Object.create(t);if(e=a[0],s.item=c[_],s.index=_,s.key=""+_,h.push(s.key),b[1]=o.components&&o.components.Component||r.Component,void 0===a[1]&&(a[1]={}),l[1]={},void 0===a[1][s.key]&&(a[1][s.key]=this.element({parent:e||"root"},!0===v?g:t)),l[1].is=s.item.type,l[1].y=s.rowY(s.index),l[1].ref="list-item-"+s.index,l[1].key=s.index,l[1].items=s.item.items?s.item.items:s.item,l[1].title=s.item.title,l[1].autoScroll=!0,p[1]=[],void 0!==b[1])for(let e in b[1][Symbol.for("config")].props)delete l[1][b[1][Symbol.for("config")].props[e]],p[1].push(b[1][Symbol.for("config")].props[e]);if(void 0===a[1][s.key].nodeId&&a[1][s.key].populate(l[1]),void 0===a[2]&&(a[2]={}),e=a[1][s.key],d[2]={},void 0===a[2][s.key]){if(d[2].is=s.item.type,m=s.rowY(s.index),!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].y=m,m="list-item-"+s.index,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].ref=m,m=s.index,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].key=m,m=s.item.items?s.item.items:s.item,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[2].items=m,d[2].title=s.item.title,d[2].autoScroll=!0,f=d[2].is||"Component",r[2],"string"==typeof f){if(r[2]=o.components&&o.components[f]||r[f],!r[2])throw new Error('Component "Component" not found')}else"function"==typeof f&&!0===f[Symbol.for("isComponent")]&&(r[2]=f);a[2][s.key]=r[2].call(null,{props:d[2]},a[1][s.key],t),a[2][s.key][Symbol.for("slots")][0]?(e=a[2][s.key][Symbol.for("slots")][0],g=a[2][s.key],v=!0):e=a[2][s.key][Symbol.for("children")][0]}let w=()=>{void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("ref")||a[1][s.key].set("ref","list-item-"+s.index)};i(w,null),u[1].push(w),t[Symbol.for("effects")].push(w);let T=()=>{void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("key")||a[1][s.key].set("key",s.index)};i(T,null),u[1].push(T),t[Symbol.for("effects")].push(T),a[2][s.key][Symbol.for("props")].ref="list-item-"+s.index,a[2][s.key][Symbol.for("props")].key=s.index}return u};let w=()=>{h[1](t.items,a,c[1])};t[Symbol.for("effects")].push(w),i(w,["items"]);let T=()=>{t.rowY;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("y")||a[1][o.key].set("y",t.rowY(o.index))}};t[Symbol.for("effects")].push(T),i(T);let S=()=>{t.item;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,void 0!==p&&void 0!==p[1]&&-1!==p[1].indexOf("items")||a[1][o.key].set("items",o.item.items?o.item.items:o.item)}};t[Symbol.for("effects")].push(S),i(S);let R=()=>{t.rowY;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[2][o.key][Symbol.for("props")].y=t.rowY(o.index)}};t[Symbol.for("effects")].push(R),i(R);let E=()=>{t.item;for(let e=0;e<t.items.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.items[e],o.key=e,a[2][o.key][Symbol.for("props")].items=o.item.items?o.item.items:o.item}};return t[Symbol.for("effects")].push(E),i(E),{elms:a,cleanup:()=>{m=null,g=null,e=null,c[1].length=0,b[1]=null,d[2]=null,r[2]=null,w=null,h[1]([],a,c[1]),h[1]=null,T=null,S=null,R=null,E=null,t=null,b.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0,p.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("y",{transition:e.y})}],context:{}},props:["autoScroll","autoscrollOffset","itemOffset","items","looping",{key:"gap",default:100}],state:()=>({focused:0,y:0}),watch:{hasFocus(e){e&&this.$trigger("focused")},focused(e){const t=this.$select(`list-item-${e}`);t&&t.$focus&&(t.$focus(),this.scroll())}},methods:{changeFocus(e){const t=this.looping?(this.focused+e+this.items.length)%this.items.length:Math.max(0,Math.min(this.focused+e,this.items.length-1));this.focused=t},rowOffset(e){return 0===e?0:this.items.slice(0,e).reduce((e,t)=>e+this.gap+(null!=t&&t.rowH?null==t?void 0:t.rowH:t.height),0)},rowY(e){return this.rowOffset(e)},scroll(){this.autoScroll&&(this.y=-this.rowOffset(this.focused))}},input:{up(){this.changeFocus(-1)},down(){this.changeFocus(1)},enter(){console.log("Selected item:",this.items[this.focused])}}}),Wa=dn.Component("Home",{components:{VerticalContainer:za},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[];let c,u,p,f=!1,m=0,g=[];if(l[0]={},a[0]=this.element({parent:e||"root"},!0===f?p:t),l[0].w=1920,l[0].h=1080,l[0].src=t.src,a[0].populate(l[0]),!0===f&&(m-=1),e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},!0===f?p:t),l[1].w=1920,l[1].h=1080,l[1].color="{top: '0x000000ff', left: '0x000000ff'}",l[1].alpha=.6,a[1].populate(l[1]),!0===f&&(m-=1),g[2]=o.components&&o.components.VerticalContainer||r.VerticalContainer,e=a[0],l[2]={},a[2]=this.element({parent:e||"root"},!0===f?p:t),l[2].x=96,l[2].items=t.items,l[2].rowSpacing=30,l[2].ref="content",l[2].autoScroll=!0,l[2].looping=!0,d[2]=[],void 0!==g[2])for(let y in g[2][Symbol.for("config")].props)delete l[2][g[2][Symbol.for("config")].props[y]],d[2].push(g[2][Symbol.for("config")].props[y]);if(a[2].populate(l[2]),!0===f&&(m-=1),e=a[2],h[3]={},h[3].x=96,u=t.items,!0===Array.isArray(u)&&(u=n(u).slice(0)),h[3].items=u,h[3].rowSpacing=30,h[3].ref="content",h[3].autoScroll=!0,h[3].looping=!0,c=h[3].is||"VerticalContainer",r[3],"string"==typeof c){if(r[3]=o.components&&o.components[c]||r[c],!r[3])throw new Error('Component "VerticalContainer" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[3]=c);return a[3]=r[3].call(null,{props:h[3]},a[2],t),a[3][Symbol.for("slots")][0]?(e=a[3][Symbol.for("slots")][0],p=a[3],f=!0):e=a[3][Symbol.for("children")][0],!0===f&&0===m&&(f=!1),{elms:a,cleanup:()=>{u=null,p=null,e=null,g[2]=null,h[3]=null,r[3]=null,t=null,g.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("src",e.src)},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[2]&&-1!==skips[2].indexOf("items")||t[2].set("items",e.items)},function(e,t,o,r,i,n){t[3][Symbol.for("props")].items=e.items}],context:{}},state:()=>({src:"",backgroundDebounce:null,items:[]}),hooks:{async init(){var e;await this.fetchData(),null===(e=this.$select("content"))||void 0===e||e.$focus(),this.$listen("changeBackground",({img:e})=>{this.backgroundDebounce&&this.$clearTimeout(this.backgroundDebounce),this.backgroundDebounce=this.$setTimeout(()=>{this.src=e},1e3)})},ready(){}},methods:{leftKeyUp(){console.log("left released")},async fetchData(){const e=await async function(e=!1){try{const t=[{title:"Popular Movies",path:"/movie/popular",type:"HorizontalContainer",width:200,height:200,rowH:200,onEnter:e=>`/details/${e}`,wBorder:!0},{title:"Trending Movies",path:"/trending/movie/week",type:"HorizontalContainer",width:200,height:600,onEnter:e=>`/details/${e}`,rowH:600,wBorder:!1},{title:"Top Rated Movies",path:"/movie/top_rated",type:"HorizontalContainer",width:640,height:360,itemOffset:50,onEnter:e=>`/details/${e}`,rowH:360,wBorder:!1},{title:"Upcoming Movies",path:"/movie/upcoming",type:"HorizontalContainer",width:200,height:100,onEnter:e=>`/details/${e}`,wBorder:!1,rowH:100}],o=await Promise.all(t.map(async t=>{const o=await ja.get(t.path),r=(e?o.data.results.slice(0,5):o.data.results).map(e=>({onEnter:e=>`/details/${e}`,type:"Card",width:t.width,height:t.height,data:{title:e.title,poster_path:e.poster_path,overview:e.overview,backdrop_path:e.backdrop_path,id:e.id}}));return{title:t.title,items:r,type:t.type,rowH:t.rowH,wBorder:t.wBorder}}));return console.log(o),o}catch(t){return console.error("Error fetching movie sections:",t),[]}}(!1);this.items=e}},input:{}});const Xa=dn.Component("Button",{props:["label","icon"],state:()=>({textWidth:0,height:44}),computed:{width(){this.textWidth;return this.textWidth+0+0+45}},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[];return l[0]={},a[0]=this.element({parent:e||"root"},t),l[0].w=t.width,l[0].h=t.height,l[0].effects=[{type:"radius",props:{radius:25}}],l[0].color=t.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x3d3d3dff",a[0].populate(l[0]),e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},t),l[1].placement="{ x: 'middle', y: 'middle' }",l[1].padding="{ left: 22.5, right: 22.5 }",l[1].__layout=!0,a[1].populate(l[1]),e=a[1],l[2]={},a[2]=this.element({parent:e||"root"},t),l[2].content=t.label,l[2].color="0xffffffff",l[2].font="PoppinsMedium",l[2].size=20,l[2]["@loaded"]=t.onTextLoaded&&t.onTextLoaded.bind(t),l[2].__textnode=!0,a[2].populate(l[2]),{elms:a,cleanup:()=>{e=null,t=null,a.length=0,r.length=0,l.length=0}}},effects:[function(e,t,o,r,i,n){t[0].set("w",e.width)},function(e,t,o,r,i,n){t[0].set("h",e.height)},function(e,t,o,r,i,n){t[0].set("effects",[{type:"radius",props:{radius:25}}])},function(e,t,o,r,i,n){t[0].set("color",e.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x3d3d3dff")},function(e,t,o,r,i,n){t[2].set("content",e.label)}],context:{}},methods:{onTextLoaded({w:e}){this.textWidth=e,this.$size({w:this.width,h:this.height})}}}),Ga=dn.Component("Detail",{props:["id"],components:{Column:xn,VerticalContainer:za,GenreLabel:Xa},code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[],c=[],u={},p=[];let f,m,g,y,x,v=!1,b=0,w=[];l[0]={},a[0]=this.element({parent:e||"root"},!0===v?g:t),l[0].w=1920,l[0].h=1080,l[0].color="0x0d0e12ff",a[0].populate(l[0]),!0===v&&(b-=1),e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},!0===v?g:t),l[1].x=318,l[1].w=1600,l[1].h=900,l[1].src=t.backdrop,a[1].populate(l[1]),!0===v&&(b-=1),e=a[0],l[2]={},a[2]=this.element({parent:e||"root"},!0===v?g:t),l[2].x=318,l[2].w=1600,l[2].h=900,l[2].color="{left: '0x0d0e12ff', bottom: '0x0d0e12ff'}",a[2].populate(l[2]),!0===v&&(b-=1),e=a[2],l[3]={},a[3]=this.element({parent:e||"root"},!0===v?g:t),l[3].width=1920,l[3].height=1006,l[3].y=48,a[3].populate(l[3]),!0===v&&(b-=1),e=a[3],l[4]={},a[4]=this.element({parent:e||"root"},!0===v?g:t),l[4].width=832,l[4].height=556,l[4].x="-228",a[4].populate(l[4]),!0===v&&(b-=1),e=a[3],l[5]={},a[5]=this.element({parent:e||"root"},!0===v?g:t),l[5].x="-228",l[5].width=832,l[5].height=100,l[5].font="AntonRegular",l[5].size=115,l[5].contain="width",l[5].maxlines=1,l[5].maxheight=100,l[5].content=t.title,l[5].__textnode=!0,a[5].populate(l[5]),!0===v&&(b-=1),e=a[3],l[6]={},a[6]=this.element({parent:e||"root"},!0===v?g:t),l[6].gap=22.5,l[6].y=155,l[6].x="-228",l[6].__layout=!0,a[6].populate(l[6]),!0===v&&(b-=1),e=a[6],l[7]={},a[7]=this.element({parent:e||"root"},!0===v?g:t),l[7].content=t.date,l[7].y=155,l[7].x="-228",l[7].font="PoppinsMedium",l[7].letterspacing=.01,l[7].size=20,l[7].__textnode=!0,a[7].populate(l[7]),!0===v&&(b-=1),e=a[6],l[8]={},a[8]=this.element({parent:e||"root"},!0===v?g:t),l[8].content=t.runtime,l[8].letterspacing=.01,l[8].font="PoppinsMedium",l[8].size=20,l[8].__textnode=!0,a[8].populate(l[8]),!0===v&&(b-=1),e=a[6],c[9]=[],u[9]=[],h[9]=(o=[],r,i)=>{const s=n(o),a=new Set;let h=s.length;const d={}||{};y=d.from||0,x="to"in d?d.to:s.length;for(;h--;)s[h],h<x&&h>=y&&a.add(""+h);let c=i.length;for(;c--;)if(!1===a.has(i[c])){const e=i[c];r[9][e]&&r[9][e].destroy(),r[9][e]=null,delete r[9][e]}i.length=0;const p=s.length;null!==t&&t[Symbol.for("removeGlobalEffects")](u[9]);for(let e=0;e<u[9].length;e++){const o=u[9][e],r=t[Symbol.for("effects")].indexOf(o);r>-1&&t[Symbol.for("effects")].splice(r,1)}u[9].length=0;for(let n=0;n<p;n++){if(n<y||n>=x)continue;let o=Object.create(t);e=r[6],o.item=s[n],o.index=n,o.key=""+n,i.push(o.key),e=r[6],void 0===r[9]&&(r[9]={}),l[9]={},void 0===r[9][o.key]&&(r[9][o.key]=this.element({parent:e||"root"},!0===v?g:t)),l[9].width=62,l[9].height=37,l[9].src=o.item,l[9].fit="{ type: 'contain', position: { x: 0.5, y: 0.5 } }",void 0===r[9][o.key].nodeId&&(r[9][o.key].populate(l[9]),!0===v&&(b-=1))}return u};let T=()=>{h[9](t.productionCompanies,a,c[9])};t[Symbol.for("effects")].push(T),i(T,["productionCompanies"]);let S,R,E=()=>{t.item;for(let e=0;e<t.productionCompanies.length;e++){if(e<y||e>=x)continue;const o={};o.index=e,o.item=t.productionCompanies[e],o.key=e,a[9][o.key].set("src",o.item)}};t[Symbol.for("effects")].push(E),i(E),e=a[3],l[10]={},a[10]=this.element({parent:e||"root"},!0===v?g:t),l[10].y=316,l[10].x="-228",l[10].width=832,l[10].maxlines=4,l[10].contain="width",l[10].font="PoppinsMedium",l[10].size=26,l[10].content=t.data.overview,l[10].__textnode=!0,a[10].populate(l[10]),!0===v&&(b-=1),e=a[3],l[11]={},a[11]=this.element({parent:e||"root"},!0===v?g:t),l[11].direction="horizontal",l[11].gap=22.5,l[11].y=512,l[11].x="-228",l[11].__layout=!0,a[11].populate(l[11]),!0===v&&(b-=1),e=a[11],console.warn(" Using 'index' in the key, like key=$index,  is not recommended"),c[12]=[],u[12]=[],h[12]=(i=[],s,a)=>{const h=n(i),c=new Set;let y=h.length;const x={}||{};S=x.from||0,R="to"in x?x.to:h.length;for(;y--;){h[y];const e=y;y<R&&y>=S&&c.add(""+e)}let T=a.length;for(;T--;)if(!1===c.has(a[T])){const e=a[T];s[12][e]&&s[12][e].destroy(),s[12][e]=null,delete s[12][e],s[13][e]&&s[13][e].destroy(),s[13][e]=null,delete s[13][e]}a.length=0;const E=h.length;null!==t&&t[Symbol.for("removeGlobalEffects")](u[12]);for(let e=0;e<u[12].length;e++){const o=u[12][e],r=t[Symbol.for("effects")].indexOf(o);r>-1&&t[Symbol.for("effects")].splice(r,1)}u[12].length=0;for(let u=0;u<E;u++){if(u<S||u>=R)continue;let i=Object.create(t);if(e=s[11],i.item=h[u],i.index=u,i.key=""+i.index,a.push(i.key),w[12]=o.components&&o.components.GenreLabel||r.GenreLabel,void 0===s[12]&&(s[12]={}),l[12]={},void 0===s[12][i.key]&&(s[12][i.key]=this.element({parent:e||"root"},!0===v?g:t)),l[12].content=i.item,l[12].height=44,l[12].size=26,l[12].label=i.item,p[12]=[],void 0!==w[12])for(let e in w[12][Symbol.for("config")].props)delete l[12][w[12][Symbol.for("config")].props[e]],p[12].push(w[12][Symbol.for("config")].props[e]);if(void 0===s[12][i.key].nodeId&&(s[12][i.key].populate(l[12]),!0===v&&(b-=1)),void 0===s[13]&&(s[13]={}),e=s[12][i.key],d[13]={},void 0===s[13][i.key]){if(m=i.item,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[13].content=m,d[13].height=44,d[13].size=26,m=i.item,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[13].label=m,f=d[13].is||"GenreLabel",r[13],"string"==typeof f){if(r[13]=o.components&&o.components[f]||r[f],!r[13])throw new Error('Component "GenreLabel" not found')}else"function"==typeof f&&!0===f[Symbol.for("isComponent")]&&(r[13]=f);s[13][i.key]=r[13].call(null,{props:d[13]},s[12][i.key],t),s[13][i.key][Symbol.for("slots")][0]?(e=s[13][i.key][Symbol.for("slots")][0],g=s[13][i.key],v=!0):e=s[13][i.key][Symbol.for("children")][0]}}return u};let _=()=>{h[12](t.genres,a,c[12])};t[Symbol.for("effects")].push(_),i(_,["genres"]);let C=()=>{t.item;for(let e=0;e<t.genres.length;e++){if(e<S||e>=R)continue;const o={};o.index=e,o.item=t.genres[e],o.key=o.index,void 0!==p&&void 0!==p[12]&&-1!==p[12].indexOf("content")||a[12][o.key].set("content",o.item)}};t[Symbol.for("effects")].push(C),i(C);let A=()=>{t.item;for(let e=0;e<t.genres.length;e++){if(e<S||e>=R)continue;const o={};o.index=e,o.item=t.genres[e],o.key=o.index,void 0!==p&&void 0!==p[12]&&-1!==p[12].indexOf("label")||a[12][o.key].set("label",o.item)}};t[Symbol.for("effects")].push(A),i(A);let k=()=>{t.item;for(let e=0;e<t.genres.length;e++){if(e<S||e>=R)continue;const o={};o.index=e,o.item=t.genres[e],o.key=o.index,a[13][o.key][Symbol.for("props")].content=o.item}};t[Symbol.for("effects")].push(k),i(k);let M=()=>{t.item;for(let e=0;e<t.genres.length;e++){if(e<S||e>=R)continue;const o={};o.index=e,o.item=t.genres[e],o.key=o.index,a[13][o.key][Symbol.for("props")].label=o.item}};if(t[Symbol.for("effects")].push(M),i(M),e=a[3],l[14]={},a[14]=this.element({parent:e||"root"},!0===v?g:t),l[14].x="-318",l[14].width=1920,l[14].height=495,l[14].y=584,l[14].overflow=!1,a[14].populate(l[14]),!0===v&&(b-=1),w[15]=o.components&&o.components.VerticalContainer||r.VerticalContainer,e=a[14],l[15]={},a[15]=this.element({parent:e||"root"},!0===v?g:t),l[15].x=96,l[15].items=t.similar,l[15].rowSpacing=30,l[15].ref="content",l[15].autoScroll=!0,l[15].looping=!0,l[15].clipping=!1,p[15]=[],void 0!==w[15])for(let O in w[15][Symbol.for("config")].props)delete l[15][w[15][Symbol.for("config")].props[O]],p[15].push(w[15][Symbol.for("config")].props[O]);if(a[15].populate(l[15]),!0===v&&(b-=1),e=a[15],d[16]={},d[16].x=96,m=t.similar,!0===Array.isArray(m)&&(m=n(m).slice(0)),d[16].items=m,d[16].rowSpacing=30,d[16].ref="content",d[16].autoScroll=!0,d[16].looping=!0,d[16].clipping=!1,f=d[16].is||"VerticalContainer",r[16],"string"==typeof f){if(r[16]=o.components&&o.components[f]||r[f],!r[16])throw new Error('Component "VerticalContainer" not found')}else"function"==typeof f&&!0===f[Symbol.for("isComponent")]&&(r[16]=f);return a[16]=r[16].call(null,{props:d[16]},a[15],t),a[16][Symbol.for("slots")][0]?(e=a[16][Symbol.for("slots")][0],g=a[16],v=!0):e=a[16][Symbol.for("children")][0],!0===v&&0===b&&(v=!1),{elms:a,cleanup:()=>{m=null,g=null,e=null,c[9].length=0,T=null,h[9]([],a,c[9]),h[9]=null,E=null,c[12].length=0,w[12]=null,d[13]=null,r[13]=null,_=null,h[12]([],a,c[12]),h[12]=null,C=null,A=null,k=null,M=null,w[15]=null,d[16]=null,r[16]=null,t=null,w.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0,p.length=0}}},effects:[function(e,t,o,r,i,n){t[1].set("src",e.backdrop)},function(e,t,o,r,i,n){t[5].set("content",e.title)},function(e,t,o,r,i,n){t[7].set("content",e.date)},function(e,t,o,r,i,n){t[8].set("content",e.runtime)},function(e,t,o,r,i,n){t[10].set("content",e.data.overview)},function(e,t,o,r,i,n){"undefined"!=typeof skips&&void 0!==skips[15]&&-1!==skips[15].indexOf("items")||t[15].set("items",e.similar)},function(e,t,o,r,i,n){t[16][Symbol.for("props")].items=e.similar}],context:{}},state:()=>({data:{},backdrop:"",genres:[],similar:[],focused:0,productionCompanies:[]}),hooks:{async init(){var e;this.data=await async function(e){return(await ja.get("/movie/"+e)).data}(this.id),this.productionCompanies=this.data.production_companies.filter(e=>e.logo_path).map(e=>cn(e.logo_path,"w300")),this.genres=this.data.genres.map(e=>e.name).sort(),this.backdrop=cn(null===(e=this.data)||void 0===e?void 0:e.backdrop_path),this.similar=await async function(e){try{const t=[],o=["Trailers","Bonus","Related"];for(let s=1;s<=3;s++)t.push(ja.get(`/movie/${e}/similar`,{params:{page:s}}));t.push(ja.get(`/movie/${e}/credits`));const r=await Promise.all(t),i=r.slice(0,3).map((e,t)=>({title:o[t],type:"HorizontalContainer",rowH:216,items:e.data.results.map(e=>({data:e,type:"Card",width:330,height:198,onEnter:e=>`/details/${e}`}))})),n={title:"Tuljani",rowH:216,type:"HorizontalContainer",items:r[3].data.cast.slice(0,5).map(e=>({data:{backdrop_path:e.profile_path},id:e.id,text:e.name,subText:e.character,type:"Card",onEnter:e=>`/person/${e}`,width:170,height:170,radius:100}))};return i.push(n),i}catch(t){return console.error("Error fetching similar movies (5 pages):",t),[]}}(this.id),this.$select("content").$focus()},focus(){}},computed:{title(){var e,t;return this.data,(null===(e=this.data)||void 0===e?void 0:e.title)||(null===(t=this.data)||void 0===t?void 0:t.original_title)||""},date(){var e;return this.data,(null===(e=this.data)||void 0===e||null===(e=e.release_date)||void 0===e?void 0:e.split("-")[0])||"N/A"},runtime(){var e,t;this.data;const o=Math.floor((null===(e=this.data)||void 0===e?void 0:e.runtime)/60);return o<0?"":o+":"+((null===(t=this.data)||void 0===t?void 0:t.runtime)%60).toString().padStart(2,"0")}}}),Va=dn.Application({code:{render:function(e,t,o,r,i,n,s){const a=[],l=[],h=[],d=[];let c,u,p=!1,f=0,m=[];if(l[0]={},a[0]=this.element({parent:e||"root"},!0===p?u:t),a[0].populate(l[0]),!0===p&&(f-=1),m[1]=o.components&&o.components.RouterView||r.RouterView,e=a[0],l[1]={},a[1]=this.element({parent:e||"root"},!0===p?u:t),d[1]=[],void 0!==m[1])for(let g in m[1][Symbol.for("config")].props)delete l[1][m[1][Symbol.for("config")].props[g]],d[1].push(m[1][Symbol.for("config")].props[g]);if(a[1].populate(l[1]),!0===p&&(f-=1),e=a[1],h[2]={},c=h[2].is||"RouterView",r[2],"string"==typeof c){if(r[2]=o.components&&o.components[c]||r[c],!r[2])throw new Error('Component "RouterView" not found')}else"function"==typeof c&&!0===c[Symbol.for("isComponent")]&&(r[2]=c);return a[2]=r[2].call(null,{props:h[2]},a[1],t),a[2][Symbol.for("slots")][0]?(e=a[2][Symbol.for("slots")][0],u=a[2],p=!0):e=a[2][Symbol.for("children")][0],!0===p&&0===f&&(p=!1),{elms:a,cleanup:()=>{u=null,e=null,m[1]=null,h[2]=null,r[2]=null,t=null,m.length=0,a.length=0,r.length=0,l.length=0,h.length=0,d.length=0}}},effects:[],context:{}},routes:[{path:"/",component:Wa,options:{keepAlive:!0}},{path:"/details/:id",component:Ga,options:{keepAlive:!0}}]});dn.Launch(Va,"app",{w:1920,h:1080,debugLevel:1,defaultFont:"InterRegular",inspector:!0,inputThrottle:300,fonts:[{family:"lato",type:"msdf",file:"fonts/Lato-Regular.ttf"},{family:"raleway",type:"msdf",file:"fonts/Raleway-ExtraBold.ttf"},{family:"InterBold",type:"msdf",file:"fonts/Inter_24pt-Bold.ttf"},{family:"InterRegular",type:"msdf",file:"fonts/Inter_24pt-Regular.ttf"},{family:"InterSemiBold",type:"msdf",file:"fonts/Inter_24pt-SemiBold.ttf"},{family:"PoppinsSemiBold",type:"msdf",file:"fonts/Poppins-SemiBold.ttf"},{family:"PoppinsMedium",type:"msdf",file:"fonts/Poppins-Medium.ttf"},{family:"AntonRegular",type:"msdf",file:"fonts/Anton-Regular.ttf"}]})}}})}();
