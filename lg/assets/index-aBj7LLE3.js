var no=Object.defineProperty;var oo=(r,t,e)=>t in r?no(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var c=(r,t,e)=>oo(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const b={cleanup:Symbol("cleanup"),currentView:Symbol("currentView"),cursorTagStart:Symbol("cursorTagStart"),computedKeys:Symbol("computedKeys"),destroy:Symbol("destroy"),rendererEventListeners:Symbol("rendererEventListeners"),getChildren:Symbol("getChildren"),holder:Symbol("holder"),id:Symbol("id"),identifier:Symbol("identifier"),index:Symbol("index"),init:Symbol("init"),inputEvents:Symbol("inputEvents"),internalEvent:Symbol("internalEvent"),intervals:Symbol("intervals"),isProxy:Symbol("isProxy"),launched:Symbol("launched"),level:Symbol("level"),methodKeys:Symbol("methodKeys"),originalState:Symbol("originalState"),propKeys:Symbol("propKeys"),raw:Symbol("raw"),ready:Symbol("ready"),renderer:Symbol("renderer"),routes:Symbol("routes"),routerHooks:Symbol("routerHooks"),settings:Symbol("settings"),state:Symbol("state"),stateKeys:Symbol("stateKeys"),textnode:Symbol("textnode"),timeouts:Symbol("timeouts"),type:Symbol("type"),watchers:Symbol("watchers"),watchKeys:Symbol("watchKeys"),wrapper:Symbol("wrapper"),children:Symbol.for("children"),components:Symbol.for("components"),config:Symbol.for("config"),isSlot:Symbol.for("isSlot"),props:Symbol.for("props"),slots:Symbol.for("slots"),componentType:Symbol.for("componentType"),isComponent:Symbol.for("isComponent"),effects:Symbol.for("effects"),removeGlobalEffects:Symbol.for("removeGlobalEffects")},ne={[b.settings]:{},get(r,t=null){return r in this[b.settings]?this[b.settings][r]:t},set(r,t){typeof r=="object"?Object.keys(r).forEach(e=>{this.set(e,r[e])}):this[b.settings][r]=t}},Kt=()=>{},Vr=r=>String(r).padStart(2,"0"),Hr=()=>{const r=new Date;return Vr(r.getHours())+":"+Vr(r.getMinutes())+":"+Vr(r.getSeconds())},Hi=r=>{const t=ne.get("debugLevel"),e={};return Object.defineProperty(e,"info",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("info")>-1)&&console.info.bind(window.console,`%c ⚡️ ${r} %c ${Hr()}`,"background-color: #0284c7; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Kt}}),Object.defineProperty(e,"warn",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("warn")>-1)&&console.warn.bind(window.console,`%c ⚡️ ${r} %c ${Hr()}`,"background-color: #fbbf24; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Kt}}),Object.defineProperty(e,"error",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("error")>-1)&&console.error.bind(window.console,`%c ⚡️ ${r} %c ${Hr()}`,"background-color: #dc2626; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Kt}}),Object.defineProperty(e,"debug",{get(){return(t>=2||Array.isArray(t)&&t.indexOf("debug")>-1)&&console.debug.bind(window.console,`%c ⚡️ ${r} %c (${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})`,"background-color: #e2e8f0; color: #334155; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Kt}}),e};let j;const ao=()=>{j=Hi("Blits")},qt={aliceblue:"0xf0f8ffff",antiquewhite:"0xfaebd7ff",aqua:"0xffffff00",aquamarine:"0x7fffd4ff",azure:"0xf0ffffff",beige:"0xf5f5dcff",bisque:"0xffe4c4ff",black:"0x000000ff",blanchedalmond:"0xffebcdff",blue:"0x0000ffff",blueviolet:"0x8a2be2ff",brown:"0xa52a2aff",burlywood:"0xdeb887ff",cadetblue:"0x5f9ea0ff",chartreuse:"0x7fff00ff",chocolate:"0xd2691eff",coral:"0xff7f50ff",cornflowerblue:"0x6495edff",cornsilk:"0xfff8dcff",crimson:"0xdc143cff",cyan:"0x00ffffff",darkblue:"0x00008bff",darkcyan:"0x008b8bff",darkgoldenrod:"0xb8860bff",darkgray:"0xa9a9a9ff",darkgreen:"0x006400ff",darkgrey:"0xa9a9a9ff",darkkhaki:"0xbdb76bff",darkmagenta:"0x8b008bff",darkolivegreen:"0x556b2fff",darkorange:"0xff8c00ff",darkorchid:"0x9932ccff",darkred:"0x8b0000ff",darksalmon:"0xe9967aff",darkseagreen:"0x8fbc8fff",darkslateblue:"0x483d8bff",darkslategray:"0x2f4f4fff",darkslategrey:"0x2f4f4fff",darkturquoise:"0x00ced1ff",darkviolet:"0x9400d3ff",deeppink:"0xff1493ff",deepskyblue:"0x00bfffff",dimgray:"0x696969ff",dimgrey:"0x696969ff",dodgerblue:"0x1e90ffff",firebrick:"0xb22222ff",floralwhite:"0xfffaf0ff",forestgreen:"0x228b22ff",fuchsia:"0xff00ffff",gainsboro:"0xdcdcdcff",ghostwhite:"0xf8f8ffff",gold:"0xffd700ff",goldenrod:"0xdaa520ff",gray:"0x808080ff",green:"0x008000ff",greenyellow:"0xadff2fff",grey:"0x808080ff",honeydew:"0xf0fff0ff",hotpink:"0xff69b4ff",indianred:"0xcd5c5cff",indigo:"0x4b0082ff",ivory:"0xfffff0ff",khaki:"0xf0e68cff",lavender:"0xe6e6faff",lavenderblush:"0xfff0f5ff",lawngreen:"0x7cfc00ff",lemonchiffon:"0xfffacdff",lightblue:"0xadd8e6ff",lightcoral:"0xf08080ff",lightcyan:"0xe0ffffff",lightgoldenrodyellow:"0xfafad2ff",lightgray:"0xd3d3d3ff",lightgreen:"0x90ee90ff",lightgrey:"0xd3d3d3ff",lightpink:"0xffb6c1ff",lightsalmon:"0xffa07aff",lightseagreen:"0x20b2aaff",lightskyblue:"0x87cefaff",lightslategray:"0x778899ff",lightslategrey:"0x778899ff",lightsteelblue:"0xb0c4deff",lightyellow:"0xffffe0ff",lime:"0x00ff00ff",limegreen:"0x32cd32ff",linen:"0xfaf0e6ff",magenta:"0xff00ffff",maroon:"0x800000ff",mediumaquamarine:"0x66cdaaff",mediumblue:"0x0000cdff",mediumorchid:"0xba55d3ff",mediumpurple:"0x9370dbff",mediumseagreen:"0x3cb371ff",mediumslateblue:"0x7b68eeff",mediumspringgreen:"0x00fa9aff",mediumturquoise:"0x48d1ccff",mediumvioletred:"0xc71585ff",midnightblue:"0x191970ff",mintcream:"0xf5fffaff",mistyrose:"0xffe4e1ff",moccasin:"0xffe4b5ff",navajowhite:"0xffdeadff",navy:"0x000080ff",oldlace:"0xfdf5e6ff",olive:"0x808000ff",olivedrab:"0x6b8e23ff",orange:"0xffa500ff",orangered:"0xff4500ff",orchid:"0xda70d6ff",palegoldenrod:"0xeee8aaff",palegreen:"0x98fb98ff",paleturquoise:"0xafeeeeff",palevioletred:"0xdb7093ff",papayawhip:"0xffefd5ff",peachpuff:"0xffdab9ff",peru:"0xcd853fff",pink:"0xffc0cbff",plum:"0xdda0ddff",powderblue:"0xb0e0e6ff",purple:"0x800080ff",rebeccapurple:"0x663399ff",red:"0xff0000ff",rosybrown:"0xbc8f8fff",royalblue:"0x4169e1ff",saddlebrown:"0x8b4513ff",salmon:"0xfa8072ff",sandybrown:"0xf4a460ff",seagreen:"0x2e8b57ff",seashell:"0xfff5eeff",sienna:"0xa0522dff",silver:"0xc0c0c0ff",skyblue:"0x87ceebff",slateblue:"0x6a5acdff",slategray:"0x708090ff",slategrey:"0x708090ff",snow:"0xfffafaff",springgreen:"0x00ff7fff",steelblue:"0x4682b4ff",tan:"0xd2b48cff",teal:"0x008080ff",thistle:"0xd8bfd8ff",tomato:"0xff6347ff",transparent:"0x00000000",turquoise:"0x40e0d0ff",violet:"0xee82eeff",wheat:"0xf5deb3ff",white:"0xffffffff",whitesmoke:"0xf5f5f5ff",yellow:"0xffff00ff",yellowgreen:"0x9acd32ff"},lo=/^#?([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,fo=/^(rgba?)\((\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*)(,(\s*(-?\d+(?:\.\d+)?)\s*))?\)$/,uo=/^(hsla?)\((\s*(360|3[0-5][0-9]|[12]?[0-9]{1,2})\s*),(\s*(100|[1-9]?[0-9])\s*)%,(\s*(100|[1-9]?[0-9])\s*)%(,(\s*(1|0(?:\.\d+)?)\s*))?\)$/,Gr={},Qt=r=>{if(Gr[r]!==void 0)return Gr[r];const t=parseInt(r).toString(16).padStart(2,"0");return Gr[r]=t,t},nt={normalize:(r="",t="0xffffffff")=>{if(r=r.toString(),r.startsWith("0x")&&r.length===10)return r;if(qt[r]!==void 0)return qt[r];if(lo.test(r)){r=r.replace("#","").toLowerCase(),r.length===3&&(r=r.split("").map(i=>i+i).join(""));const s="0x"+r.padEnd(8,"f");return qt[r]=s,s}const e=fo.exec(r);if(e){const s=Qt(e[3]),i=Qt(e[5]),n=Qt(e[7]);let o="ff";if(e[10]&&e[1]==="rgba"){const l=Math.min(Math.max(Math.round(parseFloat(e[10])*255),0),255);o=Qt(l)}const f="0x"+s+i+n+o;return qt[r]=f,f}return uo.test(r)?(console.warn("HSL(A) color format is not supported yet"),"0xffffffff"):t}},co=(r="",t,e,s=null)=>{let i=0,n=0,o=[],f=null,l=0;const a=/^<\/?([a-zA-Z0-9_\-.]+)\s*/,u=/^\s*(\/?>)\s*/,h=/^([A-Za-z0-9:.\-_@$]+)=\s*(["'])/,d=/^<>\s*/,g=/^\s*(<\/>)\s*/,p=()=>{r=y(r);try{return m(T),v(o)}catch(C){throw(C.name=="TemplateParseError"||C.name=="TemplateStructureError")&&(C.message=`${C.message}
${C.context}`),C}},m=C=>{i>=r.length||C()},y=C=>C.replace(/<!--.*?-->/gms,"").replace(/\r?\n\s*\r\n/gm," ").replace(/\r?\n\s*(\S)/gm," $1").replace(/\r?\n/g,"").trim(),x=C=>{const w=r.slice(i).match(C);return w&&(n=i,i+=w[0].length),w},T=()=>{x(d)?(o.push({[Symbol.for("componentType")]:null,[b.type]:"opening",[b.level]:l,[b.cursorTagStart]:n}),l++,m(T)):m(E)},E=()=>{x(g)?(l--,o.push({[Symbol.for("componentType")]:null,[b.type]:"closing",[b.level]:l}),m(T)):m(M)},M=()=>{const C=x(a);if(C)f={[Symbol.for("componentType")]:C[1],[b.level]:l,[b.cursorTagStart]:n},C[0].startsWith("</")?(l--,f[b.type]="closing",f[b.level]=l):(f[b.type]="opening",l++),m(O);else throw S("InvalidTag")},O=()=>{const C=x(u);if(C){if(C[1]==="/>"){if(f[b.type]==="closing")throw S("InvalidClosingTag");f[b.type]="self-closing",l--}if(f[b.type]==="opening"){const w=r.slice(i,r.indexOf("<",i));w&&(f.content=w,i+=w.length)}o.push(f),m(T)}else m(U)},U=()=>{const C=x(h);if(C){if(f[b.type]==="closing")throw S("AttributesInClosingTag");const w=C[2],R=new RegExp(`^(.*?)${w}\\s*`),V=x(R);if(V){const N=F(C[1],V[1]);f[N.name]=N.value,m(O)}else throw S("MissingOrInvalidAttributeValue")}else throw S("InvalidAttribute")},F=(C,w)=>{if(C.includes(".")){const[R,V]=C.split(".");return{name:R,value:`{${V}: ${w}}`}}return["color",":color",":effects","effects"].includes(C)?z(C,w):{name:C,value:w}},z=(C,w)=>{let R=w,V=nt.normalize(R,null);if(V===null){const N=/'([^']+)'/g;let k,B=0,$="";for(;(k=N.exec(w))!==null;){const K=k[1],X=k.index,H=k[0].length;$+=w.slice(B,X),V=nt.normalize(K,null),V===null?$+=w.slice(X,X+H):$+=`'${V}'`,B=X+H}$+=w.slice(B),R=$}else R=V;return{name:C,value:R}},v=C=>{let w=[],R=!1,V={children:[]},N=V;for(let k=0;k<C.length;k++){let B=C[k];if(B[b.level]===0&&B[b.type]!=="closing"){if(R)throw L("MultipleTopLevelTags",B);if(B[":for"]!==void 0)throw L("ForAttributeOnRootElement",B);R=!0}if(B[b.type]==="opening")w.push({[b.level]:B[b.level],[b.type]:B[b.type],[b.cursorTagStart]:B[b.cursorTagStart],[Symbol.for("componentType")]:B[Symbol.for("componentType")],parent:N});else if(B[b.type]==="closing"){const K=w.length===0;let X=!1,H=!1;if(K||(X=w[w.length-1][b.level]!==B[b.level],H=w[w.length-1][Symbol.for("componentType")]!==B[Symbol.for("componentType")]),K||X||H)throw L("MismatchedClosingTag",B);N=w.pop().parent}const $={...B};delete $[b.type],delete $[b.level],delete $[b.cursorTagStart],B[b.type]==="opening"?(k+1<C.length&&C[k+1][b.type]!=="closing"&&($.children=[]),N.children.push($),N=$):B[b.type]==="self-closing"&&N.children.push($)}if(w.length>0)throw L("UnclosedTags",w);return V},W=10,I=50,S=C=>{const w=D();C=`${C} in ${w}`;const R=new Error(C);R.name="TemplateParseError";const V=Math.max(0,n-W),N=Math.min(r.length,i+I),k=r.slice(V,N),B=i-V;return R.context=A(B,k),R},L=(C,w)=>{const R=D();C=`${C} in ${R}`;const V=new Error(C);V.name="TemplateStructureError",Array.isArray(w)?V.context=w.map(k=>N(k)).join(`
`):V.context=N(w);function N(k){const B=Math.max(0,k[b.cursorTagStart]-W),$=r.slice(B,B+I);return A(W,$)}return V},A=(C,w)=>{const R=" ".repeat(C)+"^";return`
${w}
${R}
`},D=()=>s||"Blits.Application";return p()};let Y,At;function ho(r={children:[]},t=!1){const e={renderCode:["const elms = []","const elementConfigs = []","const forloops = []","const props = []","const created = []","const effects = {}","const skips = []","let componentType","let rootComponent = component","let propData","let slotComponent","let inSlot = false","let slotChildCounter = 0","let cmps = []"],effectsCode:[],cleanupCode:["rootComponent = null","propData = null","slotComponent = null","parent = null"],context:{props:[],components:this.components}};return Y=-1,At=t,At===!0&&e.renderCode.push(`
      function propInComponent(prop, kind="dynamic") {
        const property = prop.includes('.') ? prop.split('.')[0] : prop
        if (kind === 'reactive' || prop.includes('.') === false) {
          if (property in component === false) {
            Log.warn('Property ' +  property + ' was accessed during render but is not defined on instance')
          }
        } else {
          const nestedKeys = prop.split('.')
          let base = component
          for(let i =0; i<nestedKeys.length;i++){
            if (base[nestedKeys[i]] === undefined) {
              Log.warn('Property ' +  nestedKeys.slice(0,i+1).join('.') + ' was accessed during render but is not defined on instance')
            }
            base = base[nestedKeys[i]]
          }
        }
      }
    `),Yi.call(e,r),e.renderCode.push(`
    return { elms, cleanup: () => {
      ${e.cleanupCode.join(`
`)}
      component = null
      cmps.length = 0
      elms.length = 0
      components.length = 0
      elementConfigs.length = 0
      forloops.length = 0
      props.length = 0
      skips.length = 0
    }}
  `),{render:new Function("parent","component","context","components","effect","getRaw","Log",e.renderCode.join(`
`)),effects:e.effectsCode.map(s=>new Function("component","elms","context","components","rootComponent","effect",s)),context:e.context}}const po=function(r){const t=/\$\$?\w+(\.\w+)?/g,e=r.match(t);if(e!==null){const s=/\$shader/;return e.filter(i=>!s.test(i))}else return!1},Gs=function(r,t,e="dynamic"){const s=po(r);if(s!==!1)for(let i=0;i<s.length;i++){let n=s[i];e==="reactive"&&n.includes(".")&&(n=n.split(".")[0]),t.push(`propInComponent('${n.replace("$","")}', '${e}')`)}},Er=function(r,t=!1,e={key:!1,component:"component.",forceEffect:!1,forloop:!1}){const s=e.forceEffect?this.effectsCode:this.renderCode;t&&s.push(`parent = ${t}`),"key"in r&&(e.key=le(r.key,e.component));const i=e.key?`elms[${Y}][${e.key}]`:`elms[${Y}]`;e.key&&s.push(`
      if(elms[${Y}] === undefined) {
        elms[${Y}] = {}
      }
    `),s.push(`elementConfigs[${Y}] = {}`),e.forloop&&s.push(`if(${i} === undefined) {`),s.push(`
    ${i} = this.element({parent: parent || 'root'}, inSlot === true ? slotComponent : component)
  `),e.forloop&&s.push("}");const n=r.children;delete r.children,r[Symbol.for("componentType")]==="Slot"&&s.push(`elementConfigs[${Y}][Symbol.for('isSlot')] = true`),Object.keys(r).forEach(o=>{if(o==="slot"&&s.push(`
        elementConfigs[${Y}]['parent'] = slotComponent[Symbol.for('slots')] !== undefined && Array.isArray(slotComponent[Symbol.for('slots')]) === true && slotComponent[Symbol.for('slots')].filter(slot => slot.ref === '${r.slot}').shift() || parent
      `),o==="key"||o==="inspector-data"&&!At)return;const f=r[o];if(ji(o)){if(e.holder&&o===":color")return;e.holder?this.effectsCode.push(`
        if(typeof skips === 'undefined' || (typeof skips[${Y}] === 'undefined' ||
          skips[${Y}].indexOf('${o.substring(1)}') === -1))
          ${i}.set('${o.substring(1)}', ${le(r[o],e.component)})
        `):this.effectsCode.push(`
            ${i}.set('${o.substring(1)}', ${le(r[o],e.component)})
          `),At===!0&&e.component!=="scope."&&f.includes("$")&&Gs(f,s,"reactive"),s.push(`elementConfigs[${Y}]['${o.substring(1)}'] = ${le(f,e.component)}`)}else At===!0&&e.component!=="scope."&&f.includes("$")&&Gs(f,s),s.push(`elementConfigs[${Y}]['${o}'] = ${Ls(f,o,e.component)}`)}),e.holder===!0&&s.push(`
    skips[${Y}] = []
    if(typeof cmps[${Y}] !== 'undefined') {
      for(let key in cmps[${Y}][Symbol.for('config')].props) {
        delete elementConfigs[${Y}][cmps[${Y}][Symbol.for('config')].props[key]]
        skips[${Y}].push(cmps[${Y}][Symbol.for('config')].props[key])
      }
    }
    `),e.forloop&&s.push(`if(${i}.nodeId === undefined) {`),s.push(`${i}.populate(elementConfigs[${Y}])`),s.push(`
    if(inSlot === true) {
      slotChildCounter -= 1
    }
  `),e.forloop&&s.push("}"),n&&Yi.call(this,{children:n},`${i}`,e)},Gi=function(r,t=!1,e={key:!1,component:"component.",forceEffect:!1,holder:!1,forloop:!1}){const s=e.forceEffect?this.effectsCode:this.renderCode;s.push(`
    cmps[${Y}] =
      (context.components && context.components['${r[Symbol.for("componentType")]}']) || components['${r[Symbol.for("componentType")]}']
  `),this.cleanupCode.push(`
    cmps[${Y}] = null
  `),"key"in r&&(e.key=le(r.key,e.component));const i=r.children;delete r.children,Er.call(this,r,t,{...e,holder:!0}),t=e.key?`elms[${Y}][${e.key}]`:`elms[${Y}]`,Y++;const n=e.key?`elms[${Y}][${e.key}]`:`elms[${Y}]`;e.key&&s.push(`
      if(elms[${Y}] === undefined) {
        elms[${Y}] = {}
      }
    `),t&&s.push(`parent = ${t};`),s.push(`props[${Y}] = {}`),this.cleanupCode.push(`props[${Y}] = null`),e.forloop&&s.push(`if(${n} === undefined) {`),Object.keys(r).forEach(o=>{ji(o)?(this.effectsCode.push(`
        ${n}[Symbol.for('props')]['${o.substring(1)}'] = ${le(r[o],e.component)}`),s.push(`
        propData = ${le(r[o],e.component)}
        if (Array.isArray(propData) === true) {
          propData = getRaw(propData).slice(0)
        }
        props[${Y}]['${o.substring(1)}'] = propData`)):s.push(`props[${Y}]['${o}'] = ${Ls(r[o],o,e.component)}`)}),s.push(`
    componentType = props[${Y}]['is'] || '${r[Symbol.for("componentType")]}'

    components[${Y}]
    if(typeof componentType === 'string') {
      components[${Y}] = context.components && context.components[componentType] || components[componentType]
      if(!components[${Y}]) {
        throw new Error('Component "${r[Symbol.for("componentType")]}" not found')
      }
    } else if(typeof componentType === 'function' && componentType[Symbol.for('isComponent')] === true) {
      components[${Y}] = componentType
    }

    ${n} = components[${Y}].call(null, {props: props[${Y}]}, ${t}, component)

    if (${n}[Symbol.for('slots')][0]) {
      parent = ${n}[Symbol.for('slots')][0]
      slotComponent = ${n}
      inSlot = true
    } else {
      parent = ${n}[Symbol.for('children')][0]
    }
  `),this.cleanupCode.push(`components[${Y}] = null`),e.forloop&&s.push("}"),i&&(e.forloop||s.push(`
        if(inSlot === true) {
          slotChildCounter = ${i.length}  + 1
        }
      `),Y++,Er.call(this,{children:i},!1,{...e})),e.forloop||s.push(`
      if (inSlot === true && slotChildCounter === 0) {
        inSlot = false
      }
    `)},mo=function(r,t){const e=r[":for"];delete r[":for"];const s=r.range||r[":range"]||"{}";delete r.range,delete r[":range"];const i=r.key,n=Y,o=le(i,"scope."),f=!(r.$shallow&&r.$shallow.toLowerCase()==="false");delete r.$shallow,delete r.key;const a=/(.+)\s+in\s+(.+)/gi.exec(e),[u,h]=a[1].replace("(","").replace(")","").split(/\s*,\s*/),d=new RegExp(`(scope\\.(?!${u}\\.|${h}|key)([\\w$]+))`,"gi"),g={renderCode:[],effectsCode:[],cleanupCode:[],context:{props:[],components:this.components}};if(t&&g.renderCode.push(`parent = ${t}`),h!==void 0){const F=new RegExp(`\\$${h}(?!['\\w])`).exec(i);Array.isArray(F)&&g.renderCode.push(`console.warn(" Using '${h}' in the key, like key=${i},  is not recommended")`)}g.renderCode.push(`
    created[${n}] = []
    effects[${n}] = []

    let from${n}
    let to${n}

    forloops[${n}] = (collection = [], elms, created) => {
      const rawCollection = getRaw(collection)
      const keys = new Set()
      let l = rawCollection.length

      const range = ${le(s,"component?.")} || {}
      from${n} = range['from'] || 0
      to${n} = 'to' in range ? range['to'] : rawCollection.length

      while(l--) {
        const ${u} = rawCollection[l]
  `),g.cleanupCode.push(`
    created[${n}].length = 0
  `),h!==void 0&&g.renderCode.push(`
        const ${h} = l
    `),g.renderCode.push(`
        if(l < to${n} && l >= from${n}) {
          keys.add('' +  ${le(i,"")||"l"})
        }
      }
  `);const p=g.renderCode.length;g.renderCode.push(`
      created.length = 0
      const length = rawCollection.length

      component !== null && component[Symbol.for('removeGlobalEffects')](effects[${n}])

      for(let i = 0; i < effects[${n}].length; i++) {
        const value = effects[${n}][i]
        const index = component[Symbol.for('effects')].indexOf(value)
        if (index > -1) component[Symbol.for('effects')].splice(index, 1)
      }

      effects[${n}].length = 0
      for(let __index = 0; __index < length; __index++) {
        if(__index < from${n} || __index >= to${n}) continue
        let scope = Object.create(component)
        parent = ${t}
        scope['${u}'] = rawCollection[__index]
  `),h!==""&&g.renderCode.push(`
        scope['${h}'] = __index
    `),g.renderCode.push(`
        scope['key'] = '' + ${o||"__index"}
  `),"ref"in r&&r.ref.indexOf("$")===-1&&(g.renderCode.push(`
        scope['__ref'] = '${r.ref}' + __index
    `),r.ref="$__ref"),g.renderCode.push(`
        created.push(scope.key)
  `),r[Symbol.for("componentType")]==="Element"||r[Symbol.for("componentType")]==="Slot"||r[Symbol.for("componentType")]==="Text"?(r[Symbol.for("componentType")]==="Text"&&(r.__textnode="true"),Er.call(g,r,t,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0})):Gi.call(g,r,!1,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0});const m=g.effectsCode.filter(U=>[...U.matchAll(d)].length===0),y=g.effectsCode.filter(U=>[...U.matchAll(d)].length!==0);f===!1&&g.renderCode.push(`
      scope = Object.assign(collection[__index], scope)
  `),m.forEach((U,F)=>{const z=U.indexOf(`scope.${F}`)>-1?`'${le(a[2],"")}'`:null;U.indexOf("Symbol.for('props')")===-1?g.renderCode.push(`
        let eff${F} = () => {
          ${U}
        }
        effect(eff${F}, ${z})
        effects[${n}].push(eff${F})
        component[Symbol.for('effects')].push(eff${F})
      `):g.renderCode.push(`
        ${U}
      `)}),g.renderCode.push(`
    }
    return effects
  }`);const x=[];x.push(`
      let i = created.length

      while (i--) {
        if (keys.has(created[i]) === false) {
          const key = created[i]
  `);const T=Y;for(let U=n;U<=T;U++)x.push(`
        elms[${U}][key] && elms[${U}][key].destroy()
        elms[${U}][key] = null
        delete elms[${U}][key]
    `);x.push(`
      }
    }
  `),g.renderCode.splice(p,0,...x);let E=`${le(a[2],"")}`;E&&E.includes(".")&&(E=E.match(/[^.]+$/)[0]);const M=/\$([^,} ]+)/g,O=[...s.matchAll(M)].map(U=>`'${U[1]}'`);g.renderCode.push(`
    let eff${n} = () => {
      forloops[${n}](${Ls(a[2],":for")}, elms, created[${n}])
    }

    component[Symbol.for('effects')].push(eff${n})

    effect(eff${n}, ['${E}', ${O.join(",")}])
  `),g.cleanupCode.push(`
    eff${n} = null
    // call loop with empty array
    forloops[${n}]([], elms, created[${n}])
    forloops[${n}] = null
  `),y.forEach((U,F)=>{const z=[...U.matchAll(d)];let v=z.length;const W=[];for(;v--;){const I=z[v],S=`component.${I[2]}`;W.indexOf(S)===-1&&W.push(S),I[2]!==u&&(U=U.substring(0,I.index)+S+U.substring(I.index+I[1].length))}g.renderCode.push(`
      let eff${n}_${F} = () => {
        void ${W.join(", ")}
        for(let __index = 0; __index < ${le(a[2])}.length; __index++) {
          if(__index < from${n} || __index >= to${n}) continue
          const scope = {}
          scope['${h}'] = __index
          scope['${u}'] = ${le(a[2])}[__index]
          scope['key'] = ${o||"__index"}
    `),g.cleanupCode.push(`eff${n}_${F} = null`),g.renderCode.push(`
          ${U}
        }
      }
      component[Symbol.for('effects')].push(eff${n}_${F})
      effect(eff${n}_${F})
    `)}),this.renderCode.push(g.renderCode.join(`
`)),this.cleanupCode.push(g.cleanupCode.join(`
`))},Yi=function(r,t=!1,e={}){r.children&&r.children.forEach(s=>{Y++,Object.keys(s).indexOf(":for")>-1?mo.call(this,s,t):s[Symbol.for("componentType")]==="Element"||s[Symbol.for("componentType")]==="Slot"||s[Symbol.for("componentType")]==="Text"||s[Symbol.for("componentType")]==="Layout"?(s[Symbol.for("componentType")]==="Text"&&(s.__textnode="true"),s[Symbol.for("componentType")]==="Layout"&&(s.__layout="true"),Er.call(this,s,t,e)):Gi.call(this,s,t,e)})},le=(r,t="component.")=>{if(r===void 0)return r;const e=/('.*?')+/gi,s=/\$(\$(?=\$)|\$?)/g,i=r.matchAll(e),n=[];let o=0;for(const f of i)n.push(f[0]),r=r.replace(f[0],`[@@REPLACEMENT${o}@@]`),o++;return r=r.replace(s,(f,l)=>{if(l==="")return t;if(l==="$")return t+"$"}),n.forEach((f,l)=>{r=r.replace(`[@@REPLACEMENT${l}@@]`,f)}),r},Ls=(r="",t=!1,e="component.")=>{const s=/\$\w+/gi;let i;if(t==="content")if(r.startsWith("$"))i=`${e}${r.replace("$","")}`;else{const n=r.replace(/\\\\/g,"__DOUBLE_BACKSLASH__").replace(/(^|[^\\])'/g,"$1\\'").replace(/__DOUBLE_BACKSLASH__/g,"\\\\");i=`'${go(n,e)}'`}else if(t!=="color"&&/[^0-9%\s.eE]/.test(r)===!1&&!isNaN(parseFloat(r))){if(i=parseFloat(r),r.endsWith("%")){const o={w:"width",width:"width",x:"width",h:"height",height:"height",y:"height"}[t];o&&(i=`parent.node.${o} * (${i} / 100)`)}}else if(r.toLowerCase()==="true")i=!0;else if(r.toLowerCase()==="false")i=!1;else if(t.startsWith("@")&&r){const n=e.slice(0,-1);i=`${n}['${r.replace("$","")}'] && ${n}['${r.replace("$","")}'].bind(${n})`}else if(r.startsWith("$"))i=`${e}${r.replace("$","")}`;else if(s.exec(r)){const n=/\w+\s*:\s*(?:[^\s,}]+|".*?"|'.*?')/g,o=r.match(n);if(i={},o)for(let f=0;f<o.length;f++){const l=o[f].split(/\s*:\s*/);l&&yo(l[0],l[1],e,i)}return xo(i)}else i=`"${r}"`;return i},ji=r=>r.startsWith(":"),go=(r,t)=>{const e=/\{\{\s*(\$\S+)\s*\}\}/g,s=[...r.matchAll(e)];if(s.length)for(let[i,n]of s)r=r.replace(i,`${n.replace("$",`'+${t}`)}+'`);return r},yo=(r,t,e,s)=>{t.startsWith("$")?s[r]=`${e}${t.replace("$","")}`:s[r]=t},xo=r=>{const t=[];return Object.keys(r).forEach(e=>{t.push(`${e}: ${r[e]}`)}),` { ${t.join(", ")} }`},Ys={};let bo=0;const To=r=>`BlitsComponent::${r}_${Ys[r]=(Ys[r]||0)+1}`,So=()=>++bo,_e={},cr=(r,t,e,s=[])=>{_e[t]&&_e[t][r]&&_e[t][r].apply(e,s)},wo=(r,t,e)=>{const s=b[r];_e[t]&&_e[t][s]&&_e[t][s].apply(e)},Co=(r={},t)=>{_e[t]={},[...Object.keys(r),...Object.getOwnPropertySymbols(r)].forEach(s=>{typeof r[s]=="function"&&(_e[t][s]=r[s])})};let ot=null,et=null,Ur=!1;const Eo=()=>{Ur=!0},Ro=()=>{Ur=!1},Rr=new WeakMap,hr=new Map,js=r=>{if(hr.size!==0)for(const[t,e]of hr){if(r.indexOf(t)===-1)continue;const s=Rr.get(e);if(s!==void 0)for(const i of s.values())i.delete(t),hr.delete(t)}},dr=(r,t,e=!1)=>{if(ot!==null){if(Ur)return;if(Array.isArray(et)===!0){if(et.includes(t)===!1)return}else if(et!==null&&t!==et)return;let s=Rr.get(r);s===void 0&&(s=new Map,Rr.set(r,s));let i=s.get(t);i===void 0&&(i=new Set,s.set(t,i)),i.add(ot),e===!0&&hr.set(ot,r)}},at=(r,t,e=!1)=>{if(Ur===!0)return;const s=Rr.get(r);if(s===void 0)return;const i=s.get(t);if(i!==void 0)for(let n of i)n(e)},Zt=(r,t=null)=>{ot=r,et=t,ot(),ot=null,et=null},fs=(r,t)=>{if(r===t)return!0;if(r.length!==t.length)return!1;let e=r.length;for(;e--;){const s=r[e],i=t[e];if(Array.isArray(s)&&Array.isArray(i)){if(fs(s,i)===!1)return!1}else if(typeof s=="object"&&s!==null&&typeof i=="object"&&i!==null){if(fs(Object.entries(s),Object.entries(i))===!1)return!1}else if(s!==i)return!1}return!0},pr=["push","pop","shift","unshift","splice","sort"],Ks=new WeakMap,Ce=r=>{const t=r&&r[b.raw];return t?Ce(t):r},us=(r,t=null,e,s)=>{if(typeof r=="object"&&Array.isArray(r)===!1&&Object.getPrototypeOf(r)!==Object.prototype)return r;const i=Ks.get(r);if(i!==void 0)return i;const n={get(f,l,a){return l===b.isProxy?!0:l===b.raw?r:Array.isArray(f)===!0?typeof f[l]=="object"&&f[l]!==null?(Array.isArray(f[l])===!0&&dr(f,l,s),us(Ce(f[l]),f,l,s)):pr.indexOf(l)!==-1?function(...u){Eo();const h=f[l].apply(this,u);return Ro(),at(t,e),h}:l==="length"?r.length:Reflect.get(f,l,a):typeof f[l]=="object"&&f[l]!==null?(Array.isArray(f[l])===!0&&dr(f,l,s),us(Ce(f[l]),f,l,s)):(dr(f,l,s),Reflect.get(f,l,a))},set(f,l,a,u){const h=Ce(f[l]),d=Ce(a);let g=!0,p=!1;return Array.isArray(d)===!0&&Array.isArray(h)===!0?p=fs(h,d):h===d&&(p=!0),p===!1&&(typeof a=="object"&&(Array.isArray(a)===!0?a=Ce(a).slice(0):a!==null&&f[l]!==null&&f[l]!==void 0&&Array.isArray(f)===!1&&Object.getPrototypeOf(a)===Object.prototype&&(a=Object.assign(u[l],a))),g=Reflect.set(f,l,a,u)),g===!0&&p===!1&&(Array.isArray(f)===!0&&l in f&&at(t,e,!0),at(f,l,!0)),g}},o=new Proxy(r,n);return Ks.set(r,o),o},Ki=(r,t)=>(Object.keys(r).forEach(e=>{let s=r[e];if(r[e]!==null&&typeof r[e]=="object"){if(Object.getPrototypeOf(r[e])===Object.prototype)return Ki(r[e]);if(Array.isArray(r[e])===!0)for(let i=0;i<pr.length;i++)r[e][pr[i]]=function(n){Array.prototype[pr[i]].call(this,n),at(r,e)}}Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get(){return dr(r,e,t),s},set(i){s!==i&&(s=i,at(r,e))}})}),r),_o=typeof Proxy<"u",cs=(r,t="Proxy",e=!1)=>(_o===!1&&(t="defineProperty"),t==="defineProperty"?Ki(r,e):us(r,void 0,void 0,e)),vo=["init","ready","focus","unfocus","destroy","attach","detach","enter","exit"],Ao={previous:null,current:null,get state(){return this.current},set state(r){if(vo.indexOf(r)>-1&&r!==this.current||r==="refocus"){if(j.debug(`Setting lifecycle state from ${this.current} to ${r} for ${this.component.componentId}`),this.previous=this.current,this.current=r,r==="refocus")return;wo(r,this.component[b.identifier],this.component),cr(r,this.component[b.identifier],this.component),r==="focus"&&(this.component[b.state].hasFocus=!0),r==="unfocus"&&(this.component[b.state].hasFocus=!1)}}},ko="modulepreload",Mo=function(r,t){return new URL(r,t).href},qs={},Io=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){const o=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),l=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));i=Promise.allSettled(e.map(a=>{if(a=Mo(a,s),a in qs)return;qs[a]=!0;const u=a.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!s)for(let p=o.length-1;p>=0;p--){const m=o[p];if(m.href===a&&(!u||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${h}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":ko,u||(g.as="script"),g.crossOrigin="",g.href=a,l&&g.setAttribute("nonce",l),document.head.appendChild(g),u)return new Promise((p,m)=>{g.addEventListener("load",p),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${a}`)))})}))}function n(o){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=o,window.dispatchEvent(f),!f.defaultPrevented)throw o}return i.then(o=>{for(const f of o||[])f.status==="rejected"&&n(f.reason);return t().catch(n)})};function Lo(r,t=!1,e){const s={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},i=r.getContext(t?"webgl2":"webgl",s)||r.getContext("experimental-webgl",s);if(!i)throw new Error("Unable to create WebGL context");return e?new Proxy(i,{get(n,o){const f=n[o];return typeof f=="function"?(e.increment(String(o)),f.bind(n)):f}}):i}function Qs(r,t,e){const s=Math.trunc(r>>>24),i=Math.trunc(r>>>16&255),n=Math.trunc(r>>>8&255),o=Math.trunc(r&255),f=Math.trunc(t>>>24),l=Math.trunc(t>>>16&255),a=Math.trunc(t>>>8&255),u=Math.trunc(t&255),h=Math.round(f*e+s*(1-e)),d=Math.round(l*e+i*(1-e)),g=Math.round(a*e+n*(1-e)),p=Math.round(u*e+o*(1-e));return(h<<24|d<<16|g<<8|p)>>>0}function Po(r,t){const e=r>>>24,s=r>>>16&255,i=r>>>8&255,n=Math.trunc((r&255)*t);return(e<<24|s<<16|i<<8|n)>>>0}let qi=!0;function Oo(r){qi=r==="webgl"}function Jt(r,t,e=!1){const s=(r&255)/255*t,i=qi?s:1,n=Math.trunc((r>>>24)*i),o=Math.trunc((r>>>16&255)*i),f=Math.trunc((r>>>8&255)*i),l=Math.trunc(s*255);return e?(l<<24|f<<16|o<<8|n)>>>0:(n<<24|o<<16|f<<8|l)>>>0}function _r(r,t){return Object.prototype.hasOwnProperty.call(r,t)}const Fo=!0;let Bo=1;function Uo(){return Bo++}class we{constructor(){c(this,"eventListeners",{})}on(t,e){let s=this.eventListeners[t];s||(s=[]),s.push(e),this.eventListeners[t]=s}off(t,e){const s=this.eventListeners[t];if(!s)return;if(!e){delete this.eventListeners[t];return}const i=s.indexOf(e);i>=0&&s.splice(i,1)}once(t,e){const s=(i,n)=>{this.off(t,s),e(i,n)};this.on(t,s)}emit(t,e){const s=this.eventListeners[t];s&&[...s].forEach(i=>{i(this,e)})}removeAllListeners(){this.eventListeners={}}}var q;(function(r){r[r.generic=0]="generic",r[r.color=1]="color",r[r.image=2]="image",r[r.noise=3]="noise",r[r.renderToTexture=4]="renderToTexture",r[r.subTexture=5]="subTexture"})(q||(q={}));const Or=class Or extends we{constructor(e){super();c(this,"txManager");c(this,"_dimensions",null);c(this,"_error",null);c(this,"state","initial");c(this,"renderableOwners",[]);c(this,"renderable",!1);c(this,"type",q.generic);c(this,"preventCleanup",!1);c(this,"ctxTexture");c(this,"textureData",null);c(this,"memUsed",0);c(this,"retryCount",0);c(this,"maxRetryCount");c(this,"createdAt",Date.now());c(this,"gracePeriodExpired",!1);this.txManager=e,this.maxRetryCount=e.maxRetryCount}get dimensions(){return this._dimensions}get error(){return this._error}isWithinStartupGracePeriod(){return this.gracePeriodExpired?!1:Date.now()-this.createdAt>=Or.STARTUP_GRACE_PERIOD?(this.gracePeriodExpired=!0,!1):!0}canBeCleanedUp(){return!(this.preventCleanup||this.isWithinStartupGracePeriod()||this.renderable===!0||this.renderableOwners.length>0)}setRenderableOwner(e,s){var o,f;const i=this.renderableOwners.length,n=this.renderableOwners.indexOf(e);if(s===!0){n===-1&&this.renderableOwners.push(e);const l=this.renderableOwners.length;i!==l&&l===1&&(this.renderable=!0,(o=this.onChangeIsRenderable)==null||o.call(this,!0),this.load())}else{n!==-1&&this.renderableOwners.splice(n,1);const l=this.renderableOwners.length;i!==l&&l===0&&(this.renderable=!1,(f=this.onChangeIsRenderable)==null||f.call(this,!1))}}load(){this.retryCount>this.maxRetryCount||this.txManager.loadTexture(this)}loadCtxTexture(){return this.ctxTexture===void 0&&(this.ctxTexture=this.txManager.renderer.createCtxTexture(this)),this.ctxTexture}free(){var e;(e=this.ctxTexture)==null||e.free()}release(){var e;(e=this.ctxTexture)==null||e.release(),this.ctxTexture=void 0,this.freeTextureData()}destroy(){this.state==="loaded"&&this.free(),this.freeTextureData()}freeTextureData(){queueMicrotask(()=>{this.textureData=null})}setState(e,s){if(this.state===e)return;let i=null;e==="loaded"?(this._error=null,s!==void 0&&"width"in s&&"height"in s&&s.width!==void 0&&s.height!==void 0&&(this._dimensions=s),i=this._dimensions):e==="failed"?(this._error=s,i=this._error,this.retryCount+=1,queueMicrotask(()=>{this.release()})):e==="loading"?(this._error=null,this._dimensions=null):this._error=null,this.state=e,this.emit(e,i)}async getTextureData(){return this.textureData===null&&(this.textureData=await this.getTextureSource()),this.textureData}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}retry(){this.release(),this.retryCount=0,this.load()}};c(Or,"STARTUP_GRACE_PERIOD",2e3);let Be=Or;const $o=/^(data|ftps?|https?):/,$t=r=>{const t=r>>>24,e=r>>>16&255,s=r>>>8&255,i=r&255;return[t/255,e/255,s/255,i/255]},Zs=r=>{const t=r>>>24,e=r>>>16&255,s=r>>>8&255,i=r&255;return[t,e,s,i]};function Js(r){return(r&255)/255}function Yr(r){const t=Math.floor(r[0]*255),e=Math.floor(r[1]*255),s=Math.floor(r[2]*255),i=Math.floor(r[3]*255);return`rgba(${t},${e},${s},${i.toFixed(4)})`}function tt(r,t,e,s,i){return i?(i.x1=r,i.y1=t,i.x2=e,i.y2=s,i):{x1:r,y1:t,x2:e,y2:s}}function jr(r,t){return r.x1<t.x2&&r.x2>t.x1&&r.y1<t.y2&&r.y2>t.y1}function No(r,t){return t?(t.x=r.x1,t.y=r.y1,t.width=r.x2-r.x1,t.height=r.y2-r.y1,t):{x:r.x1,y:r.y1,width:r.x2-r.x1,height:r.y2-r.y1}}function Qi(r,t,e){const s=Math.max(r.x,t.x),i=Math.max(r.y,t.y),n=Math.min(r.x+r.width,t.x+t.width)-s,o=Math.min(r.y+r.height,t.y+t.height)-i;return n>0&&o>0?e?(e.x=s,e.y=i,e.width=n,e.height=o,e):{x:s,y:i,width:n,height:o}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function Zi(r,t){return t?(t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height,t):{x:r.x,y:r.y,width:r.width,height:r.height}}function Do(r,t){return r===t?!0:r===null||t===null?!1:r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}function Kr(r,t){return r.x1<=t.x2&&r.y1<=t.y2&&r.x2>=t.x1&&r.y2>=t.y1}function zo(r,t){return r.x1<t.x1&&r.x2>t.x2&&r.y1<t.y1&&r.y2>t.y2}function Wo(r,t,e){return!(r<e.x1||r>e.x2||t<e.y1||t>e.y2)}function Xo(r){return r.x1<r.x2&&r.y1<r.y2}function hs(r,t){return tt(r.x1-t[3],r.y1-t[0],r.x2+t[1],r.y2+t[2])}function Vo(r){if(self.location.protocol==="file:"&&!$o.test(r)){const e=self.location.pathname.split("/");e.pop();const s=e.join("/"),i=self.location.protocol+"//"+s;return r.charAt(0)==="."&&(r=r.slice(1)),r.charAt(0)==="/"&&(r=r.slice(1)),i+"/"+r}return new URL(r,self.location.href).href}function qr(r){return r.startsWith("data:")===!0}function Ho(r){var l,a;r=r.replace(/^data:/,"");const t=((l=r.match(/image\/[^;]+/))==null?void 0:l[0])||"",e=r.replace(/^[^,]+,/,""),s=1024,i=atob(e),n=i.length,o=Math.ceil(n/s),f=new Array(o);for(let u=0;u<o;++u){const h=u*s,d=Math.min(h+s,n),g=new Array(d-h);for(let p=h,m=0;p<d;++m,++p)g[m]=(a=i[p])==null?void 0:a.charCodeAt(0);f[u]=new Uint8Array(g)}return new Blob(f,{type:t})}class ee{constructor(){c(this,"ta");c(this,"tb");c(this,"tx");c(this,"tc");c(this,"td");c(this,"ty");c(this,"_floatArr",null);c(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return Go}static multiply(t,e,s){const i=t.ta*e.ta+t.tb*e.tc,n=t.ta*e.tb+t.tb*e.td,o=t.ta*e.tx+t.tb*e.ty+t.tx,f=t.tc*e.ta+t.td*e.tc,l=t.tc*e.tb+t.td*e.td,a=t.tc*e.tx+t.td*e.ty+t.ty;return s||(s=new ee),s.ta=i,s.tb=n,s.tx=o,s.tc=f,s.td=l,s.ty=a,s.mutation=!0,s}static identity(t){return t||(t=new ee),t.ta=1,t.tb=0,t.tx=0,t.tc=0,t.td=1,t.ty=0,t.mutation=!0,t}static translate(t,e,s){return s||(s=new ee),s.ta=1,s.tb=0,s.tx=t,s.tc=0,s.td=1,s.ty=e,s.mutation=!0,s}static scale(t,e,s){return s||(s=new ee),s.ta=t,s.tb=0,s.tx=0,s.tc=0,s.td=e,s.ty=0,s.mutation=!0,s}static rotate(t,e){const s=Math.cos(t),i=Math.sin(t);return e||(e=new ee),e.ta=s,e.tb=-i,e.tx=0,e.tc=i,e.td=s,e.ty=0,e.mutation=!0,e}static copy(t,e){return e||(e=new ee),e.ta=t.ta,e.tc=t.tc,e.tb=t.tb,e.td=t.td,e.tx=t.tx,e.ty=t.ty,e.mutation=!0,e}translate(t,e){return this.tx=this.ta*t+this.tb*e+this.tx,this.ty=this.tc*t+this.td*e+this.ty,this.mutation=!0,this}scale(t,e){return this.ta=this.ta*t,this.tb=this.tb*e,this.tc=this.tc*t,this.td=this.td*e,this.mutation=!0,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),s=Math.sin(t),i=this.ta*e+this.tb*s,n=this.tb*e-this.ta*s,o=this.tc*e+this.td*s,f=this.td*e-this.tc*s;return this.ta=i,this.tb=n,this.tc=o,this.td=f,this.mutation=!0,this}multiply(t){return ee.multiply(this,t,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const Go=new ee,er=0,tr=2,rr=4,sr=6,ir=1,nr=3,or=5,ar=7;class rt{constructor(t){c(this,"data");this.data=new Float32Array(8),t&&(this.data[er]=t[er],this.data[tr]=t[tr],this.data[rr]=t[rr],this.data[sr]=t[sr],this.data[ir]=t[ir],this.data[nr]=t[nr],this.data[or]=t[or],this.data[ar]=t[ar])}static translate(t,e,s,i,n,o,f,l,a){return a||(a=new rt),a.data[er]=t,a.data[tr]=s,a.data[rr]=n,a.data[sr]=f,a.data[ir]=e,a.data[nr]=i,a.data[or]=o,a.data[ar]=l,a}get x1(){return this.data[er]}get x2(){return this.data[tr]}get x3(){return this.data[rr]}get x4(){return this.data[sr]}get y1(){return this.data[ir]}get y2(){return this.data[nr]}get y3(){return this.data[or]}get y4(){return this.data[ar]}}const Ji=(r,t,e,s)=>{const i=3*r,n=3*(e-r)-i,o=1-i-n,f=3*t,l=3*(s-t)-f,a=1-f-l;return function(u){if(u>=1)return 1;if(u<=0)return 0;let h=.5,d,g,p;for(let x=0;x<20;x++){if(d=h*(h*(h*o+n)+i),p=u-d,p>-1e-8&&p<1e-8)return h*(h*(h*a+l)+f);if(g=h*(h*(3*o)+2*n)+i,g>1e-10&&g<1e-10)break;h+=p/g}let m=0,y=1;for(let x=0;x<20;x++){if(h=.5*(m+y),d=h*(h*(h*o+n)+i),p=u-d,p>-1e-8&&p<1e-8)return h*(h*(h*a+l)+f);p<0?y=h:m=h}}},mr={},Yo={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},gr=r=>r,jo=r=>{const t=/-?\d*\.?\d+/g,e=r.match(t);if(e){const[s,i,n,o]=e,f=parseFloat(s||"0.42"),l=parseFloat(i||"0"),a=parseFloat(n||"1"),u=parseFloat(o||"1"),h=Ji(f,l,a,u);return mr[r]=h,h}return console.warn("Unknown cubic-bezier timing: "+r),gr},Ko=r=>{if(r==="linear")return gr;if(mr[r]!==void 0)return mr[r]||gr;if(r==="step-start")return()=>1;if(r==="step-end")return e=>e===1?1:0;const t=Yo[r];if(t!==void 0){const[e,s,i,n]=t,o=Ji(e,s,i,n);return mr[r]=o,o}return r.startsWith("cubic-bezier")?jo(r):(console.warn("Unknown timing function: "+r),gr)};function ei(r){return(r/1024/1024).toFixed(2)}class qo extends we{constructor(e,s,i){super();c(this,"node");c(this,"props");c(this,"settings");c(this,"progress",0);c(this,"delayFor",0);c(this,"delay",0);c(this,"timingFunction");c(this,"propValuesMap",{});c(this,"dynPropValuesMap");this.node=e,this.props=s;for(const f in s)if(f!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[f]={start:e[f]||0,target:s[f]};else if(e.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const l in s.shaderProps)this.propValuesMap.shaderProps[l]={start:e.shader.props[l],target:s.shaderProps[l]}}else{const l=Object.keys(s.shaderProps),a=l.length;this.dynPropValuesMap={};for(let u=0;u<a;u++){const h=l[u],d=s.shaderProps[h];this.dynPropValuesMap[h]={};const g=Object.entries(d),p=g.length;for(let m=0;m<p;m++){const[y,x]=g[m];this.dynPropValuesMap[h][y]={start:e.shader.props[h][y],target:x}}}}const n=i.easing||"linear",o=i.delay??0;this.settings={duration:i.duration??0,delay:o,easing:n,loop:i.loop??!1,repeat:i.repeat??0,repeatDelay:i.repeatDelay??0,stopMethod:i.stopMethod??!1},this.timingFunction=Ko(n),this.delayFor=o,this.delay=o}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,s){const i=Object.entries(s),n=i.length;for(let o=0;o<n;o++){const[f,l]=i[o];e[f]=l.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),s=e.length;if(s>0)for(let i=0;i<s;i++){const n=e[i];this.restoreValues(this.node.shader.props[n],this.dynPropValuesMap[n])}}}reverseValues(e){const s=Object.entries(e),i=s.length;for(let n=0;n<i;n++){const[o,f]=s[n];e[o]={start:f.target,target:f.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),s=e.length;if(s>0)for(let i=0;i<s;i++){const n=e[i];this.reverseValues(this.dynPropValuesMap[n])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,s,i){return(this.timingFunction(e)||e)*(i-s)+s}updateValue(e,s,i,n){if(this.progress===1)return s;if(this.progress===0)return i;const o=s;if(e.indexOf("color")!==-1){if(i===o)return i;if(n){const f=this.timingFunction(this.progress)||this.progress;return Qs(i,o,f)}return Qs(i,o,this.progress)}return n?this.applyEasing(this.progress,i,o):i+(o-i)*this.progress}updateValues(e,s,i){const n=Object.entries(s),o=n.length;for(let f=0;f<o;f++){const[l,a]=n[f];e[l]=this.updateValue(l,a.target,a.start,i)}}update(e){const{duration:s,loop:i,easing:n,stopMethod:o}=this.settings,{delayFor:f}=this;if(this.node.destroyed){this.emit("destroyed",{});return}if(s===0&&f===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(s===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=e/s,this.progress>1&&(this.progress=i?0:1,this.delayFor=this.delay,o)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,n),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,n),this.dynPropValuesMap!==void 0){const l=Object.keys(this.dynPropValuesMap),a=l.length;if(a>0)for(let u=0;u<a;u++){const h=l[u];this.updateValues(this.node.shader.props[h],this.dynPropValuesMap[h],n)}}this.progress<1&&this.emit("tick",{progress:this.progress}),this.progress===1&&this.emit("finished",{})}}class Qo extends we{constructor(e,s){super();c(this,"manager");c(this,"animation");c(this,"stoppedPromise");c(this,"stoppedResolve",null);c(this,"state");this.manager=e,this.animation=s,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this),this.onTick=this.onTick.bind(this),this.onDestroy=this.onDestroy.bind(this)}start(){return this.state!=="running"&&this.state!=="scheduled"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="scheduled"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.animation.on("tick",this.onTick),this.animation.on("destroyed",this.onDestroy),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating),this.animation.off("tick",this.onTick),this.animation.off("destroy",this.onDestroy)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onDestroy(){this.unregisterAnimation(),this.state="stopped"}onFinished(){const{loop:e,stopMethod:s}=this.animation.settings;if(s==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}e||(this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.emit("stopped",this),this.state="stopped")}onAnimating(){this.state="running",this.emit("animating",this)}onTick(e,s){this.emit("tick",s)}}var re;(function(r){r[r.Init=0]="Init",r[r.OutOfBounds=2]="OutOfBounds",r[r.InBounds=4]="InBounds",r[r.InViewport=8]="InViewport"})(re||(re={}));const Nt=new Map;Nt.set(re.Init,"init");Nt.set(re.OutOfBounds,"outOfBounds");Nt.set(re.InBounds,"inBounds");Nt.set(re.InViewport,"inViewport");var P;(function(r){r[r.Children=1]="Children",r[r.ScaleRotate=2]="ScaleRotate",r[r.Local=4]="Local",r[r.Global=8]="Global",r[r.Clipping=16]="Clipping",r[r.CalculatedZIndex=32]="CalculatedZIndex",r[r.ZIndexSortedChildren=64]="ZIndexSortedChildren",r[r.PremultipliedColors=128]="PremultipliedColors",r[r.WorldAlpha=256]="WorldAlpha",r[r.RenderState=512]="RenderState",r[r.IsRenderable=1024]="IsRenderable",r[r.RenderTexture=2048]="RenderTexture",r[r.ParentRenderTexture=4096]="ParentRenderTexture",r[r.RenderBounds=8192]="RenderBounds",r[r.None=0]="None",r[r.All=14335]="All"})(P||(P={}));class ds extends we{constructor(e,s){super();c(this,"stage");c(this,"children",[]);c(this,"_id",Uo());c(this,"props");c(this,"updateType",P.All);c(this,"childUpdateType",P.None);c(this,"globalTransform");c(this,"scaleRotateTransform");c(this,"localTransform");c(this,"sceneGlobalTransform");c(this,"renderCoords");c(this,"sceneRenderCoords");c(this,"renderBound");c(this,"strictBound");c(this,"preloadBound");c(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});c(this,"isRenderable",!1);c(this,"renderState",re.Init);c(this,"worldAlpha",1);c(this,"premultipliedColorTl",0);c(this,"premultipliedColorTr",0);c(this,"premultipliedColorBl",0);c(this,"premultipliedColorBr",0);c(this,"calcZIndex",0);c(this,"hasRTTupdates",!1);c(this,"parentHasRenderTexture",!1);c(this,"rttParent",null);c(this,"destroyed",!1);c(this,"onTextureLoaded",(e,s)=>{var i,n;this.autosizeNode(s),this.setUpdateType(P.IsRenderable),this.stage.requestRender(),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),s.width>1&&s.height>1&&this.emit("loaded",{type:"texture",dimensions:s}),((n=(i=this.props.textureOptions)==null?void 0:i.resizeMode)==null?void 0:n.type)==="contain"&&this.setUpdateType(P.Local)});c(this,"onTextureFailed",(e,s)=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(P.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.texture!==null&&this.texture.retryCount>this.texture.maxRetryCount&&this.emit("failed",{type:"texture",error:s})});c(this,"onTextureFreed",()=>{this.isRenderable=!1,this.updateTextureOwnership(!1),this.setUpdateType(P.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.emit("freed",{type:"texture"})});this.stage=e,this.props={...s,parent:null,texture:null,src:null,rtt:!1},this.parent=s.parent,this.texture=s.texture,this.src=s.src,this.rtt=s.rtt,this.interactive=s.interactive,s.boundsMargin&&(this.boundsMargin=Array.isArray(s.boundsMargin)?s.boundsMargin:[s.boundsMargin,s.boundsMargin,s.boundsMargin,s.boundsMargin]),this.setUpdateType(P.ScaleRotate|P.Local|P.RenderBounds|P.RenderState),this.stage.defaultTexture&&this.stage.defaultTexture.state!=="loaded"&&this.stage.defaultTexture.once("loaded",()=>{this.setUpdateType(P.IsRenderable)})}loadTexture(){const{texture:e}=this.props;queueMicrotask(()=>{var s;if(this.textureOptions.preload===!0&&this.stage.txManager.loadTexture(e),e.preventCleanup=((s=this.props.textureOptions)==null?void 0:s.preventCleanup)??!1,e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed),e.state==="loaded"?(e.dimensions,this.onTextureLoaded(e,e.dimensions)):e.state==="failed"?(e.error,this.onTextureFailed(e,e.error)):e.state==="freed"&&this.onTextureFreed(e),this.parentHasRenderTexture){this.notifyParentRTTOfUpdate();return}})}unloadTexture(){this.texture!==null&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this._id,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const s=this.props.parent;s&&(s.updateType&P.Children||s.setUpdateType(P.Children))}sortChildren(){this.children.sort((e,s)=>e.calcZIndex-s.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:s,scaleY:i}=this.props;if(e===0&&s===1&&i===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=ee.rotate(e,this.scaleRotateTransform).scale(s,i)}updateLocalTransform(){var a,u;const{x:e,y:s,width:i,height:n}=this.props,o=this.props.mountX*i,f=this.props.mountY*n;if(this.scaleRotateTransform){const h=this.props.pivotX*i,d=this.props.pivotY*n;this.localTransform=ee.translate(e-o+h,s-f+d,this.localTransform).multiply(this.scaleRotateTransform).translate(-h,-d)}else this.localTransform=ee.translate(e-o,s-f,this.localTransform);const l=this.props.texture;if(l&&l.dimensions&&((u=(a=this.props.textureOptions)==null?void 0:a.resizeMode)==null?void 0:u.type)==="contain"){let h=1,d=1,g=0,p=0;const{width:m,height:y}=l.dimensions,x=m/y,T=i/n;if(x>T){const E=i/m,M=y*E;p=(n-M)/2,d=M/n}else{const E=n/y,M=m*E;g=(i-M)/2,h=M/i}this.localTransform.translate(g,p).scale(h,d)}this.setUpdateType(P.Global)}update(e,s){this.updateType&P.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(P.Local)),this.updateType&P.Local&&(this.updateLocalTransform(),this.setUpdateType(P.Global));const i=this.props.parent;let n=null;if(this.updateType&P.RenderTexture&&this.rtt&&(this.hasRTTupdates=!0),this.updateType&P.Global&&(this.localTransform,this.parentHasRenderTexture===!0&&(i==null?void 0:i.rtt)===!0?(this.globalTransform=ee.identity(),this.sceneGlobalTransform=ee.copy((i==null?void 0:i.globalTransform)||ee.identity()).multiply(this.localTransform)):this.parentHasRenderTexture===!0&&(i==null?void 0:i.rtt)===!1?(this.sceneGlobalTransform=ee.copy((i==null?void 0:i.sceneGlobalTransform)||this.localTransform).multiply(this.localTransform),this.globalTransform=ee.copy((i==null?void 0:i.globalTransform)||this.localTransform,this.globalTransform)):this.globalTransform=ee.copy((i==null?void 0:i.globalTransform)||this.localTransform,this.globalTransform),i!==null&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(P.RenderState|P.Children),this.childUpdateType|=P.Global,this.clipping===!0&&(this.setUpdateType(P.Clipping|P.RenderBounds),this.childUpdateType|=P.RenderBounds)),this.updateType&P.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(P.RenderState),this.setUpdateType(P.Children),this.childUpdateType|=P.RenderBounds),this.updateType&P.RenderState&&(n=this.checkRenderBounds(),this.setUpdateType(P.IsRenderable),n!==re.OutOfBounds&&this.updateRenderState(n)),this.updateType&P.WorldAlpha&&(i?this.worldAlpha=i.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(P.Children|P.PremultipliedColors|P.IsRenderable),this.childUpdateType|=P.WorldAlpha),this.updateType&P.IsRenderable&&this.updateIsRenderable(),this.updateType&P.Clipping&&(this.calculateClippingRect(s),this.setUpdateType(P.Children),this.childUpdateType|=P.Clipping,this.childUpdateType|=P.RenderBounds),this.updateType&P.PremultipliedColors&&(this.premultipliedColorTl=Jt(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Jt(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Jt(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Jt(this.props.colorBr,this.worldAlpha,!0))),i!==null&&this.updateType&P.CalculatedZIndex&&(this.calculateZIndex(),i.setUpdateType(P.ZIndexSortedChildren)),this.props.strictBounds===!0&&this.renderState===re.OutOfBounds){this.updateType&=~P.RenderBounds;return}if(this.updateType&P.Children&&this.children.length>0)for(let o=0,f=this.children.length;o<f;o++){const l=this.children[o];if(l.setUpdateType(this.childUpdateType),l.updateType===0)continue;let a=this.clippingRect;this.rtt===!0&&(a={x:0,y:0,width:0,height:0,valid:!1}),l.update(e,a)}this.parentHasRenderTexture&&this.updateType>0&&this.notifyParentRTTOfUpdate(),this.updateType&P.ZIndexSortedChildren&&this.sortChildren(),n===re.OutOfBounds&&(this.updateRenderState(n),this.updateIsRenderable(),this.rtt===!0&&n===re.OutOfBounds&&this.notifyChildrenRTTOfUpdate(n)),this.updateType=0,this.childUpdateType=0}findParentRTTNode(){let e=this.parent;for(;e&&!e.rtt;)e=e.parent;return e}getRTTParentRenderState(){const e=this.rttParent||this.findParentRTTNode();return e?e.renderState:null}notifyChildrenRTTOfUpdate(e){for(const s of this.children)s.updateRenderState(e),s.updateIsRenderable(),s.notifyChildrenRTTOfUpdate(e)}notifyParentRTTOfUpdate(){if(this.parent===null)return;const e=this.rttParent||this.findParentRTTNode();e&&(e.hasRTTupdates=!0,e.setUpdateType(P.RenderTexture),e.parentHasRenderTexture===!0&&e.notifyParentRTTOfUpdate())}checkRenderBounds(){return this.renderBound,this.strictBound,this.preloadBound,Kr(this.renderBound,this.strictBound)?re.InViewport:Kr(this.renderBound,this.preloadBound)?re.InBounds:zo(this.renderBound,this.strictBound)?re.InViewport:this.parent!==null&&(this.props.width===0||this.props.height===0)?this.parent.renderState:re.OutOfBounds}updateBoundingRect(){const e=this.sceneGlobalTransform||this.globalTransform,s=this.sceneRenderCoords||this.renderCoords,{tb:i,tc:n}=e,{x1:o,y1:f,x3:l,y3:a}=s;if(i===0||n===0)this.renderBound=tt(o,f,l,a,this.renderBound);else{const{x2:u,x4:h,y2:d,y4:g}=s;this.renderBound=tt(Math.min(o,u,l,h),Math.min(f,d,a,g),Math.max(o,u,l,h),Math.max(f,d,a,g),this.renderBound)}}createRenderBounds(){if(this.stage,this.parent!==null&&this.parent.strictBound!==void 0){const u=this.parent.strictBound;this.strictBound=tt(u.x1,u.y1,u.x2,u.y2),this.preloadBound=hs(this.strictBound,this.boundsMargin)}else this.strictBound=this.stage.strictBound,this.preloadBound=this.stage.preloadBound;if(this.props.clipping===!1||this.renderBound===void 0||Kr(this.renderBound,this.strictBound)===!1)return;const{x:e,y:s,width:i,height:n}=this.props,{tx:o,ty:f}=this.sceneGlobalTransform||this.globalTransform||{},l=o??e,a=f??s;this.strictBound=tt(l,a,l+i,a+n,this.strictBound),this.preloadBound=hs(this.strictBound,this.boundsMargin)}updateRenderState(e){if(e===this.renderState)return;const s=this.renderState;this.renderState=e;const i=Nt.get(e);this.emit(i,{previous:s,current:e})}updateIsRenderable(){let e=!1,s=!1;if(this.checkBasicRenderability()===!1){this.updateTextureOwnership(!1),this.setRenderable(!1);return}if(this.texture!==null){if(this.texture.retryCount>this.texture.maxRetryCount){this.updateTextureOwnership(!1),this.setRenderable(!1);return}s=!0,e=this.texture.state==="loaded"}else(this.hasShader()||this.hasColorProperties()===!0)&&this.hasDimensions()===!0&&this.stage.defaultTexture&&this.stage.defaultTexture.state==="loaded"&&(e=!0);this.updateTextureOwnership(s),this.setRenderable(e)}checkBasicRenderability(){return!(this.worldAlpha===0||this.isOutOfBounds()===!0)}setRenderable(e){const s=this.isRenderable;this.isRenderable=e,s!==e&&this.emit("renderable",{type:"renderable",isRenderable:e})}updateTextureOwnership(e){var s;(s=this.texture)==null||s.setRenderableOwner(this._id,e)}isOutOfBounds(){return this.renderState<=re.OutOfBounds}hasDimensions(){return this.props.width!==0&&this.props.height!==0}hasColorProperties(){return this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0}hasShader(){return this.props.shader!==null}calculateRenderCoords(){const{width:e,height:s}=this,{tx:i,ty:n,ta:o,tb:f,tc:l,td:a}=this.globalTransform;if(f===0&&l===0){const y=i,x=i+e*o,T=n,E=n+s*a;this.renderCoords=rt.translate(y,T,x,T,x,E,y,E,this.renderCoords)}else this.renderCoords=rt.translate(i,n,i+e*o,n+e*l,i+e*o+s*f,n+e*l+s*a,i+s*f,n+s*a,this.renderCoords);if(this.sceneGlobalTransform===void 0)return;const{tx:u,ty:h,ta:d,tb:g,tc:p,td:m}=this.sceneGlobalTransform;if(g===0&&p===0){const y=u,x=u+e*d,T=h,E=h+s*m;this.sceneRenderCoords=rt.translate(y,T,x,T,x,E,y,E,this.sceneRenderCoords)}else this.sceneRenderCoords=rt.translate(u,h,u+e*d,h+e*p,u+e*d+s*g,h+e*p+s*m,u+s*g,h+s*m,this.sceneRenderCoords)}calculateClippingRect(e){this.globalTransform;const{clippingRect:s,props:i,globalTransform:n}=this,{clipping:o}=i,f=n.tb!==0||n.tc!==0;o===!0&&f===!1?(s.x=n.tx,s.y=n.ty,s.width=this.width*n.ta,s.height=this.height*n.td,s.valid=!0):s.valid=!1,e.valid===!0&&s.valid===!0?Qi(e,s,s):e.valid===!0&&(Zi(e,s),s.valid=!0)}calculateZIndex(){var o,f;const e=this.props,s=e.zIndex||0,i=((o=e.parent)==null?void 0:o.zIndex)||0;let n=s;(f=e.parent)!=null&&f.zIndexLocked&&(n=s<i?s:i),this.calcZIndex=n}destroy(){var e;if(this.destroyed!==!0){for(this.destroyed=!0,this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,this.renderCoords=void 0,this.renderBound=void 0,this.strictBound=void 0,this.preloadBound=void 0,this.globalTransform=void 0,this.scaleRotateTransform=void 0,this.localTransform=void 0,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;this.children.length>0;)(e=this.children[0])==null||e.destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}}renderQuads(e){this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.globalTransform,this.renderCoords,e.addQuad({width:this.props.width,height:this.props.height,colorTl:this.premultipliedColorTl,colorTr:this.premultipliedColorTr,colorBl:this.premultipliedColorBl,colorBr:this.premultipliedColorBr,texture:this.texture||this.stage.defaultTexture,textureOptions:this.textureOptions,zIndex:this.zIndex,shader:this.shader.shader,shaderProps:this.shader.getResolvedProps(),alpha:this.worldAlpha,clippingRect:this.clippingRect,tx:this.globalTransform.tx,ty:this.globalTransform.ty,ta:this.globalTransform.ta,tb:this.globalTransform.tb,tc:this.globalTransform.tc,td:this.globalTransform.td,renderCoords:this.renderCoords,rtt:this.rtt,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions}))}get id(){return this._id}get data(){return this.props.data}set data(e){this.props.data=e}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(P.Local))}get absX(){var e,s,i;return this.props.x+-this.props.width*this.props.mountX+(((e=this.props.parent)==null?void 0:e.absX)||((i=(s=this.props.parent)==null?void 0:s.globalTransform)==null?void 0:i.tx)||0)}get absY(){var e;return this.props.y+-this.props.height*this.props.mountY+(((e=this.props.parent)==null?void 0:e.absY)??0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(P.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(P.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(P.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(P.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(P.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(P.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(P.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(P.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(P.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(P.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(P.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(P.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(P.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(P.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(P.PremultipliedColors|P.WorldAlpha|P.Children|P.IsRenderable),this.childUpdateType|=P.WorldAlpha}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get boundsMargin(){var e;return this.props.boundsMargin??((e=this.parent)==null?void 0:e.boundsMargin)??this.stage.boundsMargin}set boundsMargin(e){if(e!==this.props.boundsMargin){if(e===null)this.props.boundsMargin=e;else{const s=Array.isArray(e)?e:[e,e,e,e];this.props.boundsMargin=s}this.setUpdateType(P.RenderBounds)}}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(P.Clipping|P.RenderBounds|P.Children),this.childUpdateType|=P.Global|P.Clipping}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(P.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(P.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(P.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(P.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(P.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(P.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(P.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(P.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(P.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(P.CalculatedZIndex|P.Children);for(let s=0,i=this.children.length;s<i;s++)this.children[s].setUpdateType(P.CalculatedZIndex)}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(P.CalculatedZIndex|P.Children);for(let s=0,i=this.children.length;s<i;s++)this.children[s].setUpdateType(P.CalculatedZIndex)}get parent(){return this.props.parent}set parent(e){const s=this.props.parent;if(s!==e){if(this.props.parent=e,s){const i=s.children.indexOf(this);s.children.splice(i,1),s.setUpdateType(P.Children|P.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(P.All),e.setUpdateType(P.Children|P.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.applyRTTInheritance(e)),this.updateScaleRotateTransform(),this.setUpdateType(P.RenderBounds|P.Children)}}get preventCleanup(){return this.props.textureOptions.preventCleanup||!1}set preventCleanup(e){this.props.textureOptions.preventCleanup=e}get rtt(){return this.props.rtt}set rtt(e){this.props.rtt!==e&&(this.props.rtt=e,e===!0?(this.initRenderTexture(),this.markChildrenWithRTT()):this.cleanupRenderTexture(),this.setUpdateType(P.RenderTexture),this.parentHasRenderTexture===!0&&this.notifyParentRTTOfUpdate())}initRenderTexture(){this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.stage.renderer.renderToTexture(this)}cleanupRenderTexture(){this.unloadTexture(),this.clearRTTInheritance(),this.hasRTTupdates=!1,this.texture=null}markChildrenWithRTT(e=null){const s=e||this;for(const i of s.children)i.setUpdateType(P.All),i.parentHasRenderTexture=!0,i.markChildrenWithRTT()}applyRTTInheritance(e){e.rtt&&e.setUpdateType(P.RenderTexture),this.markChildrenWithRTT(e)}clearRTTInheritance(){if(!this.rtt)for(const e of this.children)e.parentHasRenderTexture=!1,e.rttParent=null,e.setUpdateType(P.All),e.clearRTTInheritance()}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(P.IsRenderable))}get src(){return this.props.src}set src(e){if(this.props.src!==e){if(this.props.src=e,!e){this.texture=null;return}this.texture=this.stage.txManager.createTexture("ImageTexture",{src:e,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight,maxRetryCount:this.props.textureOptions.maxRetryCount})}}set imageType(e){this.props.imageType!==e&&(this.props.imageType=e)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(e){this.props.srcHeight=e}get srcWidth(){return this.props.srcWidth}set srcWidth(e){this.props.srcWidth=e}get srcX(){return this.props.srcX}set srcX(e){this.props.srcX=e}get srcY(){return this.props.srcY}set srcY(e){this.props.srcY=e}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;this.props.texture&&this.unloadTexture(),this.props.texture=e,e!==null&&(e.setRenderableOwner(this._id,this.isRenderable),this.loadTexture()),this.setUpdateType(P.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}get strictBounds(){return this.props.strictBounds}set strictBounds(e){e!==this.props.strictBounds&&(this.props.strictBounds=e,this.setUpdateType(P.RenderBounds|P.Children),this.childUpdateType|=P.RenderBounds|P.Children)}set interactive(e){this.props.interactive=e,e===!0&&this.stage.interactiveNodes.add(this)}get interactive(){return this.props.interactive}animate(e,s){const i=new qo(this,e,s);return new Qo(this.stage.animationManager,i)}flush(){}}const Zo=r=>{let t=!1,e=0;const s=(i=0)=>{const n=r.targetFrameTime;if(n>0&&i-e<n){const o=n-(i-e);setTimeout(()=>requestAnimationFrame(s),o);return}if(e=i,r.updateFrameTime(),r.updateAnimations(),!r.hasSceneUpdates()){r.calculateFps(),n>0?setTimeout(()=>requestAnimationFrame(s),Math.max(n,16.666666666666668)):setTimeout(()=>requestAnimationFrame(s),16.666666666666668),t||(r.eventBus.emit("idle"),t=!0),r.txMemManager.checkCleanup()===!0&&r.txMemManager.cleanup(),r.flushFrameEvents();return}if(t=!1,r.drawFrame(),r.flushFrameEvents(),n>0){const o=Math.max(0,n-(performance.now()-i));setTimeout(()=>requestAnimationFrame(s),o)}else requestAnimationFrame(s)};requestAnimationFrame(s)},yr=()=>performance?performance.now():Date.now();class Jo{constructor(){c(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}function ea(){function r(e){return e.indexOf("image/png")!==-1}function t(e,s,i,n,o,f,l){return new Promise(function(a,u){var h=new XMLHttpRequest;h.open("GET",e,!0),h.responseType="blob",h.onload=function(){if(h.status!==200&&h.status!==0)return u(new Error("Failed to load image: "+h.statusText));var d=h.response;s!==void 0||r(d.type),createImageBitmap(d).then(function(g){a({data:g,premultiplyAlpha:s})}).catch(function(g){u(g)})},h.onerror=function(){u(new Error("Network error occurred while trying to fetch the image."))},h.send()})}self.onmessage=e=>{var s=e.data.src,i=e.data.id,n=e.data.premultiplyAlpha;e.data.sx,e.data.sy,e.data.sw,e.data.sh,t(s,n).then(function(o){self.postMessage({id:i,src:s,data:o},[o.data])}).catch(function(o){self.postMessage({id:i,src:s,error:o.message})})}}class ta{constructor(t,e){c(this,"imageWorkersEnabled",!0);c(this,"messageManager",{});c(this,"workers",[]);c(this,"workerIndex",0);c(this,"nextId",0);this.workers=this.createWorkers(t,e),this.workers.forEach(s=>{s.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{id:e,data:s,error:i}=t.data,n=this.messageManager[e];if(n){const[o,f]=n;delete this.messageManager[e],i?f(new Error(i)):o(s)}}createWorkers(t=1,e){let s=`(${ea.toString()})()`;e.options===!0&&(s=s.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;")),e.full===!0&&(s=s.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;"),s=s.replace("var supportsFullCreateImageBitmap = false;","var supportsFullCreateImageBitmap = true;")),s=s.replace('"use strict";',"");const i=new Blob([s],{type:"application/javascript"}),n=(self.URL?URL:webkitURL).createObjectURL(i),o=[];for(let f=0;f<t;f++)o.push(new Worker(n));return o}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}getImage(t,e,s,i,n,o){return new Promise((f,l)=>{try{if(this.workers){const a=this.nextId++;this.messageManager[a]=[f,l];const u=this.getNextWorker();u&&u.postMessage({id:a,src:t,premultiplyAlpha:e,sx:s,sy:i,sw:n,sh:o})}}catch(a){l(a)}})}}const It=class It extends Be{constructor(e,s){super(e);c(this,"type",q.color);c(this,"props");this.props=It.resolveDefaults(s)}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureSource(){const e=new Uint8Array(4);return this.color===4294967295?(e[0]=255,e[1]=255,e[2]=255,e[3]=255):(e[0]=this.color>>16&255,e[1]=this.color>>8&255,e[2]=this.color&255,e[3]=this.color>>>24&255),{data:e,premultiplyAlpha:!0}}static makeCacheKey(e){return`ColorTexture,${It.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}};c(It,"z$__type__Props");let vr=It;function ra(r){return/\.(ktx|pvr)$/.test(r)}const sa=55727696,ia={0:35841,1:35843,2:35840,3:35842,6:36196,7:33776,8:33778,9:33778,10:33779,11:33779},na=1554098963,oa={"4x4":37808,"5x5":37809,"6x6":37810,"8x8":37811,"10x10":37812,"12x12":37813},ti=[171,75,84,88,32,49,49,187,13,10,26,10],ri=async r=>{try{const t=await fetch(r);if(!t.ok)throw new Error(`Failed to fetch compressed texture: ${t.status} ${t.statusText}`);const e=await t.arrayBuffer();if(e.byteLength<16)throw new Error(`File too small to be a valid compressed texture (${e.byteLength} bytes). Expected at least 16 bytes for header inspection.`);const s=new DataView(e),i=s.getUint32(0,!0);if(i===sa)return ha(s);if(i===na)return aa(s);let n=!0;for(let o=0;o<ti.length;o++)if(s.getUint8(o)!==ti[o]){n=!1;break}if(n===!0)return fa(s);throw new Error("Unrecognized compressed texture format")}catch(t){throw new Error(`Failed to load compressed texture from ${r}: ${t}`)}};function si(r,t){return r.getUint8(t)+(r.getUint8(t+1)<<8)+(r.getUint8(t+2)<<16)}const aa=async function(r){const t=r.getUint8(4),e=r.getUint8(5),s=si(r,7),i=si(r,10);if(s===0||i===0)throw new Error(`Invalid ASTC texture dimensions: ${s}x${i}`);const n=Math.ceil(s/t)*Math.ceil(i/e)*16,o=r.byteLength-16;if(n!==o)throw new Error(`Invalid ASTC texture data size: expected ${n}, got ${o}`);const f=oa[`${t}x${e}`];if(f===void 0)throw new Error(`Unsupported ASTC block size: ${t}x${e}`);const l=r.buffer,a=[];return a.push(l.slice(16)),{data:{blockInfo:Ft[f],glInternalFormat:f,mipmaps:a,width:s,height:i,type:"astc"},premultiplyAlpha:!1}},la=function(r,t,e){if(r.getExtension("WEBGL_compressed_texture_astc")===null)throw new Error("ASTC compressed textures not supported by this device");r.bindTexture(t);const{glInternalFormat:s,mipmaps:i,width:n,height:o}=e,f=new Uint8Array(i[0]);r.compressedTexImage2D(0,s,n,o,0,f),r.texParameteri(r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_MIN_FILTER,r.LINEAR)},fa=async function(r){const t=r.getUint32(12,!0),e=t===67305985;if(e===!1&&t!==16909060)throw new Error("Invalid KTX endianness value");const s=r.getUint32(16,e),i=r.getUint32(24,e);if(s!==0||i!==0)throw new Error(`KTX texture is not compressed (glType: ${s}, glFormat: ${i})`);const n=r.getUint32(28,e);if(Ft[n]===void 0)throw new Error(`Unsupported KTX compressed texture format: 0x${n.toString(16)}`);const o=r.getUint32(36,e),f=r.getUint32(40,e);if(o===0||f===0)throw new Error(`Invalid KTX texture dimensions: ${o}x${f}`);const l=r.getUint32(56,e);if(l===0)throw new Error("KTX texture has no mipmap levels");const a=r.getUint32(60,e),u=[],h=r.buffer;let d=64+a;if(d>r.byteLength)throw new Error("Invalid KTX file: key/value data exceeds file size");for(let g=0;g<l;g++){const p=r.getUint32(d,e);d+=4;const m=d+p;u.push(h.slice(d,m)),d=m,d%4!==0&&(d+=4-d%4)}return{data:{blockInfo:Ft[n],glInternalFormat:n,mipmaps:u,width:o,height:f,type:"ktx"},premultiplyAlpha:!1}},ua=function(r,t,e){const{glInternalFormat:s,mipmaps:i,width:n,height:o,blockInfo:f}=e;r.bindTexture(t);const l=f.width,a=f.height;let u=n,h=o;for(let d=0;d<i.length;d++){let g=new Uint8Array(i[d]);const p=Math.ceil(u/l)*l,m=Math.ceil(h/a)*a,y=Math.ceil(u/l)*Math.ceil(h/a)*f.bytes;if(g.byteLength<y){const x=new Uint8Array(y);x.set(g),g=x}r.compressedTexImage2D(d,s,p,m,0,g),u=Math.max(1,u>>1),h=Math.max(1,h>>1)}r.texParameteri(r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_MIN_FILTER,i.length>1?r.LINEAR_MIPMAP_LINEAR:r.LINEAR)};function ca(r,t,e){const s=e===2?16:8,i=8,n=Math.max(r,s),o=Math.max(t,i);return n*o*e/8}const ha=async function(r){const t=r.getUint32(8,!0),e=ia[t];if(e===void 0)throw new Error(`Unsupported PVR pixel format: 0x${t.toString(16)}`);const s=r.getInt32(24,!0),i=r.getInt32(28,!0);if(i===0||s===0)throw new Error(`Invalid PVR texture dimensions: ${i}x${s}`);const n=r.getInt32(44,!0),o=r.getUint32(48,!0),f=r.buffer;let l=52+o;if(l>f.byteLength)throw new Error("Invalid PVR file: metadata exceeds file size");const a=[],u=Ft[e];for(let h=0;h<n;h++){const d=r.getUint32(l,!0),g=f.byteLength-(l+4);if(d>0&&d<=g){l+=4;const p=l,m=l+d;a.push(f.slice(p,m)),l=m,l=l+3&-4;continue}if(t===0||t===1||t===2||t===3){const p=t===0||t===1?2:4,m=ca(i>>h,s>>h,p);a.push(f.slice(l,l+m)),l+=m,l=l+3&-4;continue}if(u!==void 0){const p=Math.ceil((i>>h)/u.width),m=Math.ceil((s>>h)/u.height),y=p*m*u.bytes;a.push(f.slice(l,l+y)),l+=y,l=l+3&-4}}return{data:{blockInfo:Ft[e],glInternalFormat:e,mipmaps:a,width:i,height:s,type:"pvr"},premultiplyAlpha:!1}},da=function(r,t,e){const{glInternalFormat:s,mipmaps:i,width:n,height:o}=e;r.bindTexture(t);let f=n,l=o;for(let a=0;a<i.length;a++)r.compressedTexImage2D(a,s,f,l,0,new Uint8Array(i[a])),f=Math.max(1,f>>1),l=Math.max(1,l>>1);r.texParameteri(r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_MIN_FILTER,i.length>1?r.LINEAR_MIPMAP_LINEAR:r.LINEAR)},ve={width:4,height:4,bytes:8},Ne={width:4,height:4,bytes:16},ii={width:5,height:5,bytes:16},ni={width:6,height:6,bytes:16},oi={width:8,height:4,bytes:8},ai={width:8,height:8,bytes:16},li={width:10,height:10,bytes:16},fi={width:12,height:12,bytes:16},Ft={33776:ve,33777:ve,33778:Ne,33779:Ne,36196:ve,37492:ve,37493:ve,37496:Ne,37497:Ne,35840:ve,35842:ve,35841:oi,35843:oi,37808:Ne,37840:Ne,37809:ii,37841:ii,37810:ni,37842:ni,37811:ai,37843:ai,37812:li,37844:li,37813:fi,37845:fi},pa={ktx:ua,pvr:da,astc:la};function ma(r){return/\.(svg)(\?.*)?$/.test(r)}const ui=(r,t,e,s,i,n,o)=>new Promise((f,l)=>{const a=document.createElement("canvas"),u=a.getContext("2d");u.imageSmoothingEnabled=!0;const h=new Image;h.onload=()=>{const d=s??0,g=i??0,p=t||h.width,m=e||h.height;a.width=p,a.height=m,u.drawImage(h,0,0,p,m),f({data:u.getImageData(d,g,n??p,o??m),premultiplyAlpha:!1})},h.onerror=d=>{l(d)},h.src=r});function en(r,t=""){return new Promise((e,s)=>{const i=new XMLHttpRequest;i.responseType=t,i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(i.status===0||i.status===200?e(i.response):s(i.statusText))},i.open("GET",r,!0),i.send(null)})}const Lt=class Lt extends Be{constructor(e,s){const i=Lt.resolveDefaults(s);super(e);c(this,"type",q.image);c(this,"props");this.props=i,this.maxRetryCount=i.maxRetryCount??this.txManager.maxRetryCount}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async loadImageFallback(e,s){const i=new Image;return typeof e=="string"&&qr(e)===!1&&(i.crossOrigin="anonymous"),new Promise((n,o)=>{i.onload=()=>{n({data:i,premultiplyAlpha:s})},i.onerror=f=>{const l=f instanceof Error?f.message:f instanceof Event?`Image loading failed for ${i.src}`:"Unknown image loading error";o(new Error(`Image loading failed: ${l}`))},e instanceof Blob?i.src=URL.createObjectURL(e):i.src=e})}async createImageBitmap(e,s,i,n,o,f){const l=s??e.type.includes("image/png"),a=this.txManager.imageBitmapSupported;if(a.full===!0&&o!==null&&f!==null)try{return{data:await createImageBitmap(e,i||0,n||0,o,f,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:l}}catch(u){throw new Error(`Failed to create image bitmap with crop: ${u}`)}else if(a.basic===!0)try{return{data:await createImageBitmap(e),premultiplyAlpha:l}}catch(u){throw new Error(`Failed to create basic image bitmap: ${u}`)}try{return{data:await createImageBitmap(e,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:l}}catch(u){throw new Error(`Failed to create image bitmap with options: ${u}`)}}async loadImage(e){const{premultiplyAlpha:s,sx:i,sy:n,sw:o,sh:f}=this.props;if(this.txManager.hasCreateImageBitmap===!0){if(qr(e)===!1&&this.txManager.hasWorker===!0&&this.txManager.imageWorkerManager!==null)try{return this.txManager.imageWorkerManager.getImage(e,s,i,n,o,f)}catch(a){throw new Error(`Failed to load image via worker: ${a}`)}let l;if(qr(e)===!0)l=Ho(e);else try{l=await en(e,"blob")}catch(a){throw new Error(`Failed to fetch image blob from ${e}: ${a}`)}return this.createImageBitmap(l,s,i,n,o,f)}return this.loadImageFallback(e,s??!0)}async getTextureSource(){let e;try{e=await this.determineImageTypeAndLoadImage()}catch(s){return this.setState("failed",s),{data:null}}return e.data===null?(this.setState("failed",Error("ImageTexture: No image data")),{data:null}):{data:e.data,premultiplyAlpha:this.props.premultiplyAlpha??!0}}determineImageTypeAndLoadImage(){const{src:e,premultiplyAlpha:s,type:i}=this.props;if(e===null)return{data:null};if(typeof e!="string"){if(e instanceof Blob)if(this.txManager.hasCreateImageBitmap===!0){const{sx:o,sy:f,sw:l,sh:a}=this.props;return this.createImageBitmap(e,s,o,f,l,a)}else return this.loadImageFallback(e,s??!0);return e instanceof ImageData?{data:e,premultiplyAlpha:s}:{data:e(),premultiplyAlpha:s}}const n=Vo(e);return i==="regular"?this.loadImage(n):i==="svg"?ui(n,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):ma(e)===!0?ui(n,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):i==="compressed"||ra(e)===!0?ri(n):this.loadImage(n)}static makeCacheKey(e){const s=Lt.resolveDefaults(e),i=s.key||s.src;if(typeof i!="string")return!1;let n="";return s.sh!==null&&s.sw!==null&&(n+=",",n+=s.sx??"",n+=s.sy??"",n+=s.sw||"",n+=s.sh||""),`ImageTexture,${i},${s.premultiplyAlpha??"true"}${n}`}static resolveDefaults(e){return{src:e.src??"",premultiplyAlpha:e.premultiplyAlpha??!0,key:e.key??null,type:e.type??null,width:e.width??null,height:e.height??null,sx:e.sx??null,sy:e.sy??null,sw:e.sw??null,sh:e.sh??null,maxRetryCount:e.maxRetryCount??null}}};c(Lt,"z$__type__Props");let Bt=Lt;const Pt=class Pt extends Be{constructor(e,s){super(e);c(this,"props");c(this,"type",q.noise);this.props=Pt.resolveDefaults(s)}async getTextureSource(){const{width:e,height:s}=this.props,i=e*s*4,n=new Uint8ClampedArray(i);for(let o=0;o<i;o+=4){const f=Math.floor(Math.random()*256);n[o]=f,n[o+1]=f,n[o+2]=f,n[o+3]=255}return{data:new ImageData(n,e,s)}}static makeCacheKey(e){if(e.cacheId===void 0)return!1;const s=Pt.resolveDefaults(e);return`NoiseTexture,${s.width},${s.height},${s.cacheId}`}static resolveDefaults(e){return{width:e.width??128,height:e.height??128,cacheId:e.cacheId??0}}};c(Pt,"z$__type__Props");let ps=Pt,ga=0;const Fr=class Fr extends Be{constructor(e,s){super(e);c(this,"props");c(this,"parentTexture");c(this,"type",q.subTexture);c(this,"subtextureId",`subtexture-${ga++}`);c(this,"onParentTxLoaded",()=>{this.forwardParentTxState("loaded",{width:this.props.width,height:this.props.height})});c(this,"onParentTxFailed",(e,s)=>{this.retryCount=this.parentTexture.retryCount-1,this.forwardParentTxState("failed",s)});c(this,"onParentTxLoading",()=>{this.forwardParentTxState("loading")});c(this,"onParentTxFreed",()=>{this.forwardParentTxState("freed")});this.props=Fr.resolveDefaults(s||{}),this.props.texture,this.props.texture instanceof Bt,this.parentTexture=e.resolveParentTexture(this.props.texture),this.renderableOwners.length>0&&this.parentTexture.setRenderableOwner(this.subtextureId,!0),queueMicrotask(()=>{const i=this.parentTexture;i.state==="loaded"&&i.dimensions?this.onParentTxLoaded(i,i.dimensions):i.state==="loading"?this.onParentTxLoading():i.state==="failed"&&i.error?this.onParentTxFailed(i,i.error):i.state==="freed"&&this.onParentTxFreed(),i.on("loading",this.onParentTxLoading),i.on("loaded",this.onParentTxLoaded),i.on("failed",this.onParentTxFailed),i.on("freed",this.onParentTxFreed)})}forwardParentTxState(e,s){this.setState(e,s)}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this.subtextureId,e)}async getTextureSource(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};c(Fr,"z$__type__Props");let Ut=Fr;const Br=class Br extends Be{constructor(e,s){super(e);c(this,"props");c(this,"type",q.renderToTexture);this.props=Br.resolveDefaults(s||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureSource(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}};c(Br,"z$__type__Props");let Ar=Br;async function ya(){var i,n,o;const r=new Uint8Array([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1,0,0,0,1,1,3,0,0,0,37,219,86,202,0,0,0,3,80,76,84,69,0,0,0,167,122,61,218,0,0,0,1,116,82,78,83,0,64,230,216,102,0,0,0,10,73,68,65,84,8,215,99,96,0,0,0,2,0,1,226,33,188,51,0,0,0,0,73,69,78,68,174,66,96,130]),t={basic:!1,options:!1,full:!1},e=new Blob([r],{type:"image/png"}),s=await createImageBitmap(e);(i=s.close)==null||i.call(s),t.basic=!0;try{const f={premultiplyAlpha:"none"},l=await createImageBitmap(e,f);(n=l.close)==null||n.call(l),t.options=!0}catch{}try{const f=await createImageBitmap(e,0,0,1,1,{premultiplyAlpha:"none"});(o=f.close)==null||o.call(f),t.full=!0}catch{}return t}var Se;(function(r){r.MEMORY_THRESHOLD_EXCEEDED="MEMORY_THRESHOLD_EXCEEDED",r.TEXTURE_DATA_NULL="TEXTURE_DATA_NULL",r.TEXTURE_TYPE_NOT_REGISTERED="TEXTURE_TYPE_NOT_REGISTERED"})(Se||(Se={}));const xa={[Se.MEMORY_THRESHOLD_EXCEEDED]:"Memory threshold exceeded",[Se.TEXTURE_DATA_NULL]:"Texture data is null",[Se.TEXTURE_TYPE_NOT_REGISTERED]:"Texture type is not registered"};class Qr extends Error{constructor(e,s){const i=Object.values(Se).includes(e),n=i?e:void 0;let o;i&&n?o=s??xa[n]:o=String(e);super(o);c(this,"code");this.name=new.target.name,n&&(this.code=n)}}class ba extends we{constructor(e,s){super();c(this,"keyCache",new Map);c(this,"inverseKeyCache",new WeakMap);c(this,"txConstructors",{});c(this,"maxRetryCount");c(this,"priorityQueue",[]);c(this,"uploadTextureQueue",[]);c(this,"initialized",!1);c(this,"stage");c(this,"numImageWorkers");c(this,"imageWorkerManager",null);c(this,"hasCreateImageBitmap",!!self.createImageBitmap);c(this,"imageBitmapSupported",{basic:!1,options:!1,full:!1});c(this,"hasWorker",!!self.Worker);c(this,"renderer");c(this,"frameTime",0);const{numImageWorkers:i,createImageBitmapSupport:n,maxRetryCount:o}=s;this.stage=e,this.numImageWorkers=i,this.maxRetryCount=o,n==="auto"?ya().then(f=>{this.initialize(f)}).catch(()=>{console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.initialized=!0,this.emit("initialized")}):this.initialize({basic:n==="basic",options:n==="options",full:n==="full"}),this.registerTextureType("ImageTexture",Bt),this.registerTextureType("ColorTexture",vr),this.registerTextureType("NoiseTexture",ps),this.registerTextureType("SubTexture",Ut),this.registerTextureType("RenderTexture",Ar)}registerTextureType(e,s){this.txConstructors[e]=s}initialize(e){this.hasCreateImageBitmap=e.basic||e.options||e.full,this.imageBitmapSupported=e,this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.hasCreateImageBitmap&&this.hasWorker&&this.numImageWorkers>0?this.imageWorkerManager=new ta(this.numImageWorkers,e):console.warn("[Lightning] Imageworker is 0 or not supported on this browser. Image loading will be slower."),this.initialized=!0,this.emit("initialized")}enqueueUploadTexture(e){this.uploadTextureQueue.includes(e)===!1&&this.uploadTextureQueue.push(e)}createTexture(e,s){let i;const n=this.txConstructors[e];if(!n)throw new Qr(Se.TEXTURE_TYPE_NOT_REGISTERED,`Texture type "${e}" is not registered`);const o=n.makeCacheKey(s);return o&&this.keyCache.has(o)?i=this.keyCache.get(o):(i=new n(this,s),o&&this.initTextureToCache(i,o)),i}async loadTexture(e,s){if(e.type===q.subTexture||e.state==="loaded"||e.state==="loading")return;if(this.initialized===!1){this.priorityQueue.push(e);return}if(e.setState("loading"),await e.getTextureData().catch(o=>(console.error(o),e.setState("failed"),null))===null||e.state==="failed")return;if((e.type!==q.image||s===!0)===!0){await this.uploadTexture(e).catch(o=>{console.error("Failed to upload texture:",o),e.setState("failed")});return}this.enqueueUploadTexture(e)}async uploadTexture(e){if(this.stage.txMemManager.doNotExceedCriticalThreshold===!0&&this.stage.txMemManager.criticalCleanupRequested===!0){e.setState("failed",new Qr(Se.MEMORY_THRESHOLD_EXCEEDED));return}if(e.state==="failed"||e.state==="freed"||e.state==="loaded")return;if(e.textureData===null){e.setState("failed",new Qr(Se.TEXTURE_DATA_NULL,"Texture data is null, cannot upload texture"));return}const s=e.loadCtxTexture();if(s!==null&&s.state==="loaded"){e.setState("loaded");return}await s.load()}isProcessingTexture(e){return this.uploadTextureQueue.includes(e)===!0}async processSome(e){if(this.initialized===!1)return;const s=yr();for(;this.priorityQueue.length>0&&yr()-s<e;){const i=this.priorityQueue.pop();try{await i.getTextureData(),await this.uploadTexture(i)}catch(n){console.error("Failed to process priority texture:",n)}}for(;this.uploadTextureQueue.length>0&&yr()-s<e;){const i=this.uploadTextureQueue.shift();try{await this.uploadTexture(i)}catch(n){console.error("Failed to upload texture:",n)}}}hasUpdates(){return this.uploadTextureQueue.length>0}initTextureToCache(e,s){const{keyCache:i,inverseKeyCache:n}=this;i.set(s,e),n.set(e,s)}getTextureFromCache(e){return this.keyCache.get(e)}removeTextureFromCache(e){const{inverseKeyCache:s,keyCache:i}=this,n=s.get(e);n&&i.delete(n)}resolveParentTexture(e){if(!(e!=null&&e.props))return e;const s=Bt.makeCacheKey(e.props);return(s?this.getTextureFromCache(s):void 0)??e}}const Ta={normal:400,bold:700,bolder:900,lighter:100},ci=r=>typeof r=="number"?r:Ta[r]||400;function Sa(r,t,e,s,i){let n=ci(e);for(const o of r){const f=o[t];if(!f)continue;if(f.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),f.values().next().value;const l=new Map;for(const u of f){const h=ci(u.descriptors.weight);if(h===n&&u.descriptors.style===s&&u.descriptors.stretch===i)return u;l.set(h,u)}const a=`TrFontManager: No exact match: '${t} Weight: ${n} Style: ${s} Stretch: ${i}'`;if(console.error(a),n===400&&l.has(500))return l.get(500);if(n===500&&l.has(400))return l.get(400);if(n<400){for(;n>0;){if(l.has(n))return l.get(n);n-=100}n=600}for(;n<1e3;){if(l.has(n))return l.get(n);n+=100}for(n=500;n>0;){if(l.has(n))return l.get(n);n-=100}}}class wa{constructor(t){c(this,"textRenderers");c(this,"fontCache",new Map);this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const s=this.textRenderers[e];s&&s.isFontFaceSupported(t)&&s.addFontFace(t)}}resolveFontFace(t,e,s){const{fontFamily:i,fontWeight:n,fontStyle:o,fontStretch:f}=e,l=`${s}_${i}_${o}_${n}_${f}`;if(this.fontCache.has(l)===!0)return this.fontCache.get(l);const a=Sa(t,i,n,o,f);return a!==void 0&&this.fontCache.set(l,a),a}}class tn{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function hi(r,t,e){const s=r.createShader(t);if(!s){const n=r.getError();throw new Error(`Unable to create the shader: ${t===r.VERTEX_SHADER?"VERTEX_SHADER":"FRAGMENT_SHADER"}.${n?` WebGlContext Error: ${n}`:""}`)}if(r.shaderSource(s,e),r.compileShader(s),!!r.getShaderParameter(s,r.COMPILE_STATUS))return s;console.error(r.getShaderInfoLog(s)),r.deleteShader(s)}function Ca(r,t,e){const s=r.createProgram();if(!s)throw new Error("Unable to create program");if(r.attachShader(s,t),r.attachShader(s,e),r.linkProgram(s),!!r.getProgramParameter(s,r.LINK_STATUS))return s;console.warn(r.getProgramInfoLog(s)),r.deleteProgram(s)}class $e extends tn{constructor(e){super();c(this,"buffersBound",!1);c(this,"program");c(this,"vao");c(this,"renderer");c(this,"glw");c(this,"attributeLocations");c(this,"uniformLocations");c(this,"supportsIndexedTextures");const s=this.renderer=e.renderer,i=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const n=i.isWebGl2(),o=n&&e.webgl2Extensions||!n&&e.webgl1Extensions||[],f=n?"2.0":"1.0";o.forEach(m=>{if(!i.getExtension(m))throw new Error(`Shader "${this.constructor.name}" requires extension "${m}" for WebGL ${f} but wasn't found`)});const l=e.shaderSources||this.constructor.shaderSources;if(l)n&&(l!=null&&l.webGl2)&&(l.fragment=l.webGl2.fragment,l.vertex=l.webGl2.vertex,delete l.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const a=s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,u=l.vertex instanceof Function?l.vertex(a):l.vertex,h=l.fragment instanceof Function?l.fragment(a):l.fragment,d=hi(i,i.VERTEX_SHADER,u),g=hi(i,i.FRAGMENT_SHADER,h);if(!d||!g)throw new Error(`Unable to create the following shader(s): ${[!d&&"VERTEX_SHADER",!g&&"FRAGMENT_SHADER"].filter(Boolean).join(" and ")}`);const p=Ca(i,d,g);if(!p)throw new Error("Unable to create program");this.program=p,this.attributeLocations=i.getAttributeLocations(this.program),this.uniformLocations=i.getUniformLocations(this.program)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){const e=this.glw,s=this.attributeLocations.length;for(let i=0;i<s;i++)e.disableVertexAttribArray(i)}canBatchShaderProps(e,s){return!1}bindRenderOp(e,s){var f;this.bindBufferCollection(e.buffers),e.textures.length>0&&((f=e.textures[0])!=null&&f.ctxTexture)&&this.bindTextures(e.textures);const{glw:i,parentHasRenderTexture:n,renderToTexture:o}=e;if(!(o&&n)){if(n){const{width:l,height:a}=e.framebufferDimensions||{};i.uniform1f(this.getUniformLocation("u_pixelRatio"),1),i.uniform2f(this.getUniformLocation("u_resolution"),l??0,a??0)}else i.uniform1f(this.getUniformLocation("u_pixelRatio"),e.options.pixelRatio),i.uniform2f(this.getUniformLocation("u_resolution"),i.canvas.width,i.canvas.height);if(s){if(_r(s,"$dimensions")){let l=s.$dimensions;l||(l=e.dimensions),i.uniform2f(this.getUniformLocation("u_dimensions"),l.width,l.height)}if(_r(s,"$alpha")){let l=s.$alpha;l||(l=e.alpha),i.uniform1f(this.getUniformLocation("u_alpha"),l)}this.bindProps(s)}}}getUniformLocation(e){return this.uniformLocations[e]||null}bindBufferCollection(e){const{glw:s}=this,i=this.attributeLocations,n=i.length;for(let o=0;o<n;o++){const f=i[o],l=e.getBuffer(f),a=e.getAttributeInfo(f);l===void 0||a===void 0||(s.enableVertexAttribArray(o),s.vertexAttribPointer(l,o,a.size,a.type,a.normalized,a.stride,a.offset))}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}c($e,"shaderSources");class rn extends $e{constructor(t){super({renderer:t})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}c(rn,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec2 a_nodeCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying vec2 v_nodeCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio;
        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);

        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_nodeCoordinate = a_nodeCoordinate;

        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);
        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class sn extends $e{constructor(e){super({renderer:e});c(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:s,glw:i}=this;if(e.length>s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((o,f)=>{i.activeTexture(f),i.bindTexture(o.ctxTexture)});const n=Array.from(Array(e.length).keys());this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"),n)}}c(sn,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:e=>`
      #define txUnits ${e}
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {
        ${Array.from(Array(e).keys()).map(s=>`
          ${s!==0?"else ":""}if (idx == ${s}) {
            return texture2D(textures[${s}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});class se{constructor(t){c(this,"priority",1);c(this,"name","");c(this,"ref");c(this,"target");c(this,"passParameters","");c(this,"declaredUniforms","");c(this,"uniformInfo",{});const{ref:e,target:s,props:i={}}=t;this.ref=e,this.target=s;const n={},o=[];let f="";const l=this.constructor.uniforms||{};for(const a in l){const u=l[a],h=u.type,d=`${e}_${a}`;let g="";u.size&&(g=`[${u.size(i)}]`),o.push(d),f+=`uniform ${h} ${d}${g};`,n[a]={name:d,uniform:l[a].method}}this.passParameters=o.join(","),this.declaredUniforms=f,this.uniformInfo=n}static getEffectKey(t){return""}static getMethodParameters(t,e){const s=[];for(const i in t){const n=t[i];let o="";n.size&&(o=`[${n.size(e)}]`),s.push(`${n.type} ${i}${o}`)}return s.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}c(se,"uniforms",{}),c(se,"methods"),c(se,"onShaderMask"),c(se,"onColorize"),c(se,"onEffectMask");const Zr=new Map,Ea=(r,t)=>{const e=JSON.stringify(r);if(Zr.has(e))return Zr.get(e);r=r??[];const s=[],i=r.length;let n=0;for(;n<i;n++){const{name:o,type:f,props:l}=r[n],a={name:o,type:f,props:{}},u=t[f],h=u.resolveDefaults(l),d=u.uniforms,g=Object.keys(d),p=g.length;let m=0;for(;m<p;m++){const y=g[m],x=d[y],T={value:h[y],programValue:void 0,method:x.method,updateOnBind:x.updateOnBind||!1,hasValidator:x.validator!==void 0,hasProgramValueUpdater:x.updateProgramValue!==void 0},E=T.hasValidator&&x.validator(h[y],h)||h[y];h[y]!==E&&(T.validatedValue=E),T.hasProgramValueUpdater&&x.updateProgramValue(T),T.programValue===void 0&&(T.programValue=T.value),a.props[y]=T}s.push(a)}return Zr.set(e,s),s},Te=class Te extends $e{constructor(e,s,i){const n=Te.createShader(s,i);super({renderer:e,shaderSources:{vertex:n.vertex,fragment:n.fragment}});c(this,"effects",[]);this.effects=n.effects}bindTextures(e){const{glw:s}=this;s.activeTexture(0),s.bindTexture(e[0].ctxTexture)}bindUniformMethods(e){const s=this.glw,i=e.effects,n=i.length;for(let o=0;o<n;o++){const f=this.effects[o].uniformInfo,l=i[o],a=Object.keys(l.props),u=a.length;for(let h=0;h<u;h++){const d=a[h],g=l.props[d].method,p=this.getUniformLocation(f[d].name);if(g==="uniform2fv"||g==="uniform2iv"||g==="uniform3iv"||g==="uniform4fv"||g==="uniform4iv"||g==="uniformMatrix2fv"||g==="uniformMatrix3fv"||g==="uniformMatrix4fv"||g==="uniform1f"||g==="uniform1fv"||g==="uniform1i"||g==="uniform1iv"){l.props[d].setUniformValue=function(){s[g](p,this.programValue)};continue}if(g==="uniform2f"||g==="uniform2i"){l.props[d].setUniformValue=function(){s[g](p,this.programValue[0],this.programValue[1])};continue}if(g==="uniform3f"||g==="uniform3i"){l.props[d].setUniformValue=function(){s[g](p,this.programValue[0],this.programValue[1],this.programValue[2])};continue}if(g==="uniform4f"||g==="uniform4i"){l.props[d].setUniformValue=function(){s[g](p,this.programValue[0],this.programValue[1],this.programValue[2],this.programValue[3])};continue}}}}bindProps(e){var o;const s=e.effects,i=s.length;let n=0;for(;n<i;n++){const f=s[n],l=Object.keys(f.props),a=l.length;let u=0;for(;u<a;u++){const h=l[u],d=f.props[h];if(d.updateOnBind===!0){const g=(o=this.renderer.shManager.getRegisteredEffects()[f.type])==null?void 0:o.uniforms[h];g==null||g.updateProgramValue(f.props[h],e)}d.setUniformValue()}}}canBatchShaderProps(e,s){if(e.$alpha!==s.$alpha||e.$dimensions.width!==s.$dimensions.width||e.$dimensions.height!==s.$dimensions.height||e.effects.length!==s.effects.length)return!1;const i=e.effects.length;let n=0;for(;n<i;n++){const o=e.effects[n],f=s.effects[n];if(o.type!==f.type)return!1;for(const l in o.props)if(f.props&&!f.props[l]||o.props[l].value!==f.props[l].value)return!1}return!0}static createShader(e,s){const i={},n={};let o="";const f=[],l=[],a=e.effects.map(p=>{const m=s[p.type],y=m.getEffectKey(p.props||{});i[y]=i[y]?++i[y]:1;const x=i[y];x===1&&l.push({key:y,type:p.type,props:p.props});const T=new m({ref:`${y}${x===1?"":x}`,target:y,props:p.props});return o+=T.declaredUniforms,f.push(...Object.values(T.uniformInfo)),T});let u="";l==null||l.forEach(p=>{const m=s[p.type],y=m.resolveDefaults(p.props??{}),x=[];for(const F in m.methods){let z=F;const v=m.methods[F];n[F]&&n[F]!==v&&(z=Te.resolveMethodDuplicate(F,v,n)),n[z]=v.replace("function",z),x.push({m:F,cm:z})}let T=m.onShaderMask instanceof Function?m.onShaderMask(y):m.onShaderMask,E=m.onColorize instanceof Function?m.onColorize(y):m.onColorize,M=m.onEffectMask instanceof Function?m.onEffectMask(y):m.onEffectMask;x.forEach(F=>{const{m:z,cm:v}=F,W=new RegExp(`\\$${z}`,"g");T&&(T=T.replace(W,v)),E&&(E=E.replace(W,v)),M&&(M=M.replace(W,v))});const O=m.getMethodParameters(m.uniforms,y),U=O.length>0?`, ${O}`:"";T&&(u+=`
        float fx_${p.key}_onShaderMask(float shaderMask ${U}) {
          ${T}
        }
        `),E&&(u+=`
          vec4 fx_${p.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${U}) {
            ${E}
          }
        `),M&&(u+=`
          vec4 fx_${p.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${U}) {
            ${M}
          }
        `)});let h="";for(const p in n)h+=n[p];let d="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",g=`

    `;for(let p=0;p<a.length;p++){const m=a[p],y=m.passParameters.length>0?`, ${m.passParameters}`:"",x=s[m.name];x.onShaderMask&&(g+=`
        shaderMask = fx_${m.target}_onShaderMask(shaderMask ${y});
        `),x.onColorize&&(g+=`
        maskColor = fx_${m.target}_onColorize(shaderMask, maskColor, shaderColor${y});
        `),x.onEffectMask&&(d=`fx_${m.target}_onEffectMask(shaderMask, maskColor, shaderColor${y})`);const T=a[p+1];(T===void 0||s[T.name].onEffectMask)&&(g+=`
          shaderColor = ${d};
        `)}return{effects:a,uniforms:f,fragment:Te.fragment(o,h,u,g),vertex:Te.vertex()}}static resolveMethodDuplicate(e,s,i,n=0){const o=e+(n>0?n:"");return i[o]&&i[o]!==s?this.resolveMethodDuplicate(e,s,i,++n):o}static resolveDefaults(e,s){return{effects:Ea(e.effects??[],s),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,s){var n;let i="";return(n=e.effects)==null||n.forEach(o=>{const l=s[o.type].getEffectKey(o.props||{});i+=`,${l}`}),`DynamicShader${i}`}};c(Te,"z$__type__Props"),c(Te,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_nodeCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;
    varying vec2 v_nodeCoordinate;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;
      v_nodeCoordinate = a_nodeCoordinate;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),c(Te,"fragment",(e,s,i,n)=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${e}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying vec2 v_nodeCoordinate;

    ${s}

    ${i}

    void main() {
      vec2 p = v_nodeCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${n}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let st=Te;class ms extends $e{constructor(t){super({renderer:t})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Math.min(t.$dimensions.width,t.$dimensions.height)/(2*t.radius);this.glw.uniform1f(this.getUniformLocation("u_radius"),t.radius*Math.min(e,1))}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}c(ms,"z$__type__Props"),c(ms,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute vec2 a_nodeCoordinate;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying vec2 v_nodeCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_nodeCoordinate = a_nodeCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying vec2 v_nodeCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_nodeCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const Ra=new Float32Array([1,0,0,0,1,0,0,0,1]),Ot=class Ot extends $e{constructor(t){super({renderer:t})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Ot.resolveDefaults(t);for(const s in e)if(s==="transform")this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"),e[s]);else if(s==="scrollY")this.glw.uniform1f(this.getUniformLocation("u_scrollY"),e[s]);else if(s==="color"){const i=$t(e.color);this.glw.uniform4fv(this.getUniformLocation("u_color"),i)}else s==="size"?this.glw.uniform1f(this.getUniformLocation("u_size"),e[s]):s==="distanceRange"?this.glw.uniform1f(this.getUniformLocation("u_distanceRange"),e[s]):s==="debug"&&this.glw.uniform1i(this.getUniformLocation("u_debug"),e[s]?1:0)}static resolveDefaults(t={}){return{transform:t.transform??Ra,scrollY:t.scrollY??0,color:t.color??4294967295,size:t.size??16,distanceRange:t.distanceRange??1,debug:t.debug??!1}}};c(Ot,"z$__type__Props"),c(Ot,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;

        // Calculate screen space with pixel ratio
        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);

        gl_Position = vec4(screenSpace, 0.0, 1.0);
        v_texcoord = a_textureCoordinate;

      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let gs=Ot;const ct=r=>{r.programValue===void 0&&(r.programValue=new Float32Array(4));const t=r.value,e=r.programValue;e[0]=(t>>>24)/255,e[1]=(t>>>16&255)/255,e[2]=(t>>>8&255)/255,e[3]=(t&255)/255},_a=r=>{const t=r.validatedValue||r.value;if(r.programValue instanceof Float32Array){const e=r.programValue;e[0]=t[0],e[1]=t[1]}else r.programValue=new Float32Array(t)},va=r=>{const t=r.validatedValue||r.value;if(r.programValue instanceof Float32Array){const e=r.programValue;e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]}else r.programValue=new Float32Array(t)},nn=r=>{const t=r.validatedValue||r.value;if(r.programValue instanceof Float32Array){const e=t.length,s=r.programValue;for(let i=0;i<e;i++)s[i]=t[i]}else r.programValue=new Float32Array(t)},Ps=r=>{const t=Array.isArray(r);if(t){if(t&&r.length===4)return r;if(t&&r.length===2)return[r[0],r[1],r[0],r[1]];if(t&&r.length===3)return[r[0],r[1],r[2],r[0]]}else return[r,r,r,r];return[r[0],r[0],r[0],r[0]]},on=(r,t)=>{r.programValue===void 0&&(r.programValue=new Float32Array(4));const e=r.programValue,s=r.validatedValue||r.value;if(t===void 0&&r.$dimensions===void 0){e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3];return}let i=r.$dimensions;if(t!==void 0){const{$dimensions:d}=t;if(i!==void 0&&(i.width===d.width||i.height===d.height))return;i===void 0&&(i={width:d==null?void 0:d.width,height:d==null?void 0:d.height},r.$dimensions=i)}const{width:n,height:o}=i,[f,l,a,u]=s,h=Math.min(Math.min(Math.min(n/Math.max(n,f+l),n/Math.max(n,a+u)),Math.min(o/Math.max(o,f+a),o/Math.max(o,l+u))),1);e[0]=f*h,e[1]=l*h,e[2]=a*h,e[3]=u*h};class Xe extends se{constructor(){super(...arguments);c(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){return{radius:e.radius??10}}}c(Xe,"z$__type__Props"),c(Xe,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Ps,updateProgramValue:on}}),c(Xe,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),c(Xe,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 p = v_nodeCoordinate.xy * u_dimensions - halfDimensions;
  vec4 r = radius;
  r.xy = (p.x > 0.0) ? r.yz : r.xw;
  float cornerRadius = (p.y > 0.0) ? r.y : r.x;
  return $boxDist(p, halfDimensions, cornerRadius);
  `),c(Xe,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class Tt extends se{constructor(){super(...arguments);c(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}c(Tt,"z$__type__Props"),c(Tt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ct,method:"uniform4fv",type:"vec4"}}),c(Tt,"onEffectMask",`
  float intR = shaderMask + 1.0;
  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),c(Tt,"onColorize",`
    return color;
  `);class Ve extends se{constructor(){super(...arguments);c(this,"name","linearGradient")}static getEffectKey(e){return e.colors.value?`linearGradient${e.colors.value.length}`:`linearGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let i=e.stops||[];if(i.length===0||i.length!==s.length){const n=s.length;let o=0;const f=i;for(;o<n;o++)i[o]?(f[o]=i[o],i[o-1]===void 0&&f[o-2]!==void 0&&(f[o-1]=f[o-2]+(i[o]-f[o-2])/2)):f[o]=o*(1/(s.length-1));i=f}return{colors:s,stops:i,angle:e.angle??0}}}c(Ve,"z$__type__Props"),c(Ve,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((s,i)=>s.concat($t(i)),[]),updateProgramValue:nn,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),c(Ve,"methods",{calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),c(Ve,"ColorLoop",e=>{let s="";for(let i=2;i<e;i++)s+=`colorOut = mix(colorOut, colors[${i}], clamp((dist - stops[${i-1}]) / (stops[${i}] - stops[${i-1}]), 0.0, 1.0));`;return s}),c(Ve,"onColorize",e=>`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_nodeCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      //return early if dist is lower or equal to first stop
      if(dist <= stops[0]) {
        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));
      }
      const int amount = ${e.colors.length||1};
      const int last = amount - 1;

      if(dist >= stops[last]) {
        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));
      }

      for(int i = 0; i < last; i++) {
        float left = stops[i];
        float right = stops[i + 1];
        if(dist >= left && dist <= right) {
          float localDist = smoothstep(left, right, dist);
          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);
          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
        }
      }

      //final fallback
      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));
    `);class ys extends se{constructor(){super(...arguments);c(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){return{amount:e.amount??1}}}c(ys,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),c(ys,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class He extends se{constructor(){super(...arguments);c(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}c(He,"z$__type__Props"),c(He,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ct,method:"uniform4fv",type:"vec4"}}),c(He,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),c(He,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),c(He,"onColorize",`
    return color;
  `);class Ge extends se{constructor(){super(...arguments);c(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}c(Ge,"z$__type__Props"),c(Ge,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ct,method:"uniform4fv",type:"vec4"}}),c(Ge,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),c(Ge,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),c(Ge,"onColorize",`
    return color;
  `);class Ye extends se{constructor(){super(...arguments);c(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}c(Ye,"z$__type__Props"),c(Ye,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ct,method:"uniform4fv",type:"vec4"}}),c(Ye,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),c(Ye,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),c(Ye,"onColorize",`
    return color;
  `);class je extends se{constructor(){super(...arguments);c(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}c(je,"z$__type__Props"),c(je,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ct,method:"uniform4fv",type:"vec4"}}),c(je,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),c(je,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_nodeCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),c(je,"onColorize",`
    return color;
  `);class St extends se{constructor(){super(...arguments);c(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){return{amplitude:e.amplitude??.2,narrowness:e.narrowness??4,blockiness:e.blockiness??2,minimizer:e.minimizer??8,time:e.time??Date.now()}}}c(St,"z$__type__Props"),c(St,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const s=e.value=(Date.now()-e.value)%1e3;e.programValue=s},type:"float"}}),c(St,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),c(St,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class xr extends se{constructor(){super(...arguments);c(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){return{fade:e.fade??10}}}c(xr,"z$__type__Props"),c(xr,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:Ps,updateProgramValue:va}}),c(xr,"onColorize",`
  vec2 point = v_nodeCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_nodeCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_nodeCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_nodeCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);class Ke extends se{constructor(){super(...arguments);c(this,"name","radialGradient")}static getEffectKey(e){return e.colors.value?`radialGradient${e.colors.value.length}`:`radialGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let i=e.stops||[];if(i.length===0||i.length!==s.length){const n=s.length;let o=0;const f=i;for(;o<n;o++)i[o]?(f[o]=i[o],i[o-1]===void 0&&f[o-2]!==void 0&&(f[o-1]=f[o-2]+(i[o]-f[o-2])/2)):f[o]=o*(1/(s.length-1));i=f}return{colors:s,stops:i,width:e.width??0,height:e.height??e.width??0,pivot:e.pivot??[.5,.5]}}}c(Ke,"z$__type__Props"),c(Ke,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:_a,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((s,i)=>s.concat($t(i)),[]),updateProgramValue:nn,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),c(Ke,"methods",{getGradientColor:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `}),c(Ke,"ColorLoop",e=>{let s="";for(let i=2;i<e;i++)s+=`colorOut = mix(colorOut, colors[${i}], clamp((dist - stops[${i-1}]) / (stops[${i}] - stops[${i-1}]), 0.0, 1.0));`;return s}),c(Ke,"onColorize",e=>`
      vec2 point = v_nodeCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      dist = clamp(dist, 0.0, 1.0);
      //return early if dist is lower or equal to first stop
      if(dist <= stops[0]) {
        return mix(maskColor, colors[0], clamp(colors[0].a, 0.0, 1.0));
      }
      const int amount = ${e.colors.length||1};
      const int last = amount - 1;

      if(dist >= stops[last]) {
        return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));
      }

      for(int i = 0; i < last; i++) {
        float left = stops[i];
        float right = stops[i + 1];
        if(dist >= left && dist <= right) {
          float localDist = smoothstep(left, right, dist);
          vec4 colorOut = mix(colors[i], colors[i + 1], localDist);
          return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
        }
      }

      //final fallback
      return mix(maskColor, colors[last], clamp(colors[last].a, 0.0, 1.0));
    `);class qe extends se{constructor(){super(...arguments);c(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){return{width:e.width??10,progress:e.progress??.5,offset:e.offset??0,range:e.range??Math.PI*2,rounded:e.rounded??!1,radius:e.radius??1,color:e.color??4294967295}}}c(qe,"z$__type__Props"),c(qe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ct,method:"uniform4fv",type:"vec4"}}),c(qe,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),c(qe,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_nodeCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),c(qe,"onColorize",`
    return color;
  `);class Qe extends se{constructor(){super(...arguments);c(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:e.radius??0}}}c(Qe,"z$__type__Props"),c(Qe,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Ps,updateProgramValue:on}}),c(Qe,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),c(Qe,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_nodeCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),c(Qe,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const Aa="RoundedRectangle";class $r extends tn{constructor(e){super();c(this,"shType");this.shType=e}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class ka{constructor(t,e,s,i){c(this,"type");c(this,"shader");c(this,"resolvedProps");c(this,"props");this.type=t,this.shader=e,this.resolvedProps=s;const n=Object.keys(s),o=n.length,f={};for(let l=0;l<o;l++){const a=n[l];Object.defineProperty(f,a,{get:()=>this.resolvedProps[a],set:u=>{this.resolvedProps[a]=u,i.requestRender()}})}this.props=f}getResolvedProps(){return this.resolvedProps}}class Ma{constructor(t,e,s){c(this,"shader");c(this,"resolvedProps");c(this,"props");c(this,"type");this.shader=t,this.type="DynamicShader",this.resolvedProps=e;const i=s.getRegisteredEffects(),n={},o=e.effects,f=o.length;for(let l=0;l<f;l++){const{name:a,props:u,type:h}=o[l];if(a===void 0)continue;const d={},g=Object.keys(u),p=g.length;for(let m=0;m<p;m++){const y=g[m];Object.defineProperty(d,y,{get:()=>this.resolvedProps.effects[l].props[y].value,set:x=>{var E,M;const T=this.resolvedProps.effects[l].props[y];T.value=x,T.hasValidator&&(x=T.validatedValue=(E=i[h].uniforms[y])==null?void 0:E.validator(x,u)),T.hasProgramValueUpdater?(M=i[h].uniforms[y])==null||M.updateProgramValue(T):T.programValue=x,s.renderer.stage.requestRender()}})}Object.defineProperty(n,a,{get:()=>d})}this.props=n}getResolvedProps(){return this.resolvedProps}}class Ia{constructor(){c(this,"shCache",new Map);c(this,"shConstructors",{});c(this,"attachedShader",null);c(this,"effectConstructors",{});c(this,"renderer");this.registerShaderType("DefaultShader",rn),this.registerShaderType("DefaultShaderBatched",sn),this.registerShaderType("RoundedRectangle",ms),this.registerShaderType("DynamicShader",st),this.registerShaderType("SdfShader",gs),this.registerEffectType("border",Tt),this.registerEffectType("borderBottom",Ye),this.registerEffectType("borderLeft",je),this.registerEffectType("borderRight",He),this.registerEffectType("borderTop",Ge),this.registerEffectType("fadeOut",xr),this.registerEffectType("linearGradient",Ve),this.registerEffectType("radialGradient",Ke),this.registerEffectType("grayscale",ys),this.registerEffectType("glitch",St),this.registerEffectType("radius",Xe),this.registerEffectType("radialProgress",qe),this.registerEffectType("holePunch",Qe)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const s=this.shConstructors[t];if(!s)throw new Error(`Shader type "${t}" is not registered`);if(this.renderer.mode==="canvas"&&s.prototype instanceof $e)return this._createShaderCtr(t,new $r(t),e);if(t==="DynamicShader")return this.loadDynamicShader(e);const i=s.resolveDefaults(e),n=s.makeCacheKey(i)||s.name;if(n&&this.shCache.has(n))return this._createShaderCtr(t,this.shCache.get(n),i);const o=new s(this.renderer,e);return n&&this.shCache.set(n,o),this._createShaderCtr(t,o,i)}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=st.resolveDefaults(t,this.effectConstructors),s=st.makeCacheKey(e,this.effectConstructors);if(s&&this.shCache.has(s))return this._createDynShaderCtr(this.shCache.get(s),e);const i=new st(this.renderer,t,this.effectConstructors);return s&&this.shCache.set(s,i),this._createDynShaderCtr(i,e)}_createShaderCtr(t,e,s){return new ka(t,e,s,this.renderer.stage)}_createDynShaderCtr(t,e){return t.bindUniformMethods(e),new Ma(t,e,this)}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}const La={x:(r,t)=>{r.props.x=t},y:(r,t)=>{r.props.y=t},width:(r,t)=>{r.props.width=t},height:(r,t)=>{r.props.height=t},color:(r,t)=>{r.props.color=t},zIndex:(r,t)=>{r.props.zIndex=t},fontFamily:(r,t)=>{r.props.fontFamily=t},fontWeight:(r,t)=>{r.props.fontWeight=t},fontStyle:(r,t)=>{r.props.fontStyle=t},fontStretch:(r,t)=>{r.props.fontStretch=t},fontSize:(r,t)=>{r.props.fontSize=t},text:(r,t)=>{r.props.text=t},textAlign:(r,t)=>{r.props.textAlign=t},contain:(r,t)=>{r.props.contain=t},offsetY:(r,t)=>{r.props.offsetY=t},scrollable:(r,t)=>{r.props.scrollable=t},scrollY:(r,t)=>{r.props.scrollY=t},letterSpacing:(r,t)=>{r.props.letterSpacing=t},lineHeight:(r,t)=>{r.props.lineHeight=t},maxLines:(r,t)=>{r.props.maxLines=t},textBaseline:(r,t)=>{r.props.textBaseline=t},verticalAlign:(r,t)=>{r.props.verticalAlign=t},overflowSuffix:(r,t)=>{r.props.overflowSuffix=t},debug:(r,t)=>{r.props.debug=t}};class Os{constructor(t){c(this,"stage");c(this,"set");this.stage=t;const e={...La,...this.getPropertySetters()},s={};Object.keys(e).forEach(i=>{Object.defineProperty(s,i,{value:(n,o)=>{n.props[i]!==o&&(e[i](n,o),this.stage.requestRender())},writable:!1,configurable:!1})}),this.set=s}setStatus(t,e,s){t.status!==e&&(t.status=e,t.emitter.emit(e,s))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){this.setStatus(t,"destroyed"),t.emitter.removeAllListeners()}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.status!=="destroyed"&&(t.updateScheduled=!1,this.updateState(t))}))}}class Pa{constructor(){c(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class Oa{constructor(t,e){c(this,"stage");c(this,"memUsed",0);c(this,"loadedTextures",[]);c(this,"criticalThreshold");c(this,"targetThreshold");c(this,"cleanupInterval");c(this,"debugLogging");c(this,"lastCleanupTime",0);c(this,"baselineMemoryAllocation");c(this,"hasWarnedAboveCritical",!1);c(this,"criticalCleanupRequested",!1);c(this,"doNotExceedCriticalThreshold");c(this,"frameTime",0);this.stage=t;const{criticalThreshold:s,doNotExceedCriticalThreshold:i}=e;this.doNotExceedCriticalThreshold=i||!1,this.criticalThreshold=Math.round(s);const n=Math.max(0,Math.min(1,e.targetThresholdLevel));if(this.cleanupInterval=e.cleanupInterval,this.debugLogging=e.debugLogging,this.baselineMemoryAllocation=Math.round(e.baselineMemoryAllocation),this.targetThreshold=Math.max(Math.round(s*n),this.baselineMemoryAllocation),this.memUsed=Math.round(e.baselineMemoryAllocation),e.debugLogging){let o=0;setInterval(()=>{o!==this.memUsed&&(o=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${ei(this.memUsed)} mb / ${ei(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}s===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(t,e){if(this.memUsed-=t.memUsed,e===0){const s=this.loadedTextures.indexOf(t);s!==-1&&(this.loadedTextures[s]=null),t.memUsed=0;return}else if(t.memUsed=e,this.memUsed+=e,this.loadedTextures.indexOf(t)===-1){const s=this.loadedTextures.indexOf(null);s!==-1?this.loadedTextures[s]=t:this.loadedTextures.push(t)}this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}checkCriticalCleanup(){return this.memUsed>this.criticalThreshold}destroyTexture(t){this.debugLogging===!0&&console.log(`[TextureMemoryManager] Destroying texture. State: ${t.state}`);const e=this.loadedTextures.indexOf(t);e!==-1&&(this.loadedTextures[e]=null),this.stage.txManager.removeTextureFromCache(t),t.destroy(),this.memUsed-=t.memUsed,t.memUsed=0}cleanup(){const t=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,t===!0&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging===!0&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${t}.`);const e=t?this.criticalThreshold:this.targetThreshold;let s=this.memUsed;for(let i=0;i<this.loadedTextures.length&&!(s<e);i++){const n=this.loadedTextures[i];if(!n)continue;if((n.type===q.image||n.type===q.noise||n.type===q.renderToTexture)&&n.canBeCleanedUp()===!0){const f=n.memUsed;this.destroyTexture(n),s-=f}}this.memUsed>=this.criticalThreshold?(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),!this.hasWarnedAboveCritical&&(this.debugLogging===!0||Fo===!1)&&(console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`),this.hasWarnedAboveCritical=!0)):(this.criticalCleanupRequested=!1,this.hasWarnedAboveCritical=!1)}getMemoryInfo(){let t=0,e=this.baselineMemoryAllocation;for(const i of this.loadedTextures)i&&i.renderable&&(t+=1,e+=i.memUsed);const s=this.loadedTextures.filter(i=>i!==null).length;return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:e,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:s,baselineMemoryAllocation:this.baselineMemoryAllocation}}}class an{constructor(t,e){c(this,"textureSource");c(this,"memManager");c(this,"state","freed");this.memManager=t,this.textureSource=e}setTextureMemUse(t){this.memManager.setTextureMemUse(this.textureSource,t)}get renderable(){return this.textureSource.renderable}}class ln{constructor(t){c(this,"options");c(this,"mode");c(this,"stage");c(this,"txManager");c(this,"txMemManager");c(this,"shManager");c(this,"rttNodes",[]);this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class Fa extends ds{constructor(e,s,i){super(e,s);c(this,"textRenderer");c(this,"trState");c(this,"_textRendererOverride",null);c(this,"onTextLoaded",()=>{const{contain:e}=this,s=this.trState.props.width,i=this.trState.props.height,n=this.trState.textW||0,o=this.trState.textH||0;e==="both"?(this.props.width=s,this.props.height=i):e==="width"?(this.props.width=s,this.props.height=o):e==="none"&&(this.props.width=n,this.props.height=o),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});c(this,"onTextFailed",(e,s)=>{this.emit("failed",{type:"text",error:s})});this._textRendererOverride=s.textRendererOverride,this.textRenderer=i;const n=this.createState({x:0,y:0,width:s.width,height:s.height,textAlign:s.textAlign,color:s.color,zIndex:s.zIndex,contain:s.contain,scrollable:s.scrollable,scrollY:s.scrollY,offsetY:s.offsetY,letterSpacing:s.letterSpacing,debug:s.debug,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStretch:s.fontStretch,fontStyle:s.fontStyle,fontWeight:s.fontWeight,text:s.text,lineHeight:s.lineHeight,maxLines:s.maxLines,textBaseline:s.textBaseline,verticalAlign:s.verticalAlign,overflowSuffix:s.overflowSuffix});this.trState=n}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(P.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(P.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const s=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);if(!s){console.warn("Text Renderer not found for font",this.trState.props.fontFamily);return}this.textRenderer=s,this.trState=this.createState(this.trState.props)}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,s){super.update(e,s),this.globalTransform,this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkBasicRenderability(){return this.worldAlpha===0||this.isOutOfBounds()===!0?!1:!!(this.trState&&this.trState.props.text!=="")}setRenderable(e){super.setRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var s;if(this.globalTransform,!this.textRenderer.renderQuads){super.renderQuads(e);return}this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.parentHasRenderTexture&&((s=this.props.parent)!=null&&s.rtt)&&(this.globalTransform=ee.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),this.globalTransform,this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(e){const s=this.textRenderer.createState(e,this);return s.emitter.on("loaded",this.onTextLoaded),s.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(s),s}}function Ba(r){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(r);for(let s=0;s<e.length;s++){const i=e[s];if(!i)continue;const n=r[i],o=typeof n;o==="string"&&n.length>2048&&(console.warn(`Custom Data value for ${i} is too long, it will be truncated to 2048 characters`),r[i]=n.substring(0,2048)),t[o]||(console.warn(`Custom Data value for ${i} is not a boolean, string, or number, it will be ignored`),delete r[i])}return r}const Ua=2e6;class $a{constructor(t){c(this,"options");c(this,"animationManager");c(this,"txManager");c(this,"txMemManager");c(this,"fontManager");c(this,"textRenderers");c(this,"shManager");c(this,"renderer");c(this,"root");c(this,"interactiveNodes",new Set);c(this,"boundsMargin");c(this,"defShaderCtr");c(this,"strictBound");c(this,"preloadBound");c(this,"strictBounds");c(this,"defaultTexture",null);c(this,"targetFrameTime",0);c(this,"eventBus");c(this,"deltaTime",0);c(this,"lastFrameTime",0);c(this,"currentFrameTime",0);c(this,"fpsNumFrames",0);c(this,"fpsElapsedTime",0);c(this,"numQuadsRendered",0);c(this,"renderRequested",!1);c(this,"frameEventQueue",[]);c(this,"fontResolveMap",{});c(this,"contextSpy",null);this.options=t;const{canvas:e,clearColor:s,appWidth:i,appHeight:n,boundsMargin:o,enableContextSpy:f,forceWebGL2:l,numImageWorkers:a,textureMemory:u,renderEngine:h,fontEngines:d,createImageBitmapSupport:g,maxRetryCount:p}=t;this.eventBus=t.eventBus,this.targetFrameTime=t.targetFPS>0?1e3/t.targetFPS:0,this.txManager=new ba(this,{numImageWorkers:a,createImageBitmapSupport:g,maxRetryCount:p}),this.txManager.on("initialized",()=>{this.requestRender()}),this.txMemManager=new Oa(this,u),this.shManager=new Ia,this.animationManager=new Jo,this.contextSpy=f?new Pa:null,this.strictBounds=t.strictBounds;let m=[0,0,0,0];o&&(m=Array.isArray(o)?o:[o,o,o,o]),this.boundsMargin=m,this.strictBound=tt(0,0,i,n),this.preloadBound=hs(this.strictBound,m);const y={stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:s??4278190080,bufferMemory:Ua,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy,forceWebGL2:l};this.renderer=new h(y);const x=this.renderer.mode||"webgl";this.createDefaultTexture(),this.defShaderCtr=this.renderer.getDefShaderCtr(),Oo(x),this.txManager.renderer=this.renderer,this.textRenderers={},d.forEach(E=>{const M=new E(this),O=M.type;if(O==="sdf"&&x==="canvas"){console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...");return}M instanceof Os&&(O==="canvas"?this.textRenderers.canvas=M:O==="sdf"&&(this.textRenderers.sdf=M))}),Object.keys(this.textRenderers).length===0&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new wa(this.textRenderers);const T=new ds(this,{x:0,y:0,width:i,height:n,alpha:1,autosize:!1,boundsMargin:null,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1,strictBounds:this.strictBounds});this.root=T,Zo(this)}setClearColor(t){this.renderer.updateClearColor(t),this.renderRequested=!0}updateTargetFrameTime(){this.targetFrameTime=this.options.targetFPS>0?1e3/this.options.targetFPS:0}updateFrameTime(){const t=yr();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=t,this.deltaTime=this.lastFrameTime?t-this.lastFrameTime:100/6,this.txManager.frameTime=t,this.txMemManager.frameTime=t,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}createDefaultTexture(){this.defaultTexture=this.txManager.createTexture("ColorTexture",{color:4294967295}),this.defaultTexture instanceof vr,this.txManager.loadTexture(this.defaultTexture,!0),this.defaultTexture.setRenderableOwner("stage",!0),this.defaultTexture.once("loaded",()=>{this.requestRender()})}updateAnimations(){const{animationManager:t}=this;this.root&&t.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested||this.txManager.hasUpdates()}drawFrame(){const{renderer:t,renderRequested:e}=this;this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),this.txManager.processSome(this.options.textureProcessingTimeLimit).catch(s=>{console.error("Error processing textures:",s)}),t.reset(),t.rttNodes.length>0&&t.renderRTTNodes(),this.addQuads(this.root),t==null||t.render(),this.calculateFps(),this.calculateQuads(),e&&(this.renderRequested=!1),this.txMemManager.criticalCleanupRequested===!0&&this.txMemManager.cleanup()}queueFrameEvent(t,e){this.frameEventQueue.push([t,e])}flushFrameEvents(){for(const[t,e]of this.frameEventQueue)this.eventBus.emit(t,e);this.frameEventQueue=[]}calculateFps(){var e,s;const{fpsUpdateInterval:t}=this.options;if(t&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=t)){const i=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:i,contextSpyData:((e=this.contextSpy)==null?void 0:e.getData())??null}),(s=this.contextSpy)==null||s.reset()}}calculateQuads(){const t=this.renderer.getQuadCount();t&&t!==this.numQuadsRendered&&(this.numQuadsRendered=t,this.queueFrameEvent("quadsUpdate",{quads:t}))}addQuads(t){this.renderer,t.isRenderable===!0&&t.renderQuads(this.renderer);for(let e=0;e<t.children.length;e++){const s=t.children[e];s!==void 0&&(s.worldAlpha===0||s.strictBounds===!0&&s.renderState===re.OutOfBounds||this.addQuads(s))}}requestRender(){this.renderRequested=!0}findNodesAtPoint(t){const e=t.x/this.options.deviceLogicalPixelRatio,s=t.y/this.options.deviceLogicalPixelRatio,i=[];for(const n of this.interactiveNodes)n.isRenderable!==!1&&Wo(e,s,n.renderBound)===!0&&i.push(n);return i}getNodeFromPosition(t){const e=this.findNodesAtPoint(t);if(e.length===0)return null;let s=e[e.length-1];for(let i=0;i<e.length;i++)e[i].zIndex>s.zIndex&&(s=e[i]);return s||null}resolveTextRenderer(t,e=null){const s=`${t.fontFamily}${t.fontStyle}${t.fontWeight}${t.fontStretch}${e||""}`;if(this.fontResolveMap[s]!==void 0)return this.fontResolveMap[s];let i=e,n=!1;if(i){const f=this.textRenderers[i];f?f.canRenderFont(t)||(console.warn(`Cannot use override text renderer '${i}' for font`,t),i=null,n=!0):(console.warn(`Text renderer override '${i}' not found.`),i=null,n=!0)}if(!i){for(const[f,l]of Object.entries(this.textRenderers))if(l.canRenderFont(t)){i=f;break}!i&&this.textRenderers.canvas!==void 0&&(i="canvas")}if(n&&console.warn(`Falling back to text renderer ${String(i)}`),!i)return null;const o=this.textRenderers[i];return this.fontResolveMap[s]=o,o}createShaderCtr(t,e){return this.shManager.loadShader(t,e)}createNode(t){const e=this.resolveNodeDefaults(t);return new ds(this,e)}createTextNode(t){const e=t.fontSize??16,s={...this.resolveNodeDefaults(t),text:t.text??"",textRendererOverride:t.textRendererOverride??null,fontSize:e,fontFamily:t.fontFamily??"sans-serif",fontStyle:t.fontStyle??"normal",fontWeight:t.fontWeight??"normal",fontStretch:t.fontStretch??"normal",textAlign:t.textAlign??"left",contain:t.contain??"none",scrollable:t.scrollable??!1,scrollY:t.scrollY??0,offsetY:t.offsetY??0,letterSpacing:t.letterSpacing??0,lineHeight:t.lineHeight,maxLines:t.maxLines??0,textBaseline:t.textBaseline??"alphabetic",verticalAlign:t.verticalAlign??"middle",overflowSuffix:t.overflowSuffix??"...",debug:t.debug??{},shaderProps:null},i=this.resolveTextRenderer(s,t.textRendererOverride);if(!i)throw new Error(`No compatible text renderer found for ${s.fontFamily}`);return new Fa(this,s,i)}setBoundsMargin(t){this.boundsMargin=Array.isArray(t)?t:[t,t,t,t],this.root.setUpdateType(P.RenderBounds)}resolveNodeDefaults(t){const e=t.color??4294967295,s=t.colorTl??t.colorTop??t.colorLeft??e,i=t.colorTr??t.colorTop??t.colorRight??e,n=t.colorBl??t.colorBottom??t.colorLeft??e,o=t.colorBr??t.colorBottom??t.colorRight??e;let f={};return this.options.inspector===!0&&(f=Ba(t.data??{})),{x:t.x??0,y:t.y??0,width:t.width??0,height:t.height??0,alpha:t.alpha??1,autosize:t.autosize??!1,boundsMargin:t.boundsMargin??null,clipping:t.clipping??!1,color:e,colorTop:t.colorTop??e,colorBottom:t.colorBottom??e,colorLeft:t.colorLeft??e,colorRight:t.colorRight??e,colorBl:n,colorBr:o,colorTl:s,colorTr:i,zIndex:t.zIndex??0,zIndexLocked:t.zIndexLocked??0,parent:t.parent??null,texture:t.texture??null,textureOptions:t.textureOptions??{},shader:t.shader??this.defShaderCtr,src:t.src??null,srcHeight:t.srcHeight,srcWidth:t.srcWidth,srcX:t.srcX,srcY:t.srcY,scale:t.scale??null,scaleX:t.scaleX??t.scale??1,scaleY:t.scaleY??t.scale??1,mount:t.mount??0,mountX:t.mountX??t.mount??0,mountY:t.mountY??t.mount??0,pivot:t.pivot??.5,pivotX:t.pivotX??t.pivot??.5,pivotY:t.pivotY??t.pivot??.5,rotation:t.rotation??0,rtt:t.rtt??!1,data:f,preventCleanup:t.preventCleanup??!1,imageType:t.imageType,interactive:t.interactive??!1,strictBounds:t.strictBounds??this.strictBounds}}cleanup(){this.txMemManager.cleanup()}}class Na extends we{constructor(e,s){var m,y,x,T,E,M;super();c(this,"root");c(this,"canvas");c(this,"settings");c(this,"stage");c(this,"inspector",null);const i={criticalThreshold:((m=e.textureMemory)==null?void 0:m.criticalThreshold)||124e6,targetThresholdLevel:((y=e.textureMemory)==null?void 0:y.targetThresholdLevel)||.5,cleanupInterval:((x=e.textureMemory)==null?void 0:x.cleanupInterval)||5e3,debugLogging:((T=e.textureMemory)==null?void 0:T.debugLogging)||!1,baselineMemoryAllocation:((E=e.textureMemory)==null?void 0:E.baselineMemoryAllocation)||26e6,doNotExceedCriticalThreshold:((M=e.textureMemory)==null?void 0:M.doNotExceedCriticalThreshold)||!1},n={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:i,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:e.clearColor??0,fpsUpdateInterval:e.fpsUpdateInterval||0,targetFPS:e.targetFPS||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:e.enableContextSpy??!1,forceWebGL2:e.forceWebGL2??!1,inspector:e.inspector??!1,renderEngine:e.renderEngine,quadBufferSize:e.quadBufferSize??4*1024*1024,fontEngines:e.fontEngines,strictBounds:e.strictBounds??!0,textureProcessingTimeLimit:e.textureProcessingTimeLimit||42,canvas:e.canvas||document.createElement("canvas"),createImageBitmapSupport:e.createImageBitmapSupport||"full",maxRetryCount:e.maxRetryCount??5};this.settings=n;const{appWidth:o,appHeight:f,deviceLogicalPixelRatio:l,devicePhysicalPixelRatio:a,inspector:u,canvas:h}=n,d=o*l,g=f*l;this.canvas=h,h.width=d*a,h.height=g*a,h.style.width=`${d}px`,h.style.height=`${g}px`,this.stage=new $a({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,forceWebGL2:this.settings.forceWebGL2,fpsUpdateInterval:this.settings.fpsUpdateInterval,targetFPS:this.settings.targetFPS,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:i,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines,inspector:this.settings.inspector!==null,strictBounds:this.settings.strictBounds,textureProcessingTimeLimit:this.settings.textureProcessingTimeLimit,createImageBitmapSupport:this.settings.createImageBitmapSupport,maxRetryCount:this.settings.maxRetryCount}),this.root=this.stage.root;let p;if(typeof s=="string"?p=document.getElementById(s):p=s,!p)throw new Error("Could not find target element");p.appendChild(h)}createNode(e){const s=this.stage.createNode(e);return this.inspector?this.inspector.createNode(s):s}createTextNode(e){const s=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(s):s}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,s){return this.stage.txManager.createTexture(e,s)}createShader(e,s){return this.stage.shManager.loadShader(e,s)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,s,i){return{name:i,type:e,props:s}}getNodeById(e){var n;const s=(n=this.stage)==null?void 0:n.root;if(!s)return null;const i=o=>{if(o.id===e)return o;for(const f of o.children){const l=i(f);if(l)return l}return null};return i(s)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){this.stage.requestRender()}cleanup(){this.stage.cleanup()}setClearColor(e){this.stage.setClearColor(e)}get targetFPS(){return this.stage.options.targetFPS}set targetFPS(e){this.stage.options.targetFPS=e>0?e:0,this.stage.updateTargetFrameTime()}}class fn extends we{constructor(e){super();c(this,"fontFamily");c(this,"descriptors");c(this,"loaded",!1);c(this,"metrics",null);const{fontFamily:s,descriptors:i,metrics:n}=e;n&&(this.metrics={ascender:n.ascender/n.unitsPerEm,descender:n.descender/n.unitsPerEm,lineGap:n.lineGap/n.unitsPerEm}),this.fontFamily=s,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...i}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}class xs extends fn{constructor(e){super(e);c(this,"fontFace");c(this,"fontUrl");const{fontFamily:s,fontUrl:i}=e,n=i.replace(/\(|\)/g,""),o=this.descriptors;let f={style:o.style,weight:typeof o.weight=="number"?`${o.weight}`:o.weight,stretch:o.stretch,unicodeRange:o.unicodeRange,featureSettings:o.featureSettings,display:o.display};for(const a in f){const u=a;f[u]===void 0&&delete f[u]}const l=new FontFace(s,`url(${n})`,f);n.length>0?l.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=l,this.fontUrl=i}}class Da{}class un extends Da{constructor(e,s,i,n,o,f,l,a,u,h,d,g,p){super();c(this,"glw");c(this,"options");c(this,"buffers");c(this,"shader");c(this,"shaderProps");c(this,"alpha");c(this,"clippingRect");c(this,"dimensions");c(this,"bufferIdx");c(this,"zIndex");c(this,"renderToTexture");c(this,"parentHasRenderTexture");c(this,"framebufferDimensions");c(this,"length",0);c(this,"numQuads",0);c(this,"textures",[]);c(this,"maxTextures");this.glw=e,this.options=s,this.buffers=i,this.shader=n,this.shaderProps=o,this.alpha=f,this.clippingRect=l,this.dimensions=a,this.bufferIdx=u,this.zIndex=h,this.renderToTexture=d,this.parentHasRenderTexture=g,this.framebufferDimensions=p,this.maxTextures=n.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:s,maxTextures:i}=this;let n=-1;const o=s.length;for(let f=0;f<o;f++)if(s[f]===e){n=f;break}return n!==-1?n:o>=i?4294967295:(this.textures.push(e),o)}draw(){const{glw:e,shader:s,shaderProps:i,options:n}=this,{shManager:o}=n;o.useShader(s),s.bindRenderOp(this,i);const f=this.bufferIdx/32*6*2;if(this.clippingRect.valid){const{x:l,y:a,width:u,height:h}=this.clippingRect,d=this.parentHasRenderTexture?1:n.pixelRatio,g=n.canvas.height,p=Math.round(l*d),m=Math.round(u*d),y=Math.round(h*d);let x=Math.round(g-y-a*d);this.parentHasRenderTexture&&(x=this.framebufferDimensions?this.framebufferDimensions.height-this.dimensions.height:0),e.setScissorTest(!0),e.scissor(p,x,m,y)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,f)}}function za(r){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(s=>{t[s]=r.getParameter(r[s])}),t}function Wa(r){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(s=>{t[s]=r.getExtension(s)}),t}function Xa(r,t){const e=~~(t/80),s=new Uint16Array(e*6);for(let n=0,o=0;n<e;n+=6,o+=4)s[n]=o,s[n+1]=o+1,s[n+2]=o+2,s[n+3]=o+2,s[n+4]=o+1,s[n+5]=o+3;const i=r.createBuffer();r.elementArrayBufferData(i,s,r.STATIC_DRAW)}function Va(r){return r!==null&&(typeof r=="object"&&r.constructor&&r.constructor.name==="HTMLImageElement"||typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)}const Ha=new Uint8Array([0,0,0,0]);class Fs extends an{constructor(e,s,i){super(s,i);c(this,"glw");c(this,"_nativeCtxTexture",null);c(this,"_w",0);c(this,"_h",0);c(this,"txCoordX1",0);c(this,"txCoordY1",0);c(this,"txCoordX2",1);c(this,"txCoordY2",1);this.glw=e}checkGLError(){if(this.state==="failed")return!0;const e=this.glw.getError();return e!==0?(this.state="failed",this.textureSource.setState("failed",new Error(`WebGL Error: ${e}`)),!0):!1}get ctxTexture(){return this.state==="freed"?(this.load(),null):(this._nativeCtxTexture,this._nativeCtxTexture)}get w(){return this._w}get h(){return this._h}async load(){if(this.state==="loading"||this.state==="loaded")return Promise.resolve();if(this.state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this._nativeCtxTexture===null){this.state="failed",this.textureSource.setState("failed",new Error("WebGL Texture creation failed"));return}try{const{width:e,height:s}=await this.onLoadRequest();if(this.state==="freed")return;this.state="loaded",this._w=e,this._h=s,this.textureSource.setState("loaded",{width:e,height:s}),this.textureSource.freeTextureData()}catch{if(this.state==="freed")return;this.state="failed",this.textureSource.setState("failed")}}async onLoadRequest(){var u;const{glw:e}=this,s=this.textureSource.textureData;if(this.state==="failed")return{width:0,height:0};if(s===null||this._nativeCtxTexture===null)return this.state="failed",this.textureSource.setState("failed",new Error("No texture data available")),{width:0,height:0};e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(Ha.byteLength);let i=0,n=0;if(e.activeTexture(0),this.checkGLError()===!0)return{width:0,height:0};const o=s.data,f=e.RGBA,l=4,a=1.1;if(typeof ImageBitmap<"u"&&o instanceof ImageBitmap||o instanceof ImageData||Va(o)){if(i=o.width,n=o.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!s.premultiplyAlpha),e.texImage2D(0,f,f,e.UNSIGNED_BYTE,o),this.checkGLError()===!0)return{width:0,height:0};this.setTextureMemUse(n*i*l*a)}else if(o&&"mipmaps"in o&&o.mipmaps){const{mipmaps:h,type:d,blockInfo:g}=o;if(pa[d](e,this._nativeCtxTexture,o),this.checkGLError()===!0)return{width:0,height:0};i=o.width,n=o.height,this.txCoordX2=i/(Math.ceil(i/g.width)*g.width),this.txCoordY2=n/(Math.ceil(n/g.height)*g.height),this.setTextureMemUse(((u=h[0])==null?void 0:u.byteLength)??0)}else if(o&&o instanceof Uint8Array){if(i=1,n=1,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!s.premultiplyAlpha),e.texImage2D(0,f,i,n,0,f,e.UNSIGNED_BYTE,o),this.checkGLError()===!0)return{width:0,height:0};this.setTextureMemUse(i*n*l)}else return console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",s),this.state="failed",this.textureSource.setState("failed",new Error("Unexpected texture data")),{width:0,height:0};return{width:i,height:n}}free(){this.state!=="freed"&&(this.state="freed",this.textureSource.setState("freed"),this.release())}release(){this._w=0,this._h=0,this._nativeCtxTexture!==null&&(this.glw.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null),this.textureSource.freeTextureData()}createNativeCtxTexture(){const{glw:e}=this,s=e.createTexture();return!s||(e.activeTexture(0),e.bindTexture(s),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.getError()!==0)?null:s}}class Ga extends Fs{constructor(t,e,s){super(t,e,s)}async onLoadRequest(){var e,s;const t=this.textureSource.textureData;return t.data instanceof Uint8Array?{width:1,height:1}:{width:((e=t.data)==null?void 0:e.width)||0,height:((s=t.data)==null?void 0:s.height)||0}}}class cn{constructor(t){c(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.attributes[t]}}function Ya(r){return self.WebGL2RenderingContext&&r instanceof self.WebGL2RenderingContext}class ja{constructor(t){c(this,"gl");c(this,"activeTextureUnit",0);c(this,"texture2dUnits");c(this,"texture2dParams",new WeakMap);c(this,"scissorEnabled");c(this,"scissorX");c(this,"scissorY");c(this,"scissorWidth");c(this,"scissorHeight");c(this,"blendEnabled");c(this,"blendSrcRgb");c(this,"blendDstRgb");c(this,"blendSrcAlpha");c(this,"blendDstAlpha");c(this,"boundArrayBuffer");c(this,"boundElementArrayBuffer");c(this,"curProgram");c(this,"canvas");c(this,"MAX_RENDERBUFFER_SIZE");c(this,"MAX_TEXTURE_SIZE");c(this,"MAX_VIEWPORT_DIMS");c(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");c(this,"MAX_TEXTURE_IMAGE_UNITS");c(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");c(this,"MAX_VERTEX_ATTRIBS");c(this,"MAX_VARYING_VECTORS");c(this,"MAX_VERTEX_UNIFORM_VECTORS");c(this,"MAX_FRAGMENT_UNIFORM_VECTORS");c(this,"TEXTURE_MAG_FILTER");c(this,"TEXTURE_MIN_FILTER");c(this,"TEXTURE_WRAP_S");c(this,"TEXTURE_WRAP_T");c(this,"LINEAR");c(this,"LINEAR_MIPMAP_LINEAR");c(this,"CLAMP_TO_EDGE");c(this,"RGB");c(this,"RGBA");c(this,"UNSIGNED_BYTE");c(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");c(this,"UNPACK_FLIP_Y_WEBGL");c(this,"FLOAT");c(this,"TRIANGLES");c(this,"UNSIGNED_SHORT");c(this,"ONE");c(this,"ONE_MINUS_SRC_ALPHA");c(this,"VERTEX_SHADER");c(this,"FRAGMENT_SHADER");c(this,"STATIC_DRAW");c(this,"COMPILE_STATUS");c(this,"LINK_STATUS");c(this,"DYNAMIC_DRAW");c(this,"COLOR_ATTACHMENT0");c(this,"INVALID_ENUM");c(this,"INVALID_OPERATION");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((i,n)=>(this.activeTexture(n),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const s=t.getParameter(t.SCISSOR_BOX);this.scissorX=s[0],this.scissorY=s[1],this.scissorWidth=s[2],this.scissorHeight=s[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.LINEAR_MIPMAP_LINEAR=t.LINEAR_MIPMAP_LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGB=t.RGB,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=t.UNPACK_FLIP_Y_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=t.COLOR_ATTACHMENT0,this.INVALID_ENUM=t.INVALID_ENUM,this.INVALID_OPERATION=t.INVALID_OPERATION}isWebGl2(){return Ya(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:s,texture2dUnits:i}=this;i[s]!==t&&(i[s]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:s,texture2dParams:i}=this,n=this._getActiveTexture();if(!n)throw new Error("No active texture");let o=i.get(n);o||(o={},i.set(n,o)),o[t]!==e&&(o[t]=e,s.texParameteri(s.TEXTURE_2D,t,e))}texImage2D(t,e,s,i,n,o,f,l){const{gl:a}=this;o?a.texImage2D(a.TEXTURE_2D,t,e,s,i,n,o,f,l):a.texImage2D(a.TEXTURE_2D,t,e,s,i,n)}compressedTexImage2D(t,e,s,i,n,o){const{gl:f}=this;f.compressedTexImage2D(f.TEXTURE_2D,t,e,s,i,n,o)}pixelStorei(t,e){const{gl:s}=this;s.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}deleteFramebuffer(t){this.gl.deleteFramebuffer(t)}viewport(t,e,s,i){const{gl:n}=this;n.viewport(t,e,s,i)}clearColor(t,e,s,i){const{gl:n}=this;n.clearColor(t,e,s,i)}setScissorTest(t){const{gl:e,scissorEnabled:s}=this;t!==s&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,s,i){const{gl:n,scissorX:o,scissorY:f,scissorWidth:l,scissorHeight:a}=this;(t!==o||e!==f||s!==l||i!==a)&&(n.scissor(t,e,s,i),this.scissorX=t,this.scissorY=e,this.scissorWidth=s,this.scissorHeight=i)}setBlend(t){const{gl:e,blendEnabled:s}=this;t!==s&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:s,blendSrcRgb:i,blendDstRgb:n,blendSrcAlpha:o,blendDstAlpha:f}=this;(t!==i||e!==n||t!==o||e!==f)&&(s.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}createFramebuffer(){const{gl:t}=this;return t.createFramebuffer()}bindFramebuffer(t){const{gl:e}=this;e.bindFramebuffer(e.FRAMEBUFFER,t)}framebufferTexture2D(t,e,s){const{gl:i}=this;i.framebufferTexture2D(i.FRAMEBUFFER,t,i.TEXTURE_2D,e,s)}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,s){const{gl:i,boundArrayBuffer:n}=this;n!==t&&(i.bindBuffer(i.ARRAY_BUFFER,t),this.boundArrayBuffer=t),i.bufferData(i.ARRAY_BUFFER,e,s)}elementArrayBufferData(t,e,s){const{gl:i,boundElementArrayBuffer:n}=this;n!==t&&(i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,s)}vertexAttribPointer(t,e,s,i,n,o,f){const{gl:l,boundArrayBuffer:a}=this;a!==t&&(l.bindBuffer(l.ARRAY_BUFFER,t),this.boundArrayBuffer=t),l.vertexAttribPointer(e,s,i,n,o,f)}getUniformLocations(t){const e=this.gl,s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i={};for(let n=0;n<s;n++){let f=e.getActiveUniform(t,n).name.replace(/\[.*?\]/g,"");i[f]=e.getUniformLocation(t,f)}return i}getAttributeLocations(t){const e=this.gl,s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=[];for(let n=0;n<s;n++){const{name:o}=e.getActiveAttrib(t,n);i[e.getAttribLocation(t,o)]=o}return i}useProgram(t){const{gl:e,curProgram:s}=this;s!==t&&(e.useProgram(t),this.curProgram=t)}uniform1f(t,e){const{gl:s}=this;s.uniform1f(t,e)}uniform1fv(t,e){const{gl:s}=this;s.uniform1fv(t,e)}uniform1i(t,e){const{gl:s}=this;s.uniform1i(t,e)}uniform1iv(t,e){const{gl:s}=this;s.uniform1iv(t,e)}uniform2f(t,e,s){const{gl:i}=this;i.uniform2f(t,e,s)}uniform2fv(t,e){const{gl:s}=this;s.uniform2fv(t,e)}uniform2i(t,e,s){const{gl:i}=this;i.uniform2i(t,e,s)}uniform2iv(t,e){const{gl:s}=this;s.uniform2iv(t,e)}uniform3f(t,e,s,i){const{gl:n}=this;n.uniform3f(t,e,s,i)}uniform3fv(t,e){const{gl:s}=this;s.uniform3fv(t,e)}uniform3i(t,e,s,i){const{gl:n}=this;n.uniform3i(t,e,s,i)}uniform3iv(t,e){const{gl:s}=this;s.uniform3iv(t,e)}uniform4f(t,e,s,i,n){const{gl:o}=this;o.uniform4f(t,e,s,i,n)}uniform4fv(t,e){const{gl:s}=this;s.uniform4fv(t,e)}uniform4i(t,e,s,i,n){const{gl:o}=this;o.uniform4i(t,e,s,i,n)}uniform4iv(t,e){const{gl:s}=this;s.uniform4iv(t,e)}uniformMatrix2fv(t,e){const{gl:s}=this;s.uniformMatrix2fv(t,!1,e)}uniformMatrix3fv(t,e){const{gl:s}=this;s.uniformMatrix3fv(t,!1,e)}uniformMatrix4fv(t,e){const{gl:s}=this;s.uniformMatrix4fv(t,!1,e)}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,s,i){const{gl:n}=this;n.drawElements(t,e,s,i)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}getError(){const{gl:t}=this;return t.getError()}createVertexArray(){const{gl:t}=this;return t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:s}=this;return s.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:s}=this;return s.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:s}=this;s.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:s}=this;return s.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:s}=this;return s.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:s}=this;s.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}checkError(t){const e=this.getError();if(e!==0){let s="UNKNOWN_ERROR";switch(e){case this.INVALID_ENUM:s="INVALID_ENUM";break;case 1281:s="INVALID_VALUE";break;case this.INVALID_OPERATION:s="INVALID_OPERATION";break;case 1285:s="OUT_OF_MEMORY";break;case 37442:s="CONTEXT_LOST_WEBGL";break}const i=`WebGL ${s} (0x${e.toString(16)}) during ${t}`;return{error:e,errorName:s,message:i}}return null}}class Ka extends Fs{constructor(e,s,i){super(e,s,i);c(this,"framebuffer",null)}async onLoadRequest(){const{glw:e}=this,s=this._nativeCtxTexture=this.createNativeCtxTexture();if(!s)throw new Error("Failed to create native texture for RenderTexture");const{width:i,height:n}=this.textureSource;return this.framebuffer=e.createFramebuffer(),e.texImage2D(0,e.RGBA,i,n,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(i*n*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,s,0),e.bindFramebuffer(null),{width:i,height:n}}free(){super.free(),this.glw.deleteFramebuffer(this.framebuffer),this.framebuffer=null}}class qa extends ln{constructor(e){super(e);c(this,"glw");c(this,"system");c(this,"quadBuffer");c(this,"fQuadBuffer");c(this,"uiQuadBuffer");c(this,"renderOps",[]);c(this,"curBufferIdx",0);c(this,"curRenderOp",null);c(this,"rttNodes",[]);c(this,"activeRttNode",null);c(this,"defShaderCtrl");c(this,"defaultShader");c(this,"quadBufferCollection");c(this,"clearColor",{raw:0,normalized:[0,0,0,0]});c(this,"quadBufferUsage",0);c(this,"numQuadsRendered",0);c(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:s,clearColor:i,bufferMemory:n}=e,o=Lo(s,e.forceWebGL2,e.contextSpy),f=this.glw=new ja(o);f.viewport(0,0,s.width,s.height),this.updateClearColor(i),f.setBlend(!0),f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA),Xa(f,n),this.system={parameters:za(this.glw),extensions:Wa(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const l=f.createBuffer(),a=8*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new cn([{buffer:l,attributes:{a_position:{name:"a_position",size:2,type:f.FLOAT,normalized:!1,stride:a,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:f.FLOAT,normalized:!1,stride:a,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:f.UNSIGNED_BYTE,normalized:!0,stride:a,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:f.FLOAT,normalized:!1,stride:a,offset:5*Float32Array.BYTES_PER_ELEMENT},a_nodeCoordinate:{name:"a_nodeCoordinate",size:2,type:f.FLOAT,normalized:!1,stride:a,offset:6*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof Ut?new Ga(this.glw,this.txMemManager,e):e instanceof Ar?new Ka(this.glw,this.txMemManager,e):new Fs(this.glw,this.txMemManager,e)}addQuad(e){var y;const{fQuadBuffer:s,uiQuadBuffer:i}=this;let n=e.texture;if(e.shader!==this.defaultShader){if(_r(e.shaderProps,"$dimensions")==!0){const x=e.shaderProps.$dimensions;x.width=e.width,x.height=e.height}_r(e.shaderProps,"$alpha")===!0&&(e.shaderProps.$alpha=e.alpha)}let{curBufferIdx:o,curRenderOp:f}=this;const l={width:e.width,height:e.height};this.reuseRenderOp(e)===!1&&(this.newRenderOp(e.shader,e.shaderProps,e.alpha,l,e.clippingRect,o,e.rtt,e.parentHasRenderTexture,e.framebufferDimensions),f=this.curRenderOp);let a,u=0,h=0,d=1,g=1;if(n.type===q.subTexture){const{x,y:T,width:E,height:M}=n.props,{width:O=0,height:U=0}=n.parentTexture.dimensions||{width:0,height:0};u=x/O,d=u+E/O,h=T/U,g=h+M/U,n=n.parentTexture,a=n.ctxTexture}else a=n.ctxTexture,a===void 0&&(a=(y=this.stage.defaultTexture)==null?void 0:y.ctxTexture,console.warn("WebGL Renderer: Texture does not have a ctxTexture, using default texture instead")),u=a.txCoordX1,h=a.txCoordY1,d=a.txCoordX2,g=a.txCoordY2;if(n.type===q.image&&e.textureOptions!==null&&e.textureOptions.resizeMode!==void 0&&n.dimensions!==null){const x=e.textureOptions.resizeMode,{width:T,height:E}=n.dimensions;if(x.type==="cover"){const M=e.width/T,O=e.height/E,U=Math.max(M,O),F=1/U;if(U&&M&&M<U){const z=F*e.width;u=(1-z/T)*(x.clipX??.5),d=u+z/T}if(U&&O&&O<U){const z=F*e.height;h=(1-z/E)*(x.clipY??.5),g=h+z/E}}}let p=0;e.textureOptions!==null&&(e.textureOptions.flipX===!0&&([u,d]=[d,u]),p=+(e.textureOptions.flipY||!1)),p^+(n.type===q.renderToTexture)&&([h,g]=[g,h]);const m=this.addTexture(a,o);if(this.curRenderOp,e.renderCoords)s[o++]=e.renderCoords.x1,s[o++]=e.renderCoords.y1,s[o++]=u,s[o++]=h,i[o++]=e.colorTl,s[o++]=m,s[o++]=0,s[o++]=0,s[o++]=e.renderCoords.x2,s[o++]=e.renderCoords.y2,s[o++]=d,s[o++]=h,i[o++]=e.colorTr,s[o++]=m,s[o++]=1,s[o++]=0,s[o++]=e.renderCoords.x4,s[o++]=e.renderCoords.y4,s[o++]=u,s[o++]=g,i[o++]=e.colorBl,s[o++]=m,s[o++]=0,s[o++]=1,s[o++]=e.renderCoords.x3,s[o++]=e.renderCoords.y3,s[o++]=d,s[o++]=g,i[o++]=e.colorBr,s[o++]=m,s[o++]=1,s[o++]=1;else if(e.tb!==0||e.tc!==0)s[o++]=e.tx,s[o++]=e.ty,s[o++]=u,s[o++]=h,i[o++]=e.colorTl,s[o++]=m,s[o++]=0,s[o++]=0,s[o++]=e.tx+e.width*e.ta,s[o++]=e.ty+e.width*e.tc,s[o++]=d,s[o++]=h,i[o++]=e.colorTr,s[o++]=m,s[o++]=1,s[o++]=0,s[o++]=e.tx+e.height*e.tb,s[o++]=e.ty+e.height*e.td,s[o++]=u,s[o++]=g,i[o++]=e.colorBl,s[o++]=m,s[o++]=0,s[o++]=1,s[o++]=e.tx+e.width*e.ta+e.height*e.tb,s[o++]=e.ty+e.width*e.tc+e.height*e.td,s[o++]=d,s[o++]=g,i[o++]=e.colorBr,s[o++]=m,s[o++]=1,s[o++]=1;else{const x=e.tx+e.width*e.ta,T=e.ty+e.height*e.td;s[o++]=e.tx,s[o++]=e.ty,s[o++]=u,s[o++]=h,i[o++]=e.colorTl,s[o++]=m,s[o++]=0,s[o++]=0,s[o++]=x,s[o++]=e.ty,s[o++]=d,s[o++]=h,i[o++]=e.colorTr,s[o++]=m,s[o++]=1,s[o++]=0,s[o++]=e.tx,s[o++]=T,s[o++]=u,s[o++]=g,i[o++]=e.colorBl,s[o++]=m,s[o++]=0,s[o++]=1,s[o++]=x,s[o++]=T,s[o++]=d,s[o++]=g,i[o++]=e.colorBr,s[o++]=m,s[o++]=1,s[o++]=1}this.curRenderOp.numQuads++,this.curBufferIdx=o}newRenderOp(e,s,i,n,o,f,l,a,u){const h=new un(this.glw,this.options,this.quadBufferCollection,e,s,i,o,n,f,0,l,a,u);this.curRenderOp=h,this.renderOps.push(h)}addTexture(e,s,i){const{curRenderOp:n}=this,o=n.addTexture(e);if(o===4294967295){if(i)throw new Error("Unable to add texture to render op");return this.newRenderOp(n.shader,n.shaderProps,n.alpha,n.dimensions,n.clippingRect,s),this.addTexture(e,s,!0)}return o}reuseRenderOp(e){var l;const{shader:s,shaderProps:i,parentHasRenderTexture:n,rtt:o,clippingRect:f}=e;return!(((l=this.curRenderOp)==null?void 0:l.shader)!==s||Do(this.curRenderOp.clippingRect,f)===!1||n===!0||o===!0||this.curRenderOp.shader!==this.defaultShader&&this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,i)===!1)}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){const{glw:s,quadBuffer:i}=this,n=new Float32Array(i,0,this.curBufferIdx),o=this.quadBufferCollection.getBuffer("a_position")||null;s.arrayBufferData(o,n,s.STATIC_DRAW);for(let l=0,a=this.renderOps.length;l<a;l++)this.renderOps[l].draw();this.quadBufferUsage=this.curBufferIdx*n.BYTES_PER_ELEMENT;const f=4*(8*n.BYTES_PER_ELEMENT);this.numQuadsRendered=this.quadBufferUsage/f}getQuadCount(){return this.numQuadsRendered}renderToTexture(e){for(let s=0;s<this.rttNodes.length;s++)if(this.rttNodes[s]===e)return;this.insertRTTNodeInOrder(e)}insertRTTNodeInOrder(e){let s=this.rttNodes.length,i=e;for(;i&&i.parent;){const o=this.rttNodes.indexOf(i.parent);if(o!==-1){s=o;break}i=i.parent}const n=this.findMaxChildRTTIndex(e);n!==-1&&(s=Math.max(s,n+1)),this.rttNodes.splice(s,0,e)}findMaxChildRTTIndex(e){let s=-1;const i=n=>{const o=this.rttNodes.indexOf(n);o!==-1&&(s=Math.max(s,o));for(const f of n.children)i(f)};return i(e),s}renderRTTNodes(){const{glw:e}=this,{txManager:s}=this.stage;for(let n=0;n<this.rttNodes.length;n++){const o=this.rttNodes[n];if(o===void 0||o.hasRTTupdates===!1||o.worldAlpha===0||o.strictBounds===!0&&o.renderState===re.OutOfBounds||o.texture===null||o.texture.state!=="loaded")continue;this.activeRttNode=o,o.texture;const f=o.texture.ctxTexture;this.renderToTextureActive=!0,e.bindFramebuffer(f.framebuffer),e.viewport(0,0,f.w,f.h),e.clearColor(0,0,0,0),e.clear();for(let l=0;l<o.children.length;l++){const a=o.children[l];a!==void 0&&(this.stage.addQuads(a),a.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,o.hasRTTupdates=!1}const i=this.clearColor.normalized;e.clearColor(i[0],i[1],i[2],i[3]),e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const s=this.rttNodes.indexOf(e);s!==-1&&this.rttNodes.splice(s,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}updateClearColor(e){if(this.clearColor.raw===e)return;const s=this.glw,i=$t(e);s.clearColor(i[0],i[1],i[2],i[3]),this.clearColor={raw:e,normalized:i},s.clear()}}const Qa={LINE_FEED:10};class Za{}class Ja extends Za{constructor(e,s){super();c(this,"data");c(this,"glyphMap");c(this,"kernings");this.data=e,this.glyphMap=s;const i=this.kernings={};e.kernings.forEach(n=>{const o=n.second,f=i[o]=i[o]||{};f[n.first]=n.amount}),this.kernings=i}*shapeText(e,s){var o;let i,n;for(;(i=s.peek())&&!i.done;){const f=i.value,l=this.glyphMap.get(f);if(s.next(),l!==void 0){const a=n!==void 0?(((o=this.kernings[l.id])==null?void 0:o[n])||0)+e.letterSpacing:0;n=l.id,yield{mapped:!0,glyphId:l.id,codepoint:f,cluster:s.lastIndex,xAdvance:l.xadvance+a,yAdvance:0,xOffset:l.xoffset+a,yOffset:l.yoffset,xBearing:0,yBearing:0,width:l.width,height:l.height}}else f===Qa.LINE_FEED&&(n=void 0),yield{mapped:!1,codepoint:f,cluster:s.lastIndex}}}}class hn extends fn{constructor(e,s){super(s);c(this,"type");c(this,"texture");c(this,"maxCharHeight",0);c(this,"shaper");c(this,"glyphMap",new Map);c(this,"data");const{atlasUrl:i,atlasDataUrl:n,stage:o}=s;this.type=e,o.renderer,this.texture=o.txManager.createTexture("ImageTexture",{src:i,premultiplyAlpha:!1}),o.txManager.loadTexture(this.texture,!0),this.texture.preventCleanup=!0,this.texture.on("loaded",()=>{this.checkLoaded(),o.requestRender()}),en(n).then(f=>{var a;this.data=JSON.parse(f),this.data;let l=0;if(this.data.chars.forEach(u=>{this.glyphMap.set(u.id,u);const h=u.yoffset+u.height;h>l&&(l=h)}),this.maxCharHeight=l,this.shaper=new Ja(this.data,this.glyphMap),!this.metrics)if((a=this.data)!=null&&a.lightningMetrics){const{ascender:u,descender:h,lineGap:d,unitsPerEm:g}=this.data.lightningMetrics;this.metrics={ascender:u/g,descender:h/g,lineGap:d/g}}else throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const s=this.glyphMap.get(e);if(s===void 0)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:s.x,y:s.y,width:s.width,height:s.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const el=24;function tl(r,t,e,s,i,n,o,f,l){const a=Math.min(Math.max(o.firstLineIdx,0),f.length),u=0,{metrics:h}=e;e.data;const d=(h.ascender-h.descender)*r;let g=0;s==="middle"?g=(t-d)/2:s==="bottom"&&(g=t-d);const p=i/n,m=e.data.common.base,x=h.ascender*r-m,T=p+x+a*t+g;if(!(l&&T>=l/n))return{sdfX:u,sdfY:T,lineIndex:a}}class wt{constructor(t,e=0){c(this,"iterator");c(this,"peekBuffer",[]);c(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*Ct(r,t=0){let e=t;for(;e<r.length;){const s=r.codePointAt(e);if(s===void 0)throw new Error("Invalid Unicode code point");yield s,e+=s<=65535?1:2}}function rl(r,t,e){const s=e.shapeText(t,new wt(Ct(r,0),0));let i=0;for(const n of s)n.mapped&&n.codepoint!==8203&&(i+=n.xAdvance);return i}function sl(r,t,e,s,i,n,o,f,l,a,u,h,d,g,p,m,y,x,T){p.loaded,p.data,p.shaper;const E=f/p.data.info.size,M=l/E,O=n/E,U=a/E,F=d[r],z=(F==null?void 0:F.codepointIndex)||0,v=(F==null?void 0:F.maxX)||0,W=(F==null?void 0:F.maxY)||0;let I=v,S=W,L=t,A=e,D=0;const C={codepointIndex:-1,bufferOffset:-1,xStart:-1},w=p.shaper,R={letterSpacing:U};s.endsWith(" ")&&(s+=" ");let V=w.shapeText(R,new wt(Ct(s,z),z)),N,k=-1;const B=[],$=o/E,K=rl(x,R,w);let X=!0;for(;X;){const H=(T===0||r+1<T)&&(h!=="both"||y||A+M+p.maxCharHeight<=$),Q=H?O:O-K;let te=0;const pt=A+p.maxCharHeight>=g.y1,mt=A<=g.y2,xe=pt&&mt;for(;(N=V.next())&&!N.done;){const J=N.value;if(r===d.length)d.push({codepointIndex:J.cluster,maxY:S,maxX:I});else if(r>d.length)throw new Error("Unexpected lineCache length");if(J.codepoint===32||J.codepoint===10||J.codepoint===8203?C.codepointIndex!==-1&&(C.codepointIndex=-1,te=L):C.codepointIndex===-1&&(C.codepointIndex=J.cluster,C.bufferOffset=D,C.xStart=te),J.mapped){const io=L+J.xOffset+J.width;if(h!=="none"&&io>=Q&&C.codepointIndex!==-1&&C.xStart>0)if(H){V=w.shapeText(R,new wt(Ct(s,C.codepointIndex),C.codepointIndex)),D=C.bufferOffset;break}else V=w.shapeText(R,new wt(Ct(x,0),0)),L=C.xStart,D=C.bufferOffset,h="none";else{const gt=L+J.xOffset,yt=A+J.yOffset;if(xe){k===-1&&(k=D);const Gt=p.getAtlasEntry(J.glyphId),Yt=Gt.x/p.data.common.scaleW,jt=Gt.y/p.data.common.scaleH,Vs=Gt.width/p.data.common.scaleW,Hs=Gt.height/p.data.common.scaleH;u[D++]=gt,u[D++]=yt,u[D++]=Yt,u[D++]=jt,u[D++]=gt+J.width,u[D++]=yt,u[D++]=Yt+Vs,u[D++]=jt,u[D++]=gt,u[D++]=yt+J.height,u[D++]=Yt,u[D++]=jt+Hs,u[D++]=gt+J.width,u[D++]=yt+J.height,u[D++]=Yt+Vs,u[D++]=jt+Hs}S=Math.max(S,yt+J.height),I=Math.max(I,gt+J.width),L+=J.xAdvance}}else if(J.codepoint===10){if(H)break;V=w.shapeText(R,new wt(Ct(x,0),0)),h="none"}}k!==-1&&(B.push({bufferStart:k,bufferEnd:D}),k=-1),L=0,A+=M,r++,C.codepointIndex=-1,te=0,!m&&h==="both"&&A>g.y2||N&&N.done?X=!1:H||(X=!1)}if(i==="center"){const H=h==="none"?I:O;for(let Q=0;Q<B.length;Q++){const te=B[Q],pt=u[te.bufferEnd-4]-u[te.bufferStart],mt=(H-pt)/2;for(let xe=te.bufferStart;xe<te.bufferEnd;xe+=4)u[xe]+=mt}}else if(i==="right"){const H=h==="none"?I:O;for(let Q=0;Q<B.length;Q++){const te=B[Q],pt=te.bufferEnd===te.bufferStart?0:u[te.bufferEnd-4]-u[te.bufferStart],mt=H-pt;for(let xe=te.bufferStart;xe<te.bufferEnd;xe+=4)u[xe]+=mt}}return{bufferNumFloats:D,bufferNumQuads:D/16,layoutNumCharacters:N.done?s.length-z:N.value.cluster-z+1,fullyProcessed:!!N.done,maxX:I,maxY:S,numLines:d.length}}function il(r,t){return Math.ceil(r/t)*t}function nl(r,t){return Math.floor(r/t)*t}function ol(r,t,e,s,i,n,o,f){const{screen:l,sdf:a}=r;if(!Xo(o))l.x1=0,l.y1=0,l.x2=0,l.y2=0,a.x1=0,a.y1=0,a.x2=0,a.y2=0,r.numLines=0,r.firstLineIdx=0;else{const u=o.x1-t,h=u+(o.x2-o.x1),d=o.y1-e+s,g=nl(d-n,i||1),p=il(d+(o.y2-o.y1)+n,i||1);l.x1=u,l.y1=g,l.x2=h,l.y2=p,a.x1=u/f,a.y1=g/f,a.x2=h/f,a.y2=p/f,r.numLines=Math.ceil((p-g)/i),r.firstLineIdx=i?Math.floor(g/i):0}r.valid=!0}function dn(r,t){return t*(r.ascender-r.descender+r.lineGap)}const al={x:0,y:0,width:0,height:0};class ll extends Os{constructor(e){super(e);c(this,"ssdfFontFamilies",{});c(this,"msdfFontFamilies",{});c(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);c(this,"sdfShader");c(this,"rendererBounds");c(this,"type","sdf");this.sdfShader=this.stage.shManager.loadShader("SdfShader",{transform:new Float32Array,color:0,size:0,scrollY:0,distanceRange:0,debug:!1}).shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s},x:(e,s)=>{e.props.x=s,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&jr(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,s)=>{e.props.y=s,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&jr(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollable:(e,s)=>{e.props.scrollable=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s,this.scheduleUpdateState(e)},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)},debug:(e,s)=>{e.props.debug=s}}}canRenderFont(e){const{fontFamily:s}=e;return s in this.ssdfFontFamilies||s in this.msdfFontFamilies||s==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof hn}addFontFace(e){const s=e.fontFamily,i=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!i){console.warn(`Invalid font face type: ${e.type}`);return}let n=i[s];n||(n=new Set,i[s]=n),n.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new we,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:s}=e;const{textH:i,lineCache:n,debugData:o,forceFullLayoutCalc:f}=e;if(o.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),s===void 0){if(s=this.resolveFontFace(e.props),e.trFontFace=s,s===void 0){const w=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;console.error(w),this.setStatus(e,"failed",new Error(w));return}s.texture.setRenderableOwner(e.props.fontFamily,!0)}if(s.loaded===!1){s.once("loaded",()=>{this.scheduleUpdateState(e)});return}s.data,s.metrics;const{text:l,fontSize:a,x:u,y:h,contain:d,width:g,height:p,verticalAlign:m,scrollable:y,overflowSuffix:x,maxLines:T}=e.props,E=d==="both"&&y?e.props.scrollY:0,{renderWindow:M}=e,O=s.data.info.size,U=a/O;let F=e.resLineHeight;if(F===void 0){const w=e.props.lineHeight;w===void 0?F=dn(s.metrics,a):F=w,e.resLineHeight=F}const z=F/U;e.distanceRange=U*s.data.distanceField.distanceRange;const v=l.length*el;let W=e.vertexBuffer;(!W||W.length<v)&&(W=new Float32Array(v*2));const I=e.elementBounds;if(I.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),I.valid=!0),!f&&M.valid){const w=M.screen;if(u+w.x1<=I.x1&&u+w.x2>=I.x2&&h-E+w.y1<=I.y1&&h-E+w.y2>=I.y2){this.setStatus(e,"loaded");return}M.valid=!1,this.setStatus(e,"loading")}const{offsetY:S,textAlign:L}=e.props;if(!M.valid){if(!jr(I,this.rendererBounds))return;ol(M,u,h,E,F,d==="both"?I.y2-I.y1:0,I,U)}const A=tl(O,z,s,m,S,U,M,n,i);if(!A){this.setStatus(e,"loaded");return}const{letterSpacing:D}=e.props,C=sl(A.lineIndex,A.sdfX,A.sdfY,l,L,g,p,a,F,D,W,d,n,M.sdf,s,f,y,x,T);e.bufferUploaded=!1,e.bufferNumFloats=C.bufferNumFloats,e.bufferNumQuads=C.bufferNumQuads,e.vertexBuffer=W,e.renderWindow=M,o.lastLayoutNumCharacters=C.layoutNumCharacters,o.bufferSize=W.byteLength,C.fullyProcessed&&(e.textW=C.maxX*U,e.textH=C.numLines*z*U),this.setStatus(e,"loaded")}renderQuads(e,s,i,n,o,f){var I,S;if(!e.vertexBuffer)return;const l=this.stage.renderer,{fontSize:a,color:u,contain:h,scrollable:d,zIndex:g,debug:p}=e.props,m=h==="both"&&d?e.props.scrollY:0,{textW:y=0,textH:x=0,distanceRange:T,vertexBuffer:E,bufferUploaded:M,trFontFace:O,elementBounds:U}=e;let{webGlBuffers:F}=e;if(!F){const L=l.glw,A=4*Float32Array.BYTES_PER_ELEMENT,D=L.createBuffer();e.webGlBuffers=new cn([{buffer:D,attributes:{a_position:{name:"a_position",size:2,type:L.FLOAT,normalized:!1,stride:A,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:L.FLOAT,normalized:!1,stride:A,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,e.webGlBuffers,F=e.webGlBuffers}if(!M){const L=l.glw,A=(F==null?void 0:F.getBuffer("a_textureCoordinate"))??null;L.arrayBufferData(A,E,L.STATIC_DRAW),e.bufferUploaded=!0}if(d&&h==="both"){U.valid;const L=No(U,al);i.valid?(e.clippingRect.valid=!0,i=Qi(i,L,e.clippingRect)):(e.clippingRect.valid=!0,i=Zi(L,e.clippingRect))}const z=new un(l.glw,l.options,F,this.sdfShader,{transform:s.getFloatArr(),color:Po(u,n),size:a/(((I=O.data)==null?void 0:I.info.size)||0),scrollY:m,distanceRange:T,debug:p.sdfShaderDebug},n,i,{height:x,width:y},0,g,!1,o,f),W=((S=e.trFontFace)==null?void 0:S.texture).ctxTexture;z.addTexture(W),z.length=e.bufferNumFloats,z.numQuads=e.bufferNumQuads,l.addRenderOp(z)}setIsRenderable(e,s){var i;super.setIsRenderable(e,s),(i=e.trFontFace)==null||i.texture.setRenderableOwner(e.props.fontFamily,s)}destroyState(e){var s;super.destroyState(e),(s=e.trFontFace)==null||s.texture.setRenderableOwner(e.props.fontFamily,!1)}resolveFontFace(e){return this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e,"sdf")}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e.props.fontFamily,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:s,contain:i,width:n}=e.props,{elementBounds:o}=e;o.x1=s,o.x2=i!=="none"?s+n:1/0}setElementBoundsY(e){const{y:s,contain:i,height:n}=e.props,{elementBounds:o}=e;o.y1=s,o.y2=i==="both"?s+n:1/0}}function di(r){return r===""||r==="​"}function fl(r,t,e){if(t.metrics)return t.metrics;const s=r.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn(`Font metrics not provided for Canvas Web font ${t.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`);let i;return s.actualBoundingBoxDescent&&s.actualBoundingBoxAscent?i={ascender:s.actualBoundingBoxAscent/e,descender:-s.actualBoundingBoxDescent/e,lineGap:.2}:i={ascender:.8,descender:-.2,lineGap:.2},t.metrics=i,i}const pi=2048;function mi(r,t,e,s,i){const n=r!=="bottom"?.5*t:0;return e*(s-1)+n+Math.max(e,t)+(i||0)}class ul{constructor(t,e){c(this,"_canvas");c(this,"_context");c(this,"_settings");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFamily],e=[];for(let s=0,i=t.length;s<i;s++)t[s]==="serif"||t[s]==="sans-serif"?e.push(t[s]):e.push(`"${t[s]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${e.join(",")}`}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch{console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),s=this._settings.paddingLeft*e,i=this._settings.paddingRight*e,n=this._settings.fontSize*e;let o=this._settings.offsetY===null?null:this._settings.offsetY*e;const f=this._settings.w*e,l=this._settings.h*e;let a=this._settings.wordWrapWidth*e;const u=this._settings.cutSx*e,h=this._settings.cutEx*e,d=this._settings.cutSy*e,g=this._settings.cutEy*e,p=(this._settings.letterSpacing||0)*e,m=this._settings.textIndent*e,y=this._settings.trFontFace;this.setFontProperties();const x=fl(this._context,y,n),T=dn(x,n)*e,E=this._settings.lineHeight!==null?this._settings.lineHeight*e:T,M=this._settings.maxHeight,O=M!==null&&E>0?Math.floor(M/E):0,U=this._settings.maxLines,F=O>0&&U>0?Math.min(O,U):Math.max(O,U);let z=f||2048/this.getPrecision(),v=z-s;if(v<10&&(z+=10-v,v=10),a||(a=v),this._settings.textOverflow&&!this._settings.wordWrap){let D;switch(this._settings.textOverflow){case"clip":D="";break;case"ellipsis":D=this._settings.overflowSuffix;break;default:D=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,a-m,D)}let W;if(this._settings.wordWrap)W=this.wrapText(this._settings.text,a,p,m);else{W={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const D=W.l.length;for(let C=0;C<D-1;C++)W.n.push(C)}let I=W.l;if(F&&I.length>F){const D=I.slice(0,F);let C=null;if(this._settings.overflowSuffix){const k=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,B=this.wrapText(D[D.length-1],a-k,p,m);D[D.length-1]=`${B.l[0]}${this._settings.overflowSuffix}`,C=[B.l.length>1?B.l[1]:""]}else C=[""];let w;const R=I.length;let V=0;const N=W.n.length;for(w=F;w<R;w++)C[V]+=`${C[V]?" ":""}${I[w]}`,w+1<N&&W.n[w+1]&&V++;t.remainingText=C.join(`
`),t.moreTextLines=!0,I=D}else t.moreTextLines=!1,t.remainingText="";let S=0;const L=[];for(let D=0;D<I.length;D++){const C=this.measureText(I[D],p)+(D===0?m:0);L.push(C),S=Math.max(S,C)}t.lineWidths=L,f||(z=S+s+i,v=S),this._settings.wordWrap&&f>S&&this._settings.textAlign==="left"&&I.length===1&&(z=S+s+i);let A;return l?A=l:A=mi(this._settings.textBaseline,n,E,I.length,o),o===null&&(o=n),t.w=z,t.h=A,t.lines=I,t.precision=e,z||(z=1),A||(A=1),(u||h)&&(z=Math.min(z,h-u)),(d||g)&&(A=Math.min(A,g-d)),t.width=z,t.innerWidth=v,t.height=A,t.fontSize=n,t.cutSx=u,t.cutSy=d,t.cutEx=h,t.cutEy=g,t.lineHeight=E,t.defLineHeight=T,t.lineWidths=L,t.offsetY=o,t.paddingLeft=s,t.paddingRight=i,t.letterSpacing=p,t.textIndent=m,t.metrics=x,t}draw(t,e){const s=this.getPrecision(),i=(e==null?void 0:e.lines)||t.lines,n=(e==null?void 0:e.lineWidths)||t.lineWidths,o=e?mi(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*s):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),pi),this._canvas.height=Math.min(Math.ceil(o),pi),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let f,l;const a=[],{metrics:u}=t,h=u?u.ascender*t.fontSize:t.fontSize,d=(u.ascender-u.descender)*t.fontSize;for(let p=0,m=i.length;p<m;p++)f=p===0?t.textIndent:0,l=p*t.lineHeight+h,this._settings.verticalAlign=="middle"?l+=(t.lineHeight-d)/2:this._settings.verticalAlign=="bottom"&&(l+=t.lineHeight-d),this._settings.textAlign==="right"?f+=t.innerWidth-n[p]:this._settings.textAlign==="center"&&(f+=(t.innerWidth-n[p])/2),f+=t.paddingLeft,a.push({text:i[p],x:f,y:l,w:n[p]});if(this._settings.highlight){const p=this._settings.highlightColor,m=this._settings.highlightHeight*s||t.fontSize*1.5,y=this._settings.highlightOffset*s,x=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*s:t.paddingLeft,T=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*s:t.paddingRight;this._context.fillStyle=Yr(p);for(let E=0;E<a.length;E++){const M=a[E];this._context.fillRect(M.x-x,M.y-t.offsetY+y,M.w+T+x,m)}}let g=null;this._settings.shadow&&(g=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Yr(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*s,this._context.shadowOffsetY=this._settings.shadowOffsetY*s,this._context.shadowBlur=this._settings.shadowBlur*s),this._context.fillStyle=Yr(this._settings.textColor);for(let p=0,m=a.length;p<m;p++){const y=a[p];if(t.letterSpacing===0)this._context.fillText(y.text,y.x,y.y);else{const x=y.text.split("");let T=y.x;for(let E=0,M=x.length;E<M;E++)this._context.fillText(x[E],T,y.y),T+=this.measureText(x[E],t.letterSpacing)}}g&&(this._context.shadowColor=g[0],this._context.shadowOffsetX=g[1],this._context.shadowOffsetY=g[2],this._context.shadowBlur=g[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy)}wrapWord(t,e,s){const i=this._context.measureText(s).width,n=t.length,o=this._context.measureText(t).width;if(o<=e)return t;let f=Math.floor(e*n/o),l=this._context.measureText(t.substring(0,f)).width+i;if(l>e)for(;f>0&&(l=this._context.measureText(t.substring(0,f)).width+i,l>e);)f-=1;else for(;f<n;)if(l=this._context.measureText(t.substring(0,f)).width+i,l<e)f+=1;else{f-=1;break}return t.substring(0,f)+(e>=i?s:"")}wrapText(t,e,s,i=0){const n=/ |\u200B/g,o=t.split(/\r?\n/g);let f=[];const l=[];for(let a=0;a<o.length;a++){const u=[];let h="",d=e-i;const g=o[a].split(n),p=o[a].match(n)||[];for(let m=0;m<g.length;m++){const y=p[m-1]||"",x=g[m],T=this.measureText(x,s),E=di(y)?T:T+this.measureText(y,s);m===0||E>d?(m>0&&(u.push(h),h=""),h+=x,d=e-T-(m===0?i:0)):(d-=E,h+=y+x)}u.push(h),h="",f=f.concat(u),a<o.length-1&&l.push(f.length)}return{l:f,n:l}}measureText(t,e=0){return e?t.split("").reduce((s,i)=>di(i)?s:s+this._context.measureText(i).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const gi=typeof self>"u"?globalThis:self;var Vi;const yi=((Vi=gi.document)==null?void 0:Vi.fonts)||gi.fonts;function cl(r){const{fontFamily:t,fontStyle:e,fontWeight:s,fontStretch:i,fontSize:n}=r;return[e,s,i,`${n}px`,t].join(" ")}class xi extends Os{constructor(e){super(e);c(this,"canvas");c(this,"context");c(this,"fontFamilies",{});c(this,"fontFamilyArray",[this.fontFamilies]);c(this,"type","canvas");c(this,"loadFont",e=>{const s=cl(e.props),i=this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e.props,"canvas");if(e.fontInfo={fontFace:i,cssString:s,loaded:!1},!e.fontInfo.loaded){yi.load(s).then(this.onFontLoaded.bind(this,e,s)).catch(this.onFontLoadError.bind(this,e,s));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let s=this.canvas.getContext("2d",{willReadFrequently:!0});s||(this.canvas=document.createElement("canvas"),s=this.canvas.getContext("2d",{willReadFrequently:!0})),this.context=s,this.addFontFace(new xs({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s,this.invalidateLayoutCache(e)},x:(e,s)=>{e.props.x=s},y:(e,s)=>{e.props.y=s},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof xs}addFontFace(e){const s=e.fontFamily;s!=="sans-serif"&&yi.add(e.fontFace);let i=this.fontFamilies[s];i||(i=new Set,this.fontFamilies[s]=i),i.add(e)}createState(e,s){return{node:s,props:e,status:"initialState",updateScheduled:!1,emitter:new we,textureNode:void 0,lightning2TextRenderer:new ul(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),e.status!=="loaded"){if(!e.fontInfo)return this.loadFont(e);e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))}}renderSingleCanvasPage(e){e.renderInfo;const s=e.node,i=this.stage.txManager.createTexture("ImageTexture",{premultiplyAlpha:!0,src:(function(n,o){return n.draw(o,{lines:o.lines,lineWidths:o.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=i,e.textureNode.alpha=Js(e.props.color);else{const n=this.stage.createNode({parent:s,texture:i,autosize:!0,alpha:Js(e.props.color)});e.textureNode=n}this.setStatus(e,"loaded")}calculateRenderInfo(e){var s;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:(s=e.fontInfo)==null?void 0:s.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:$t(e.props.color),offsetY:e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:e.props.lineHeight??null,maxLines:e.props.maxLines,maxHeight:e.props.contain==="both"?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:e.props.contain!=="none"?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){e.status!=="destroyed"&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,s){var i;s!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,s,i){var n;s!==((n=e.fontInfo)==null?void 0:n.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,i),this.scheduleUpdateState(e))}}const pn={isWhite:!0,a:1,r:255,g:255,b:255};function Jr(r){if(r===4294967295)return pn;const t=(r>>>24&255)/255,e=r>>>16&255&255,s=r>>>8&255&255,i=r&255&255;return{isWhite:!1,a:t,r:i,g:s,b:e}}function mn(r){if(r===4294967295)return pn;const t=r>>>24&255,e=r>>>16&255&255,s=r>>>8&255&255,i=(r&255&255)/255;return{isWhite:!1,r:t,g:e,b:s,a:i}}function it({a:r,r:t,g:e,b:s}){return`rgba(${t},${e},${s},${r})`}class hl extends an{constructor(){super(...arguments);c(this,"image");c(this,"tintCache")}async load(){this.textureSource.setState("loading");try{const e=await this.onLoadRequest();this.textureSource.setState("loaded",e),this.updateMemSize()}catch(e){throw this.textureSource.setState("failed",e),e}}release(){this.image=void 0,this.tintCache=void 0}free(){this.release(),this.textureSource.setState("freed"),this.setTextureMemUse(0),this.textureSource.freeTextureData()}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:s,height:i}=this.textureSource.dimensions;this.setTextureMemUse(s*i*e)}}hasImage(){return this.image!==void 0}getImage(e){var o;const s=this.image;if(e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),s;const i=it(e);if(((o=this.tintCache)==null?void 0:o.key)===i)return this.tintCache.image;const n=this.tintTexture(s,i);return this.tintCache={key:i,image:n},this.updateMemSize(),n}tintTexture(e,s){const{width:i,height:n}=e,o=document.createElement("canvas");o.width=i,o.height=n;const f=o.getContext("2d");return f&&(f.fillStyle=s,f.globalCompositeOperation="copy",f.fillRect(0,0,i,n),f.globalCompositeOperation="multiply",f.drawImage(e,0,0,i,n,0,0,i,n),f.globalCompositeOperation="destination-in",f.drawImage(e,0,0,i,n,0,0,i,n)),o}async onLoadRequest(){var s,i;(i=(s=this.textureSource)==null?void 0:s.textureData)==null||i.data;const{data:e}=this.textureSource.textureData;if(e instanceof ImageData){const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const o=n.getContext("2d");return o&&o.putImageData(e,0,0),this.image=n,{width:e.width,height:e.height}}else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap||e instanceof HTMLImageElement)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function dl(r){var t,e;if(r.shader instanceof $r){const s=r.shader.shType;if(s===Aa)return((t=r.shaderProps)==null?void 0:t.radius)??0;if(s==="DynamicShader"){const i=(e=r.shaderProps)==null?void 0:e.effects;if(i){const n=i.find(o=>{var f;return o.type==="radius"&&((f=o==null?void 0:o.props)==null?void 0:f.radius)});return n&&n.type==="radius"&&n.props.radius||0}}}return 0}function xt(r,t=""){var e;if(r.shader instanceof $r&&r.shader.shType==="DynamicShader"){const i=(e=r.shaderProps)==null?void 0:e.effects;if(i&&i.length){const n=i.find(o=>o.type===`border${t}`&&o.props&&o.props.width);return n&&n.props}}}function bi(r,t,e,s,i){if(Object.getPrototypeOf(this).roundRect)this.roundRect(r,t,e,s,i);else{const o=l=>{const a=Math.min(e/2,s/2),u=l.topLeft+l.topRight+l.bottomRight+l.bottomLeft;if(u>e||u>s){const h=a/Math.max(l.topLeft,l.topRight,l.bottomRight,l.bottomLeft);l.topLeft*=h,l.topRight*=h,l.bottomRight*=h,l.bottomLeft*=h}},f=typeof i=="number"?{topLeft:i,topRight:i,bottomRight:i,bottomLeft:i}:{topLeft:0,topRight:0,bottomRight:0,bottomLeft:0,...i};o(f),this.moveTo(r+f.topLeft,t),this.lineTo(r+e-f.topRight,t),this.ellipse(r+e-f.topRight,t+f.topRight,f.topRight,f.topRight,0,1.5*Math.PI,2*Math.PI),this.lineTo(r+e,t+s-f.bottomRight),this.ellipse(r+e-f.bottomRight,t+s-f.bottomRight,f.bottomRight,f.bottomRight,0,0,.5*Math.PI),this.lineTo(r+f.bottomLeft,t+s),this.ellipse(r+f.bottomLeft,t+s-f.bottomLeft,f.bottomLeft,f.bottomLeft,0,.5*Math.PI,Math.PI),this.lineTo(r,t+f.topLeft),this.ellipse(r+f.topLeft,t+f.topLeft,f.topLeft,f.topLeft,0,Math.PI,1.5*Math.PI)}}function lr(r,t,e,s,i,n=0,o,f){if(!n)return;let l,a=0,u,h=0;switch(f){case"Top":l=t,a=e,u=s+t,h=e;break;case"Right":l=t+s,a=e,u=t+s,h=e+i;break;case"Bottom":l=t,a=e+i,u=t+s,h=e+i;break;case"Left":l=t,a=e,u=t,h=e+i;break}r.beginPath(),r.lineWidth=n,r.strokeStyle=it(mn(o??0)),r.moveTo(l,a),r.lineTo(u,h),r.stroke()}class pl extends ln{constructor(e){super(e);c(this,"context");c(this,"canvas");c(this,"pixelRatio");c(this,"clearColor");c(this,"renderToTextureActive",!1);c(this,"activeRttNode",null);c(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:s,pixelRatio:i,clearColor:n}=e;this.canvas=s,this.context=s.getContext("2d"),this.pixelRatio=i,this.clearColor=n?Zs(n):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new $r("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[s,i,n,o]=this.clearColor;e.fillStyle=`rgba(${s}, ${i}, ${n}, ${o/255})`,e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const s=this.context,{tx:i,ty:n,width:o,height:f,alpha:l,colorTl:a,colorTr:u,colorBr:h,ta:d,tb:g,tc:p,td:m,clippingRect:y}=e;let x=e.texture,T,E;const M=x==null?void 0:x.type;if(M!==q.image&&M!==q.color&&M!==q.subTexture&&M!==q.noise||x&&(x instanceof Ut&&(E=x.props,x=x.parentTexture),T=x.ctxTexture,x.state==="freed"||x.state!=="loaded"))return;const O=Jr(a),U=d!==1,F=y.width!==0&&y.height!==0,z=a!==u||a!==h,v=!!e.shader,W=v?dl(e):0,I=v?xt(e):void 0;if((U||F||W)&&s.save(),F){const S=new Path2D,{x:L,y:A,width:D,height:C}=y;S.rect(L,A,D,C),s.clip(S)}if(U){const S=this.pixelRatio;s.setTransform(d,p,g,m,i*S,n*S),s.scale(S,S),s.translate(-i,-n)}if(W){const S=new Path2D;bi.call(S,i,n,o,f,W),s.clip(S)}if((M===q.image||M===q.subTexture||M===q.noise)&&T){const S=T.getImage(O);if(s.globalAlpha=O.a??l,E)s.drawImage(S,E.x,E.y,E.width,E.height,i,n,o,f);else try{s.drawImage(S,i,n,o,f)}catch{}s.globalAlpha=1}else if(M===q.color&&z){let S=i,L=n,A;a===u?(S=i,L=n+f,A=Jr(h)):(S=i+o,L=n,A=Jr(u));const D=s.createLinearGradient(i,n,S,L);D.addColorStop(0,it(O)),D.addColorStop(1,it(A)),s.fillStyle=D,s.fillRect(i,n,o,f)}else M===q.color&&(s.fillStyle=it(O),s.fillRect(i,n,o,f));if(I&&I.width){const S=I.width,L=I.width/2,A=it(mn(I.color??0));s.beginPath(),s.lineWidth=S,s.strokeStyle=A,s.globalAlpha=l,W?(bi.call(s,i+L,n+L,o-S,f-S,W),s.stroke()):s.strokeRect(i+L,n+L,o-S,f-S),s.globalAlpha=1}else if(v){const S=xt(e,"Top"),L=xt(e,"Right"),A=xt(e,"Bottom"),D=xt(e,"Left");S&&lr(s,i,n,o,f,S.width,S.color,"Top"),L&&lr(s,i,n,o,f,L.width,L.color,"Right"),A&&lr(s,i,n,o,f,A.width,A.color,"Bottom"),D&&lr(s,i,n,o,f,D.width,D.color,"Left")}(U||F||W)&&s.restore()}createCtxTexture(e){return new hl(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}getQuadCount(){return null}updateClearColor(e){this.clearColor=e?Zs(e):void 0}}const Et={alpha:r=>r===1?null:{prop:"opacity",value:`${r}`},x:r=>({prop:"left",value:`${r}px`}),y:r=>({prop:"top",value:`${r}px`}),width:r=>r===0?{prop:"width",value:"auto"}:{prop:"width",value:`${r}px`},height:r=>r===0?{prop:"height",value:"auto"}:{prop:"height",value:`${r}px`},fontSize:r=>r===0?null:{prop:"font-size",value:`${r}px`},lineHeight:r=>r===0?null:{prop:"line-height",value:`${r}px`},zIndex:()=>"z-index",fontFamily:()=>"font-family",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:r=>r===!1?null:{prop:"overflow",value:r?"hidden":"visible"},rotation:r=>r===0?null:{prop:"transform",value:`rotate(${r}rad)`},scale:r=>r===1?null:{prop:"transform",value:`scale(${r})`},scaleX:r=>r===1?null:{prop:"transform",value:`scaleX(${r})`},scaleY:r=>r===1?null:{prop:"transform",value:`scaleY(${r})`},color:r=>r===0?null:{prop:"color",value:gn(r)}},gn=r=>{const t=(r&255)/255,e=r>>8&255,s=r>>16&255;return`rgba(${r>>24&255},${s},${e},${t})`},bs={id:"test-id"},ml={[q.generic]:"generic",[q.color]:"color",[q.image]:"image",[q.noise]:"noise",[q.renderToTexture]:"renderToTexture",[q.subTexture]:"subTexture"},gl=new Set([...Object.keys(Et),...Object.keys(bs),"src","parent","data","text","texture"]);class yl{constructor(t,e){c(this,"root",null);c(this,"canvas",null);c(this,"height",1080);c(this,"width",1920);c(this,"scaleX",1);c(this,"scaleY",1);c(this,"textureMetrics",new Map)}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,s=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left=`${s}px`,this.root.style.top=`${e}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const s=document.createElement("div");s.style.position="absolute",s.id=t.toString();for(const i in e)this.updateNodeProperty(s,i,e[i],e);return s}createNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,t.on("inViewport",()=>e.setAttribute("state","inViewport")),t.on("inBounds",()=>e.setAttribute("state","inBounds")),t.on("outOfBounds",()=>e.setAttribute("state","outOfBounds")),this.createProxy(t,e)}createTextNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createProxy(t,e){const s=new Map,i=f=>{if(s.forEach((l,a)=>{a.off("loaded",l.onLoaded),a.off("failed",l.onFailed),a.off("freed",l.onFreed)}),s.clear(),f){this.textureMetrics.has(f)||this.textureMetrics.set(f,{previousState:f.state,loadedCount:0,failedCount:0,freedCount:0});const l=()=>{const h=this.textureMetrics.get(f);h&&(h.previousState=h.previousState!==f.state?h.previousState:"loading",h.loadedCount++),this.updateTextureAttributes(e,f)},a=()=>{const h=this.textureMetrics.get(f);h&&(h.previousState=h.previousState!==f.state?h.previousState:"loading",h.failedCount++),this.updateTextureAttributes(e,f)},u=()=>{const h=this.textureMetrics.get(f);h&&(h.previousState=h.previousState!==f.state?h.previousState:f.state,h.freedCount++),this.updateTextureAttributes(e,f)};f.on("loaded",l),f.on("failed",a),f.on("freed",u),s.set(f,{onLoaded:l,onFailed:a,onFreed:u})}};gl.forEach(f=>{let l=Object.getOwnPropertyDescriptor(t,f);if(l===void 0){const a=Object.getPrototypeOf(t);l=Object.getOwnPropertyDescriptor(a,f)}l!==void 0&&Object.defineProperty(t,f,{get(){var a;return(a=l==null?void 0:l.get)==null?void 0:a.call(t)},set:a=>{var u;if((u=l==null?void 0:l.set)==null||u.call(t,a),this.updateNodeProperty(e,f,a,t.props),f==="texture"){const h=a&&typeof a=="object"&&"state"in a?a:null;i(h)}},configurable:!0,enumerable:!0})});const n=t.destroy;Object.defineProperty(t,"destroy",{value:()=>{s.forEach((f,l)=>{l.off("loaded",f.onLoaded),l.off("failed",f.onFailed),l.off("freed",f.onFreed),this.textureMetrics.delete(l)}),s.clear(),this.destroyNode(t.id),n.call(t)}}),t.texture&&i(t.texture);const o=t.animate;return Object.defineProperty(t,"animate",{value:(f,l)=>{const a=o.call(t,f,l),u=a.start.bind(a);return a.start=()=>(this.animateNode(e,f,l),u()),a}}),t}destroyNode(t){const e=document.getElementById(t.toString());e==null||e.remove()}updateTextureAttributes(t,e){t.setAttribute("data-texture-state",e.state),t.setAttribute("data-texture-type",ml[e.type]||"unknown"),e.dimensions?(t.setAttribute("data-texture-width",String(e.dimensions.width)),t.setAttribute("data-texture-height",String(e.dimensions.height))):(t.removeAttribute("data-texture-width"),t.removeAttribute("data-texture-height")),t.setAttribute("data-texture-owners",String(e.renderableOwners.length)),t.setAttribute("data-texture-retry-count",String(e.retryCount)),e.maxRetryCount!==null?t.setAttribute("data-texture-max-retry-count",String(e.maxRetryCount)):t.removeAttribute("data-texture-max-retry-count");const s=this.textureMetrics.get(e);s?(t.setAttribute("data-texture-previous-state",s.previousState),t.setAttribute("data-texture-loaded-count",String(s.loadedCount)),t.setAttribute("data-texture-failed-count",String(s.failedCount)),t.setAttribute("data-texture-freed-count",String(s.freedCount))):(t.removeAttribute("data-texture-previous-state"),t.removeAttribute("data-texture-loaded-count"),t.removeAttribute("data-texture-failed-count"),t.removeAttribute("data-texture-freed-count")),e.error?t.setAttribute("data-texture-error",e.error.code||e.error.message):t.removeAttribute("data-texture-error")}updateNodeProperty(t,e,s,i){var n;if(!(this.root===null||s===void 0||s===null)){if(e==="parent"){const o=s.id;if(o===1){this.root.appendChild(t);return}const f=document.getElementById(o.toString());f==null||f.appendChild(t);return}if(e==="text"){t.innerHTML=String(s),t.style.opacity="0.001",t.style.pointerEvents="none",t.style.userSelect="none";return}if(e==="src"&&s){t.setAttribute("data-src",String(s));return}if(e==="rtt"&&s){t.setAttribute("data-rtt",String(s));return}if(e==="texture"){if(s&&typeof s=="object"&&"state"in s){const o=s;this.updateTextureAttributes(t,o)}else t.removeAttribute("data-texture-state"),t.removeAttribute("data-texture-type"),t.removeAttribute("data-texture-width"),t.removeAttribute("data-texture-height"),t.removeAttribute("data-texture-owners"),t.removeAttribute("data-texture-error");return}if(Et[e]){const o=(n=Et[e])==null?void 0:n.call(Et,s);if(o===null)return;if(typeof o=="string"){t.style.setProperty(o,String(s));return}if(typeof o=="object"){let f=o.value;if(e==="x"){const l=i.mountX,a=i.width;l&&(f=`${parseInt(f)-a*l}px`)}else if(e==="y"){const l=i.mountY,a=i.height;l&&(f=`${parseInt(f)-a*l}px`)}t.style.setProperty(o.prop,f)}return}if(bs[e]){const o=bs[e];if(!o)return;t.setAttribute(String(o),String(s));return}if(e==="data"){for(const o in s){const f=s[o];f===void 0?t.removeAttribute(`data-${o}`):t.setAttribute(`data-${o}`,String(f))}return}}}animateNode(t,e,s){const{duration:i=1e3,delay:n=0}=s,{x:o,y:f,width:l,height:a,alpha:u=1,rotation:h=0,scale:d=1,color:g,mountX:p,mountY:m}=e;function y(){setTimeout(()=>{t.style.top=`${f-a*m}px`,t.style.left=`${o-l*p}px`,t.style.width=`${l}px`,t.style.height=`${a}px`,t.style.opacity=`${u}`,t.style.rotate=`${h}rad`,t.style.scale=`${d}`,t.style.color=gn(g)},i)}setTimeout(y,n)}}const yn=50,xl={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Enter:"enter"," ":"space",Backspace:"back",Escape:"escape",37:"left",39:"right",38:"up",40:"down",13:"enter",32:"space",8:"back",27:"escape"},Ti={hd:.66666667,"720p":.66666667,720:.66666667,fhd:1,fullhd:1,"1080p":1,1080:1,"4k":2,"2160p":2,2160:2},bl={low:.66666667,medium:.85,high:1,retina:2},Tl=()=>{const r=de.stage;ne.get("fonts",[]).forEach(t=>{t.type==="sdf"||t.type==="msdf"?(!t.png&&t.file&&(t.png=t.file.replace(/\.[^.]+$/,`.${t.type}.png`)),!t.json&&t.file&&(t.json=t.file.replace(/\.[^.]+$/,`.${t.type}.json`)),r.fontManager.addFontFace(new hn(t.type,{fontFamily:t.family,descriptors:{},atlasUrl:t.png,atlasDataUrl:t.json,stage:r,metrics:t.metrics}))):t.type==="web"&&r.fontManager.addFontFace(new xs({fontFamily:t.family,fontUrl:t.file,descriptors:{},metrics:t.metrics}))})},Sl=()=>{const r=de.stage;ne.get("shaders",[]).forEach(t=>{r.shManager.registerShaderType(t.name,t.type)}),ne.get("effects",[]).forEach(t=>{r.shManager.registerShaderType(t.name,t.type)})};let de={};const wl=r=>{const t="renderMode"in r?r.renderMode:"webgl";if(t==="webgl")return qa;if(t==="canvas")return pl},Cl=r=>{const t="renderMode"in r?r.renderMode:"webgl";if(t==="webgl")return[ll,xi];if(t==="canvas")return[xi]},El=r=>{const t={max:200,target:.8,cleanupInterval:5e3,baseline:25,strict:!1,..."gpuMemory"in r?r.gpuMemory:{}};return{criticalThreshold:t.max*1024*1024,targetThresholdLevel:t.target,cleanupInterval:t.cleanupInterval,baselineMemoryAllocation:t.baseline*1024*1024,doNotExceedCriticalThreshold:t.strict}},Rl=(r,t,e={})=>{de=new Na({appWidth:e.w||1920,appHeight:e.h||1080,fpsUpdateInterval:e.fpsInterval||1e3,devicePhysicalPixelRatio:bl[e.renderQuality]||e.renderQuality||1,deviceLogicalPixelRatio:e.pixelRatio||Ti[e.screenResolution]||Ti[window.innerHeight]||1,numImageWorkers:"webWorkersLimit"in e?e.webWorkersLimit:window.navigator.hardwareConcurrency||2,clearColor:e.canvasColor&&nt.normalize(e.canvasColor)||0,inspector:e.inspector===!0?yl:void 0,boundsMargin:e.viewportMargin||0,renderEngine:wl(e),fontEngines:Cl(e),canvas:e.canvas,textureProcessingTimeLimit:e.textureProcessingTimeLimit,textureMemory:El(e),createImageBitmapSupport:"auto",targetFPS:"maxFPS"in e?e.maxFPS:0,...e.advanced||{}},t);const s=()=>{let i=r();i.quit=()=>{j.info("Closing App"),i.destroy(),i=null,de=null}};return Sl(),Tl(),s(),de},_l=(r,t)=>{if(r===void 0)return{start:0,end:0,oppositeStart:0,oppositeEnd:0};if(typeof r=="number")return{start:r,end:r,oppositeStart:r,oppositeEnd:r};if(ge(r)===!0&&(r=ye(r)),typeof r=="object"){const{top:e=void 0,right:s=void 0,bottom:i=void 0,left:n=void 0,x:o=0,y:f=0}=r;return t==="vertical"?{start:e!==void 0?e:f,end:i!==void 0?i:f,oppositeStart:n!==void 0?n:o,oppositeEnd:s!==void 0?s:o}:{start:n!==void 0?n:o,end:s!==void 0?s:o,oppositeStart:e!==void 0?e:f,oppositeEnd:i!==void 0?i:f}}return{start:0,end:0,oppositeStart:0,oppositeEnd:0}},vl=function(r){const t=r.direction==="vertical"?"y":"x",e=r.direction==="vertical"?"x":"y",s=r.direction==="vertical"?"mountX":"mountY",i=r.direction==="vertical"?"height":"width",n=r.direction==="vertical"?"width":"height",o=_l(r.padding,r.direction);let f=o.start;const l=this.node.children,a=l.length,u=this.children;let h=0;const d=r.gap||0;for(let p=0;p<a;p++){if(u[p]!==void 0&&u[p].props.raw.show===!1)continue;const m=l[p];m[t]=f,m[e]=o.oppositeStart,i==="width"?f+=m.width+(m.width!==("text"in m?1:0)?d:0):f+="text"in m?m.width>1?m.height+d:0:m.height!==0?m.height+d:0,h=Math.max(h,m[n]+o.oppositeStart+o.oppositeEnd)}this.node[i]=f-d+o.end,this.node[n]=h;const g={start:0,end:1,center:.5}[r["align-items"]||"start"];if(g!==0)for(let p=0;p<a;p++){const m=l[p];m[e]=h*g,m[s]=g}r["@updated"]!==void 0&&r["@updated"]({w:this.node.width,h:this.node.height},this),this.config.parent&&this.config.parent.props.__layout===!0&&this.config.parent.triggerLayout(this.config.parent.props)},Si=r=>r!==null&&typeof r=="object"&&"transition"in r,ge=r=>typeof r=="string"&&r.startsWith("{")&&r.endsWith("}"),ye=r=>JSON.parse(r.replace(/'/g,'"').replace(/([{,]\s*)([\w-_]+)(\s*:)/g,'$1"$2"$3')),De=function(r,t){return typeof r!="string"?r:r.indexOf("%")===r.length-1?this.element.config.parent&&(this.element.config.parent.node[t]||0)*(parseFloat(r)/100)||0:r},Ts=r=>{if(typeof r!="object"||r===null)return r;if(r.constructor===Object){if("value"in r)return r.value;if("transition"in r)return Ts(r.transition)}return r},Al={top:"colorTop",bottom:"colorBottom",left:"colorLeft",right:"colorRight"};let Ss=null,ws=null;const kl={set parent(r){this.props.parent=r==="root"?de.root:r.node},set rotation(r){this.props.rotation=r*(Math.PI/180)},set w(r){this.props.width=De.call(this,r,"width")},set width(r){this.props.width=De.call(this,r,"width")},set h(r){this.props.height=De.call(this,r,"height")},set height(r){this.props.height=De.call(this,r,"height")},set x(r){this.props.x=De.call(this,r,"width")},set y(r){this.props.y=De.call(this,r,"height")},set z(r){this.props.zIndex=r},set zIndex(r){this.props.zIndex=r},set color(r){typeof r=="string"&&r.startsWith("{")===!1?this.props.color=nt.normalize(r):(typeof r=="object"||ge(r)===!0&&(r=ye(r)))&&(this.props.color=0,Object.entries(r).forEach(t=>{this.props[Al[t[0]]]=nt.normalize(t[1])}))},set src(r){typeof r=="object"||ge(r)===!0&&(r=ye(r))?(this.props.src=r.src,this.props.imageType=r.type):this.props.src=r,this.raw.color===void 0&&(this.props.color=this.props.src?4294967295:0),!("w"in this.raw)&&!("w"in this.raw)&&!("h"in this.raw)&&!("height"in this.raw)&&(this.props.autosize=!0)},set texture(r){this.props.texture=r,this.raw.color===void 0&&r==null?this.props.color=0:this.raw.color===void 0&&(this.props.color=4294967295)},set fit(r){const t={};if(r==="cover"||r==="contain"){this.props.textureOptions={resizeMode:{type:r}};return}(typeof r=="object"||ge(r)===!0&&(r=ye(r)))&&(t.type=r.type||"cover",typeof r.position=="number"&&(t.clipY=t.clipX=r.position),typeof r.position=="object"&&(t.clipX="x"in r.position?r.position.x:null,t.clipY="y"in r.position?r.position.y:null),this.props.textureOptions={resizeMode:t})},set rtt(r){this.props.rtt=r,this.raw.color===void 0&&(this.props.color=r===!0?4294967295:0)},set mount(r){typeof r=="object"||ge(r)===!0&&(r=ye(r))?("x"in r&&(this.props.mountX=r.x),"y"in r&&(this.props.mountY=r.y)):(this.props.mountX=r,this.props.mountY=r)},set pivot(r){typeof r=="object"||ge(r)===!0&&(r=ye(r))?("x"in r&&(this.props.pivotX=r.x),"y"in r&&(this.props.pivotY=r.y)):(this.props.pivotX=r,this.props.pivotY=r)},set scale(r){typeof r=="object"||ge(r)===!0&&(r=ye(r))?("x"in r&&(this.props.scaleX=r.x),"y"in r&&(this.props.scaleY=r.y)):(this.props.scaleX=r,this.props.scaleY=r)},set show(r){r?this.props.alpha=this.raw.alpha!==void 0?this.raw.alpha:1:this.props.alpha=0},set alpha(r){(this.raw.show===void 0||this.raw.show==!0)&&(this.props.alpha=r)},set shader(r){const t=this.element.node!==void 0?this.element.node:this.props;if(r===null){t.shader=null;return}if(typeof r=="object"||ge(r)===!0&&(r=ye(r))){if(t.shader!==void 0&&t.shader.type===r.type){for(const e in r.props)t.shader.props[e]=r.props[e];return}t.shader=de.createShader(r.type,r.props)}},set effects(r){for(let t=0;t<r.length;t++)r[t].props&&r[t].props.color&&(r[t].props.color=nt.normalize(r[t].props.color));this.element.node===void 0&&(this.props.shader=de.createShader("DynamicShader",{effects:r.map(t=>de.createEffect(t.type,t.props))}))},set clipping(r){this.props.clipping=r},set overflow(r){this.props.clipping=!r},set font(r){this.props.fontFamily=r},set size(r){this.props.fontSize=r},set wordwrap(r){j.warn("The wordwrap attribute is deprecated, use maxwidth instead"),this.props.width=r,this.props.contain="width"},set maxwidth(r){this.props.width=r,this.props.contain="width"},set maxheight(r){this.props.height=r,this.props.contain="both"},set contain(r){this.props.contain=r},set maxlines(r){this.props.maxLines=r},set textoverflow(r){this.props.overflowSuffix=r===!1?" ":r===!0?void 0:r},set letterspacing(r){this.props.letterSpacing=r||1},set lineheight(r){this.props.lineHeight=r},set align(r){this.props.textAlign=r},set content(r){this.props.text=""+r},set placement(r){let t,e;typeof r=="object"||ge(r)===!0&&(r=ye(r))?("x"in r&&(t=r.x),"y"in r&&(e=r.y)):r==="center"||r==="right"?t=r:e=r,t==="center"?(this.x="50%",this.props.mountX=.5):t==="right"&&(this.x="100%",this.props.mountX=1),e==="middle"?(this.y="50%",this.props.mountY=.5):e==="bottom"&&(this.y="100%",this.props.mountY=1)},set"inspector-data"(r){ws!==!1&&(typeof r=="object"||ge(r)===!0&&(r=ye(r)))&&(this.props.data=r)}},Ml={populate(r){const t=r;t.node=this.config.node,t[b.isSlot]===!0&&(this[b.isSlot]=!0),this.props.element=this,this.props.parent=t.parent||this.config.parent,delete t.parent,this.props.raw=r;const e=Object.keys(t),s=e.length;for(let i=0;i<s;i++){const n=e[i],o=t[n];o!==void 0&&(this.props[n]=Ts(o))}this.props.props.color===void 0&&!("__textnode"in t)&&(this.props.props.color=0),this.node=t.__textnode?de.createTextNode({...Ss,...this.props.props}):de.createNode(this.props.props),t["@loaded"]!==void 0&&typeof t["@loaded"]=="function"&&this.node.on("loaded",(i,{type:n,dimensions:o})=>{t["@loaded"]({w:o.width,h:o.height,type:n},this)}),t["@error"]!==void 0&&typeof t["@error"]=="function"&&this.node.on("failed",(i,n)=>{t["@error"](n,this)}),t.__layout===!0&&(this.triggerLayout=vl.bind(this)),this.config.parent.props!==void 0&&this.config.parent.props.__layout===!0&&(this.config.parent.triggerLayout(this.config.parent.props),this.node.on("loaded",()=>{this.config.parent.triggerLayout(this.config.parent.props)}))},set(r,t){if(t===void 0||this.props.raw[r]===t)return;this.props.raw[r]=t,this.props.props={},this.props[r]=Ts(t);const e=Object.keys(this.props.props);if(e.length===1){if(Si(t)===!0)return this.animate(e[0],this.props.props[e[0]],t.transition);this.node[e[0]]=this.props.props[e[0]]}else for(let s=0;s<e.length;s++)Si(t)===!0?this.animate(e[s],this.props.props[e[s]],t.transition):this.node[e[s]]=this.props.props[e[s]];this.config.parent.props&&this.config.parent.props.__layout===!0&&this.config.parent.triggerLayout(this.config.parent.props)},animate(r,t,e){if(this.scheduledTransitions[r]!==void 0&&this.scheduledTransitions[r].f.state==="scheduled"&&this.scheduledTransitions[r].f.stop(),this.node[r]===t)return;const s={};s[r]=t;const i=this.node.animate(s,{duration:typeof e=="object"&&"duration"in e?e.duration:300,easing:typeof e=="object"&&"easing"in e?e.easing:"ease",delay:typeof e=="object"&&"delay"in e?e.delay:0}),n=this.node[r];if(this.scheduledTransitions[r]={v:s[r],f:i},e.start!==void 0&&typeof e.start=="function"&&i.once("animating",()=>{e.start.call(this.component,this,r,n)}),this.config.parent.props&&this.config.parent.props.__layout===!0&&i.on("tick",()=>{this.config.parent.triggerLayout(this.config.parent.props)}),e.progress!==void 0&&typeof e.progress=="function"){let o=0;i.on("tick",(f,{progress:l})=>{e.progress.call(this.component,this,r,l,o),o=l})}i.once("stopped",()=>{this.scheduledTransitions[r]!==void 0&&this.scheduledTransitions[r].canceled===!0||(this.node!==void 0&&e.end&&typeof e.end=="function"&&e.end.call(this.component,this,r,this.node[r]),delete this.scheduledTransitions[r])}),i.start()},destroy(){if(this.node===null)return;j.debug("Deleting Node",this.nodeId);const r=Object.keys(this.scheduledTransitions);for(let t=0;t<r.length;t++){const e=this.scheduledTransitions[r[t]];e!==void 0&&(e.canceled=!0,e.f!==void 0&&e.f.stop())}this.scheduledTransitions={},this.component=null,delete this.component,this.config=null,delete this.config,this.props.raw={},this.props.element=null,this.props.props=null,this.props={},delete this.props,this.triggerLayout=null,delete this.triggerLayout,this.forComponent=null,delete this.forComponent,this.node.destroy(),this.node=null},get nodeId(){return this.node&&this.node.id},get ref(){return this.props.ref||null},get parent(){return this.node&&this.node.parent},get children(){const r=this.component[b.getChildren](),t=[],e=r.length;for(let s=0;s<e;s++){const i=r[s];i!==void 0&&i.parent===(this[b.isSlot]?this.node.children[0]:this.node)&&t.push(i)}return t}},Il=(r,t)=>(Ss===null&&(Ss={fontSize:32,fontFamily:ne.get("defaultFont","sans-serif")}),ws===null&&(ws=ne.get("inspector",!1)),Object.assign(Object.create(Ml),{props:Object.assign(Object.create(kl),{props:{}}),scheduledTransitions:{},config:r,component:t})),wi={Element:Il,Launch:Rl},Ll="1.45.2",Pl={"@lightningjs/renderer":"^2.20.2"},xn={version:Ll,dependencies:Pl};let lt={};const Bs={};async function Ol(){let r;try{if(r=await Io(()=>import("./package-CxjZmVa0.js"),[],import.meta.url),r!==void 0)return r.version}catch{return xn.dependencies["@lightningjs/renderer"]}}const Fl=(r,t,e)=>{ne.set(e),ao(),Ol().then(s=>{j.info("Blits Version ",xn.version),j.info("Renderer Version ",s)}),Bs.element=wi.Element,lt=wi.Launch(r,t,e)},Bl={before:{prop:"alpha",value:0},in:{prop:"alpha",value:1,duration:200},out:{prop:"alpha",value:0,duration:100}},Oe=window.speechSynthesis,Ul=/android/i.test((window.navigator||{}).userAgent||""),es=new Map;let bn=!1,kt=null;const kr=()=>{kt&&(clearTimeout(kt),kt=null)},Cs=r=>{if(!r||kt)return kr();Oe.pause(),setTimeout(()=>{Oe.resume()},0),kt=setTimeout(()=>{Cs(r)},5e3)},Ze={lang:"en-US",pitch:1,rate:1,voice:null,volume:1},$l=()=>{const r=Oe.getVoices();Ze.voice=r[0]||null,bn=!0},Nl=r=>{const t=new SpeechSynthesisUtterance(r.message),e=r.id;return t.lang=r.lang||Ze.lang,t.pitch=r.pitch||Ze.pitch,t.rate=r.rate||Ze.rate,t.voice=r.voice||Ze.voice,t.volume=r.volume||Ze.volume,es.set(e,t),Ul===!1&&(t.onstart=()=>{Cs(t)},t.onresume=()=>{Cs(t)}),new Promise((s,i)=>{t.onend=()=>{kr(),es.delete(e),s()},t.onerror=n=>{kr(),es.delete(e),i(n)},Oe.speak(t)})},Us={speak(r){return Oe!==void 0?(bn===!1&&$l(),Nl(r)):(j.error("speechSynthesis web API not available"),Promise.reject({error:"unavailable"}))},cancel(){Oe!==void 0&&(Oe.cancel(),kr())}};let Dt=!1,Dl=0;const Ee=[];let Me=!1,Rt=null,fr=null,Es={};const Tn={then(){},done(){},cancel(){},remove(){},stop(){}},zl=()=>{Dt=!0},Wl=()=>{Dt=!1},Xl=r=>{Dt=!!r},$s=(r,t="off",e={})=>Dt===!1?Tn:Sn(r,t,!1,e),Vl=r=>Dt===!1?Tn:Sn(void 0,void 0,r),Sn=(r,t,e=!1,s={})=>{const i=Dl++;let n;const o=new Promise(f=>{n=f});return o.remove=o.cancel=()=>{const f=Ee.findIndex(l=>l.id===i);f!==-1&&Ee.splice(f,1),j.debug(`Announcer - removed from queue: "${r}" (id: ${i})`),n("canceled")},o.stop=()=>{i===Rt&&(Us.cancel(),Me=!1,n("interupted"))},e===!1?t==="assertive"?Ee.unshift({message:r,resolveFn:n,id:i,options:s}):Ee.push({message:r,resolveFn:n,id:i,options:s}):Ee.push({delay:e,resolveFn:n,id:i}),j.debug(`Announcer - added to queue: "${r}" (id: ${i})`),setTimeout(()=>{br()},100),o},br=async()=>{if(Me===!0||Ee.length===0)return;Me=!0;const{message:r,resolveFn:t,delay:e,id:s,options:i={}}=Ee.shift();Rt=s,e?setTimeout(()=>{Me=!1,Rt=null,t("finished"),br()},e):(fr!==null&&clearTimeout(fr),fr=setTimeout(()=>{j.debug(`Announcer - speaking: "${r}" (id: ${s})`),Us.speak({message:r,id:s,...Es,...i}).then(()=>{j.debug(`Announcer - finished speaking: "${r}" (id: ${s})`),Rt=null,Me=!1,t("finished"),br()}).catch(n=>{Rt=null,Me=!1,j.debug(`Announcer - error ("${n.error}") while speaking: "${r}" (id: ${s})`),t(n.error),br()}),fr=null},200))},Hl=(r,t={})=>$s(r,"polite",t),Gl=(r,t={})=>$s(r,"assertive",t),Yl=()=>{Us.cancel()},jl=()=>{Me=!1,Ee.length=0},Kl=(r={})=>{Es={...Es,...r}},Tr={speak:$s,polite:Hl,assertive:Gl,stop:Yl,enable:zl,disable:Wl,toggle:Xl,clear:jl,pause:Vl,configure:Kl};let ie;const ae=cs({path:"",navigating:!1,data:null,params:null,hash:""},ne.get("reactivityMode"),!0),Re=[];let wn={},Cn={},be=!1,_t,Rs,ze=!1;const En=r=>{r||(r="/");const t=r.replace(/^#/,"").split("?");return{path:t[0],queryParams:new URLSearchParams(t[1]),hash:r}},ts=r=>r.replace(/^\/+|\/+$/g,"").toLowerCase(),Ci=r=>typeof r=="object"&&r!==null,Ei=r=>typeof r=="string",ql=r=>{if(!r)return{};const t={},e=[...r.entries()];for(let s=0;s<e.length;s++)t[e[s][0]]=e[s][1];return t},Rn=({hash:r,path:t,queryParams:e},s=[])=>{const i=t.replace(/^\/+|\/+$/g,""),n=ts(t),o={hash:r,queryParams:ql(e)};let f=!1,l=0;for(;!f&&l<s.length;){const a=s[l],u=ts(a.path);if(ts(u)===n)f=rs(a,o);else if(u.indexOf(":")>-1){const h=[...u.matchAll(/:([^\s/]+)/gi)];let d=u;h.reverse().forEach(p=>{d=d.substring(0,p.index)+"([^\\s/]+)"+d.substring(p.index+p[0].length)}),d="^"+d;const g=i.match(new RegExp(`${d}`,"i"));g&&(o.params=h.reverse().reduce((p,m,y)=>(p[m[1]]=g[y+1],p),{}),f=rs(a,o))}else if(u.endsWith("*")){const h=new RegExp(u.replace(/\/?\*/,"/?([^\\s]*)"),"i"),d=n.match(h);d&&(o.params={},d[1]&&(o.params.path=d[1]),f=rs(a,o))}l++}return f},Ql={inHistory:!0,keepAlive:!1,passFocus:!0,reuseComponent:!1},rs=(r,t)=>({hash:t.hash,path:r.path,component:r.component,transition:"transition"in r?r.transition:Bl,options:{...Ql,...r.options,...wn},announce:r.announce||!1,hooks:r.hooks||{},data:{...r.data,...Cn,...t.queryParams},params:t.params||{},meta:r.meta||{}}),Zl=async function(){Tr.stop(),Tr.clear(),ae.navigating=!0;let r=!1;if(ze===!1&&this.parent[b.routes]){let t=ie,e=Rn(En(document.location.hash),this.parent[b.routes]);if(ie=e,e){const s=ie.path;let i;if(this.parent[b.routerHooks]){const d=this.parent[b.routerHooks];if(d.beforeEach){try{if(i=await d.beforeEach.call(this.parent,e,t),Ei(i)){ie=t,Ie(i);return}}catch(g){if(j.error('Error or Rejected Promise in "BeforeEach" Hook',g),Re.length>0){ze=!0,ie=t,window.history.back(),be=!1,ae.navigating=!1;return}}if(Ci(i)===!0&&i.path!==s){ie=t,Ie(i.path,i.data,i.options);return}if(i===!1&&Re.length>0){ze=!0,ie=t,window.history.back(),be=!1,ae.navigating=!1;return}}}let n;if(e.hooks.before){try{if(n=await e.hooks.before.call(this.parent,e,t),Ei(n)){ie=t,Ie(n);return}}catch(d){if(j.error('Error or Rejected Promise in "Before" Hook',d),Re.length>0){ze=!0,ie=t,window.history.back(),be=!1,ae.navigating=!1;return}}if(Ci(n)===!0&&n.path!==s){ie=t,Ie(n.path,n.data,n.options);return}if(n===!1&&Re.length>0){ze=!0,ie=t,window.history.back(),be=!1,ae.navigating=!1;return}}t!==void 0&&t.options.inHistory===!0&&be===!1&&Re.push(t),typeof e.transition=="function"&&(e.transition=e.transition(t,e));let o,f,l;be===!0&&_t!==void 0&&(f=_t.view,l=_t.focus,_t=null);const a={...this[b.props],...e.params,...e.data};if(t&&e.options.reuseComponent===!0&&e.options.keepAlive!==!0&&e.component===t.component){r=!0,f=this[b.children][this[b.children].length-1];for(const d in a)f[b.props][d]=a[d]}if(e.announce&&(typeof e.announce=="string"&&(e.announce={message:e.announce}),Tr.speak(e.announce.message,e.announce.politeness)),ae.path=e.path,ae.params=e.params||{},ae.hash=e.hash,ae.data=null,ae.data=e.data||{},!f)o=Bs.element({parent:this[b.children][0]}),o.populate({}),o.set("w","100%"),o.set("h","100%"),f=await e.component({props:a},o,this),f[Symbol.toStringTag]==="Module"&&(f.default&&typeof f.default=="function"?f=f.default({props:a},o,this):j.error("Dynamic import doesn't have a default export or default is not a function")),typeof f=="function"&&(f=f({props:a},o,this));else{o=f[b.holder];let d=!1;if(e.transition.before)if(Array.isArray(e.transition.before)){for(let g=0;g<e.transition.before.length;g++)if(e.transition.before[g].prop==="alpha"){d=!0;break}}else e.transition.before.prop==="alpha"&&(d=!0);d===!1&&o.set("alpha",1)}r===!1&&this[b.children].push(f),Rs=Le.get();const u=this[b.children];if(this.activeView=u[u.length-1],e.options.passFocus!==!1&&(l?l.$focus():f.$focus()),e.transition.before)if(Array.isArray(e.transition.before))for(let d=0;d<e.transition.before.length;d++)o.set(e.transition.before[d].prop,e.transition.before[d].value);else o.set(e.transition.before.prop,e.transition.before.value);let h=!1;if(t!==void 0&&r===!1){h=!0;const d=this[b.children].splice(1,1).pop();d&&Jl(t,d,e.transition.out,be)}if(e.transition.in)if(Array.isArray(e.transition.in))for(let d=0;d<e.transition.in.length;d++)d===e.transition.length-1?await ft(o,e.transition.in[d],h):ft(o,e.transition.in[d],h);else await ft(o,e.transition.in,h)}else{j.error(`Route ${e.hash} not found`);const s=this.parent[b.routerHooks];s&&typeof s.error=="function"&&s.error.call(this.parent,`Route ${e.hash} not found`)}}be=!1,ae.navigating=!1,ze=!1},Jl=async(r,t,e,s)=>{if(e)if(Array.isArray(e))for(let i=0;i<e.length;i++)i===e.length-1?await ft(t[b.holder],e[i]):ft(t[b.holder],e[i]);else await ft(t[b.holder],e);if(s===!1&&r.options&&r.options.keepAlive===!0&&r.options.inHistory===!0){const i=Re[Re.length-1];i!==void 0&&(i.view=t,i.focus=Rs)}r.options&&(r.options.keepAlive!==!0||s===!0)&&(t.destroy(),t=null),Rs=null,r=null},ft=(r,t,e=!0)=>new Promise(s=>{if(e===!0){let i=t.end;t.end=(...n)=>{i&&i(n),i=null,s()},r!==void 0?r.set(t.prop,{transition:t}):s()}else r!==void 0&&r.set(t.prop,t.value),s()}),Ie=(r,t={},e={})=>{Cn=t,wn=e,window.location.hash=r},_n=function(){const r=Re.pop();if(r&&ie!==r)return be=!0,_t=r,Ie(r.hash,r.data,r.options),!0;const t=ie&&ie.options.backtrack||!1;if(t===!1)return!1;const e=/(\/:?[\w%\s-]+)$/;let s=ie.path,i=s.split("/").length;if(i<=1)return!1;for(;i--;){if(!e.test(s))return!1;s=s.replace(e,"");const n=Rn(En(s),this.parent[b.routes]);if(n&&t)return Ie(n.path,n.data,n.options),!0}return!1},ss={navigate:Zl,back:_n};let Je=null,he=[],Ri;const Mr=new Map,Le={_hold:!1,set hold(r){this._hold=r},get hold(){return this._hold},get(){return Je},set(r,t){if(clearTimeout(Ri),r===Je)return;if(Je===null&&(he=_s([r])),Je!==null)if(he[he.length-1]===r.parent)he.push(r);else{const s=_s([r]);let i=he.length;for(;i--&&!(s.indexOf(he[i])>-1);)he[i].lifecycle.state="unfocus";he=s}let e=0;for(;e<he.length-1;)he[e].lifecycle.state="focus",e++;Ri=setTimeout(()=>ef(r,t),this.hold===!0?ne.get("holdTimeout",yn):0)},input(r,t){if(ae.navigating===!0)return;const e=Ns(Je,r);if(e===null)return;const s=e[b.inputEvents];let i;s[r]?i=s[r].call(e,t):s.any&&(i=s.any.call(e,t)),i!==void 0&&Mr.set(t.code,i)}},_s=r=>r[0].parent!==void 0?(r.unshift(r[0].parent),_s(r)):r,Ns=(r,t)=>r[b.inputEvents]&&(typeof r[b.inputEvents][t]=="function"||typeof r[b.inputEvents].any=="function")?r:r.parent!==void 0?Ns(r.parent,t):null,ef=(r,t)=>{if(j.info(`
Focus chain:
`,he.map((e,s)=>"	".repeat(s)+"↳ "+e.componentId).join(`
`)),Je=r,r.lifecycle.state="focus",t instanceof KeyboardEvent){const e=new KeyboardEvent("keydown",t);e[b.internalEvent]=!0,document.dispatchEvent(e)}},Ae=new Map,We=new Map;function tf(r){return r&&typeof r=="object"&&r[b.isProxy]===!0}function vn(r){if(r===null||typeof r!="object")return r;const t=tf(r)?Ce(r):r,e=Array.isArray(t)?[]:{};for(const s of Object.keys(t)){const i=t[s];e[s]=i&&typeof i=="object"?vn(i):i}return e}const vt={registerListener(r,t,e,s=0){let i=Ae.get(t);i===void 0&&(i=new Map,Ae.set(t,i));let n=i.get(r);n===void 0&&(n=new Set,i.set(r,n)),n.add({cb:e,priority:s}),We.delete(t)},deregisterListener(r,t){let e=Ae.get(t);e!==void 0&&e.has(r)&&(e.delete(r),Ae.set(t,e),We.delete(t))},executeListeners(r,t,e){e===!1&&(t=vn(t));const s=Ae.get(r);if(s===void 0||s.size===0)return!0;if(We.has(r)===!1){const n=[];for(const[o,f]of s)for(const l of f)n.push({...l,component:o});n.sort((o,f)=>f.priority-o.priority),We.set(r,n)}const i=We.get(r);for(let n=0;n<i.length;n++){const{cb:o,component:f}=i[n];if(o.call(f,t)===!1)return!1}return!0},removeListeners(r){for(const[t,e]of Ae)e.has(r)&&(e.delete(r),We.delete(t),e.size===0&&Ae.delete(t))}};let Mt={};const rf=r=>{r.hooks=r.hooks||{};let t,e,s,i=0,n=null;return r.hooks[b.destroy]=function(){document.removeEventListener("keydown",t),document.removeEventListener("keyup",e)},r.hooks[b.init]=function(){this.$announcer.toggle(ne.get("announcer",!1));const o=ne.get("announcerOptions",null);o&&typeof o=="object"&&this.$announcer.configure(o),Mt={...xl,...ne.get("keymap",{})};const f=ne.get("inputThrottle",0);t=async a=>{const u=performance.now(),h=Mt[a.key]||Mt[a.keyCode]||a.key||a.keyCode,d=n===h;if(n=h,f===0||a[b.internalEvent]===!0||d===!1)return await l.call(this,a,h);u-i<f||(i=u,await l.call(this,a,h))};const l=async function(a,u){this[b.inputEvents]!==void 0&&this[b.inputEvents].intercept!==void 0&&(a=await this[b.inputEvents].intercept.call(this,a),!(a instanceof KeyboardEvent))||(Le.input(u,a),clearTimeout(s),s=setTimeout(()=>{Le.hold=!0},ne.get("holdTimeout",yn)))};e=a=>{const u=Mr.get(a.code);u!==void 0&&typeof u=="function"&&(Mr.delete(a.code),u()),clearTimeout(s),Le.hold=!1},document.addEventListener("keydown",t),document.addEventListener("keyup",e),setTimeout(()=>Le.set(this))},ht("App",r)},sf={focus:{value:function(r){return j.warn("this.focus is deprecated, use this.$focus instead"),this.$focus(r)},writable:!1,enumerable:!0,configurable:!1},$focus:{value:function(r){this.lifecycle.state==="focus"&&(this.lifecycle.state="refocus"),Le.set(this,r)},writable:!1,enumerable:!0,configurable:!1},$input:{value:function(r){if(r==null||!(r instanceof KeyboardEvent))return!1;const t=Mt[r.key]||Mt[r.keyCode]||r.key||r.keyCode,e=Ns(this,t);if(e===null)return!1;const s=e[b.inputEvents]||{};let i;return s[t]?i=s[t].call(e,r):s.any&&(i=s.any.call(e,r)),i!==void 0&&r.code&&Mr.set(r.code,i),!0},writable:!1,enumerable:!0,configurable:!1},unfocus:{value:function(){this[b.state].hasFocus=!1,this.lifecycle.state="unfocus"},writable:!1,enumerable:!0,configurable:!1},destroy:{value:function(){this.eol=!0,this.lifecycle.state="destroy",this.hasFocus===!0&&this.parent.$focus();for(let t in this[b.state])Array.isArray(this[b.state][t])&&(this[b.state][t]=[]);this.$clearTimeouts(),this.$clearIntervals(),vt.removeListeners(this);const r=this[b.rendererEventListeners].length;if(r>0)for(let t=0;t<r;t++){const e=this[b.rendererEventListeners][t];lt.off(e.event,e.cb)}this[b.rendererEventListeners]=null,An(this[b.children]),this[b.children].length=0,js(this[b.effects]),this[b.state]={},this[b.props]={},this[b.computed]=null,this.lifecycle={},this[b.effects].length=0,this.parent=null,this.rootParent=null,this[b.wrapper]=null,this[b.originalState]=null,this[b.slots].length=0,delete this[b.computed],delete this.parent,delete this.rootParent,delete this[b.wrapper],delete this[b.originalState],delete this[b.children],delete this[b.slots],delete this.componentId,delete this[b.id],delete this.ref,delete this[b.state].hasFocus,this[b.holder].destroy(),this[b.holder]=null,delete this[b.holder],this[b.cleanup](),delete this[b.cleanup],delete this[b.effects],j.debug(`Destroyed component ${this.componentId}`)},writable:!1,enumerable:!0,configurable:!1},[b.removeGlobalEffects]:{value:function(r=[]){js(r)},writable:!1,enumerable:!1,configurable:!1},select:{value:function(r){return j.warn("this.select is deprecated, use this.$select instead"),this.$select(r)},writable:!1,enumerable:!0,configurable:!1},$select:{value:function(r){if(this.eol===!0)return;let t=null;return this[b.children].forEach(e=>{Array.isArray(e)?e.forEach(s=>{s.ref===r&&(t=s)}):Object.getPrototypeOf(e)===Object.prototype?Object.keys(e).forEach(s=>{e[s].ref===r&&(t=e[s])}):e.ref===r&&(t=e)}),t},writable:!1,enumerable:!0,configurable:!1},trigger:{value:function(r){return j.warn("this.trigger is deprecated, use this.$trigger instead"),this.$trigger(r)},writable:!1,enumerable:!0,configurable:!1},$trigger:{value:function(r){let t=this[b.originalState];if(r.indexOf(".")>-1){const e=r.split(".");r=e.pop(e);for(let s=0;s<e.length;s++)t=t[e[s]]}at(t,r,!0)},writable:!1,enumerable:!0,configurable:!1},shader:{value:function(r,t){return{type:r,props:t}},writable:!1,enumerable:!0,configurable:!1}},An=function(r){for(let t=0;t<r.length;t++){if(!r[t])return;r[t].destroy&&typeof r[t].destroy=="function"?r[t].destroy():Object.getPrototypeOf(r[t])===Object.prototype&&An(Object.values(r[t])),r[t]=null}r.length=0},nf={$setTimeout:{value:function(r,t,...e){if(this.eol===!0)return;const s=setTimeout(()=>{this.$clearTimeout(s),r.apply(null,e)},t,e);return this[b.timeouts].push(s),s},writable:!1,enumerable:!0,configurable:!1},$clearTimeout:{value:function(r){const t=this[b.timeouts].indexOf(r);t>-1&&(this[b.timeouts].splice(t,1),clearTimeout(r))},writable:!1,enumerable:!0,configurable:!1},$clearTimeouts:{value:function(){for(let r=0;r<this[b.timeouts].length;r++)clearTimeout(this[b.timeouts][r]);this[b.timeouts]=[]},writable:!1,enumerable:!0,configurable:!1},$setInterval:{value:function(r,t,...e){if(this.eol===!0)return;const s=setInterval(()=>r.apply(null,e),t,e);return this[b.intervals].push(s),s},writable:!1,enumerable:!0,configurable:!1},$clearInterval:{value:function(r){const t=this[b.intervals].indexOf(r);t>-1&&(this[b.intervals].splice(t,1),clearInterval(r))},writable:!1,enumerable:!0,configurable:!1},$clearIntervals:{value:function(){for(let r=0;r<this[b.intervals].length;r++)clearInterval(this[b.intervals][r]);this[b.intervals]=[]},writable:!1,enumerable:!0,configurable:!1}},of={$emit:{value:function(r,t,e=!0){if(this.eol!==!0)return vt.executeListeners(r,t,e)},writable:!1,enumerable:!0,configurable:!1},$listen:{value:function(r,t,e=0){this.eol!==!0&&vt.registerListener(this,r,t,e)},writable:!1,enumerable:!0,configurable:!1},$unlisten:{value:function(r){vt.deregisterListener(this,r)},writable:!1,enumerable:!0,configurable:!1},$clearListeners:{value:function(){vt.removeListeners(this)},writable:!1,enumerable:!0,configurable:!1}},af={$router:{value:{to:Ie,back:_n,get currentRoute(){return ie},get routes(){return this[b.routes]},get navigating(){return ae.navigating},state:ae},writable:!1,enumerable:!0,configurable:!1}},lf={$announcer:{value:Tr,writable:!1,enumerable:!0,configurable:!1}},ff={$size:{value:function(r={w:0,h:0}){this[b.holder].set("w",r.w||0),this[b.holder].set("h",r.h||0)},writable:!1,enumerable:!0,configurable:!1},[b.renderer]:{value:()=>lt,writable:!1,enumerable:!0,configurable:!1},[b.getChildren]:{value(){const r=this.rootParent||this.parent;return(this[b.children]||[]).concat(r&&r[b.getChildren]().map(t=>Object.getPrototypeOf(t)===Object.prototype?Object.values(t).map(e=>(e.forComponent=e[Symbol.for("config")]&&e[Symbol.for("config")].parent.component,e)):t).flat().filter(t=>{if(t&&t.component)return t.component&&t.component.componentId===this.componentId||t.forComponent&&t.forComponent.componentId===this.componentId})||[])},writable:!1,enumerable:!0,configurable:!1}},kn={...of,...af,...lf},ke=Object.defineProperties({[b.launched]:!1},{...sf,...nf,...kn,...ff}),uf={cast:r=>r,required:!1},cf=(r,t=[])=>{t.indexOf("ref")===-1&&t.push("ref"),r[b.propKeys]=[];const e=t.length;for(let s=0;s<e;s++){const i={...uf,...typeof t[s]=="object"?t[s]:{key:t[s]}};r[b.propKeys].push(i.key),Object.defineProperty(r,i.key,{get(){const n=i.cast(this[b.props]!==void 0&&i.key in this[b.props]?this[b.props][i.key]:"default"in i?i.default:void 0);return i.required===!0&&n===void 0&&j.warn(`${i.key} is required`),n},set(n){j.warn(`Warning! Avoid mutating props directly (prop "${i.key}" in component "${this.componentId}")`),this[b.props][i.key]=n}})}},hf=(r,t)=>{r[b.methodKeys]=[];for(let e in t)r[b.propKeys]&&r[b.propKeys].indexOf(e)>-1?j.error(`${e} already exists as a prop`):(typeof t[e]!="function"&&j.warn(`${e} is not a function`),r[b.methodKeys].push(e),r[e]=t[e])},df=(r,t=()=>{})=>{Object.defineProperty(r,b.stateKeys,{value:[],enumerable:!1,configurable:!1,writable:!1});const e=Object.keys(t.apply(r)||{});e.indexOf("hasFocus")>-1?j.warn("State `hasFocus` already exists as a built-in Component variable (to indicate whether the component currently has focus). Avoid using your own `hasFocus` key in the Component state"):e.push(["hasFocus"]);const s=e.length;for(let i=0;i<s;i++){const n=e[i];r[b.propKeys]!==void 0&&r[b.propKeys].indexOf(n)>-1&&j.error(`State ${n} already exists as a prop`),r[b.methodKeys]!==void 0&&r[b.methodKeys].indexOf(n)>-1&&j.error(`State ${n} already exists as a method`),r[b.stateKeys].push(n),Object.defineProperty(r,n,{get(){return this[b.state][n]},set(o){this[b.state][n]=o}})}},pf=(r,t)=>{r[b.computedKeys]=[];for(let e in t)r[b.stateKeys]&&r[b.stateKeys].indexOf(e)>-1?j.error(`${e} already exists as a state variable`):r[b.propKeys]&&r[b.propKeys].indexOf(e)>-1?j.error(`${e} already exists as a prop`):r[b.methodKeys]&&r[b.methodKeys].indexOf(e)>-1?j.error(`${e} already exists as a method`):(typeof t[e]!="function"&&j.warn(`${e} is not a function`),r[b.computedKeys].push(e),Object.defineProperty(r,e,{get(){return t[e].apply(this)}}))},mf=(r,t)=>{r[b.inputEvents]=[],Object.keys(t).forEach(e=>{typeof t[e]!="function"&&j.warn(`${t[e]} is not a function`),r[b.inputEvents][e]=t[e]})},gf=(r,t)=>{let e=t;Array.isArray(t)===!1&&(r[b.routerHooks]=t.hooks,e=t.routes),r[b.routes]=[];const s=e.length;for(let i=0;i<s;i++)r[b.routes][i]=e[i],r[b.routes][i].options={inHistory:!0,...e[i].options}},yf=(r,t)=>{r[b.watchKeys]=[],r[b.watchers]={};for(let e in t)typeof t[e]!="function"&&console.warn(`${e} is not a function`),r[b.watchKeys].push(e),r[b.watchers][e]=function(s,i){t[e].call(this,s,i)}};let xf=0;function bf(r,t){r[b.identifier]=++xf,Co(t.hooks,r[b.identifier]),cf(r,t.props),t.methods&&hf(r,t.methods),df(r,t.state),t.computed&&pf(r,t.computed),t.watch&&yf(r,t.watch);const e=t.router!==void 0?t.router:t.routes;return e!==void 0&&gf(r,e),t.input&&mf(r,t.input),r}const Tf=()=>ht("Circle",{code:{render:function(t,e,s,i,n,o,f){const l=[],a=[];return a[0]={},l[0]=this.element({parent:t||"root"},e),a[0].color=e.color,a[0].w=e.size,a[0].h=e.size,a[0].effects=[e.shader("radius",{radius:e.radius})],l[0].populate(a[0]),{elms:l,cleanup:()=>{t=null,e=null,l.length=0,i.length=0,a.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("color",t.color)},function(t,e,s,i,n,o){e[0].set("w",t.size)},function(t,e,s,i,n,o){e[0].set("h",t.size)},function(t,e,s,i,n,o){e[0].set("effects",[t.shader("radius",{radius:t.radius})])}],context:{}},props:[{key:"size",default:40},"color"],computed:{radius(){return this.size/2}}});let is=null;const Sf=()=>ht("RouterView",{code:{render:function(t,e,s,i,n,o,f){const l=[],a=[];return a[0]={},l[0]=this.element({parent:t||"root"},e),a[0].w=t.node.width*(100/100),a[0].height=t.node.height*(100/100),l[0].populate(a[0]),{elms:l,cleanup:()=>{t=null,e=null,l.length=0,i.length=0,a.length=0}}},effects:[],context:{}},state(){return{activeView:null}},hooks:{async ready(){this.parent[b.routerHooks]&&this.parent[b.routerHooks].init&&await this.parent[b.routerHooks].init.apply(this.parent),is=()=>ss.navigate.apply(this),ss.navigate.apply(this),window.addEventListener("hashchange",is)},destroy(){window.removeEventListener("hashchange",is,!1)},focus(){this.activeView&&Le.get()===this&&this.activeView.$focus()}},input:{back(r){ss.back.call(this)===!1&&this.parent.$focus(r)}}}),wf=()=>ht("Sprite",{code:{render:function(t,e,s,i,n,o,f){const l=[],a=[];return a[0]={},l[0]=this.element({parent:t||"root"},e),a[0].w=t.node.width*(100/100),a[0].h=t.node.height*(100/100),a[0].texture=e.texture,a[0].color=e.color,a[0].effects=e.effects,l[0].populate(a[0]),{elms:l,cleanup:()=>{t=null,e=null,l.length=0,i.length=0,a.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("texture",t.texture)},function(t,e,s,i,n,o){e[0].set("color",t.color)}],context:{}},props:["image","map","frame","color","effects"],state(){return{spriteTexture:null,currentSrc:null}},computed:{texture(){if(this.image===void 0||this.image===null)return null;const r=this[b.renderer]();if(r==null||r.createTexture===void 0)return null;(this.spriteTexture===void 0||this.spriteTexture===null||this.currentSrc!==this.image)&&(this.spriteTexture=r.createTexture("ImageTexture",{src:this.image}),this.currentSrc=this.image);let t=null;return this.map!==null&&this.map!==void 0&&this.frame!==null&&this.frame!==void 0&&(this.map.frames!==null&&this.map.frames!==void 0&&this.frame in this.map.frames?t=Object.assign({},this.map.defaults||{},this.map.frames[this.frame]):this.frame in this.map&&(t=this.map[this.frame])),t==null&&typeof this.frame=="object"&&(t=this.frame),t!=null?r.createTexture("SubTexture",{texture:this.spriteTexture,x:t.x,y:t.y,width:t.w,height:t.h}):this.spriteTexture}}}),Cf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAAAbCAYAAADRe+BYAAAAAXNSR0IArs4c6QAAGn9JREFUeF7tXQ1UVdWePxcWFg7ZA0sym5n0Tmk1z4+0YeVU4yo1h1jvPVBo1ETU8QvTdJlhsmKpi0he5jyXX0CKIWkpl3OlME3RGcdJixVEas+nJtq0sMwXN/kIgbxn1m+791n/ezifF0hr7lmrVV3O2Wfv/977//v//h/7uKTQFZJASAIhCYQkEJLADZaAy+j9iqIMkCRpliRJGeSeWkmSClwuV25X9VtRlOGSJI3m7wq6bd5Osqa/6OZSSZJKXC4X+h7UpSgKZABZQCbiKuHt4t+dvri8z5GG3E77rChKtCRJ9TY647ht0aaiKJAx5LCK/4Y5m23jneotiqJgvg84eCaYd6Cf4h/xqgo+ZwUO3h1wK5cx1oIYP/5eJUlSrsvl6tRakGUZbYr9tjQpKanL9lmw4w09F5LAzyUBXTDiih3KAspN76pwuVxjgu2koijYzGibbmg0tzQYoOPt5Zv0xydJ0hiXywWlYfviAAE5UBDSPu9YUep1QFEUvAdKWlyOAYPP26c2BhhM25ivXZo+4lWOxx8EGEHRw6iwdXHjQbu26LMwTlJsNUZusrEeHMuC9kGWZRgSYs/VJiUluZ32MXR/SAK/VAkYgREsdKaAKysr58fFxd0Di23Xrl1ScjKMTUl69913906cODHe6cDNFAVvcyAUHCxNO21rGIVv7969ufHx8djQGatWrZIyMq4bmj6frz4mJuYRSZJsMyQNQJS43e4/19bWThk+fPiA/Px8afhwkDpJKikpKUhJSXHEDujY9MDU7XZLtbWsq1BItvrMWQsAQxozZoxUUQEiYHrZapuzAYCcAOWSnJycv2RmZjZThiRJklMZGDIkyHfWLNgskkRkgXVh+g4N0NUuWLCgYN26dcMHDBiQjPUr5qyoqOjttLS0KVYC0syTui/q6+tX9O7duyU6OnoV2h09+rodEexakGUZG4vNnbiWL18uHT9+HCBsay84Gcv/13s9Hs/osLAwlZW7XK6KxMRES8Pa6/Ue4GuLic7v94+ZMGGC5Qb7OeXcXWMrLS3Nd7lcs+zKKtgxdwAjupnPnDlTNHDgwN9RhlRfXy9FR0dDuUsxMTGYDMuJ1GxooAO0eNWgQYNaX3jhhcfnzp2bhHuWLl0q5eayfWd7AyqKoro2uIJ5jr7vwIEDqqKIi4trqKysfJK7VUxlRl1ebW1tX99yyy3tlCFB+aBtroCklJQUS0Wp90L+Hii5ABYaJBhBtowRjBgxQqqqsiSCdsEISpJZIZcuXVp01113PaPHkKyAQmf8umCE9XXu3Dm2zgCoAFZ+YXGYMiS6HjZt2iSnp6eztYVLZ87gVrPFkCjQX758+d0+ffr8k1gP6Oenn34qDRgwgBkQbrfb8VqQZVnIGCyerYX9+/dLeXl5MERuSoYky7JiU/GoLE+r1A2eh4cEIKG7gD0ez4CwsDCsxwD2qygKmGlFUlKSobtUq7A5sLgnTJhgaPDx91EX+i8CjLpqbHSeXS7XCKN5sbkWDG/TAyNVuSckJHyzZ8+evvxpbNoSRVHgDmMmK1d4toFD0wumOGH9wgruBBip7q2YmBgGkiBCXDGiv6qCnj17tlRQUGBrc5PYgJSZmTk1JyfnAd5/LPTZBESowoTV7igeoSiKUEK1ly5dCo+Njf17vKezYERkAU0etAVHjZPm5uaiqKioxylD4uMNun0DgFbnbNq0aXveeustgB8TixVLpOuTsEPMeYqiKFgXTKkQkLM1ZxTkNPuCrf8rV678qVevXi+QfWGrXdxfXl4e3dbWxmJ933zzzbHz588/OnLkSKmpqUlKT0/Hv9U51CjGDq482hZk1aNHjxEJCQlsU3D2JYxB/MRiXTQG6Pf7TRUzna9uBCPxmg5xM1mW1bVhovxKkpKSdI0MPTAqLi6WvF6voWGt907OWtGFTu2vzipw+nx3jU0wo6+++qpu0aJF/bg+cURC7IxTD4xUK5goRNUipco9JSUFbgks9Bg7L9MBo+EbN24M7wwzIm3S4K+qCKgSIcpphB12xNumSQEqkFElDTYHVgewtmtp42ZqbX/99dfTzp07VzBq1KiIToCRaii4XOrUOhlrh2mk8nv66acr9u/fL+JatpWtk7VBmaLf778QHh5+O2cKtli4jvGB17O+0jkrKCiQYJzYnTMKcnpuQ+pqdWL0cJBQFeybb7557Nq1a4/OmTOHiS0vLw8MKYBpERYlaS1VjbsvNykpiS1MCyWOdc1csMGCUVKSSkDNprvW6/XWCncXUejqM2PHjpXE2PFjdXX10uzsbOYu0Shb39mzZ7MyMjL+BkYt5mTKlCnS4MGDWVunTp0qy8zM/IO2M3oKGyx8yZIlbNvpGTuyLMNFfd0nz69fChh18dgoE+6UXtFbJHpgpDINsulU9DfY7EF3jG7iYNx0ZFA0AQDg6KOK7erVqy2RkZGR/H4nihRgdD14cZ1xCaUGxT/A7/dfue+++27n8R1bCpMDEdoVcRgE1OH2SxaxhyCZEZMBxrpt27ZIEXPhfQdQMjeGQ3BgG7G9vb0pPj4+Cm2KuCFvJ6ikE6M+0PWgcbPZskDpnGNOYDBVVVWNURQFCheGFlMqRL625syAcdF9gTXCKD5Zx7b2hVB2iqL8MHXq1N+gjW3btjERcWWCdQdFyRiO1+udxfsjcateBSuakQcFi+fvvffeD9asWSPiu779+/e/lZeX9wRkAcUPABDX3Llz4Yo1VMx03igz6iowQvsUkI4fPy4tX76csU8Kwh6PZ/uOHTsm0/5ERUVJGzdulPBvXDNmzCjz+XwBgETBCOOMjY1l93JZdfDyeL3e4YqisKSgpqam+qioKGZ43+xg1E1jE8aurT3jRM/gXrtgpFoMBmDEXHhOX86Vst4mDtb1F9AFatVv3br18PTp0/+F32BLsdHGqDIiv1ekpqZuKy4uvq45rrs8bGV9kb75EhMTs3bv3r2OxreCBCM1wG4yFylOUpAVRWHWUEtLy9XIyMhbDdqtgoUezPxrn1EUhY0BivmOO+6Q6uvroZxtuVZFW8gqrKurK+vXrx9cCtqrdv369fnz588XSQG24jt03RNWRfeFyswJGFkaPVTZnT9//sTixYt/iw5v2LDhWN++fR8lilJti7riuLJWvRMiI6+xsVEFtldffbXsgQce+D3a2rdvn1xQUBBAY15//XUGzri6AIwMy0XQPo0ZGSl0Oj64KlNTU/FoCgdaxuBIP1WXPH7Pz88vvfPOO9n4Vq9eLR09ejRgT1Iw8nq9UmJiIhs3/ru4uBhuy4B1TMF93759344bN+4u3K/Xd85KA8oJYPwhlkXjWBp21sHVKsuyuo9RNpGYmGjL9d9dY6P9SUpKYvNL3cUYn6IoyHjNQKID2XCOyhO6CowsN52RoupCZhTwCtruTz/9VBMREYFYDNhIUG5FPTACW5gxY0ZzcXExzCu0i4VsmflG3UU8KwtZXQOqq6svDRs2jJlqQYIR3D0Zp0+fDp88eXKvqqoq9KkkIyNjFjILcTU3N7c9+eSTz1ZWVu62Ag9t7RMSItLT05EEMn7o0KGLNm/eHC+y04LNrqR9oG7L3bt3y4mJiUJpOlpfkK/f738zLCzsXu0YwWRnzpz5fWFhocgMtIxDoQ1togkHHGbUUKMH9zph+FTZbdiwofbgwYPol2/Lli0ro6Oj/8NIUVKWAGXd1NQ0AgpVWPFQnAUFBVCcPlmWsSYZI+T34j9VJU4B4mYAI3ROh3VV8PExNzF3XzKQ0jGEsc9pUhDzlHAlqmbTgVUOGTKEufbAJDB2vofVxAkB7j/88EPF+++/PxquQD0wEnEVkz0VoJg196t/o6wX4zKKfem9h4JRV47NCox4yAPrtkMpEIBq/PjxtrJsf5VgpEnv9Y0cOXLXsWPHhEA6y7ryR48ezZS7UMRz5sw5kZ+fD3eAJRBxxSYsHzAKUF6AiK+xsfHPUVFR/xwsGJEF2oEh0VRpriwt2SwFI7i8kLDiu54hwhYdssfgBsLFs8g6WJZWgKcBI9XVOnDgwK/PnDnzt1yJqC4qq/ZorVVTU9Op+Ph46ciRIw+gr5CBcIOmpqZeKi4uRualbbclBUudfqhxFx4zYrhklZYtlJ3f729IS0vrBSYAJVReXj5bJDUQdqC6/ajS4gxgqSzLeJZZHcJFB9esLMvMWqVsScTRONipacs3AxhRpUpiHj6v17tUuCcJIBkZE2r8lAKWVmE3NzerMSrOdlQmRe997733Prxy5crTemDk9XrB5JmLFvt50aJF2y9cuBDvdruTX3zxRdUVuGrVqvmVlZXrcR/YX0tLy/+Gh4dHYX7nzZt34Z133nm4ra1NgKjv+eefb7p48SL2AC5Lg6w7xob9oQEj1hmPx+MOCwtTMwyPHj0qFRYWFtXX168cMWLE6wsWLEgS7tL09PQV33777XKrvfurAyNt4eeMGTNyCgsLl3FBdEpZ8jbYIqeK+LPPPrv28MMPT7TjqqTunldeeSU9Ozt7I28XGw1WH7P8gmFGZLIZQ+LgiEVcpRO8D4hD6C0UCkaaFGvIkbXb0tJy4tZbb/1HPM8z+CwVsMG71DTv48ePVwwZMkQkSjhqj9aGpaamphYXF2MTMBZEU8YvXLjg79+//7/ZmTPa39OnT//hiy++2JmYmNgDv6N+LTo6+mVaxE3S6k37TpMNvvzyy7+89NJLg/i7mKFA2Y/W5URdWTwFvMrr9SJOOhqxjdTUVJFUBPcWq186ffp0w8svv9yLv0NlC13BjEwUTYAbyspNx2WCPcYMHsKAmK7XnFIhtbe3/xgREbHS7/eXmKVni/5pXVlgW1u2bGmJiIiI1KbSE/biS01NdT333HO/EfE16qaTZRl9ZWtsyZIlQ8+dO4d1xS64AQWA8bGoa4IaFHh3ZGTk3scff/xf8dwnn3wi5+bmCs+ArcSo7hibHTAirBJ6gTEkjFm4QPnatXSH282m040Z8Ww6W6httFi70k2nPTli/fr1GSQ2YNuNZoXg4u/Nzc0Xe/bsyVLfefaaKdtwcFyP2oUDBw6kjh07tthun0zkjEXCLJmSkhIW2Ley3Gl/CRiBAcBCZ24PnSwzR/Ed0V/aTkpKSnVJScnD/G+23GikHRbjunr1al1kZKSIGang2djY+D8a9mnJEHVk2qFAVRSEX7lyBSAXxksMTK1ZCjZW8wvLc/Xq1QEuZvG8SAEXSQ8ffPDBic2bNyP2xO4XLi+iNALm6EaBkdWYz58/v3Px4sXP8vtUQ3LatGn5Dz744CwR5yLtwNNQYBZjoQqbg4/0xhtvnOjfv/9vCQNl7lfBWuvq6vbMnz//GZrsYRDvUuPfnHGneL3eZE2yCbqrrumdO3f+V0REhIhls6EoinJh/PjxIovUtt7qrrFZMSMetxTTwEpfOBtnLJ0YFKoBpDf3pnVGBGwoGKmp38QCtKSQ3Q1G3IpH1guzqD766KOcxx57TDAi/GQrs4koNXFmHn4S7rSAYYhgOwEjU+alc/6c1X5Ehp0tMOLMR6Sf4rimgIJBg7RmS2uFxyCG8yJn9Dcgk4YyEVLbZLrotIOmcvnuu++qY2NjBRBZ9k+nLQZGFy9ebOnXr5/InqTrV5stGhR4kvMUkylLPnLkSOUTTzyBgljTNaepB7JcB7iBx3tU8KTMCjECYYFnZGQ0nD17FgyIyY+mJvM2AuawK8DIRjYdk7PNotdcj8fTtmPHjudJHEKrY5DOnYF4Dyxw4RLie7EiIiIiRdRXUeHqKewJEyaUTZo0iSV4CCtelmXIiDHKDRs27Dl48OAz8+bNa33qqaduwW96YJSVlfV2bGxsXN++ff9Bb0J55iP+pI6FJrCIZwoLCzeXl5f/O/9/256B7hqbAzBS9xItJbCI76miMj2BwSBriJ2fxY/XUV0BTt0dROl3OptOe2bY559/vm7o0KGIB4iAWjDZc1Ds4py3DmfxUQV64sSJ1sGDB7NFqpehqLMwdQ80NcimE4+bjkETz+hwRhplHiTAbkn/deq0VEWmiSn91e1238E765TNqP7911577ciyZctQWIsrmHlTa0K4q5PWhqmB7aampvbbbruN1XTZKaY1QwsKyMOGDfugpqYGadSmblC6WQmT6fAa6u7gykydMw5oLMYAqx4KuaGhoTYtLU0kZwgLX83044ohAIApWHVBzMhIVB3ASK/OyOBhoyxVcTDycIASAFHUGV2+fPnU7NmzH9S2p6eweVwNbUULBsrBCL/5ONBG5+Tk1A4aNIjJloJReXl5VVtbG4ycgFok7bsJGAUADJU/Ya943JGh1B1js+OmI8xI1Q0GYGRKWozOplM3NGdH4vQFlRWtXbv2xMKFC1kaqlPWQSeps2467blptbW1f3S73TNNLCozvRLwN8p8uMWbybOnsOigQNniW7hw4V/Xrl0rFLFpait/geoyoy/sDBihHdpfnt32Co8XqUWVyACMjY2N4m4kS+ZBs8jwzMSJE5s+/PDD2zgQqXU7mZmZp8gpFbaZEW2fH7skArZB1TLQmByy/yZNmoREiL/j71EPevV4PHXJycnCjecIPMWcaU9z52vvJf53U9lSBUSSDTqsTQAqUq9xkWC+Kl+tq+/QoUOH169fD7eP6tKjabgALQDS0aNHWRvaLDAKRvw5duaV3llsBnVGwaR2G+1JgBDWgVWSifBiZGzatCla1A5lZWVVnjx5cpxwKeMlVGETJYokD8iLHWQJGWzatIn1iRfPMta0devW6ttvv52xdgpGpaWlySKlGQkMa9asOYWkGbBnWjOlB0Z6ZxISJuHIGOuOsd0MYIQiR/gyr1ePdbzAFLAAYGk6Qm9tU10ARnaOB1Ff6yJHE1ihEmJQ165dOxQeHi6Cvh0eqaury7/nnntEpl6nEiSohR1MAgP629TUtCcqKup6JV/Hy5eQkPCfe/bsEYFRWy4Aq1O2OyMDCh55eXmVc+fOFS6uzrh+aSZVBym0trYevvvuu4fwGiZHqf4mspjtcrlgSYvEC0OAo66Z77//vm7mzJkCFHXnQwe41Pu0yoy46ALYhCZl2HDpUzAqLS1V60b0UnS7EIwsla5mnIYpz+vWrSvv168fOz6KK/UAo8ZIYXu9XtTKME8IQEowrJUrV1bU1NRgTpHNJxKBAsBIlmVWAI9n09LSahoaGoYKAdsAI5H56vvxxx979ezZM1xk1zU2Nva30lH0790xthsORhggLN+cnJz/XrZsGS0cFN8zAhBdP77bRvqqmUBvZjDicohesWLFl1OmTIlBbIBcBTt27KiZPHnyDELPg1ag/F16p184strBANDfBQsWxCB7jFxLR40aFXP48GFhuVtm09GHy8rKhp09e/bo4sWLaeFrRWVlZVlcXFxaMDKgrKgzRa566ys7O/vtuLi4ySKVm99TVV9fX967d2+kzwvQsGSHtH0NGDGr3e12R+I0d3JmnynIUzZSWlpat337drHHdOOa1OUhMudEcSZ11RHmhC53UPBZWVlTwsLCtglFC5der169cIIGTnRg8jBiRgZFnurxMCRmFAwzsgQjTYzN16NHD7deTIjGpHj8B8NS5WqgsBlg0dgIHmpvbz/57LPPskxRpOhzI4LJSZNNB8Yd3dra2jpx4kThrkebSLfH/SyQr2VGdF5ramq2f/zxx5PFUUh8nh3pk+4Y200BRnwCADqm3zVyemq3CTDRTBRbFrumLUcMyWZsR7zCSg5ssdo9fcEMnPnf6NFGjsCIzBs2iNF3mNj3nRyczye6bPVRvM7IgM5fMPOvJ1ZThiQynqgbx8bcWMnCiQKhcUk7rJqekaYFLno2oxnbo/uMjYWewECKYum6o3KkRw/9bGCEflLlDeA9dOjQsb17947E3wBWra2tq4S7rKGhgdVt8clS58RCYQfokLKysi+LiopEMgKKilfpnKsHEINMmXFOAAdZjAEfYaRg5PF4SkidTu3UqVPDGhsb783Ly/P36dMnDG1xlovCbXHQrehfLXebBtQ1dsfYuhqMPB5PBf+EB3RTQCGw3fiG9rh2xpCsCvocbGzcejODEfonzqjTfvEVckBQ2cqv7UQcnQUj2l8sYEqR2Jdv7Rbo6nRa7wvAGLuQg5NxintpxbwjxmbjZVi7mDP64UIofsigM98JosAs4hqQAVMcNi+q5O0AMFWWWkZH+9PBKOBuLgT5MW7ci7ZGI74i4iN1dXUN8+fPFwqcghFtW2UxP6ebTshz+/btf4qMjGSno5tcvqysrLMnT54ULl81A9FMYWs/FUGAmRkKRjVSvL7LyGhXi6H5kUPo9lKv1ztaABs9oikhIWHz9OnTWSYdZ7oU/E2PCeqOsXU1GPFTNMSHUANq0OyAkc19FbotJIGQBG5GCXAlK8oe6NEzOARUTcQpKir6qqysjH3ChJ/EbwqsNwKM0LGHHnoo9/77739Jm9INpt/Y2Fg+depU1P6JM9ICYtpmChttC8DR1M4wQ8GsYBcyrqqqOvDII48wb0R7ezsKaVf06NGjQJykITLlZs2aJY8bN47FbTWuQFbD5/V6dwmg4myKsWDBDFHUvGTJkphLly7hfhgHjCF119gcpHZbZtNRZrRz5876nTt3IpGGyTcERjej9gj1KSSBLpQAXFjt7e2qgtNruqGh4d20tDRxcoAdlyFthn5awK5OoezfMmak02fqljSSlpk7Wsts6fd5tNmu2uxQo76bufNVhqRx6dO2qIuX9k87H/S4Lz23cHeMjZE14voX80xlpZcBS9k87Sv1hDGDwe7C6cKtEWoqJIGQBG6EBHJzc5+vr69/Iy4ujh1lxK+S6urqquzsbLgzRZ2Mk7gXmrkRYIT3QhGKWiPqirbjhjVT2GhbgISegjUDUvQJCph+dgZuU7jb2AcUSQYyVch6BgB9D3XjqrEjyozInHbX2LoSjCAnjI/FjkLM6EZohNA7QxK4cRKAwlZrrQy64Si78MYNJfTmX5sEQszo1zajofGEJGAtAfHNHVGegSeQ2CD+sW4hdEdIAl0sgRAYdbFAQ82FJBCSQEgCIQk4l0AIjJzLLPRESAIhCYQkEJJAF0vg/wBMng85iZWBHAAAAABJRU5ErkJggg==",Ef=()=>ht("FPScounter",{code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[];let d,g,p,m=!1,y=0,x=[];if(a[0]={},l[0]=this.element({parent:t||"root"},m===!0?p:e),l[0].populate(a[0]),m===!0&&(y-=1),t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},m===!0?p:e),a[1].y=15,a[1].x=20,l[1].populate(a[1]),m===!0&&(y-=1),t=l[1],a[2]={},l[2]=this.element({parent:t||"root"},m===!0?p:e),l[2].populate(a[2]),m===!0&&(y-=1),x[3]=s.components&&s.components.Sprite||i.Sprite,t=l[2],a[3]={},l[3]=this.element({parent:t||"root"},m===!0?p:e),a[3].image=e.image,a[3].w=43,a[3].h=25,a[3].map=e.sprite,a[3].frame="fps",h[3]=[],typeof x[3]<"u")for(let T in x[3][Symbol.for("config")].props)delete a[3][x[3][Symbol.for("config")].props[T]],h[3].push(x[3][Symbol.for("config")].props[T]);if(l[3].populate(a[3]),m===!0&&(y-=1),t=l[3],u[4]={},u[4].image=e.image,u[4].w=43,u[4].h=25,u[4].map=e.sprite,u[4].frame="fps",d=u[4].is||"Sprite",i[4],typeof d=="string"){if(i[4]=s.components&&s.components[d]||i[d],!i[4])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[4]=d);if(l[4]=i[4].call(null,{props:u[4]},l[3],e),l[4][Symbol.for("slots")][0]?(t=l[4][Symbol.for("slots")][0],p=l[4],m=!0):t=l[4][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[2],a[5]={},l[5]=this.element({parent:t||"root"},m===!0?p:e),a[5].x=58,a[5].y=2,l[5].populate(a[5]),m===!0&&(y-=1),x[6]=s.components&&s.components.Sprite||i.Sprite,t=l[5],a[6]={},l[6]=this.element({parent:t||"root"},m===!0?p:e),a[6].image=e.image,a[6].x=0,a[6].h=20,a[6].w=20,a[6].map=e.sprite,a[6].frame=e.fps[0],h[6]=[],typeof x[6]<"u")for(let T in x[6][Symbol.for("config")].props)delete a[6][x[6][Symbol.for("config")].props[T]],h[6].push(x[6][Symbol.for("config")].props[T]);if(l[6].populate(a[6]),m===!0&&(y-=1),t=l[6],u[7]={},u[7].image=e.image,u[7].x=0,u[7].h=20,u[7].w=20,u[7].map=e.sprite,g=e.fps[0],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[7].frame=g,d=u[7].is||"Sprite",i[7],typeof d=="string"){if(i[7]=s.components&&s.components[d]||i[d],!i[7])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[7]=d);if(l[7]=i[7].call(null,{props:u[7]},l[6],e),l[7][Symbol.for("slots")][0]?(t=l[7][Symbol.for("slots")][0],p=l[7],m=!0):t=l[7][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[8]=s.components&&s.components.Sprite||i.Sprite,t=l[5],a[8]={},l[8]=this.element({parent:t||"root"},m===!0?p:e),a[8].image=e.image,a[8].x=18,a[8].h=20,a[8].w=20,a[8].map=e.sprite,a[8].frame=e.fps[1],h[8]=[],typeof x[8]<"u")for(let T in x[8][Symbol.for("config")].props)delete a[8][x[8][Symbol.for("config")].props[T]],h[8].push(x[8][Symbol.for("config")].props[T]);if(l[8].populate(a[8]),m===!0&&(y-=1),t=l[8],u[9]={},u[9].image=e.image,u[9].x=18,u[9].h=20,u[9].w=20,u[9].map=e.sprite,g=e.fps[1],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[9].frame=g,d=u[9].is||"Sprite",i[9],typeof d=="string"){if(i[9]=s.components&&s.components[d]||i[d],!i[9])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[9]=d);if(l[9]=i[9].call(null,{props:u[9]},l[8],e),l[9][Symbol.for("slots")][0]?(t=l[9][Symbol.for("slots")][0],p=l[9],m=!0):t=l[9][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[10]=s.components&&s.components.Sprite||i.Sprite,t=l[5],a[10]={},l[10]=this.element({parent:t||"root"},m===!0?p:e),a[10].image=e.image,a[10].x=36,a[10].h=20,a[10].w=20,a[10].map=e.sprite,a[10].frame=e.fps[2],h[10]=[],typeof x[10]<"u")for(let T in x[10][Symbol.for("config")].props)delete a[10][x[10][Symbol.for("config")].props[T]],h[10].push(x[10][Symbol.for("config")].props[T]);if(l[10].populate(a[10]),m===!0&&(y-=1),t=l[10],u[11]={},u[11].image=e.image,u[11].x=36,u[11].h=20,u[11].w=20,u[11].map=e.sprite,g=e.fps[2],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[11].frame=g,d=u[11].is||"Sprite",i[11],typeof d=="string"){if(i[11]=s.components&&s.components[d]||i[d],!i[11])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[11]=d);if(l[11]=i[11].call(null,{props:u[11]},l[10],e),l[11][Symbol.for("slots")][0]?(t=l[11][Symbol.for("slots")][0],p=l[11],m=!0):t=l[11][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[1],a[12]={},l[12]=this.element({parent:t||"root"},m===!0?p:e),a[12].x=150,l[12].populate(a[12]),m===!0&&(y-=1),x[13]=s.components&&s.components.Sprite||i.Sprite,t=l[12],a[13]={},l[13]=this.element({parent:t||"root"},m===!0?p:e),a[13].image=e.image,a[13].y=2,a[13].w=48,a[13].h=25,a[13].map=e.sprite,a[13].frame="avg",h[13]=[],typeof x[13]<"u")for(let T in x[13][Symbol.for("config")].props)delete a[13][x[13][Symbol.for("config")].props[T]],h[13].push(x[13][Symbol.for("config")].props[T]);if(l[13].populate(a[13]),m===!0&&(y-=1),t=l[13],u[14]={},u[14].image=e.image,u[14].y=2,u[14].w=48,u[14].h=25,u[14].map=e.sprite,u[14].frame="avg",d=u[14].is||"Sprite",i[14],typeof d=="string"){if(i[14]=s.components&&s.components[d]||i[d],!i[14])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[14]=d);if(l[14]=i[14].call(null,{props:u[14]},l[13],e),l[14][Symbol.for("slots")][0]?(t=l[14][Symbol.for("slots")][0],p=l[14],m=!0):t=l[14][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[12],a[15]={},l[15]=this.element({parent:t||"root"},m===!0?p:e),a[15].x=63,a[15].y=2,l[15].populate(a[15]),m===!0&&(y-=1),x[16]=s.components&&s.components.Sprite||i.Sprite,t=l[15],a[16]={},l[16]=this.element({parent:t||"root"},m===!0?p:e),a[16].image=e.image,a[16].x=0,a[16].h=20,a[16].w=20,a[16].map=e.sprite,a[16].frame=e.avgFps[0],h[16]=[],typeof x[16]<"u")for(let T in x[16][Symbol.for("config")].props)delete a[16][x[16][Symbol.for("config")].props[T]],h[16].push(x[16][Symbol.for("config")].props[T]);if(l[16].populate(a[16]),m===!0&&(y-=1),t=l[16],u[17]={},u[17].image=e.image,u[17].x=0,u[17].h=20,u[17].w=20,u[17].map=e.sprite,g=e.avgFps[0],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[17].frame=g,d=u[17].is||"Sprite",i[17],typeof d=="string"){if(i[17]=s.components&&s.components[d]||i[d],!i[17])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[17]=d);if(l[17]=i[17].call(null,{props:u[17]},l[16],e),l[17][Symbol.for("slots")][0]?(t=l[17][Symbol.for("slots")][0],p=l[17],m=!0):t=l[17][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[18]=s.components&&s.components.Sprite||i.Sprite,t=l[15],a[18]={},l[18]=this.element({parent:t||"root"},m===!0?p:e),a[18].image=e.image,a[18].x=18,a[18].h=20,a[18].w=20,a[18].map=e.sprite,a[18].frame=e.avgFps[1],h[18]=[],typeof x[18]<"u")for(let T in x[18][Symbol.for("config")].props)delete a[18][x[18][Symbol.for("config")].props[T]],h[18].push(x[18][Symbol.for("config")].props[T]);if(l[18].populate(a[18]),m===!0&&(y-=1),t=l[18],u[19]={},u[19].image=e.image,u[19].x=18,u[19].h=20,u[19].w=20,u[19].map=e.sprite,g=e.avgFps[1],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[19].frame=g,d=u[19].is||"Sprite",i[19],typeof d=="string"){if(i[19]=s.components&&s.components[d]||i[d],!i[19])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[19]=d);if(l[19]=i[19].call(null,{props:u[19]},l[18],e),l[19][Symbol.for("slots")][0]?(t=l[19][Symbol.for("slots")][0],p=l[19],m=!0):t=l[19][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[20]=s.components&&s.components.Sprite||i.Sprite,t=l[15],a[20]={},l[20]=this.element({parent:t||"root"},m===!0?p:e),a[20].image=e.image,a[20].x=36,a[20].h=20,a[20].w=20,a[20].map=e.sprite,a[20].frame=e.avgFps[2],h[20]=[],typeof x[20]<"u")for(let T in x[20][Symbol.for("config")].props)delete a[20][x[20][Symbol.for("config")].props[T]],h[20].push(x[20][Symbol.for("config")].props[T]);if(l[20].populate(a[20]),m===!0&&(y-=1),t=l[20],u[21]={},u[21].image=e.image,u[21].x=36,u[21].h=20,u[21].w=20,u[21].map=e.sprite,g=e.avgFps[2],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[21].frame=g,d=u[21].is||"Sprite",i[21],typeof d=="string"){if(i[21]=s.components&&s.components[d]||i[d],!i[21])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[21]=d);if(l[21]=i[21].call(null,{props:u[21]},l[20],e),l[21][Symbol.for("slots")][0]?(t=l[21][Symbol.for("slots")][0],p=l[21],m=!0):t=l[21][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[1],a[22]={},l[22]=this.element({parent:t||"root"},m===!0?p:e),a[22].x=0,a[22].y=40,l[22].populate(a[22]),m===!0&&(y-=1),x[23]=s.components&&s.components.Sprite||i.Sprite,t=l[22],a[23]={},l[23]=this.element({parent:t||"root"},m===!0?p:e),a[23].image=e.image,a[23].x="-2",a[23].w=47,a[23].h=25,a[23].map=e.sprite,a[23].frame="min",h[23]=[],typeof x[23]<"u")for(let T in x[23][Symbol.for("config")].props)delete a[23][x[23][Symbol.for("config")].props[T]],h[23].push(x[23][Symbol.for("config")].props[T]);if(l[23].populate(a[23]),m===!0&&(y-=1),t=l[23],u[24]={},u[24].image=e.image,u[24].x="-2",u[24].w=47,u[24].h=25,u[24].map=e.sprite,u[24].frame="min",d=u[24].is||"Sprite",i[24],typeof d=="string"){if(i[24]=s.components&&s.components[d]||i[d],!i[24])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[24]=d);if(l[24]=i[24].call(null,{props:u[24]},l[23],e),l[24][Symbol.for("slots")][0]?(t=l[24][Symbol.for("slots")][0],p=l[24],m=!0):t=l[24][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[22],a[25]={},l[25]=this.element({parent:t||"root"},m===!0?p:e),a[25].x=58,a[25].y=2,l[25].populate(a[25]),m===!0&&(y-=1),x[26]=s.components&&s.components.Sprite||i.Sprite,t=l[25],a[26]={},l[26]=this.element({parent:t||"root"},m===!0?p:e),a[26].image=e.image,a[26].x=0,a[26].h=20,a[26].w=20,a[26].map=e.sprite,a[26].frame=e.minFps[0],h[26]=[],typeof x[26]<"u")for(let T in x[26][Symbol.for("config")].props)delete a[26][x[26][Symbol.for("config")].props[T]],h[26].push(x[26][Symbol.for("config")].props[T]);if(l[26].populate(a[26]),m===!0&&(y-=1),t=l[26],u[27]={},u[27].image=e.image,u[27].x=0,u[27].h=20,u[27].w=20,u[27].map=e.sprite,g=e.minFps[0],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[27].frame=g,d=u[27].is||"Sprite",i[27],typeof d=="string"){if(i[27]=s.components&&s.components[d]||i[d],!i[27])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[27]=d);if(l[27]=i[27].call(null,{props:u[27]},l[26],e),l[27][Symbol.for("slots")][0]?(t=l[27][Symbol.for("slots")][0],p=l[27],m=!0):t=l[27][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[28]=s.components&&s.components.Sprite||i.Sprite,t=l[25],a[28]={},l[28]=this.element({parent:t||"root"},m===!0?p:e),a[28].image=e.image,a[28].x=18,a[28].h=20,a[28].w=20,a[28].map=e.sprite,a[28].frame=e.minFps[1],h[28]=[],typeof x[28]<"u")for(let T in x[28][Symbol.for("config")].props)delete a[28][x[28][Symbol.for("config")].props[T]],h[28].push(x[28][Symbol.for("config")].props[T]);if(l[28].populate(a[28]),m===!0&&(y-=1),t=l[28],u[29]={},u[29].image=e.image,u[29].x=18,u[29].h=20,u[29].w=20,u[29].map=e.sprite,g=e.minFps[1],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[29].frame=g,d=u[29].is||"Sprite",i[29],typeof d=="string"){if(i[29]=s.components&&s.components[d]||i[d],!i[29])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[29]=d);if(l[29]=i[29].call(null,{props:u[29]},l[28],e),l[29][Symbol.for("slots")][0]?(t=l[29][Symbol.for("slots")][0],p=l[29],m=!0):t=l[29][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[30]=s.components&&s.components.Sprite||i.Sprite,t=l[25],a[30]={},l[30]=this.element({parent:t||"root"},m===!0?p:e),a[30].image=e.image,a[30].x=36,a[30].h=20,a[30].w=20,a[30].map=e.sprite,a[30].frame=e.minFps[2],h[30]=[],typeof x[30]<"u")for(let T in x[30][Symbol.for("config")].props)delete a[30][x[30][Symbol.for("config")].props[T]],h[30].push(x[30][Symbol.for("config")].props[T]);if(l[30].populate(a[30]),m===!0&&(y-=1),t=l[30],u[31]={},u[31].image=e.image,u[31].x=36,u[31].h=20,u[31].w=20,u[31].map=e.sprite,g=e.minFps[2],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[31].frame=g,d=u[31].is||"Sprite",i[31],typeof d=="string"){if(i[31]=s.components&&s.components[d]||i[d],!i[31])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[31]=d);if(l[31]=i[31].call(null,{props:u[31]},l[30],e),l[31][Symbol.for("slots")][0]?(t=l[31][Symbol.for("slots")][0],p=l[31],m=!0):t=l[31][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[1],a[32]={},l[32]=this.element({parent:t||"root"},m===!0?p:e),a[32].x=150,a[32].y=40,l[32].populate(a[32]),m===!0&&(y-=1),x[33]=s.components&&s.components.Sprite||i.Sprite,t=l[32],a[33]={},l[33]=this.element({parent:t||"root"},m===!0?p:e),a[33].image=e.image,a[33].w=53,a[33].h=25,a[33].map=e.sprite,a[33].frame="max",h[33]=[],typeof x[33]<"u")for(let T in x[33][Symbol.for("config")].props)delete a[33][x[33][Symbol.for("config")].props[T]],h[33].push(x[33][Symbol.for("config")].props[T]);if(l[33].populate(a[33]),m===!0&&(y-=1),t=l[33],u[34]={},u[34].image=e.image,u[34].w=53,u[34].h=25,u[34].map=e.sprite,u[34].frame="max",d=u[34].is||"Sprite",i[34],typeof d=="string"){if(i[34]=s.components&&s.components[d]||i[d],!i[34])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[34]=d);if(l[34]=i[34].call(null,{props:u[34]},l[33],e),l[34][Symbol.for("slots")][0]?(t=l[34][Symbol.for("slots")][0],p=l[34],m=!0):t=l[34][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[32],a[35]={},l[35]=this.element({parent:t||"root"},m===!0?p:e),a[35].x=63,a[35].y=2,l[35].populate(a[35]),m===!0&&(y-=1),x[36]=s.components&&s.components.Sprite||i.Sprite,t=l[35],a[36]={},l[36]=this.element({parent:t||"root"},m===!0?p:e),a[36].image=e.image,a[36].x=0,a[36].h=20,a[36].w=20,a[36].map=e.sprite,a[36].frame=e.maxFps[0],h[36]=[],typeof x[36]<"u")for(let T in x[36][Symbol.for("config")].props)delete a[36][x[36][Symbol.for("config")].props[T]],h[36].push(x[36][Symbol.for("config")].props[T]);if(l[36].populate(a[36]),m===!0&&(y-=1),t=l[36],u[37]={},u[37].image=e.image,u[37].x=0,u[37].h=20,u[37].w=20,u[37].map=e.sprite,g=e.maxFps[0],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[37].frame=g,d=u[37].is||"Sprite",i[37],typeof d=="string"){if(i[37]=s.components&&s.components[d]||i[d],!i[37])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[37]=d);if(l[37]=i[37].call(null,{props:u[37]},l[36],e),l[37][Symbol.for("slots")][0]?(t=l[37][Symbol.for("slots")][0],p=l[37],m=!0):t=l[37][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[38]=s.components&&s.components.Sprite||i.Sprite,t=l[35],a[38]={},l[38]=this.element({parent:t||"root"},m===!0?p:e),a[38].image=e.image,a[38].x=18,a[38].h=20,a[38].w=20,a[38].map=e.sprite,a[38].frame=e.maxFps[1],h[38]=[],typeof x[38]<"u")for(let T in x[38][Symbol.for("config")].props)delete a[38][x[38][Symbol.for("config")].props[T]],h[38].push(x[38][Symbol.for("config")].props[T]);if(l[38].populate(a[38]),m===!0&&(y-=1),t=l[38],u[39]={},u[39].image=e.image,u[39].x=18,u[39].h=20,u[39].w=20,u[39].map=e.sprite,g=e.maxFps[1],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[39].frame=g,d=u[39].is||"Sprite",i[39],typeof d=="string"){if(i[39]=s.components&&s.components[d]||i[d],!i[39])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[39]=d);if(l[39]=i[39].call(null,{props:u[39]},l[38],e),l[39][Symbol.for("slots")][0]?(t=l[39][Symbol.for("slots")][0],p=l[39],m=!0):t=l[39][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),x[40]=s.components&&s.components.Sprite||i.Sprite,t=l[35],a[40]={},l[40]=this.element({parent:t||"root"},m===!0?p:e),a[40].image=e.image,a[40].x=36,a[40].h=20,a[40].w=20,a[40].map=e.sprite,a[40].frame=e.maxFps[2],h[40]=[],typeof x[40]<"u")for(let T in x[40][Symbol.for("config")].props)delete a[40][x[40][Symbol.for("config")].props[T]],h[40].push(x[40][Symbol.for("config")].props[T]);if(l[40].populate(a[40]),m===!0&&(y-=1),t=l[40],u[41]={},u[41].image=e.image,u[41].x=36,u[41].h=20,u[41].w=20,u[41].map=e.sprite,g=e.maxFps[2],Array.isArray(g)===!0&&(g=o(g).slice(0)),u[41].frame=g,d=u[41].is||"Sprite",i[41],typeof d=="string"){if(i[41]=s.components&&s.components[d]||i[d],!i[41])throw new Error('Component "Sprite" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[41]=d);return l[41]=i[41].call(null,{props:u[41]},l[40],e),l[41][Symbol.for("slots")][0]?(t=l[41][Symbol.for("slots")][0],p=l[41],m=!0):t=l[41][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),{elms:l,cleanup:()=>{g=null,p=null,t=null,x[3]=null,u[4]=null,i[4]=null,x[6]=null,u[7]=null,i[7]=null,x[8]=null,u[9]=null,i[9]=null,x[10]=null,u[11]=null,i[11]=null,x[13]=null,u[14]=null,i[14]=null,x[16]=null,u[17]=null,i[17]=null,x[18]=null,u[19]=null,i[19]=null,x[20]=null,u[21]=null,i[21]=null,x[23]=null,u[24]=null,i[24]=null,x[26]=null,u[27]=null,i[27]=null,x[28]=null,u[29]=null,i[29]=null,x[30]=null,u[31]=null,i[31]=null,x[33]=null,u[34]=null,i[34]=null,x[36]=null,u[37]=null,i[37]=null,x[38]=null,u[39]=null,i[39]=null,x[40]=null,u[41]=null,i[41]=null,e=null,x.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0}}},effects:[function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[6]>"u"||skips[6].indexOf("frame")===-1)&&e[6].set("frame",t.fps[0])},function(t,e,s,i,n,o){e[7][Symbol.for("props")].frame=t.fps[0]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[8]>"u"||skips[8].indexOf("frame")===-1)&&e[8].set("frame",t.fps[1])},function(t,e,s,i,n,o){e[9][Symbol.for("props")].frame=t.fps[1]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[10]>"u"||skips[10].indexOf("frame")===-1)&&e[10].set("frame",t.fps[2])},function(t,e,s,i,n,o){e[11][Symbol.for("props")].frame=t.fps[2]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[16]>"u"||skips[16].indexOf("frame")===-1)&&e[16].set("frame",t.avgFps[0])},function(t,e,s,i,n,o){e[17][Symbol.for("props")].frame=t.avgFps[0]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[18]>"u"||skips[18].indexOf("frame")===-1)&&e[18].set("frame",t.avgFps[1])},function(t,e,s,i,n,o){e[19][Symbol.for("props")].frame=t.avgFps[1]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[20]>"u"||skips[20].indexOf("frame")===-1)&&e[20].set("frame",t.avgFps[2])},function(t,e,s,i,n,o){e[21][Symbol.for("props")].frame=t.avgFps[2]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[26]>"u"||skips[26].indexOf("frame")===-1)&&e[26].set("frame",t.minFps[0])},function(t,e,s,i,n,o){e[27][Symbol.for("props")].frame=t.minFps[0]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[28]>"u"||skips[28].indexOf("frame")===-1)&&e[28].set("frame",t.minFps[1])},function(t,e,s,i,n,o){e[29][Symbol.for("props")].frame=t.minFps[1]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[30]>"u"||skips[30].indexOf("frame")===-1)&&e[30].set("frame",t.minFps[2])},function(t,e,s,i,n,o){e[31][Symbol.for("props")].frame=t.minFps[2]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[36]>"u"||skips[36].indexOf("frame")===-1)&&e[36].set("frame",t.maxFps[0])},function(t,e,s,i,n,o){e[37][Symbol.for("props")].frame=t.maxFps[0]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[38]>"u"||skips[38].indexOf("frame")===-1)&&e[38].set("frame",t.maxFps[1])},function(t,e,s,i,n,o){e[39][Symbol.for("props")].frame=t.maxFps[1]},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[40]>"u"||skips[40].indexOf("frame")===-1)&&e[40].set("frame",t.maxFps[2])},function(t,e,s,i,n,o){e[41][Symbol.for("props")].frame=t.maxFps[2]}],context:{}},state(){return{image:Cf,sprite:{defaults:{y:1,w:20,h:20},frames:{"-":{x:-1e3},0:{x:1},1:{x:23},2:{x:45},3:{x:67},4:{x:89},5:{x:111},6:{x:133},7:{x:155},8:{x:177},9:{x:199},avg:{x:221,w:48,h:25},fps:{x:271,w:43,h:25},max:{x:316,w:53,h:25},min:{x:371,w:47,h:25}}},fps:"---",avgFps:"---",minFps:"---",maxFps:"---"}},hooks:{ready(){}}}),Rf=()=>({Circle:Tf(),RouterView:Sf(),Sprite:wf(),FPScounter:Ef()}),_f={name:"log",plugin(){return Hi("App")}},vs={log:_f},Mn=(r,t="",e={})=>{let s;if(typeof t=="object"?e=t:s=t,typeof r=="function"){if(s===void 0||s==="")throw Error("Error registering plugin: name is required for plugin");vs[s]={plugin:r,options:e}}else r.plugin&&Mn(r.plugin,s||r.name,e)};let ns;const _i=r=>{throw new Error(`Parameter ${r} is required`)},ht=(r=_i("name"),t=_i("config"))=>{let e;const s=function(n,o,f,l){this.componentId=To(r),this[b.effects]=[],this.lifecycle=Object.assign(Object.create(Ao),{component:this,previous:null,current:null}),this.parent=f,this.rootParent=l,this[b.holder]=o,this[b.id]=So(),this[b.props]=cs(n.props||{},ne.get("reactivityMode")),this[b.timeouts]=[],this[b.intervals]=[],this[b.originalState]=t.state&&typeof t.state=="function"&&t.state.apply(this)||{},this[b.originalState].hasFocus=!1,this[b.state]=cs(this[b.originalState],ne.get("reactivityMode")),this.lifecycle.state="init";const{elms:a,cleanup:u}=t.code.render.apply(Bs,[o,this,t,ns,Zt,Ce,j])||{elms:[],cleanup:()=>{}};this[b.children]=a,this[b.cleanup]=u,this[b.wrapper]=this[b.children][0],this[b.slots]=this[b.children].filter(d=>d[b.isSlot]),this[b.rendererEventListeners]=[],t.hooks&&(setTimeout(()=>{if(t.hooks.frameTick){const d=(g,p)=>cr("frameTick",this[b.identifier],this,[p]);this[b.rendererEventListeners].push({event:"frameTick",cb:d}),lt.on("frameTick",d)}if(t.hooks.idle){const d=()=>{cr("idle",this[b.identifier],this)};this[b.rendererEventListeners].push({event:"idle",cb:d}),lt.on("idle",d)}if(t.hooks.fpsUpdate){const d=(g,p)=>{cr("fpsUpdate",this[b.identifier],this,[p.fps])};this[b.rendererEventListeners].push({event:"fpsUpdate",cb:d}),lt.on("fpsUpdate",d)}}),t.hooks.attach&&this[b.wrapper].node.on("inBounds",()=>{this.lifecycle.state="attach"}),t.hooks.detach&&this[b.wrapper].node.on("outOfBounds",(d,{previous:g})=>{g>0&&(this.lifecycle.state="detach")}),t.hooks.enter&&this[b.wrapper].node.on("inViewport",()=>{this.lifecycle.state="enter"}),t.hooks.exit&&this[b.wrapper].node.on("outOfBounds",()=>{this.lifecycle.state="exit"}));const h=t.code.effects;for(let d=0;d<h.length;d++){const g=()=>{h[d](this,this[b.children],t,ns,l,Zt)};this[b.effects].push(g),Zt(g)}if(this[b.watchers]){const d=Object.keys(this[b.watchers]),g=d.length;for(let p=0;p<g;p++){let m=this,y=d[p];const x=y;if(y.indexOf(".")>-1){const M=y.split(".");y=M.pop();for(let O=0;O<M.length;O++)m=m[M[O]]}let T=this[y];const E=(M=!1)=>{const O=m[y];(T!==O||M===!0)&&(this[b.watchers][x].apply(this,[O,T]),T=O)};this[b.effects].push(E),Zt(E)}}return setTimeout(()=>this.lifecycle.state="ready"),this},i=(n={},o,f,l)=>{if(ke[b.launched]===!1){const a=Object.keys(vs),u=a.length,h={};for(let d=0;d<u;d++){const g=a[d],p=`$${g}`;p in ke&&j.warn(`"${g}" (this.${p}) already exists as a property or plugin on the Base Component. You may be overwriting built-in functionality. Proceed with care!`);const m=vs[g];h[p]={value:Object.defineProperties(m.plugin(m.options),kn),writable:!1,enumerable:!0,configurable:!0}}Object.defineProperties(ke,h);for(const d in h)Object.defineProperties(ke[d],h),delete ke[d][d];ns=Rf(),ke[b.launched]=!0}return e===void 0&&(j.debug(`Setting up ${r} component`),e=bf(Object.create(ke),t)),t.code===void 0&&(j.debug(`Generating code for ${r} component`),t.code=ho.call(t,co(t.template))),s.call(Object.create(e),n,o,f,l)};return i[Symbol.for("config")]=t,i[b.isComponent]=!0,i},ce={Component:ht,Application:rf,Launch:Fl,Plugin:Mn},vf="c1e672f11dd715c09878f04137c94ba1",Af="https://image.tmdb.org/t/p";function Ir(r,t="w1280"){return`${Af}/${t}${r}?api_key=${vf}`}const kf=ce.Component("FocusBorder",{code:{render:function(t,e,s,i,n,o,f){const l=[],a=[];return a[0]={},l[0]=this.element({parent:t||"root"},e),a[0].y=e.calc,a[0].x=e.calc,a[0].w=e.width,a[0].h=e.height,a[0].effects=[{type:"radius",props:{radius:e.radius}},{type:"border",props:{width:e.bWidth,color:"0xffffffff"}}],l[0].populate(a[0]),{elms:l,cleanup:()=>{t=null,e=null,l.length=0,i.length=0,a.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("y",t.calc)},function(t,e,s,i,n,o){e[0].set("x",t.calc)},function(t,e,s,i,n,o){e[0].set("effects",[{type:"radius",props:{radius:t.radius}},{type:"border",props:{width:t.bWidth,color:"0xffffffff"}}])}],context:{}},props:["width","height","x","y",{key:"bWidth",default:8},{key:"radius",default:6}],computed:{calc(){return this.bWidth,-this.bWidth/2}}}),vi=""+new URL("red-CM8haZ7A.png",import.meta.url).href,In=ce.Component("Card",{props:["key","items"],components:{FocusBorder:kf},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[];let d,g,p,m=!1,y=0,x=[];if(a[0]={},l[0]=this.element({parent:t||"root"},m===!0?p:e),a[0].w=e.items.width,a[0].h=e.items.height,a[0].direction="vertical",a[0].scale=e.hasFocus?1.1:1,a[0].__layout=!0,l[0].populate(a[0]),m===!0&&(y-=1),x[1]=s.components&&s.components.FocusBorder||i.FocusBorder,t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},m===!0?p:e),a[1].width=e.items.width+6,a[1].height=e.items.height+6,a[1].bWidth=6,a[1].alpha=e.hasFocus?1:0,a[1].radius=e.items.radius,h[1]=[],typeof x[1]<"u")for(let T in x[1][Symbol.for("config")].props)delete a[1][x[1][Symbol.for("config")].props[T]],h[1].push(x[1][Symbol.for("config")].props[T]);if(l[1].populate(a[1]),m===!0&&(y-=1),t=l[1],u[2]={},u[2].width=e.items.width+6,u[2].height=e.items.height+6,u[2].bWidth=6,g=e.hasFocus?1:0,Array.isArray(g)===!0&&(g=o(g).slice(0)),u[2].alpha=g,g=e.items.radius,Array.isArray(g)===!0&&(g=o(g).slice(0)),u[2].radius=g,d=u[2].is||"FocusBorder",i[2],typeof d=="string"){if(i[2]=s.components&&s.components[d]||i[d],!i[2])throw new Error('Component "FocusBorder" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[2]=d);return l[2]=i[2].call(null,{props:u[2]},l[1],e),l[2][Symbol.for("slots")][0]?(t=l[2][Symbol.for("slots")][0],p=l[2],m=!0):t=l[2][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),t=l[0],a[3]={},l[3]=this.element({parent:t||"root"},m===!0?p:e),a[3].w=e.items.width,a[3].h=e.items.height,a[3].effects=[{type:"radius",props:{radius:e.items.radius}}],a[3].src=e.backdrop,a[3].fit="{ type: 'cover', position: { x: 0.5 } }",a[3]["@loaded"]=e.revealPage&&e.revealPage.bind(e),a[3]["@error"]=e.showFallback&&e.showFallback.bind(e),l[3].populate(a[3]),m===!0&&(y-=1),t=l[0],a[4]={},l[4]=this.element({parent:t||"root"},m===!0?p:e),a[4].content=e.items.text,a[4].y=e.items.height,a[4].width=e.items.width,a[4].align="center",a[4].textoverflow=!0,a[4].maxlines=1,a[4].contain="width",a[4].size=16,a[4].color="0xffffffff",a[4].font="PoppinsSemiBold",a[4].__textnode=!0,l[4].populate(a[4]),m===!0&&(y-=1),t=l[0],a[5]={},l[5]=this.element({parent:t||"root"},m===!0?p:e),a[5].content=e.items.subText,a[5].y=e.items.height,a[5].width=e.items.width,a[5].align="center",a[5].textoverflow=!0,a[5].maxlines=1,a[5].contain="width",a[5].size=16,a[5].color="0x909090ff",a[5].font="PoppinsSemiBold",a[5].__textnode=!0,l[5].populate(a[5]),m===!0&&(y-=1),{elms:l,cleanup:()=>{g=null,p=null,t=null,x[1]=null,u[2]=null,i[2]=null,e=null,x.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("scale",t.hasFocus?1.1:1)},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[1]>"u"||skips[1].indexOf("alpha")===-1)&&e[1].set("alpha",t.hasFocus?1:0)},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[1]>"u"||skips[1].indexOf("radius")===-1)&&e[1].set("radius",t.items.radius)},function(t,e,s,i,n,o){e[2][Symbol.for("props")].alpha=t.hasFocus?1:0},function(t,e,s,i,n,o){e[2][Symbol.for("props")].radius=t.items.radius},function(t,e,s,i,n,o){e[3].set("effects",[{type:"radius",props:{radius:t.items.radius}}])}],context:{}},state(){return{backdrop:vi}},hooks:{init(){this.backdrop=this.items.data.backdrop_path?Ir(this.items.data.backdrop_path)||Ir(this.items.data.poster_path):vi},idle(){},focus(){this.$emit("changeBackground",{img:this.backdrop})}},input:{enter(){console.log("onEnter",this.items.onEnter),this.$router.to(this.items.onEnter(this.items.data.id),{inHistory:!1})}},methods:{revealPage(r){this.show=!0},showFallback(r){this.showBackupImage()}}}),Ln=ce.Component("Button",{code:{render:function(t,e,s,i,n,o,f){const l=[],a=[];return a[0]={},l[0]=this.element({parent:t||"root"},e),a[0].ref="button",a[0].color=e.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x00000000",a[0].padding=16,a[0].effects=[{type:"radius",props:{radius:25}}],a[0].__layout=!0,l[0].populate(a[0]),t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},e),a[1].content="Season 213123132213",a[1].__textnode=!0,l[1].populate(a[1]),{elms:l,cleanup:()=>{t=null,e=null,l.length=0,i.length=0,a.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("color",t.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x00000000")},function(t,e,s,i,n,o){e[0].set("effects",[{type:"radius",props:{radius:25}}])}],context:{}},hooks:{focus(){this.$trigger("focused")}},methods:{focused(){const r=this.$select("button");r&&r.$focus&&r.$focus()}}}),Mf=ce.Component("List",{components:{Card:In,Button:Ln},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[],d=[],g={},p=[];let m,y,x,T=!1,E=[];a[0]={},l[0]=this.element({parent:t||"root"},T===!0?x:e),a[0].x={transition:e.x},l[0].populate(a[0]),t=l[0],d[1]=[],g[1]=[];let M,O;u[1]=(I=[],S,L)=>{const A=o(I),D=new Set;let C=A.length;const w={};for(M=w.from||0,O=("to"in w)?w.to:A.length;C--;)A[C],C<O&&C>=M&&D.add(""+C);let R=L.length;for(;R--;)if(D.has(L[R])===!1){const N=L[R];S[1][N]&&S[1][N].destroy(),S[1][N]=null,delete S[1][N],S[2][N]&&S[2][N].destroy(),S[2][N]=null,delete S[2][N]}L.length=0;const V=A.length;e!==null&&e[Symbol.for("removeGlobalEffects")](g[1]);for(let N=0;N<g[1].length;N++){const k=g[1][N],B=e[Symbol.for("effects")].indexOf(k);B>-1&&e[Symbol.for("effects")].splice(B,1)}g[1].length=0;for(let N=0;N<V;N++){if(N<M||N>=O)continue;let k=Object.create(e);if(t=S[0],k.item=A[N],k.index=N,k.key=""+N,L.push(k.key),E[1]=s.components&&s.components.Component||i.Component,S[1]===void 0&&(S[1]={}),a[1]={},S[1][k.key]===void 0&&(S[1][k.key]=this.element({parent:t||"root"},T===!0?x:e)),a[1].is=k.item.type,a[1].item=k.item,a[1].x=k.index*k.totalWidth,a[1].ref="list-item-"+k.item.data.id,a[1].key=k.item.data.id,p[1]=[],typeof E[1]<"u")for(let K in E[1][Symbol.for("config")].props)delete a[1][E[1][Symbol.for("config")].props[K]],p[1].push(E[1][Symbol.for("config")].props[K]);if(S[1][k.key].nodeId===void 0&&S[1][k.key].populate(a[1]),S[2]===void 0&&(S[2]={}),t=S[1][k.key],h[2]={},S[2][k.key]===void 0){if(h[2].is=k.item.type,y=k.item,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].item=y,y=k.index*k.totalWidth,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].x=y,y="list-item-"+k.item.data.id,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].ref=y,y=k.item.data.id,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].key=y,m=h[2].is||"Component",i[2],typeof m=="string"){if(i[2]=s.components&&s.components[m]||i[m],!i[2])throw new Error('Component "Component" not found')}else typeof m=="function"&&m[Symbol.for("isComponent")]===!0&&(i[2]=m);S[2][k.key]=i[2].call(null,{props:h[2]},S[1][k.key],e),S[2][k.key][Symbol.for("slots")][0]?(t=S[2][k.key][Symbol.for("slots")][0],x=S[2][k.key],T=!0):t=S[2][k.key][Symbol.for("children")][0]}let B=()=>{(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("ref")===-1)&&S[1][k.key].set("ref","list-item-"+k.item.data.id)};n(B,null),g[1].push(B),e[Symbol.for("effects")].push(B);let $=()=>{(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("key")===-1)&&S[1][k.key].set("key",k.item.data.id)};n($,null),g[1].push($),e[Symbol.for("effects")].push($),S[2][k.key][Symbol.for("props")].ref="list-item-"+k.item.data.id,S[2][k.key][Symbol.for("props")].key=k.item.data.id}return g};let U=()=>{u[1](e.items,l,d[1])};e[Symbol.for("effects")].push(U),n(U,["items"]);let F=()=>{e.item;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("item")===-1)&&l[1][S.key].set("item",S.item)}};e[Symbol.for("effects")].push(F),n(F);let z=()=>{e.totalWidth;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("x")===-1)&&l[1][S.key].set("x",S.index*e.totalWidth)}};e[Symbol.for("effects")].push(z),n(z);let v=()=>{e.item;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,l[2][S.key][Symbol.for("props")].item=S.item}};e[Symbol.for("effects")].push(v),n(v);let W=()=>{e.totalWidth;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,l[2][S.key][Symbol.for("props")].x=S.index*e.totalWidth}};return e[Symbol.for("effects")].push(W),n(W),{elms:l,cleanup:()=>{y=null,x=null,t=null,d[1].length=0,E[1]=null,h[2]=null,i[2]=null,U=null,u[1]([],l,d[1]),u[1]=null,F=null,z=null,v=null,W=null,e=null,E.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0,p.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("x",{transition:t.x})}],context:{}},props:["autoScroll","autoscrollOffset","itemOffset","itemHeight","itemWidth","items","looping","containerWidth"],state(){return{focused:0,x:0,borderWidth:0}},computed:{totalWidth(){return this.items,this.itemOffset,(this.items[0].width||300)+(this.itemOffset||0)}},hooks:{focus(){var r;this.$trigger("focused"),(r=this.$select(`list-item-${this.items[this.focused].data.id}`))==null||r.$focus()}},watch:{hasFocus(r){r&&this.$trigger("focused")},focused(r){const t=this.$select(`list-item-${this.items[r].data.id}`);t&&t.$focus&&(t.$focus(),this.scrollToFocus())}},methods:{changeFocus(r){const t=this.looping?(this.focused+r+this.items.length)%this.items.length:Math.max(0,Math.min(this.focused+r,this.items.length-1));this.focused=t},scrollToFocus(){this.autoScroll&&(this.x=0-(this.items.length-1770/(this.items[0].width+this.itemOffset)<0?0:Math.min(this.focused,this.items.length-1770/(this.items[0].width+this.itemOffset))*(this.items[0].width+this.itemOffset)))}},input:{left(){this.changeFocus(-1)},right(){this.changeFocus(1)},enter(){console.log("Selected item:",this.items[this.focused])}}}),Pn=ce.Component("HorizontalContainer",{components:{Card:In,Button:Ln},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[],d=[],g={},p=[];let m,y,x,T=!1,E=[];a[0]={},l[0]=this.element({parent:t||"root"},T===!0?x:e),a[0].x={transition:e.x},a[0].ref="container",l[0].populate(a[0]),t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},T===!0?x:e),a[1].content=e.title,a[1].color="0xffffffff",a[1].h=50,a[1].__textnode=!0,l[1].populate(a[1]),t=l[0],d[2]=[],g[2]=[];let M,O;u[2]=(L=[],A,D)=>{const C=o(L),w=new Set;let R=C.length;const V={};for(M=V.from||0,O=("to"in V)?V.to:C.length;R--;)C[R],R<O&&R>=M&&w.add(""+R);let N=D.length;for(;N--;)if(w.has(D[N])===!1){const B=D[N];A[2][B]&&A[2][B].destroy(),A[2][B]=null,delete A[2][B],A[3][B]&&A[3][B].destroy(),A[3][B]=null,delete A[3][B]}D.length=0;const k=C.length;e!==null&&e[Symbol.for("removeGlobalEffects")](g[2]);for(let B=0;B<g[2].length;B++){const $=g[2][B],K=e[Symbol.for("effects")].indexOf($);K>-1&&e[Symbol.for("effects")].splice(K,1)}g[2].length=0;for(let B=0;B<k;B++){if(B<M||B>=O)continue;let $=Object.create(e);if(t=A[0],$.item=C[B],$.index=B,$.key=""+B,D.push($.key),E[2]=s.components&&s.components.Component||i.Component,A[2]===void 0&&(A[2]={}),a[2]={},A[2][$.key]===void 0&&(A[2][$.key]=this.element({parent:t||"root"},T===!0?x:e)),a[2].is=$.item.type,a[2].x=$.rowX($.index),a[2].y=$.title?50:0,a[2].ref="list-item-"+$.index,a[2].key=$.index,a[2].items=$.item.items?$.item.items:$.item,a[2].autoScroll=!0,p[2]=[],typeof E[2]<"u")for(let H in E[2][Symbol.for("config")].props)delete a[2][E[2][Symbol.for("config")].props[H]],p[2].push(E[2][Symbol.for("config")].props[H]);if(A[2][$.key].nodeId===void 0&&A[2][$.key].populate(a[2]),A[3]===void 0&&(A[3]={}),t=A[2][$.key],h[3]={},A[3][$.key]===void 0){if(h[3].is=$.item.type,y=$.rowX($.index),Array.isArray(y)===!0&&(y=o(y).slice(0)),h[3].x=y,y=$.title?50:0,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[3].y=y,y="list-item-"+$.index,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[3].ref=y,y=$.index,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[3].key=y,y=$.item.items?$.item.items:$.item,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[3].items=y,h[3].autoScroll=!0,m=h[3].is||"Component",i[3],typeof m=="string"){if(i[3]=s.components&&s.components[m]||i[m],!i[3])throw new Error('Component "Component" not found')}else typeof m=="function"&&m[Symbol.for("isComponent")]===!0&&(i[3]=m);A[3][$.key]=i[3].call(null,{props:h[3]},A[2][$.key],e),A[3][$.key][Symbol.for("slots")][0]?(t=A[3][$.key][Symbol.for("slots")][0],x=A[3][$.key],T=!0):t=A[3][$.key][Symbol.for("children")][0]}let K=()=>{(typeof p>"u"||typeof p[2]>"u"||p[2].indexOf("ref")===-1)&&A[2][$.key].set("ref","list-item-"+$.index)};n(K,null),g[2].push(K),e[Symbol.for("effects")].push(K);let X=()=>{(typeof p>"u"||typeof p[2]>"u"||p[2].indexOf("key")===-1)&&A[2][$.key].set("key",$.index)};n(X,null),g[2].push(X),e[Symbol.for("effects")].push(X),A[3][$.key][Symbol.for("props")].ref="list-item-"+$.index,A[3][$.key][Symbol.for("props")].key=$.index}return g};let U=()=>{u[2](e.items,l,d[2])};e[Symbol.for("effects")].push(U),n(U,["items"]);let F=()=>{e.rowX;for(let L=0;L<e.items.length;L++){if(L<M||L>=O)continue;const A={};A.index=L,A.item=e.items[L],A.key=L,(typeof p>"u"||typeof p[2]>"u"||p[2].indexOf("x")===-1)&&l[2][A.key].set("x",e.rowX(A.index))}};e[Symbol.for("effects")].push(F),n(F);let z=()=>{e.title;for(let L=0;L<e.items.length;L++){if(L<M||L>=O)continue;const A={};A.index=L,A.item=e.items[L],A.key=L,(typeof p>"u"||typeof p[2]>"u"||p[2].indexOf("y")===-1)&&l[2][A.key].set("y",e.title?50:0)}};e[Symbol.for("effects")].push(z),n(z);let v=()=>{e.item;for(let L=0;L<e.items.length;L++){if(L<M||L>=O)continue;const A={};A.index=L,A.item=e.items[L],A.key=L,(typeof p>"u"||typeof p[2]>"u"||p[2].indexOf("items")===-1)&&l[2][A.key].set("items",A.item.items?A.item.items:A.item)}};e[Symbol.for("effects")].push(v),n(v);let W=()=>{e.rowX;for(let L=0;L<e.items.length;L++){if(L<M||L>=O)continue;const A={};A.index=L,A.item=e.items[L],A.key=L,l[3][A.key][Symbol.for("props")].x=e.rowX(A.index)}};e[Symbol.for("effects")].push(W),n(W);let I=()=>{e.title;for(let L=0;L<e.items.length;L++){if(L<M||L>=O)continue;const A={};A.index=L,A.item=e.items[L],A.key=L,l[3][A.key][Symbol.for("props")].y=e.title?50:0}};e[Symbol.for("effects")].push(I),n(I);let S=()=>{e.item;for(let L=0;L<e.items.length;L++){if(L<M||L>=O)continue;const A={};A.index=L,A.item=e.items[L],A.key=L,l[3][A.key][Symbol.for("props")].items=A.item.items?A.item.items:A.item}};return e[Symbol.for("effects")].push(S),n(S),{elms:l,cleanup:()=>{y=null,x=null,t=null,d[2].length=0,E[2]=null,h[3]=null,i[3]=null,U=null,u[2]([],l,d[2]),u[2]=null,F=null,z=null,v=null,W=null,I=null,S=null,e=null,E.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0,p.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("x",{transition:t.x})}],context:{}},props:["autoScroll","autoscrollOffset","itemOffset","items","looping","title",{key:"gap",default:50}],state(){return{focused:0,x:0}},hooks:{init(){console.log(this.items)}},watch:{hasFocus(r){r&&this.$trigger("focused")},focused(r){const t=this.$select(`list-item-${r}`);t&&t.$focus&&(t.$focus(),this.scroll())}},methods:{changeFocus(r){const t=this.looping?(this.focused+r+this.items.length)%this.items.length:Math.max(0,Math.min(this.focused+r,this.items.length-1));this.focused=t},rowOffset(r){return r===0?0:this.items.slice(0,r).reduce((t,e)=>{const s=e!=null&&e.items?e==null?void 0:e.items[0].width:e.width;return t+s+this.gap},0)},rowX(r){return this.rowOffset(r)},scroll(){this.autoScroll&&(this.x=0-(this.items.length-1770/(this.items[0].width+this.gap)<0?0:Math.min(this.focused,this.items.length-1770/(this.items[0].width+this.gap))*(this.items[0].width+this.gap))),console.log(this.x)}},input:{left(){this.changeFocus(-1)},right(){this.changeFocus(1)},enter(){console.log("Selected item:",this.items[this.focused])}}}),If=ce.Component("Column",{props:["items","itemOffset","autoScroll","looping"],components:{List:Mf,HorizontalContainer:Pn},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[],d=[],g={},p=[];let m,y,x,T=!1,E=[];a[0]={},l[0]=this.element({parent:t||"root"},T===!0?x:e),a[0].w=1920,a[0].y={transition:e.y},a[0].ref="columnCont",l[0].populate(a[0]),t=l[0],d[1]=[],g[1]=[];let M,O;u[1]=(z=[],v,W)=>{const I=o(z),S=new Set;let L=I.length;const A={};for(M=A.from||0,O=("to"in A)?A.to:I.length;L--;)I[L],L<O&&L>=M&&S.add(""+L);let D=W.length;for(;D--;)if(S.has(W[D])===!1){const w=W[D];v[1][w]&&v[1][w].destroy(),v[1][w]=null,delete v[1][w],v[2][w]&&v[2][w].destroy(),v[2][w]=null,delete v[2][w],v[3][w]&&v[3][w].destroy(),v[3][w]=null,delete v[3][w],v[4][w]&&v[4][w].destroy(),v[4][w]=null,delete v[4][w],v[5][w]&&v[5][w].destroy(),v[5][w]=null,delete v[5][w]}W.length=0;const C=I.length;e!==null&&e[Symbol.for("removeGlobalEffects")](g[1]);for(let w=0;w<g[1].length;w++){const R=g[1][w],V=e[Symbol.for("effects")].indexOf(R);V>-1&&e[Symbol.for("effects")].splice(V,1)}g[1].length=0;for(let w=0;w<C;w++){if(w<M||w>=O)continue;let R=Object.create(e);if(t=v[0],R.item=I[w],R.index=w,R.key=""+w,W.push(R.key),t=v[0],v[1]===void 0&&(v[1]={}),a[1]={},v[1][R.key]===void 0&&(v[1][R.key]=this.element({parent:t||"root"},T===!0?x:e)),a[1].x=64,a[1].y=R.rowY(R.index),v[1][R.key].nodeId===void 0&&v[1][R.key].populate(a[1]),t=v[1][R.key],v[2]===void 0&&(v[2]={}),a[2]={},v[2][R.key]===void 0&&(v[2][R.key]=this.element({parent:t||"root"},T===!0?x:e)),a[2].w=103,a[2].h=29,a[2].content=R.item.name,a[2].font="InterBold",a[2].size=24,a[2].letterspacing=6,a[2].__textnode=!0,v[2][R.key].nodeId===void 0&&v[2][R.key].populate(a[2]),t=v[1][R.key],v[3]===void 0&&(v[3]={}),a[3]={},v[3][R.key]===void 0&&(v[3][R.key]=this.element({parent:t||"root"},T===!0?x:e)),a[3].w=t.node.width*(100/100),a[3].h=R.item.height,a[3].y=39,a[3].overflow=!0,a[3].ref="backgroundEl",v[3][R.key].nodeId===void 0&&v[3][R.key].populate(a[3]),E[4]=s.components&&s.components.HorizontalContainer||i.HorizontalContainer,t=v[3][R.key],v[4]===void 0&&(v[4]={}),a[4]={},v[4][R.key]===void 0&&(v[4][R.key]=this.element({parent:t||"root"},T===!0?x:e)),a[4].items=R.item.movies,a[4].type=R.item.type,a[4].itemWidth=R.item.width,a[4].itemHeight=R.item.height,a[4].ref="cardRow"+R.index,a[4].autoScroll=!0,a[4].looping=!0,a[4].itemOffset=R.item.itemOffset||30,a[4].wBorder=R.item.wBorder,p[4]=[],typeof E[4]<"u")for(let te in E[4][Symbol.for("config")].props)delete a[4][E[4][Symbol.for("config")].props[te]],p[4].push(E[4][Symbol.for("config")].props[te]);if(v[4][R.key].nodeId===void 0&&v[4][R.key].populate(a[4]),v[5]===void 0&&(v[5]={}),t=v[4][R.key],h[5]={},v[5][R.key]===void 0){if(y=R.item.movies,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].items=y,y=R.item.type,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].type=y,y=R.item.width,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].itemWidth=y,y=R.item.height,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].itemHeight=y,y="cardRow"+R.index,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].ref=y,h[5].autoScroll=!0,h[5].looping=!0,y=R.item.itemOffset||30,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].itemOffset=y,y=R.item.wBorder,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[5].wBorder=y,m=h[5].is||"HorizontalContainer",i[5],typeof m=="string"){if(i[5]=s.components&&s.components[m]||i[m],!i[5])throw new Error('Component "HorizontalContainer" not found')}else typeof m=="function"&&m[Symbol.for("isComponent")]===!0&&(i[5]=m);v[5][R.key]=i[5].call(null,{props:h[5]},v[4][R.key],e),v[5][R.key][Symbol.for("slots")][0]?(t=v[5][R.key][Symbol.for("slots")][0],x=v[5][R.key],T=!0):t=v[5][R.key][Symbol.for("children")][0]}let V=()=>{v[2][R.key].set("content",R.item.name)};n(V,null),g[1].push(V),e[Symbol.for("effects")].push(V);let N=()=>{v[3][R.key].set("h",R.item.height)};n(N,null),g[1].push(N),e[Symbol.for("effects")].push(N);let k=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("items")===-1)&&v[4][R.key].set("items",R.item.movies)};n(k,null),g[1].push(k),e[Symbol.for("effects")].push(k);let B=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("type")===-1)&&v[4][R.key].set("type",R.item.type)};n(B,null),g[1].push(B),e[Symbol.for("effects")].push(B);let $=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("itemWidth")===-1)&&v[4][R.key].set("itemWidth",R.item.width)};n($,null),g[1].push($),e[Symbol.for("effects")].push($);let K=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("itemHeight")===-1)&&v[4][R.key].set("itemHeight",R.item.height)};n(K,null),g[1].push(K),e[Symbol.for("effects")].push(K);let X=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("ref")===-1)&&v[4][R.key].set("ref","cardRow"+R.index)};n(X,null),g[1].push(X),e[Symbol.for("effects")].push(X);let H=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("itemOffset")===-1)&&v[4][R.key].set("itemOffset",R.item.itemOffset||30)};n(H,null),g[1].push(H),e[Symbol.for("effects")].push(H);let Q=()=>{(typeof p>"u"||typeof p[4]>"u"||p[4].indexOf("wBorder")===-1)&&v[4][R.key].set("wBorder",R.item.wBorder)};n(Q,null),g[1].push(Q),e[Symbol.for("effects")].push(Q),v[5][R.key][Symbol.for("props")].items=R.item.movies,v[5][R.key][Symbol.for("props")].type=R.item.type,v[5][R.key][Symbol.for("props")].itemWidth=R.item.width,v[5][R.key][Symbol.for("props")].itemHeight=R.item.height,v[5][R.key][Symbol.for("props")].ref="cardRow"+R.index,v[5][R.key][Symbol.for("props")].itemOffset=R.item.itemOffset||30,v[5][R.key][Symbol.for("props")].wBorder=R.item.wBorder}return g};let U=()=>{u[1](e.items,l,d[1])};e[Symbol.for("effects")].push(U),n(U,["items"]);let F=()=>{e.rowY;for(let z=0;z<e.items.length;z++){if(z<M||z>=O)continue;const v={};v.index=z,v.item=e.items[z],v.key=z,l[1][v.key].set("y",e.rowY(v.index))}};return e[Symbol.for("effects")].push(F),n(F),{elms:l,cleanup:()=>{y=null,x=null,t=null,d[1].length=0,E[4]=null,h[5]=null,i[5]=null,U=null,u[1]([],l,d[1]),u[1]=null,F=null,e=null,E.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0,p.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("y",{transition:t.y})}],context:{}},state(){return{y:0,focused:0}},hooks:{async init(){this.$trigger("focused")},focus(){this.$trigger("focused")}},watch:{focused(r){const t=this.$select("cardRow"+r);t&&t.$focus&&t.$focus()}},input:{up(){this.focused=this.focused===0&&this.looping?this.focused=this.items.length-1:Math.max(this.focused-1,0),this.scroll()},down(){this.focused=this.focused===this.items.length-1&&this.looping?this.focused=0:Math.min(this.focused+1,this.items.length-1),this.scroll()}},methods:{rowY(r){return r===0?0:this.items.slice(0,r).reduce((t,e)=>t+29+24+e.height+this.itemOffset,0)},scroll(){this.autoScroll&&(this.y=this.focused===0?0:-this.items.slice(0,this.focused).reduce((r,t)=>r+29+24+t.type.height+this.itemOffset,0))}}});function On(r,t){return function(){return r.apply(t,arguments)}}const{toString:Lf}=Object.prototype,{getPrototypeOf:Ds}=Object,{iterator:Nr,toStringTag:Fn}=Symbol,Dr=(r=>t=>{const e=Lf.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),pe=r=>(r=r.toLowerCase(),t=>Dr(t)===r),zr=r=>t=>typeof t===r,{isArray:dt}=Array,ut=zr("undefined");function zt(r){return r!==null&&!ut(r)&&r.constructor!==null&&!ut(r.constructor)&&fe(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const Bn=pe("ArrayBuffer");function Pf(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&Bn(r.buffer),t}const Of=zr("string"),fe=zr("function"),Un=zr("number"),Wt=r=>r!==null&&typeof r=="object",Ff=r=>r===!0||r===!1,Sr=r=>{if(Dr(r)!=="object")return!1;const t=Ds(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Fn in r)&&!(Nr in r)},Bf=r=>{if(!Wt(r)||zt(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},Uf=pe("Date"),$f=pe("File"),Nf=pe("Blob"),Df=pe("FileList"),zf=r=>Wt(r)&&fe(r.pipe),Wf=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||fe(r.append)&&((t=Dr(r))==="formdata"||t==="object"&&fe(r.toString)&&r.toString()==="[object FormData]"))},Xf=pe("URLSearchParams"),[Vf,Hf,Gf,Yf]=["ReadableStream","Request","Response","Headers"].map(pe),jf=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xt(r,t,{allOwnKeys:e=!1}={}){if(r===null||typeof r>"u")return;let s,i;if(typeof r!="object"&&(r=[r]),dt(r))for(s=0,i=r.length;s<i;s++)t.call(null,r[s],s,r);else{if(zt(r))return;const n=e?Object.getOwnPropertyNames(r):Object.keys(r),o=n.length;let f;for(s=0;s<o;s++)f=n[s],t.call(null,r[f],f,r)}}function $n(r,t){if(zt(r))return null;t=t.toLowerCase();const e=Object.keys(r);let s=e.length,i;for(;s-- >0;)if(i=e[s],t===i.toLowerCase())return i;return null}const Pe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Nn=r=>!ut(r)&&r!==Pe;function As(){const{caseless:r,skipUndefined:t}=Nn(this)&&this||{},e={},s=(i,n)=>{const o=r&&$n(e,n)||n;Sr(e[o])&&Sr(i)?e[o]=As(e[o],i):Sr(i)?e[o]=As({},i):dt(i)?e[o]=i.slice():(!t||!ut(i))&&(e[o]=i)};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&Xt(arguments[i],s);return e}const Kf=(r,t,e,{allOwnKeys:s}={})=>(Xt(t,(i,n)=>{e&&fe(i)?Object.defineProperty(r,n,{value:On(i,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(r,n,{value:i,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:s}),r),qf=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Qf=(r,t,e,s)=>{r.prototype=Object.create(t.prototype,s),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},Zf=(r,t,e,s)=>{let i,n,o;const f={};if(t=t||{},r==null)return t;do{for(i=Object.getOwnPropertyNames(r),n=i.length;n-- >0;)o=i[n],(!s||s(o,r,t))&&!f[o]&&(t[o]=r[o],f[o]=!0);r=e!==!1&&Ds(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},Jf=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const s=r.indexOf(t,e);return s!==-1&&s===e},eu=r=>{if(!r)return null;if(dt(r))return r;let t=r.length;if(!Un(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},tu=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Ds(Uint8Array)),ru=(r,t)=>{const s=(r&&r[Nr]).call(r);let i;for(;(i=s.next())&&!i.done;){const n=i.value;t.call(r,n[0],n[1])}},su=(r,t)=>{let e;const s=[];for(;(e=r.exec(t))!==null;)s.push(e);return s},iu=pe("HTMLFormElement"),nu=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,s,i){return s.toUpperCase()+i}),Ai=(({hasOwnProperty:r})=>(t,e)=>r.call(t,e))(Object.prototype),ou=pe("RegExp"),Dn=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),s={};Xt(e,(i,n)=>{let o;(o=t(i,n,r))!==!1&&(s[n]=o||i)}),Object.defineProperties(r,s)},au=r=>{Dn(r,(t,e)=>{if(fe(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const s=r[e];if(fe(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},lu=(r,t)=>{const e={},s=i=>{i.forEach(n=>{e[n]=!0})};return dt(r)?s(r):s(String(r).split(t)),e},fu=()=>{},uu=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function cu(r){return!!(r&&fe(r.append)&&r[Fn]==="FormData"&&r[Nr])}const hu=r=>{const t=new Array(10),e=(s,i)=>{if(Wt(s)){if(t.indexOf(s)>=0)return;if(zt(s))return s;if(!("toJSON"in s)){t[i]=s;const n=dt(s)?[]:{};return Xt(s,(o,f)=>{const l=e(o,i+1);!ut(l)&&(n[f]=l)}),t[i]=void 0,n}}return s};return e(r,0)},du=pe("AsyncFunction"),pu=r=>r&&(Wt(r)||fe(r))&&fe(r.then)&&fe(r.catch),zn=((r,t)=>r?setImmediate:t?((e,s)=>(Pe.addEventListener("message",({source:i,data:n})=>{i===Pe&&n===e&&s.length&&s.shift()()},!1),i=>{s.push(i),Pe.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",fe(Pe.postMessage)),mu=typeof queueMicrotask<"u"?queueMicrotask.bind(Pe):typeof process<"u"&&process.nextTick||zn,gu=r=>r!=null&&fe(r[Nr]),_={isArray:dt,isArrayBuffer:Bn,isBuffer:zt,isFormData:Wf,isArrayBufferView:Pf,isString:Of,isNumber:Un,isBoolean:Ff,isObject:Wt,isPlainObject:Sr,isEmptyObject:Bf,isReadableStream:Vf,isRequest:Hf,isResponse:Gf,isHeaders:Yf,isUndefined:ut,isDate:Uf,isFile:$f,isBlob:Nf,isRegExp:ou,isFunction:fe,isStream:zf,isURLSearchParams:Xf,isTypedArray:tu,isFileList:Df,forEach:Xt,merge:As,extend:Kf,trim:jf,stripBOM:qf,inherits:Qf,toFlatObject:Zf,kindOf:Dr,kindOfTest:pe,endsWith:Jf,toArray:eu,forEachEntry:ru,matchAll:su,isHTMLForm:iu,hasOwnProperty:Ai,hasOwnProp:Ai,reduceDescriptors:Dn,freezeMethods:au,toObjectSet:lu,toCamelCase:nu,noop:fu,toFiniteNumber:uu,findKey:$n,global:Pe,isContextDefined:Nn,isSpecCompliantForm:cu,toJSONObject:hu,isAsyncFn:du,isThenable:pu,setImmediate:zn,asap:mu,isIterable:gu};let G=class Wn extends Error{static from(t,e,s,i,n,o){const f=new Wn(t.message,e||t.code,s,i,n);return f.cause=t,f.name=t.name,o&&Object.assign(f,o),f}constructor(t,e,s,i,n){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),s&&(this.config=s),i&&(this.request=i),n&&(this.response=n,this.status=n.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_.toJSONObject(this.config),code:this.code,status:this.status}}};G.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";G.ERR_BAD_OPTION="ERR_BAD_OPTION";G.ECONNABORTED="ECONNABORTED";G.ETIMEDOUT="ETIMEDOUT";G.ERR_NETWORK="ERR_NETWORK";G.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";G.ERR_DEPRECATED="ERR_DEPRECATED";G.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";G.ERR_BAD_REQUEST="ERR_BAD_REQUEST";G.ERR_CANCELED="ERR_CANCELED";G.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";G.ERR_INVALID_URL="ERR_INVALID_URL";const yu=null;function ks(r){return _.isPlainObject(r)||_.isArray(r)}function Xn(r){return _.endsWith(r,"[]")?r.slice(0,-2):r}function ki(r,t,e){return r?r.concat(t).map(function(i,n){return i=Xn(i),!e&&n?"["+i+"]":i}).join(e?".":""):t}function xu(r){return _.isArray(r)&&!r.some(ks)}const bu=_.toFlatObject(_,{},null,function(t){return/^is[A-Z]/.test(t)});function Wr(r,t,e){if(!_.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=_.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!_.isUndefined(y[m])});const s=e.metaTokens,i=e.visitor||u,n=e.dots,o=e.indexes,l=(e.Blob||typeof Blob<"u"&&Blob)&&_.isSpecCompliantForm(t);if(!_.isFunction(i))throw new TypeError("visitor must be a function");function a(p){if(p===null)return"";if(_.isDate(p))return p.toISOString();if(_.isBoolean(p))return p.toString();if(!l&&_.isBlob(p))throw new G("Blob is not supported. Use a Buffer instead.");return _.isArrayBuffer(p)||_.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,m,y){let x=p;if(p&&!y&&typeof p=="object"){if(_.endsWith(m,"{}"))m=s?m:m.slice(0,-2),p=JSON.stringify(p);else if(_.isArray(p)&&xu(p)||(_.isFileList(p)||_.endsWith(m,"[]"))&&(x=_.toArray(p)))return m=Xn(m),x.forEach(function(E,M){!(_.isUndefined(E)||E===null)&&t.append(o===!0?ki([m],M,n):o===null?m:m+"[]",a(E))}),!1}return ks(p)?!0:(t.append(ki(y,m,n),a(p)),!1)}const h=[],d=Object.assign(bu,{defaultVisitor:u,convertValue:a,isVisitable:ks});function g(p,m){if(!_.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(p),_.forEach(p,function(x,T){(!(_.isUndefined(x)||x===null)&&i.call(t,x,_.isString(T)?T.trim():T,m,d))===!0&&g(x,m?m.concat(T):[T])}),h.pop()}}if(!_.isObject(r))throw new TypeError("data must be an object");return g(r),t}function Mi(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function zs(r,t){this._pairs=[],r&&Wr(r,this,t)}const Vn=zs.prototype;Vn.append=function(t,e){this._pairs.push([t,e])};Vn.toString=function(t){const e=t?function(s){return t.call(this,s,Mi)}:Mi;return this._pairs.map(function(i){return e(i[0])+"="+e(i[1])},"").join("&")};function Tu(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Hn(r,t,e){if(!t)return r;const s=e&&e.encode||Tu,i=_.isFunction(e)?{serialize:e}:e,n=i&&i.serialize;let o;if(n?o=n(t,i):o=_.isURLSearchParams(t)?t.toString():new zs(t,i).toString(s),o){const f=r.indexOf("#");f!==-1&&(r=r.slice(0,f)),r+=(r.indexOf("?")===-1?"?":"&")+o}return r}class Ii{constructor(){this.handlers=[]}use(t,e,s){return this.handlers.push({fulfilled:t,rejected:e,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){_.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Gn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Su=typeof URLSearchParams<"u"?URLSearchParams:zs,wu=typeof FormData<"u"?FormData:null,Cu=typeof Blob<"u"?Blob:null,Eu={isBrowser:!0,classes:{URLSearchParams:Su,FormData:wu,Blob:Cu},protocols:["http","https","file","blob","url","data"]},Ws=typeof window<"u"&&typeof document<"u",Ms=typeof navigator=="object"&&navigator||void 0,Ru=Ws&&(!Ms||["ReactNative","NativeScript","NS"].indexOf(Ms.product)<0),_u=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vu=Ws&&window.location.href||"http://localhost",Au=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ws,hasStandardBrowserEnv:Ru,hasStandardBrowserWebWorkerEnv:_u,navigator:Ms,origin:vu},Symbol.toStringTag,{value:"Module"})),oe={...Au,...Eu};function ku(r,t){return Wr(r,new oe.classes.URLSearchParams,{visitor:function(e,s,i,n){return oe.isNode&&_.isBuffer(e)?(this.append(s,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...t})}function Mu(r){return _.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Iu(r){const t={},e=Object.keys(r);let s;const i=e.length;let n;for(s=0;s<i;s++)n=e[s],t[n]=r[n];return t}function Yn(r){function t(e,s,i,n){let o=e[n++];if(o==="__proto__")return!0;const f=Number.isFinite(+o),l=n>=e.length;return o=!o&&_.isArray(i)?i.length:o,l?(_.hasOwnProp(i,o)?i[o]=[i[o],s]:i[o]=s,!f):((!i[o]||!_.isObject(i[o]))&&(i[o]=[]),t(e,s,i[o],n)&&_.isArray(i[o])&&(i[o]=Iu(i[o])),!f)}if(_.isFormData(r)&&_.isFunction(r.entries)){const e={};return _.forEachEntry(r,(s,i)=>{t(Mu(s),i,e,0)}),e}return null}function Lu(r,t,e){if(_.isString(r))try{return(t||JSON.parse)(r),_.trim(r)}catch(s){if(s.name!=="SyntaxError")throw s}return(e||JSON.stringify)(r)}const Vt={transitional:Gn,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const s=e.getContentType()||"",i=s.indexOf("application/json")>-1,n=_.isObject(t);if(n&&_.isHTMLForm(t)&&(t=new FormData(t)),_.isFormData(t))return i?JSON.stringify(Yn(t)):t;if(_.isArrayBuffer(t)||_.isBuffer(t)||_.isStream(t)||_.isFile(t)||_.isBlob(t)||_.isReadableStream(t))return t;if(_.isArrayBufferView(t))return t.buffer;if(_.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let f;if(n){if(s.indexOf("application/x-www-form-urlencoded")>-1)return ku(t,this.formSerializer).toString();if((f=_.isFileList(t))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Wr(f?{"files[]":t}:t,l&&new l,this.formSerializer)}}return n||i?(e.setContentType("application/json",!1),Lu(t)):t}],transformResponse:[function(t){const e=this.transitional||Vt.transitional,s=e&&e.forcedJSONParsing,i=this.responseType==="json";if(_.isResponse(t)||_.isReadableStream(t))return t;if(t&&_.isString(t)&&(s&&!this.responseType||i)){const o=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(f){if(o)throw f.name==="SyntaxError"?G.from(f,G.ERR_BAD_RESPONSE,this,null,this.response):f}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oe.classes.FormData,Blob:oe.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_.forEach(["delete","get","head","post","put","patch"],r=>{Vt.headers[r]={}});const Pu=_.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ou=r=>{const t={};let e,s,i;return r&&r.split(`
`).forEach(function(o){i=o.indexOf(":"),e=o.substring(0,i).trim().toLowerCase(),s=o.substring(i+1).trim(),!(!e||t[e]&&Pu[e])&&(e==="set-cookie"?t[e]?t[e].push(s):t[e]=[s]:t[e]=t[e]?t[e]+", "+s:s)}),t},Li=Symbol("internals");function bt(r){return r&&String(r).trim().toLowerCase()}function wr(r){return r===!1||r==null?r:_.isArray(r)?r.map(wr):String(r)}function Fu(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=e.exec(r);)t[s[1]]=s[2];return t}const Bu=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function os(r,t,e,s,i){if(_.isFunction(s))return s.call(this,t,e);if(i&&(t=e),!!_.isString(t)){if(_.isString(s))return t.indexOf(s)!==-1;if(_.isRegExp(s))return s.test(t)}}function Uu(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,s)=>e.toUpperCase()+s)}function $u(r,t){const e=_.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(r,s+e,{value:function(i,n,o){return this[s].call(this,t,i,n,o)},configurable:!0})})}let ue=class{constructor(t){t&&this.set(t)}set(t,e,s){const i=this;function n(f,l,a){const u=bt(l);if(!u)throw new Error("header name must be a non-empty string");const h=_.findKey(i,u);(!h||i[h]===void 0||a===!0||a===void 0&&i[h]!==!1)&&(i[h||l]=wr(f))}const o=(f,l)=>_.forEach(f,(a,u)=>n(a,u,l));if(_.isPlainObject(t)||t instanceof this.constructor)o(t,e);else if(_.isString(t)&&(t=t.trim())&&!Bu(t))o(Ou(t),e);else if(_.isObject(t)&&_.isIterable(t)){let f={},l,a;for(const u of t){if(!_.isArray(u))throw TypeError("Object iterator must return a key-value pair");f[a=u[0]]=(l=f[a])?_.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(f,e)}else t!=null&&n(e,t,s);return this}get(t,e){if(t=bt(t),t){const s=_.findKey(this,t);if(s){const i=this[s];if(!e)return i;if(e===!0)return Fu(i);if(_.isFunction(e))return e.call(this,i,s);if(_.isRegExp(e))return e.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=bt(t),t){const s=_.findKey(this,t);return!!(s&&this[s]!==void 0&&(!e||os(this,this[s],s,e)))}return!1}delete(t,e){const s=this;let i=!1;function n(o){if(o=bt(o),o){const f=_.findKey(s,o);f&&(!e||os(s,s[f],f,e))&&(delete s[f],i=!0)}}return _.isArray(t)?t.forEach(n):n(t),i}clear(t){const e=Object.keys(this);let s=e.length,i=!1;for(;s--;){const n=e[s];(!t||os(this,this[n],n,t,!0))&&(delete this[n],i=!0)}return i}normalize(t){const e=this,s={};return _.forEach(this,(i,n)=>{const o=_.findKey(s,n);if(o){e[o]=wr(i),delete e[n];return}const f=t?Uu(n):String(n).trim();f!==n&&delete e[n],e[f]=wr(i),s[f]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return _.forEach(this,(s,i)=>{s!=null&&s!==!1&&(e[i]=t&&_.isArray(s)?s.join(", "):s)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const s=new this(t);return e.forEach(i=>s.set(i)),s}static accessor(t){const s=(this[Li]=this[Li]={accessors:{}}).accessors,i=this.prototype;function n(o){const f=bt(o);s[f]||($u(i,o),s[f]=!0)}return _.isArray(t)?t.forEach(n):n(t),this}};ue.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_.reduceDescriptors(ue.prototype,({value:r},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(s){this[e]=s}}});_.freezeMethods(ue);function as(r,t){const e=this||Vt,s=t||e,i=ue.from(s.headers);let n=s.data;return _.forEach(r,function(f){n=f.call(e,n,i.normalize(),t?t.status:void 0)}),i.normalize(),n}function jn(r){return!!(r&&r.__CANCEL__)}let Ht=class extends G{constructor(t,e,s){super(t??"canceled",G.ERR_CANCELED,e,s),this.name="CanceledError",this.__CANCEL__=!0}};function Kn(r,t,e){const s=e.config.validateStatus;!e.status||!s||s(e.status)?r(e):t(new G("Request failed with status code "+e.status,[G.ERR_BAD_REQUEST,G.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function Nu(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function Du(r,t){r=r||10;const e=new Array(r),s=new Array(r);let i=0,n=0,o;return t=t!==void 0?t:1e3,function(l){const a=Date.now(),u=s[n];o||(o=a),e[i]=l,s[i]=a;let h=n,d=0;for(;h!==i;)d+=e[h++],h=h%r;if(i=(i+1)%r,i===n&&(n=(n+1)%r),a-o<t)return;const g=u&&a-u;return g?Math.round(d*1e3/g):void 0}}function zu(r,t){let e=0,s=1e3/t,i,n;const o=(a,u=Date.now())=>{e=u,i=null,n&&(clearTimeout(n),n=null),r(...a)};return[(...a)=>{const u=Date.now(),h=u-e;h>=s?o(a,u):(i=a,n||(n=setTimeout(()=>{n=null,o(i)},s-h)))},()=>i&&o(i)]}const Lr=(r,t,e=3)=>{let s=0;const i=Du(50,250);return zu(n=>{const o=n.loaded,f=n.lengthComputable?n.total:void 0,l=o-s,a=i(l),u=o<=f;s=o;const h={loaded:o,total:f,progress:f?o/f:void 0,bytes:l,rate:a||void 0,estimated:a&&f&&u?(f-o)/a:void 0,event:n,lengthComputable:f!=null,[t?"download":"upload"]:!0};r(h)},e)},Pi=(r,t)=>{const e=r!=null;return[s=>t[0]({lengthComputable:e,total:r,loaded:s}),t[1]]},Oi=r=>(...t)=>_.asap(()=>r(...t)),Wu=oe.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,oe.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(oe.origin),oe.navigator&&/(msie|trident)/i.test(oe.navigator.userAgent)):()=>!0,Xu=oe.hasStandardBrowserEnv?{write(r,t,e,s,i,n,o){if(typeof document>"u")return;const f=[`${r}=${encodeURIComponent(t)}`];_.isNumber(e)&&f.push(`expires=${new Date(e).toUTCString()}`),_.isString(s)&&f.push(`path=${s}`),_.isString(i)&&f.push(`domain=${i}`),n===!0&&f.push("secure"),_.isString(o)&&f.push(`SameSite=${o}`),document.cookie=f.join("; ")},read(r){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+r+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(r){this.write(r,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Vu(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Hu(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function qn(r,t,e){let s=!Vu(t);return r&&(s||e==!1)?Hu(r,t):t}const Fi=r=>r instanceof ue?{...r}:r;function Ue(r,t){t=t||{};const e={};function s(a,u,h,d){return _.isPlainObject(a)&&_.isPlainObject(u)?_.merge.call({caseless:d},a,u):_.isPlainObject(u)?_.merge({},u):_.isArray(u)?u.slice():u}function i(a,u,h,d){if(_.isUndefined(u)){if(!_.isUndefined(a))return s(void 0,a,h,d)}else return s(a,u,h,d)}function n(a,u){if(!_.isUndefined(u))return s(void 0,u)}function o(a,u){if(_.isUndefined(u)){if(!_.isUndefined(a))return s(void 0,a)}else return s(void 0,u)}function f(a,u,h){if(h in t)return s(a,u);if(h in r)return s(void 0,a)}const l={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:f,headers:(a,u,h)=>i(Fi(a),Fi(u),h,!0)};return _.forEach(Object.keys({...r,...t}),function(u){const h=l[u]||i,d=h(r[u],t[u],u);_.isUndefined(d)&&h!==f||(e[u]=d)}),e}const Qn=r=>{const t=Ue({},r);let{data:e,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:n,headers:o,auth:f}=t;if(t.headers=o=ue.from(o),t.url=Hn(qn(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),f&&o.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):""))),_.isFormData(e)){if(oe.hasStandardBrowserEnv||oe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(_.isFunction(e.getHeaders)){const l=e.getHeaders(),a=["content-type","content-length"];Object.entries(l).forEach(([u,h])=>{a.includes(u.toLowerCase())&&o.set(u,h)})}}if(oe.hasStandardBrowserEnv&&(s&&_.isFunction(s)&&(s=s(t)),s||s!==!1&&Wu(t.url))){const l=i&&n&&Xu.read(n);l&&o.set(i,l)}return t},Gu=typeof XMLHttpRequest<"u",Yu=Gu&&function(r){return new Promise(function(e,s){const i=Qn(r);let n=i.data;const o=ue.from(i.headers).normalize();let{responseType:f,onUploadProgress:l,onDownloadProgress:a}=i,u,h,d,g,p;function m(){g&&g(),p&&p(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function x(){if(!y)return;const E=ue.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),O={data:!f||f==="text"||f==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:E,config:r,request:y};Kn(function(F){e(F),m()},function(F){s(F),m()},O),y=null}"onloadend"in y?y.onloadend=x:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(x)},y.onabort=function(){y&&(s(new G("Request aborted",G.ECONNABORTED,r,y)),y=null)},y.onerror=function(M){const O=M&&M.message?M.message:"Network Error",U=new G(O,G.ERR_NETWORK,r,y);U.event=M||null,s(U),y=null},y.ontimeout=function(){let M=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const O=i.transitional||Gn;i.timeoutErrorMessage&&(M=i.timeoutErrorMessage),s(new G(M,O.clarifyTimeoutError?G.ETIMEDOUT:G.ECONNABORTED,r,y)),y=null},n===void 0&&o.setContentType(null),"setRequestHeader"in y&&_.forEach(o.toJSON(),function(M,O){y.setRequestHeader(O,M)}),_.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),f&&f!=="json"&&(y.responseType=i.responseType),a&&([d,p]=Lr(a,!0),y.addEventListener("progress",d)),l&&y.upload&&([h,g]=Lr(l),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(u=E=>{y&&(s(!E||E.type?new Ht(null,r,y):E),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const T=Nu(i.url);if(T&&oe.protocols.indexOf(T)===-1){s(new G("Unsupported protocol "+T+":",G.ERR_BAD_REQUEST,r));return}y.send(n||null)})},ju=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let s=new AbortController,i;const n=function(a){if(!i){i=!0,f();const u=a instanceof Error?a:this.reason;s.abort(u instanceof G?u:new Ht(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,n(new G(`timeout of ${t}ms exceeded`,G.ETIMEDOUT))},t);const f=()=>{r&&(o&&clearTimeout(o),o=null,r.forEach(a=>{a.unsubscribe?a.unsubscribe(n):a.removeEventListener("abort",n)}),r=null)};r.forEach(a=>a.addEventListener("abort",n));const{signal:l}=s;return l.unsubscribe=()=>_.asap(f),l}},Ku=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let s=0,i;for(;s<e;)i=s+t,yield r.slice(s,i),s=i},qu=async function*(r,t){for await(const e of Qu(r))yield*Ku(e,t)},Qu=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}},Bi=(r,t,e,s)=>{const i=qu(r,t);let n=0,o,f=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:a,value:u}=await i.next();if(a){f(),l.close();return}let h=u.byteLength;if(e){let d=n+=h;e(d)}l.enqueue(new Uint8Array(u))}catch(a){throw f(a),a}},cancel(l){return f(l),i.return()}},{highWaterMark:2})},Ui=64*1024,{isFunction:ur}=_,Zu=(({Request:r,Response:t})=>({Request:r,Response:t}))(_.global),{ReadableStream:$i,TextEncoder:Ni}=_.global,Di=(r,...t)=>{try{return!!r(...t)}catch{return!1}},Ju=r=>{r=_.merge.call({skipUndefined:!0},Zu,r);const{fetch:t,Request:e,Response:s}=r,i=t?ur(t):typeof fetch=="function",n=ur(e),o=ur(s);if(!i)return!1;const f=i&&ur($i),l=i&&(typeof Ni=="function"?(p=>m=>p.encode(m))(new Ni):async p=>new Uint8Array(await new e(p).arrayBuffer())),a=n&&f&&Di(()=>{let p=!1;const m=new e(oe.origin,{body:new $i,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!m}),u=o&&f&&Di(()=>_.isReadableStream(new s("").body)),h={stream:u&&(p=>p.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!h[p]&&(h[p]=(m,y)=>{let x=m&&m[p];if(x)return x.call(m);throw new G(`Response type '${p}' is not supported`,G.ERR_NOT_SUPPORT,y)})});const d=async p=>{if(p==null)return 0;if(_.isBlob(p))return p.size;if(_.isSpecCompliantForm(p))return(await new e(oe.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(_.isArrayBufferView(p)||_.isArrayBuffer(p))return p.byteLength;if(_.isURLSearchParams(p)&&(p=p+""),_.isString(p))return(await l(p)).byteLength},g=async(p,m)=>{const y=_.toFiniteNumber(p.getContentLength());return y??d(m)};return async p=>{let{url:m,method:y,data:x,signal:T,cancelToken:E,timeout:M,onDownloadProgress:O,onUploadProgress:U,responseType:F,headers:z,withCredentials:v="same-origin",fetchOptions:W}=Qn(p),I=t||fetch;F=F?(F+"").toLowerCase():"text";let S=ju([T,E&&E.toAbortSignal()],M),L=null;const A=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let D;try{if(U&&a&&y!=="get"&&y!=="head"&&(D=await g(z,x))!==0){let k=new e(m,{method:"POST",body:x,duplex:"half"}),B;if(_.isFormData(x)&&(B=k.headers.get("content-type"))&&z.setContentType(B),k.body){const[$,K]=Pi(D,Lr(Oi(U)));x=Bi(k.body,Ui,$,K)}}_.isString(v)||(v=v?"include":"omit");const C=n&&"credentials"in e.prototype,w={...W,signal:S,method:y.toUpperCase(),headers:z.normalize().toJSON(),body:x,duplex:"half",credentials:C?v:void 0};L=n&&new e(m,w);let R=await(n?I(L,W):I(m,w));const V=u&&(F==="stream"||F==="response");if(u&&(O||V&&A)){const k={};["status","statusText","headers"].forEach(X=>{k[X]=R[X]});const B=_.toFiniteNumber(R.headers.get("content-length")),[$,K]=O&&Pi(B,Lr(Oi(O),!0))||[];R=new s(Bi(R.body,Ui,$,()=>{K&&K(),A&&A()}),k)}F=F||"text";let N=await h[_.findKey(h,F)||"text"](R,p);return!V&&A&&A(),await new Promise((k,B)=>{Kn(k,B,{data:N,headers:ue.from(R.headers),status:R.status,statusText:R.statusText,config:p,request:L})})}catch(C){throw A&&A(),C&&C.name==="TypeError"&&/Load failed|fetch/i.test(C.message)?Object.assign(new G("Network Error",G.ERR_NETWORK,p,L),{cause:C.cause||C}):G.from(C,C&&C.code,p,L)}}},ec=new Map,Zn=r=>{let t=r&&r.env||{};const{fetch:e,Request:s,Response:i}=t,n=[s,i,e];let o=n.length,f=o,l,a,u=ec;for(;f--;)l=n[f],a=u.get(l),a===void 0&&u.set(l,a=f?new Map:Ju(t)),u=a;return a};Zn();const Xs={http:yu,xhr:Yu,fetch:{get:Zn}};_.forEach(Xs,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const zi=r=>`- ${r}`,tc=r=>_.isFunction(r)||r===null||r===!1;function rc(r,t){r=_.isArray(r)?r:[r];const{length:e}=r;let s,i;const n={};for(let o=0;o<e;o++){s=r[o];let f;if(i=s,!tc(s)&&(i=Xs[(f=String(s)).toLowerCase()],i===void 0))throw new G(`Unknown adapter '${f}'`);if(i&&(_.isFunction(i)||(i=i.get(t))))break;n[f||"#"+o]=i}if(!i){const o=Object.entries(n).map(([l,a])=>`adapter ${l} `+(a===!1?"is not supported by the environment":"is not available in the build"));let f=e?o.length>1?`since :
`+o.map(zi).join(`
`):" "+zi(o[0]):"as no adapter specified";throw new G("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return i}const Jn={getAdapter:rc,adapters:Xs};function ls(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Ht(null,r)}function Wi(r){return ls(r),r.headers=ue.from(r.headers),r.data=as.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Jn.getAdapter(r.adapter||Vt.adapter,r)(r).then(function(s){return ls(r),s.data=as.call(r,r.transformResponse,s),s.headers=ue.from(s.headers),s},function(s){return jn(s)||(ls(r),s&&s.response&&(s.response.data=as.call(r,r.transformResponse,s.response),s.response.headers=ue.from(s.response.headers))),Promise.reject(s)})}const eo="1.13.4",Xr={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{Xr[r]=function(s){return typeof s===r||"a"+(t<1?"n ":" ")+r}});const Xi={};Xr.transitional=function(t,e,s){function i(n,o){return"[Axios v"+eo+"] Transitional option '"+n+"'"+o+(s?". "+s:"")}return(n,o,f)=>{if(t===!1)throw new G(i(o," has been removed"+(e?" in "+e:"")),G.ERR_DEPRECATED);return e&&!Xi[o]&&(Xi[o]=!0,console.warn(i(o," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(n,o,f):!0}};Xr.spelling=function(t){return(e,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function sc(r,t,e){if(typeof r!="object")throw new G("options must be an object",G.ERR_BAD_OPTION_VALUE);const s=Object.keys(r);let i=s.length;for(;i-- >0;){const n=s[i],o=t[n];if(o){const f=r[n],l=f===void 0||o(f,n,r);if(l!==!0)throw new G("option "+n+" must be "+l,G.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new G("Unknown option "+n,G.ERR_BAD_OPTION)}}const Cr={assertOptions:sc,validators:Xr},me=Cr.validators;let Fe=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Ii,response:new Ii}}async request(t,e){try{return await this._request(t,e)}catch(s){if(s instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const n=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?n&&!String(s.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+n):s.stack=n}catch{}}throw s}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Ue(this.defaults,e);const{transitional:s,paramsSerializer:i,headers:n}=e;s!==void 0&&Cr.assertOptions(s,{silentJSONParsing:me.transitional(me.boolean),forcedJSONParsing:me.transitional(me.boolean),clarifyTimeoutError:me.transitional(me.boolean)},!1),i!=null&&(_.isFunction(i)?e.paramsSerializer={serialize:i}:Cr.assertOptions(i,{encode:me.function,serialize:me.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Cr.assertOptions(e,{baseUrl:me.spelling("baseURL"),withXsrfToken:me.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=n&&_.merge(n.common,n[e.method]);n&&_.forEach(["delete","get","head","post","put","patch","common"],p=>{delete n[p]}),e.headers=ue.concat(o,n);const f=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(e)===!1||(l=l&&m.synchronous,f.unshift(m.fulfilled,m.rejected))});const a=[];this.interceptors.response.forEach(function(m){a.push(m.fulfilled,m.rejected)});let u,h=0,d;if(!l){const p=[Wi.bind(this),void 0];for(p.unshift(...f),p.push(...a),d=p.length,u=Promise.resolve(e);h<d;)u=u.then(p[h++],p[h++]);return u}d=f.length;let g=e;for(;h<d;){const p=f[h++],m=f[h++];try{g=p(g)}catch(y){m.call(this,y);break}}try{u=Wi.call(this,g)}catch(p){return Promise.reject(p)}for(h=0,d=a.length;h<d;)u=u.then(a[h++],a[h++]);return u}getUri(t){t=Ue(this.defaults,t);const e=qn(t.baseURL,t.url,t.allowAbsoluteUrls);return Hn(e,t.params,t.paramsSerializer)}};_.forEach(["delete","get","head","options"],function(t){Fe.prototype[t]=function(e,s){return this.request(Ue(s||{},{method:t,url:e,data:(s||{}).data}))}});_.forEach(["post","put","patch"],function(t){function e(s){return function(n,o,f){return this.request(Ue(f||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}Fe.prototype[t]=e(),Fe.prototype[t+"Form"]=e(!0)});let ic=class to{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(n){e=n});const s=this;this.promise.then(i=>{if(!s._listeners)return;let n=s._listeners.length;for(;n-- >0;)s._listeners[n](i);s._listeners=null}),this.promise.then=i=>{let n;const o=new Promise(f=>{s.subscribe(f),n=f}).then(i);return o.cancel=function(){s.unsubscribe(n)},o},t(function(n,o,f){s.reason||(s.reason=new Ht(n,o,f),e(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=s=>{t.abort(s)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new to(function(i){t=i}),cancel:t}}};function nc(r){return function(e){return r.apply(null,e)}}function oc(r){return _.isObject(r)&&r.isAxiosError===!0}const Is={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Is).forEach(([r,t])=>{Is[t]=r});function ro(r){const t=new Fe(r),e=On(Fe.prototype.request,t);return _.extend(e,Fe.prototype,t,{allOwnKeys:!0}),_.extend(e,t,null,{allOwnKeys:!0}),e.create=function(i){return ro(Ue(r,i))},e}const Z=ro(Vt);Z.Axios=Fe;Z.CanceledError=Ht;Z.CancelToken=ic;Z.isCancel=jn;Z.VERSION=eo;Z.toFormData=Wr;Z.AxiosError=G;Z.Cancel=Z.CanceledError;Z.all=function(t){return Promise.all(t)};Z.spread=nc;Z.isAxiosError=oc;Z.mergeConfig=Ue;Z.AxiosHeaders=ue;Z.formToJSON=r=>Yn(_.isHTMLForm(r)?new FormData(r):r);Z.getAdapter=Jn.getAdapter;Z.HttpStatusCode=Is;Z.default=Z;const{Axios:xc,AxiosError:bc,CanceledError:Tc,isCancel:Sc,CancelToken:wc,VERSION:Cc,all:Ec,Cancel:Rc,isAxiosError:_c,spread:vc,toFormData:Ac,AxiosHeaders:kc,HttpStatusCode:Mc,formToJSON:Ic,getAdapter:Lc,mergeConfig:Pc}=Z,Pr=Z.create({baseURL:"https://api.themoviedb.org/3",params:{api_key:"c1e672f11dd715c09878f04137c94ba1"}});async function ac(r=!1){try{const t=[{title:"Popular Movies",path:"/movie/popular",type:"HorizontalContainer",width:200,height:200,rowH:200,onEnter:s=>`/details/${s}`,wBorder:!0},{title:"Trending Movies",path:"/trending/movie/week",type:"HorizontalContainer",width:200,height:600,onEnter:s=>`/details/${s}`,rowH:600,wBorder:!1},{title:"Top Rated Movies",path:"/movie/top_rated",type:"HorizontalContainer",width:640,height:360,itemOffset:50,onEnter:s=>`/details/${s}`,rowH:360,wBorder:!1},{title:"Upcoming Movies",path:"/movie/upcoming",type:"HorizontalContainer",width:200,height:100,onEnter:s=>`/details/${s}`,wBorder:!1,rowH:100}],e=await Promise.all(t.map(async s=>{const i=await Pr.get(s.path),n=(r?i.data.results.slice(0,5):i.data.results).map(o=>({onEnter:f=>`/details/${f}`,type:"Card",width:s.width,height:s.height,data:{title:o.title,poster_path:o.poster_path,overview:o.overview,backdrop_path:o.backdrop_path,id:o.id}}));return{title:s.title,items:n,type:s.type,rowH:s.rowH,wBorder:s.wBorder}}));return console.log(e),e}catch(t){return console.error("Error fetching movie sections:",t),[]}}const so=ce.Component("VerticalContainer",{components:{HorizontalContainer:Pn},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[],d=[],g={},p=[];let m,y,x,T=!1,E=[];a[0]={},l[0]=this.element({parent:t||"root"},T===!0?x:e),a[0].y={transition:e.y},l[0].populate(a[0]),t=l[0],d[1]=[],g[1]=[];let M,O;u[1]=(I=[],S,L)=>{const A=o(I),D=new Set;let C=A.length;const w={};for(M=w.from||0,O=("to"in w)?w.to:A.length;C--;)A[C],C<O&&C>=M&&D.add(""+C);let R=L.length;for(;R--;)if(D.has(L[R])===!1){const N=L[R];S[1][N]&&S[1][N].destroy(),S[1][N]=null,delete S[1][N],S[2][N]&&S[2][N].destroy(),S[2][N]=null,delete S[2][N]}L.length=0;const V=A.length;e!==null&&e[Symbol.for("removeGlobalEffects")](g[1]);for(let N=0;N<g[1].length;N++){const k=g[1][N],B=e[Symbol.for("effects")].indexOf(k);B>-1&&e[Symbol.for("effects")].splice(B,1)}g[1].length=0;for(let N=0;N<V;N++){if(N<M||N>=O)continue;let k=Object.create(e);if(t=S[0],k.item=A[N],k.index=N,k.key=""+N,L.push(k.key),E[1]=s.components&&s.components.Component||i.Component,S[1]===void 0&&(S[1]={}),a[1]={},S[1][k.key]===void 0&&(S[1][k.key]=this.element({parent:t||"root"},T===!0?x:e)),a[1].is=k.item.type,a[1].y=k.rowY(k.index),a[1].ref="list-item-"+k.index,a[1].key=k.index,a[1].items=k.item.items?k.item.items:k.item,a[1].title=k.item.title,a[1].autoScroll=!0,p[1]=[],typeof E[1]<"u")for(let K in E[1][Symbol.for("config")].props)delete a[1][E[1][Symbol.for("config")].props[K]],p[1].push(E[1][Symbol.for("config")].props[K]);if(S[1][k.key].nodeId===void 0&&S[1][k.key].populate(a[1]),S[2]===void 0&&(S[2]={}),t=S[1][k.key],h[2]={},S[2][k.key]===void 0){if(h[2].is=k.item.type,y=k.rowY(k.index),Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].y=y,y="list-item-"+k.index,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].ref=y,y=k.index,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].key=y,y=k.item.items?k.item.items:k.item,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[2].items=y,h[2].title=k.item.title,h[2].autoScroll=!0,m=h[2].is||"Component",i[2],typeof m=="string"){if(i[2]=s.components&&s.components[m]||i[m],!i[2])throw new Error('Component "Component" not found')}else typeof m=="function"&&m[Symbol.for("isComponent")]===!0&&(i[2]=m);S[2][k.key]=i[2].call(null,{props:h[2]},S[1][k.key],e),S[2][k.key][Symbol.for("slots")][0]?(t=S[2][k.key][Symbol.for("slots")][0],x=S[2][k.key],T=!0):t=S[2][k.key][Symbol.for("children")][0]}let B=()=>{(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("ref")===-1)&&S[1][k.key].set("ref","list-item-"+k.index)};n(B,null),g[1].push(B),e[Symbol.for("effects")].push(B);let $=()=>{(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("key")===-1)&&S[1][k.key].set("key",k.index)};n($,null),g[1].push($),e[Symbol.for("effects")].push($),S[2][k.key][Symbol.for("props")].ref="list-item-"+k.index,S[2][k.key][Symbol.for("props")].key=k.index}return g};let U=()=>{u[1](e.items,l,d[1])};e[Symbol.for("effects")].push(U),n(U,["items"]);let F=()=>{e.rowY;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("y")===-1)&&l[1][S.key].set("y",e.rowY(S.index))}};e[Symbol.for("effects")].push(F),n(F);let z=()=>{e.item;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,(typeof p>"u"||typeof p[1]>"u"||p[1].indexOf("items")===-1)&&l[1][S.key].set("items",S.item.items?S.item.items:S.item)}};e[Symbol.for("effects")].push(z),n(z);let v=()=>{e.rowY;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,l[2][S.key][Symbol.for("props")].y=e.rowY(S.index)}};e[Symbol.for("effects")].push(v),n(v);let W=()=>{e.item;for(let I=0;I<e.items.length;I++){if(I<M||I>=O)continue;const S={};S.index=I,S.item=e.items[I],S.key=I,l[2][S.key][Symbol.for("props")].items=S.item.items?S.item.items:S.item}};return e[Symbol.for("effects")].push(W),n(W),{elms:l,cleanup:()=>{y=null,x=null,t=null,d[1].length=0,E[1]=null,h[2]=null,i[2]=null,U=null,u[1]([],l,d[1]),u[1]=null,F=null,z=null,v=null,W=null,e=null,E.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0,p.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("y",{transition:t.y})}],context:{}},props:["autoScroll","autoscrollOffset","itemOffset","items","looping",{key:"gap",default:100}],state(){return{focused:0,y:0}},watch:{hasFocus(r){r&&this.$trigger("focused")},focused(r){const t=this.$select(`list-item-${r}`);t&&t.$focus&&(t.$focus(),this.scroll())}},methods:{changeFocus(r){const t=this.looping?(this.focused+r+this.items.length)%this.items.length:Math.max(0,Math.min(this.focused+r,this.items.length-1));this.focused=t},rowOffset(r){return r===0?0:this.items.slice(0,r).reduce((t,e)=>t+this.gap+(e!=null&&e.rowH?e==null?void 0:e.rowH:e.height),0)},rowY(r){return this.rowOffset(r)},scroll(){this.autoScroll&&(this.y=-this.rowOffset(this.focused))}},input:{up(){this.changeFocus(-1)},down(){this.changeFocus(1)},enter(){console.log("Selected item:",this.items[this.focused])}}}),lc=ce.Component("Home",{components:{VerticalContainer:so},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[];let d,g,p,m=!1,y=0,x=[];if(a[0]={},l[0]=this.element({parent:t||"root"},m===!0?p:e),a[0].w=1920,a[0].h=1080,a[0].src=e.src,l[0].populate(a[0]),m===!0&&(y-=1),t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},m===!0?p:e),a[1].w=1920,a[1].h=1080,a[1].color="{top: '0x000000ff', left: '0x000000ff'}",a[1].alpha=.6,l[1].populate(a[1]),m===!0&&(y-=1),x[2]=s.components&&s.components.VerticalContainer||i.VerticalContainer,t=l[0],a[2]={},l[2]=this.element({parent:t||"root"},m===!0?p:e),a[2].x=96,a[2].items=e.items,a[2].rowSpacing=30,a[2].ref="content",a[2].autoScroll=!0,a[2].looping=!0,h[2]=[],typeof x[2]<"u")for(let T in x[2][Symbol.for("config")].props)delete a[2][x[2][Symbol.for("config")].props[T]],h[2].push(x[2][Symbol.for("config")].props[T]);if(l[2].populate(a[2]),m===!0&&(y-=1),t=l[2],u[3]={},u[3].x=96,g=e.items,Array.isArray(g)===!0&&(g=o(g).slice(0)),u[3].items=g,u[3].rowSpacing=30,u[3].ref="content",u[3].autoScroll=!0,u[3].looping=!0,d=u[3].is||"VerticalContainer",i[3],typeof d=="string"){if(i[3]=s.components&&s.components[d]||i[d],!i[3])throw new Error('Component "VerticalContainer" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[3]=d);return l[3]=i[3].call(null,{props:u[3]},l[2],e),l[3][Symbol.for("slots")][0]?(t=l[3][Symbol.for("slots")][0],p=l[3],m=!0):t=l[3][Symbol.for("children")][0],m===!0&&y===0&&(m=!1),{elms:l,cleanup:()=>{g=null,p=null,t=null,x[2]=null,u[3]=null,i[3]=null,e=null,x.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("src",t.src)},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[2]>"u"||skips[2].indexOf("items")===-1)&&e[2].set("items",t.items)},function(t,e,s,i,n,o){e[3][Symbol.for("props")].items=t.items}],context:{}},state(){return{src:"",backgroundDebounce:null,items:[]}},hooks:{async init(){var r;await this.fetchData(),(r=this.$select("content"))==null||r.$focus(),this.$listen("changeBackground",({img:t})=>{this.backgroundDebounce&&this.$clearTimeout(this.backgroundDebounce),this.backgroundDebounce=this.$setTimeout(()=>{this.src=t},1e3)})},ready(){}},methods:{leftKeyUp(){console.log("left released")},async fetchData(){const r=await ac(!1);this.items=r}},input:{}});async function fc(r){return(await Pr.get("/movie/"+r)).data}async function uc(r){try{const t=[],e=["Trailers","Bonus","Related"];for(let o=1;o<=3;o++)t.push(Pr.get(`/movie/${r}/similar`,{params:{page:o}}));t.push(Pr.get(`/movie/${r}/credits`));const s=await Promise.all(t),i=s.slice(0,3).map((o,f)=>({title:e[f],type:"HorizontalContainer",rowH:216,items:o.data.results.map(l=>({data:l,type:"Card",width:330,height:198,onEnter:a=>`/details/${a}`}))})),n={title:"Tuljani",rowH:216,type:"HorizontalContainer",items:s[3].data.cast.slice(0,5).map(o=>({data:{backdrop_path:o.profile_path},id:o.id,text:o.name,subText:o.character,type:"Card",onEnter:f=>`/person/${f}`,width:170,height:170,radius:100}))};return i.push(n),i}catch(t){return console.error("Error fetching similar movies (5 pages):",t),[]}}const cc=ce.Component("Button",{props:["label","icon"],state(){return{textWidth:0,height:44}},computed:{width(){this.textWidth;const r=22.5*2;return this.textWidth+0+0+r}},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[];return a[0]={},l[0]=this.element({parent:t||"root"},e),a[0].w=e.width,a[0].h=e.height,a[0].effects=[{type:"radius",props:{radius:25}}],a[0].color=e.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x3d3d3dff",l[0].populate(a[0]),t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},e),a[1].placement="{ x: 'middle', y: 'middle' }",a[1].padding="{ left: 22.5, right: 22.5 }",a[1].__layout=!0,l[1].populate(a[1]),t=l[1],a[2]={},l[2]=this.element({parent:t||"root"},e),a[2].content=e.label,a[2].color="0xffffffff",a[2].font="PoppinsMedium",a[2].size=20,a[2]["@loaded"]=e.onTextLoaded&&e.onTextLoaded.bind(e),a[2].__textnode=!0,l[2].populate(a[2]),{elms:l,cleanup:()=>{t=null,e=null,l.length=0,i.length=0,a.length=0}}},effects:[function(t,e,s,i,n,o){e[0].set("w",t.width)},function(t,e,s,i,n,o){e[0].set("h",t.height)},function(t,e,s,i,n,o){e[0].set("effects",[{type:"radius",props:{radius:25}}])},function(t,e,s,i,n,o){e[0].set("color",t.hasFocus?{left:"0xed51f0ff",right:"0x9a33ffff"}:"0x3d3d3dff")},function(t,e,s,i,n,o){e[2].set("content",t.label)}],context:{}},methods:{onTextLoaded({w:r}){this.textWidth=r,this.$size({w:this.width,h:this.height})}}}),hc=ce.Component("Detail",{props:["id"],components:{Column:If,VerticalContainer:so,GenreLabel:cc},code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[],d=[],g={},p=[];let m,y,x,T=!1,E=0,M=[];a[0]={},l[0]=this.element({parent:t||"root"},T===!0?x:e),a[0].w=1920,a[0].h=1080,a[0].color="0x0d0e12ff",l[0].populate(a[0]),T===!0&&(E-=1),t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},T===!0?x:e),a[1].x=318,a[1].w=1600,a[1].h=900,a[1].src=e.backdrop,l[1].populate(a[1]),T===!0&&(E-=1),t=l[0],a[2]={},l[2]=this.element({parent:t||"root"},T===!0?x:e),a[2].x=318,a[2].w=1600,a[2].h=900,a[2].color="{left: '0x0d0e12ff', bottom: '0x0d0e12ff'}",l[2].populate(a[2]),T===!0&&(E-=1),t=l[2],a[3]={},l[3]=this.element({parent:t||"root"},T===!0?x:e),a[3].width=1920,a[3].height=1006,a[3].y=48,l[3].populate(a[3]),T===!0&&(E-=1),t=l[3],a[4]={},l[4]=this.element({parent:t||"root"},T===!0?x:e),a[4].width=832,a[4].height=556,a[4].x="-228",l[4].populate(a[4]),T===!0&&(E-=1),t=l[3],a[5]={},l[5]=this.element({parent:t||"root"},T===!0?x:e),a[5].x="-228",a[5].width=832,a[5].height=115,a[5].font="AntonRegular",a[5].size=115,a[5].contain="width",a[5].maxlines=1,a[5].maxheight=100,a[5].content=e.title,a[5].__textnode=!0,l[5].populate(a[5]),T===!0&&(E-=1),t=l[3],a[6]={},l[6]=this.element({parent:t||"root"},T===!0?x:e),a[6].gap=22.5,a[6].y=155,a[6].x="-228",a[6].__layout=!0,l[6].populate(a[6]),T===!0&&(E-=1),t=l[6],a[7]={},l[7]=this.element({parent:t||"root"},T===!0?x:e),a[7].content=e.date,a[7].y=155,a[7].x="-228",a[7].__textnode=!0,l[7].populate(a[7]),T===!0&&(E-=1),t=l[6],a[8]={},l[8]=this.element({parent:t||"root"},T===!0?x:e),a[8].content=e.runtime,a[8].__textnode=!0,l[8].populate(a[8]),T===!0&&(E-=1),t=l[6],d[9]=[],g[9]=[];let O,U;u[9]=(C=[],w,R)=>{const V=o(C),N=new Set;let k=V.length;const B={};for(O=B.from||0,U=("to"in B)?B.to:V.length;k--;)V[k],k<U&&k>=O&&N.add(""+k);let $=R.length;for(;$--;)if(N.has(R[$])===!1){const X=R[$];w[9][X]&&w[9][X].destroy(),w[9][X]=null,delete w[9][X]}R.length=0;const K=V.length;e!==null&&e[Symbol.for("removeGlobalEffects")](g[9]);for(let X=0;X<g[9].length;X++){const H=g[9][X],Q=e[Symbol.for("effects")].indexOf(H);Q>-1&&e[Symbol.for("effects")].splice(Q,1)}g[9].length=0;for(let X=0;X<K;X++){if(X<O||X>=U)continue;let H=Object.create(e);t=w[6],H.item=V[X],H.index=X,H.key=""+X,R.push(H.key),t=w[6],w[9]===void 0&&(w[9]={}),a[9]={},w[9][H.key]===void 0&&(w[9][H.key]=this.element({parent:t||"root"},T===!0?x:e)),a[9].width=62,a[9].height=37,a[9].src=H.item,a[9].fit="{ type: 'contain', position: { x: 0.5, y: 0.5 } }",w[9][H.key].nodeId===void 0&&(w[9][H.key].populate(a[9]),T===!0&&(E-=1))}return g};let F=()=>{u[9](e.productionCompanies,l,d[9])};e[Symbol.for("effects")].push(F),n(F,["productionCompanies"]);let z=()=>{e.item;for(let C=0;C<e.productionCompanies.length;C++){if(C<O||C>=U)continue;const w={};w.index=C,w.item=e.productionCompanies[C],w.key=C,l[9][w.key].set("src",w.item)}};e[Symbol.for("effects")].push(z),n(z),t=l[3],a[10]={},l[10]=this.element({parent:t||"root"},T===!0?x:e),a[10].y=316,a[10].x="-228",a[10].width=832,a[10].maxlines=4,a[10].contain="width",a[10].font="PoppinsMedium",a[10].size=26,a[10].content=e.data.overview,a[10].__textnode=!0,l[10].populate(a[10]),T===!0&&(E-=1),t=l[3],a[11]={},l[11]=this.element({parent:t||"root"},T===!0?x:e),a[11].direction="horizontal",a[11].gap=22.5,a[11].y=512,a[11].x="-228",a[11].__layout=!0,l[11].populate(a[11]),T===!0&&(E-=1),t=l[11],console.warn(" Using 'index' in the key, like key=$index,  is not recommended"),d[12]=[],g[12]=[];let v,W;u[12]=(C=[],w,R)=>{const V=o(C),N=new Set;let k=V.length;const B={};for(v=B.from||0,W=("to"in B)?B.to:V.length;k--;){V[k];const X=k;k<W&&k>=v&&N.add(""+X)}let $=R.length;for(;$--;)if(N.has(R[$])===!1){const X=R[$];w[12][X]&&w[12][X].destroy(),w[12][X]=null,delete w[12][X],w[13][X]&&w[13][X].destroy(),w[13][X]=null,delete w[13][X]}R.length=0;const K=V.length;e!==null&&e[Symbol.for("removeGlobalEffects")](g[12]);for(let X=0;X<g[12].length;X++){const H=g[12][X],Q=e[Symbol.for("effects")].indexOf(H);Q>-1&&e[Symbol.for("effects")].splice(Q,1)}g[12].length=0;for(let X=0;X<K;X++){if(X<v||X>=W)continue;let H=Object.create(e);if(t=w[11],H.item=V[X],H.index=X,H.key=""+H.index,R.push(H.key),M[12]=s.components&&s.components.GenreLabel||i.GenreLabel,w[12]===void 0&&(w[12]={}),a[12]={},w[12][H.key]===void 0&&(w[12][H.key]=this.element({parent:t||"root"},T===!0?x:e)),a[12].content=H.item,a[12].height=44,a[12].size=26,a[12].label=H.item,p[12]=[],typeof M[12]<"u")for(let Q in M[12][Symbol.for("config")].props)delete a[12][M[12][Symbol.for("config")].props[Q]],p[12].push(M[12][Symbol.for("config")].props[Q]);if(w[12][H.key].nodeId===void 0&&(w[12][H.key].populate(a[12]),T===!0&&(E-=1)),w[13]===void 0&&(w[13]={}),t=w[12][H.key],h[13]={},w[13][H.key]===void 0){if(y=H.item,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[13].content=y,h[13].height=44,h[13].size=26,y=H.item,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[13].label=y,m=h[13].is||"GenreLabel",i[13],typeof m=="string"){if(i[13]=s.components&&s.components[m]||i[m],!i[13])throw new Error('Component "GenreLabel" not found')}else typeof m=="function"&&m[Symbol.for("isComponent")]===!0&&(i[13]=m);w[13][H.key]=i[13].call(null,{props:h[13]},w[12][H.key],e),w[13][H.key][Symbol.for("slots")][0]?(t=w[13][H.key][Symbol.for("slots")][0],x=w[13][H.key],T=!0):t=w[13][H.key][Symbol.for("children")][0]}}return g};let I=()=>{u[12](e.genres,l,d[12])};e[Symbol.for("effects")].push(I),n(I,["genres"]);let S=()=>{e.item;for(let C=0;C<e.genres.length;C++){if(C<v||C>=W)continue;const w={};w.index=C,w.item=e.genres[C],w.key=w.index,(typeof p>"u"||typeof p[12]>"u"||p[12].indexOf("content")===-1)&&l[12][w.key].set("content",w.item)}};e[Symbol.for("effects")].push(S),n(S);let L=()=>{e.item;for(let C=0;C<e.genres.length;C++){if(C<v||C>=W)continue;const w={};w.index=C,w.item=e.genres[C],w.key=w.index,(typeof p>"u"||typeof p[12]>"u"||p[12].indexOf("label")===-1)&&l[12][w.key].set("label",w.item)}};e[Symbol.for("effects")].push(L),n(L);let A=()=>{e.item;for(let C=0;C<e.genres.length;C++){if(C<v||C>=W)continue;const w={};w.index=C,w.item=e.genres[C],w.key=w.index,l[13][w.key][Symbol.for("props")].content=w.item}};e[Symbol.for("effects")].push(A),n(A);let D=()=>{e.item;for(let C=0;C<e.genres.length;C++){if(C<v||C>=W)continue;const w={};w.index=C,w.item=e.genres[C],w.key=w.index,l[13][w.key][Symbol.for("props")].label=w.item}};if(e[Symbol.for("effects")].push(D),n(D),t=l[3],a[14]={},l[14]=this.element({parent:t||"root"},T===!0?x:e),a[14].x="-318",a[14].width=1920,a[14].height=495,a[14].y=584,a[14].overflow=!1,l[14].populate(a[14]),T===!0&&(E-=1),M[15]=s.components&&s.components.VerticalContainer||i.VerticalContainer,t=l[14],a[15]={},l[15]=this.element({parent:t||"root"},T===!0?x:e),a[15].x=96,a[15].items=e.similar,a[15].rowSpacing=30,a[15].ref="content",a[15].autoScroll=!0,a[15].looping=!0,a[15].clipping=!1,p[15]=[],typeof M[15]<"u")for(let C in M[15][Symbol.for("config")].props)delete a[15][M[15][Symbol.for("config")].props[C]],p[15].push(M[15][Symbol.for("config")].props[C]);if(l[15].populate(a[15]),T===!0&&(E-=1),t=l[15],h[16]={},h[16].x=96,y=e.similar,Array.isArray(y)===!0&&(y=o(y).slice(0)),h[16].items=y,h[16].rowSpacing=30,h[16].ref="content",h[16].autoScroll=!0,h[16].looping=!0,h[16].clipping=!1,m=h[16].is||"VerticalContainer",i[16],typeof m=="string"){if(i[16]=s.components&&s.components[m]||i[m],!i[16])throw new Error('Component "VerticalContainer" not found')}else typeof m=="function"&&m[Symbol.for("isComponent")]===!0&&(i[16]=m);return l[16]=i[16].call(null,{props:h[16]},l[15],e),l[16][Symbol.for("slots")][0]?(t=l[16][Symbol.for("slots")][0],x=l[16],T=!0):t=l[16][Symbol.for("children")][0],T===!0&&E===0&&(T=!1),{elms:l,cleanup:()=>{y=null,x=null,t=null,d[9].length=0,F=null,u[9]([],l,d[9]),u[9]=null,z=null,d[12].length=0,M[12]=null,h[13]=null,i[13]=null,I=null,u[12]([],l,d[12]),u[12]=null,S=null,L=null,A=null,D=null,M[15]=null,h[16]=null,i[16]=null,e=null,M.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0,p.length=0}}},effects:[function(t,e,s,i,n,o){e[1].set("src",t.backdrop)},function(t,e,s,i,n,o){e[5].set("content",t.title)},function(t,e,s,i,n,o){e[7].set("content",t.date)},function(t,e,s,i,n,o){e[8].set("content",t.runtime)},function(t,e,s,i,n,o){e[10].set("content",t.data.overview)},function(t,e,s,i,n,o){(typeof skips>"u"||typeof skips[15]>"u"||skips[15].indexOf("items")===-1)&&e[15].set("items",t.similar)},function(t,e,s,i,n,o){e[16][Symbol.for("props")].items=t.similar}],context:{}},state(){return{data:{},backdrop:"",genres:[],similar:[],focused:0,productionCompanies:[]}},hooks:{async init(){var r;this.data=await fc(this.id),this.productionCompanies=this.data.production_companies.filter(t=>t.logo_path).map(t=>Ir(t.logo_path)),this.genres=this.data.genres.map(t=>t.name).sort(),this.backdrop=Ir((r=this.data)==null?void 0:r.backdrop_path),this.similar=await uc(this.id),this.$select("content").$focus()},focus(){}},computed:{title(){var r,t;return this.data,((r=this.data)==null?void 0:r.title)||((t=this.data)==null?void 0:t.original_title)||""},date(){var r,t;return this.data,((t=(r=this.data)==null?void 0:r.release_date)==null?void 0:t.split("-")[0])||"N/A"},runtime(){var t,e;this.data;const r=Math.floor(((t=this.data)==null?void 0:t.runtime)/60);return r<0?"":r+":"+(((e=this.data)==null?void 0:e.runtime)%60).toString().padStart(2,"0")}}}),dc=ce.Application({code:{render:function(t,e,s,i,n,o,f){const l=[],a=[],u=[],h=[];let d,g,p=!1,m=0,y=[];if(a[0]={},l[0]=this.element({parent:t||"root"},p===!0?g:e),l[0].populate(a[0]),p===!0&&(m-=1),y[1]=s.components&&s.components.RouterView||i.RouterView,t=l[0],a[1]={},l[1]=this.element({parent:t||"root"},p===!0?g:e),h[1]=[],typeof y[1]<"u")for(let x in y[1][Symbol.for("config")].props)delete a[1][y[1][Symbol.for("config")].props[x]],h[1].push(y[1][Symbol.for("config")].props[x]);if(l[1].populate(a[1]),p===!0&&(m-=1),t=l[1],u[2]={},d=u[2].is||"RouterView",i[2],typeof d=="string"){if(i[2]=s.components&&s.components[d]||i[d],!i[2])throw new Error('Component "RouterView" not found')}else typeof d=="function"&&d[Symbol.for("isComponent")]===!0&&(i[2]=d);return l[2]=i[2].call(null,{props:u[2]},l[1],e),l[2][Symbol.for("slots")][0]?(t=l[2][Symbol.for("slots")][0],g=l[2],p=!0):t=l[2][Symbol.for("children")][0],p===!0&&m===0&&(p=!1),{elms:l,cleanup:()=>{g=null,t=null,y[1]=null,u[2]=null,i[2]=null,e=null,y.length=0,l.length=0,i.length=0,a.length=0,u.length=0,h.length=0}}},effects:[],context:{}},routes:[{path:"/",component:lc,options:{keepAlive:!0}},{path:"/details/:id",component:hc}]});ce.Launch(dc,"app",{w:1920,h:1080,debugLevel:1,defaultFont:"InterRegular",inspector:!0,inputThrottle:300,fonts:[{family:"lato",type:"msdf",file:"fonts/Lato-Regular.ttf"},{family:"raleway",type:"msdf",file:"fonts/Raleway-ExtraBold.ttf"},{family:"InterBold",type:"msdf",file:"fonts/Inter_24pt-Bold.ttf"},{family:"InterRegular",type:"msdf",file:"fonts/Inter_24pt-Regular.ttf"},{family:"InterSemiBold",type:"msdf",file:"fonts/Inter_24pt-SemiBold.ttf"},{family:"PoppinsSemiBold",type:"msdf",file:"fonts/Poppins-SemiBold.ttf"},{family:"PoppinsMedium",type:"msdf",file:"fonts/Poppins-Medium.ttf"},{family:"AntonRegular",type:"msdf",file:"fonts/Anton-Regular.ttf"}]});
